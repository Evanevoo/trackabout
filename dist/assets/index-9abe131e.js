function ik(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sk(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var _y={exports:{}},Ad={},by={exports:{}},jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z0=Symbol.for("react.element"),ok=Symbol.for("react.portal"),lk=Symbol.for("react.fragment"),ck=Symbol.for("react.strict_mode"),uk=Symbol.for("react.profiler"),fk=Symbol.for("react.provider"),hk=Symbol.for("react.context"),dk=Symbol.for("react.forward_ref"),pk=Symbol.for("react.suspense"),mk=Symbol.for("react.memo"),gk=Symbol.for("react.lazy"),yx=Symbol.iterator;function xk(e){return e===null||typeof e!="object"?null:(e=yx&&e[yx]||e["@@iterator"],typeof e=="function"?e:null)}var ky={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sy=Object.assign,Ey={};function Bc(e,t,r){this.props=e,this.context=t,this.refs=Ey,this.updater=r||ky}Bc.prototype.isReactComponent={};Bc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Bc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ay(){}Ay.prototype=Bc.prototype;function d2(e,t,r){this.props=e,this.context=t,this.refs=Ey,this.updater=r||ky}var p2=d2.prototype=new Ay;p2.constructor=d2;Sy(p2,Bc.prototype);p2.isPureReactComponent=!0;var wx=Array.isArray,Ny=Object.prototype.hasOwnProperty,m2={current:null},Ty={key:!0,ref:!0,__self:!0,__source:!0};function Cy(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)Ny.call(t,n)&&!Ty.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:z0,type:e,key:i,ref:s,props:a,_owner:m2.current}}function vk(e,t){return{$$typeof:z0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function g2(e){return typeof e=="object"&&e!==null&&e.$$typeof===z0}function yk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var _x=/\/+/g;function $1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yk(""+e.key):t.toString(36)}function bh(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case z0:case ok:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+$1(s,0):n,wx(a)?(r="",e!=null&&(r=e.replace(_x,"$&/")+"/"),bh(a,t,r,"",function(c){return c})):a!=null&&(g2(a)&&(a=vk(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(_x,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",wx(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+$1(i,o);s+=bh(i,t,r,l,a)}else if(l=xk(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+$1(i,o++),s+=bh(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function $f(e,t,r){if(e==null)return e;var n=[],a=0;return bh(e,n,"","",function(i){return t.call(r,i,a++)}),n}function wk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Kn={current:null},kh={transition:null},_k={ReactCurrentDispatcher:Kn,ReactCurrentBatchConfig:kh,ReactCurrentOwner:m2};function Ly(){throw Error("act(...) is not supported in production builds of React.")}jt.Children={map:$f,forEach:function(e,t,r){$f(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return $f(e,function(){t++}),t},toArray:function(e){return $f(e,function(t){return t})||[]},only:function(e){if(!g2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};jt.Component=Bc;jt.Fragment=lk;jt.Profiler=uk;jt.PureComponent=d2;jt.StrictMode=ck;jt.Suspense=pk;jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_k;jt.act=Ly;jt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Sy({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=m2.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Ny.call(t,l)&&!Ty.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:z0,type:e.type,key:a,ref:i,props:n,_owner:s}};jt.createContext=function(e){return e={$$typeof:hk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fk,_context:e},e.Consumer=e};jt.createElement=Cy;jt.createFactory=function(e){var t=Cy.bind(null,e);return t.type=e,t};jt.createRef=function(){return{current:null}};jt.forwardRef=function(e){return{$$typeof:dk,render:e}};jt.isValidElement=g2;jt.lazy=function(e){return{$$typeof:gk,_payload:{_status:-1,_result:e},_init:wk}};jt.memo=function(e,t){return{$$typeof:mk,type:e,compare:t===void 0?null:t}};jt.startTransition=function(e){var t=kh.transition;kh.transition={};try{e()}finally{kh.transition=t}};jt.unstable_act=Ly;jt.useCallback=function(e,t){return Kn.current.useCallback(e,t)};jt.useContext=function(e){return Kn.current.useContext(e)};jt.useDebugValue=function(){};jt.useDeferredValue=function(e){return Kn.current.useDeferredValue(e)};jt.useEffect=function(e,t){return Kn.current.useEffect(e,t)};jt.useId=function(){return Kn.current.useId()};jt.useImperativeHandle=function(e,t,r){return Kn.current.useImperativeHandle(e,t,r)};jt.useInsertionEffect=function(e,t){return Kn.current.useInsertionEffect(e,t)};jt.useLayoutEffect=function(e,t){return Kn.current.useLayoutEffect(e,t)};jt.useMemo=function(e,t){return Kn.current.useMemo(e,t)};jt.useReducer=function(e,t,r){return Kn.current.useReducer(e,t,r)};jt.useRef=function(e){return Kn.current.useRef(e)};jt.useState=function(e){return Kn.current.useState(e)};jt.useSyncExternalStore=function(e,t,r){return Kn.current.useSyncExternalStore(e,t,r)};jt.useTransition=function(){return Kn.current.useTransition()};jt.version="18.3.1";by.exports=jt;var ge=by.exports;const bk=wy(ge),kk=ik({__proto__:null,default:bk},[ge]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sk=ge,Ek=Symbol.for("react.element"),Ak=Symbol.for("react.fragment"),Nk=Object.prototype.hasOwnProperty,Tk=Sk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ck={key:!0,ref:!0,__self:!0,__source:!0};function Fy(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Nk.call(t,n)&&!Ck.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Ek,type:e,key:i,ref:s,props:a,_owner:Tk.current}}Ad.Fragment=Ak;Ad.jsx=Fy;Ad.jsxs=Fy;_y.exports=Ad;var m=_y.exports,Py={exports:{}},Ta={},Iy={exports:{}},jy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,q){var Z=ie.length;ie.push(q);e:for(;0<Z;){var oe=Z-1>>>1,b=ie[oe];if(0<a(b,q))ie[oe]=q,ie[Z]=b,Z=oe;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var q=ie[0],Z=ie.pop();if(Z!==q){ie[0]=Z;e:for(var oe=0,b=ie.length,A=b>>>1;oe<A;){var C=2*(oe+1)-1,R=ie[C],H=C+1,re=ie[H];if(0>a(R,Z))H<b&&0>a(re,R)?(ie[oe]=re,ie[H]=Z,oe=H):(ie[oe]=R,ie[C]=Z,oe=C);else if(H<b&&0>a(re,Z))ie[oe]=re,ie[H]=Z,oe=H;else break e}}return q}function a(ie,q){var Z=ie.sortIndex-q.sortIndex;return Z!==0?Z:ie.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,h=null,p=3,d=!1,y=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(ie){for(var q=r(c);q!==null;){if(q.callback===null)n(c);else if(q.startTime<=ie)n(c),q.sortIndex=q.expirationTime,t(l,q);else break;q=r(c)}}function j(ie){if(x=!1,_(ie),!y)if(r(l)!==null)y=!0,le(D);else{var q=r(c);q!==null&&fe(j,q.startTime-ie)}}function D(ie,q){y=!1,x&&(x=!1,v(T),T=-1),d=!0;var Z=p;try{for(_(q),h=r(l);h!==null&&(!(h.expirationTime>q)||ie&&!F());){var oe=h.callback;if(typeof oe=="function"){h.callback=null,p=h.priorityLevel;var b=oe(h.expirationTime<=q);q=e.unstable_now(),typeof b=="function"?h.callback=b:h===r(l)&&n(l),_(q)}else n(l);h=r(l)}if(h!==null)var A=!0;else{var C=r(c);C!==null&&fe(j,C.startTime-q),A=!1}return A}finally{h=null,p=Z,d=!1}}var z=!1,I=null,T=-1,L=5,O=-1;function F(){return!(e.unstable_now()-O<L)}function N(){if(I!==null){var ie=e.unstable_now();O=ie;var q=!0;try{q=I(!0,ie)}finally{q?M():(z=!1,I=null)}}else z=!1}var M;if(typeof k=="function")M=function(){k(N)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,he=K.port2;K.port1.onmessage=N,M=function(){he.postMessage(null)}}else M=function(){S(N,0)};function le(ie){I=ie,z||(z=!0,M())}function fe(ie,q){T=S(function(){ie(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){y||d||(y=!0,le(D))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ie){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var Z=p;p=q;try{return ie()}finally{p=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,q){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Z=p;p=ie;try{return q()}finally{p=Z}},e.unstable_scheduleCallback=function(ie,q,Z){var oe=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?oe+Z:oe):Z=oe,ie){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=Z+b,ie={id:u++,callback:q,priorityLevel:ie,startTime:Z,expirationTime:b,sortIndex:-1},Z>oe?(ie.sortIndex=Z,t(c,ie),r(l)===null&&ie===r(c)&&(x?(v(T),T=-1):x=!0,fe(j,Z-oe))):(ie.sortIndex=b,t(l,ie),y||d||(y=!0,le(D))),ie},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(ie){var q=p;return function(){var Z=p;p=q;try{return ie.apply(this,arguments)}finally{p=Z}}}})(jy);Iy.exports=jy;var Lk=Iy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fk=ge,Aa=Lk;function Xe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ry=new Set,h0={};function ol(e,t){Nc(e,t),Nc(e+"Capture",t)}function Nc(e,t){for(h0[e]=t,e=0;e<t.length;e++)Ry.add(t[e])}var ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qp=Object.prototype.hasOwnProperty,Pk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bx={},kx={};function Ik(e){return qp.call(kx,e)?!0:qp.call(bx,e)?!1:Pk.test(e)?kx[e]=!0:(bx[e]=!0,!1)}function jk(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Rk(e,t,r,n){if(t===null||typeof t>"u"||jk(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xn(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){vn[e]=new Xn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];vn[t]=new Xn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){vn[e]=new Xn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){vn[e]=new Xn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){vn[e]=new Xn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){vn[e]=new Xn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){vn[e]=new Xn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){vn[e]=new Xn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){vn[e]=new Xn(e,5,!1,e.toLowerCase(),null,!1,!1)});var x2=/[\-:]([a-z])/g;function v2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x2,v2);vn[t]=new Xn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x2,v2);vn[t]=new Xn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x2,v2);vn[t]=new Xn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){vn[e]=new Xn(e,1,!1,e.toLowerCase(),null,!1,!1)});vn.xlinkHref=new Xn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){vn[e]=new Xn(e,1,!1,e.toLowerCase(),null,!0,!0)});function y2(e,t,r,n){var a=vn.hasOwnProperty(t)?vn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Rk(t,r,a,n)&&(r=null),n||a===null?Ik(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ws=Fk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qf=Symbol.for("react.element"),Zl=Symbol.for("react.portal"),ec=Symbol.for("react.fragment"),w2=Symbol.for("react.strict_mode"),Hp=Symbol.for("react.profiler"),Oy=Symbol.for("react.provider"),Dy=Symbol.for("react.context"),_2=Symbol.for("react.forward_ref"),Vp=Symbol.for("react.suspense"),Wp=Symbol.for("react.suspense_list"),b2=Symbol.for("react.memo"),qs=Symbol.for("react.lazy"),My=Symbol.for("react.offscreen"),Sx=Symbol.iterator;function Su(e){return e===null||typeof e!="object"?null:(e=Sx&&e[Sx]||e["@@iterator"],typeof e=="function"?e:null)}var _r=Object.assign,q1;function Ru(e){if(q1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);q1=t&&t[1]||""}return`
`+q1+e}var H1=!1;function V1(e,t){if(!e||H1)return"";H1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{H1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ru(e):""}function Ok(e){switch(e.tag){case 5:return Ru(e.type);case 16:return Ru("Lazy");case 13:return Ru("Suspense");case 19:return Ru("SuspenseList");case 0:case 2:case 15:return e=V1(e.type,!1),e;case 11:return e=V1(e.type.render,!1),e;case 1:return e=V1(e.type,!0),e;default:return""}}function Gp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ec:return"Fragment";case Zl:return"Portal";case Hp:return"Profiler";case w2:return"StrictMode";case Vp:return"Suspense";case Wp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Dy:return(e.displayName||"Context")+".Consumer";case Oy:return(e._context.displayName||"Context")+".Provider";case _2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case b2:return t=e.displayName||null,t!==null?t:Gp(e.type)||"Memo";case qs:t=e._payload,e=e._init;try{return Gp(e(t))}catch{}}return null}function Dk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gp(t);case 8:return t===w2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function mo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function By(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mk(e){var t=By(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hf(e){e._valueTracker||(e._valueTracker=Mk(e))}function Uy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=By(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Mh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Kp(e,t){var r=t.checked;return _r({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Ex(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=mo(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function zy(e,t){t=t.checked,t!=null&&y2(e,"checked",t,!1)}function Xp(e,t){zy(e,t);var r=mo(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Yp(e,t.type,r):t.hasOwnProperty("defaultValue")&&Yp(e,t.type,mo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ax(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Yp(e,t,r){(t!=="number"||Mh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ou=Array.isArray;function dc(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+mo(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Jp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Xe(91));return _r({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Nx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Xe(92));if(Ou(r)){if(1<r.length)throw Error(Xe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:mo(r)}}function $y(e,t){var r=mo(t.value),n=mo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Tx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function qy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?qy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vf,Hy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Vf=Vf||document.createElement("div"),Vf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Vf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function d0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Hu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bk=["Webkit","ms","Moz","O"];Object.keys(Hu).forEach(function(e){Bk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hu[t]=Hu[e]})});function Vy(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Hu.hasOwnProperty(e)&&Hu[e]?(""+t).trim():t+"px"}function Wy(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Vy(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Uk=_r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zp(e,t){if(t){if(Uk[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Xe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Xe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Xe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Xe(62))}}function em(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tm=null;function k2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rm=null,pc=null,mc=null;function Cx(e){if(e=H0(e)){if(typeof rm!="function")throw Error(Xe(280));var t=e.stateNode;t&&(t=Fd(t),rm(e.stateNode,e.type,t))}}function Gy(e){pc?mc?mc.push(e):mc=[e]:pc=e}function Ky(){if(pc){var e=pc,t=mc;if(mc=pc=null,Cx(e),t)for(e=0;e<t.length;e++)Cx(t[e])}}function Xy(e,t){return e(t)}function Yy(){}var W1=!1;function Jy(e,t,r){if(W1)return e(t,r);W1=!0;try{return Xy(e,t,r)}finally{W1=!1,(pc!==null||mc!==null)&&(Yy(),Ky())}}function p0(e,t){var r=e.stateNode;if(r===null)return null;var n=Fd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Xe(231,t,typeof r));return r}var nm=!1;if(ps)try{var Eu={};Object.defineProperty(Eu,"passive",{get:function(){nm=!0}}),window.addEventListener("test",Eu,Eu),window.removeEventListener("test",Eu,Eu)}catch{nm=!1}function zk(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Vu=!1,Bh=null,Uh=!1,am=null,$k={onError:function(e){Vu=!0,Bh=e}};function qk(e,t,r,n,a,i,s,o,l){Vu=!1,Bh=null,zk.apply($k,arguments)}function Hk(e,t,r,n,a,i,s,o,l){if(qk.apply(this,arguments),Vu){if(Vu){var c=Bh;Vu=!1,Bh=null}else throw Error(Xe(198));Uh||(Uh=!0,am=c)}}function ll(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Qy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Lx(e){if(ll(e)!==e)throw Error(Xe(188))}function Vk(e){var t=e.alternate;if(!t){if(t=ll(e),t===null)throw Error(Xe(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Lx(a),e;if(i===n)return Lx(a),t;i=i.sibling}throw Error(Xe(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(Xe(189))}}if(r.alternate!==n)throw Error(Xe(190))}if(r.tag!==3)throw Error(Xe(188));return r.stateNode.current===r?e:t}function Zy(e){return e=Vk(e),e!==null?ew(e):null}function ew(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ew(e);if(t!==null)return t;e=e.sibling}return null}var tw=Aa.unstable_scheduleCallback,Fx=Aa.unstable_cancelCallback,Wk=Aa.unstable_shouldYield,Gk=Aa.unstable_requestPaint,Rr=Aa.unstable_now,Kk=Aa.unstable_getCurrentPriorityLevel,S2=Aa.unstable_ImmediatePriority,rw=Aa.unstable_UserBlockingPriority,zh=Aa.unstable_NormalPriority,Xk=Aa.unstable_LowPriority,nw=Aa.unstable_IdlePriority,Nd=null,Bi=null;function Yk(e){if(Bi&&typeof Bi.onCommitFiberRoot=="function")try{Bi.onCommitFiberRoot(Nd,e,void 0,(e.current.flags&128)===128)}catch{}}var vi=Math.clz32?Math.clz32:Zk,Jk=Math.log,Qk=Math.LN2;function Zk(e){return e>>>=0,e===0?32:31-(Jk(e)/Qk|0)|0}var Wf=64,Gf=4194304;function Du(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $h(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=Du(o):(i&=s,i!==0&&(n=Du(i)))}else s=r&~a,s!==0?n=Du(s):i!==0&&(n=Du(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-vi(t),a=1<<r,n|=e[r],t&=~a;return n}function eS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-vi(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=eS(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function im(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function aw(){var e=Wf;return Wf<<=1,!(Wf&4194240)&&(Wf=64),e}function G1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function $0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-vi(t),e[t]=r}function rS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-vi(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function E2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-vi(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Zt=0;function iw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sw,A2,ow,lw,cw,sm=!1,Kf=[],ao=null,io=null,so=null,m0=new Map,g0=new Map,Gs=[],nS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Px(e,t){switch(e){case"focusin":case"focusout":ao=null;break;case"dragenter":case"dragleave":io=null;break;case"mouseover":case"mouseout":so=null;break;case"pointerover":case"pointerout":m0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":g0.delete(t.pointerId)}}function Au(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=H0(t),t!==null&&A2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function aS(e,t,r,n,a){switch(t){case"focusin":return ao=Au(ao,e,t,r,n,a),!0;case"dragenter":return io=Au(io,e,t,r,n,a),!0;case"mouseover":return so=Au(so,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return m0.set(i,Au(m0.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,g0.set(i,Au(g0.get(i)||null,e,t,r,n,a)),!0}return!1}function uw(e){var t=Ho(e.target);if(t!==null){var r=ll(t);if(r!==null){if(t=r.tag,t===13){if(t=Qy(r),t!==null){e.blockedOn=t,cw(e.priority,function(){ow(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Sh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=om(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);tm=n,r.target.dispatchEvent(n),tm=null}else return t=H0(r),t!==null&&A2(t),e.blockedOn=r,!1;t.shift()}return!0}function Ix(e,t,r){Sh(e)&&r.delete(t)}function iS(){sm=!1,ao!==null&&Sh(ao)&&(ao=null),io!==null&&Sh(io)&&(io=null),so!==null&&Sh(so)&&(so=null),m0.forEach(Ix),g0.forEach(Ix)}function Nu(e,t){e.blockedOn===t&&(e.blockedOn=null,sm||(sm=!0,Aa.unstable_scheduleCallback(Aa.unstable_NormalPriority,iS)))}function x0(e){function t(a){return Nu(a,e)}if(0<Kf.length){Nu(Kf[0],e);for(var r=1;r<Kf.length;r++){var n=Kf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ao!==null&&Nu(ao,e),io!==null&&Nu(io,e),so!==null&&Nu(so,e),m0.forEach(t),g0.forEach(t),r=0;r<Gs.length;r++)n=Gs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Gs.length&&(r=Gs[0],r.blockedOn===null);)uw(r),r.blockedOn===null&&Gs.shift()}var gc=ws.ReactCurrentBatchConfig,qh=!0;function sS(e,t,r,n){var a=Zt,i=gc.transition;gc.transition=null;try{Zt=1,N2(e,t,r,n)}finally{Zt=a,gc.transition=i}}function oS(e,t,r,n){var a=Zt,i=gc.transition;gc.transition=null;try{Zt=4,N2(e,t,r,n)}finally{Zt=a,gc.transition=i}}function N2(e,t,r,n){if(qh){var a=om(e,t,r,n);if(a===null)np(e,t,n,Hh,r),Px(e,n);else if(aS(a,e,t,r,n))n.stopPropagation();else if(Px(e,n),t&4&&-1<nS.indexOf(e)){for(;a!==null;){var i=H0(a);if(i!==null&&sw(i),i=om(e,t,r,n),i===null&&np(e,t,n,Hh,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else np(e,t,n,null,r)}}var Hh=null;function om(e,t,r,n){if(Hh=null,e=k2(n),e=Ho(e),e!==null)if(t=ll(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Qy(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Hh=e,null}function fw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Kk()){case S2:return 1;case rw:return 4;case zh:case Xk:return 16;case nw:return 536870912;default:return 16}default:return 16}}var Qs=null,T2=null,Eh=null;function hw(){if(Eh)return Eh;var e,t=T2,r=t.length,n,a="value"in Qs?Qs.value:Qs.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return Eh=a.slice(e,1<n?1-n:void 0)}function Ah(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Xf(){return!0}function jx(){return!1}function Ca(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xf:jx,this.isPropagationStopped=jx,this}return _r(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Xf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Xf)},persist:function(){},isPersistent:Xf}),t}var Uc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},C2=Ca(Uc),q0=_r({},Uc,{view:0,detail:0}),lS=Ca(q0),K1,X1,Tu,Td=_r({},q0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:L2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Tu&&(Tu&&e.type==="mousemove"?(K1=e.screenX-Tu.screenX,X1=e.screenY-Tu.screenY):X1=K1=0,Tu=e),K1)},movementY:function(e){return"movementY"in e?e.movementY:X1}}),Rx=Ca(Td),cS=_r({},Td,{dataTransfer:0}),uS=Ca(cS),fS=_r({},q0,{relatedTarget:0}),Y1=Ca(fS),hS=_r({},Uc,{animationName:0,elapsedTime:0,pseudoElement:0}),dS=Ca(hS),pS=_r({},Uc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),mS=Ca(pS),gS=_r({},Uc,{data:0}),Ox=Ca(gS),xS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=yS[e])?!!t[e]:!1}function L2(){return wS}var _S=_r({},q0,{key:function(e){if(e.key){var t=xS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ah(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:L2,charCode:function(e){return e.type==="keypress"?Ah(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ah(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),bS=Ca(_S),kS=_r({},Td,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dx=Ca(kS),SS=_r({},q0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:L2}),ES=Ca(SS),AS=_r({},Uc,{propertyName:0,elapsedTime:0,pseudoElement:0}),NS=Ca(AS),TS=_r({},Td,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),CS=Ca(TS),LS=[9,13,27,32],F2=ps&&"CompositionEvent"in window,Wu=null;ps&&"documentMode"in document&&(Wu=document.documentMode);var FS=ps&&"TextEvent"in window&&!Wu,dw=ps&&(!F2||Wu&&8<Wu&&11>=Wu),Mx=String.fromCharCode(32),Bx=!1;function pw(e,t){switch(e){case"keyup":return LS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var tc=!1;function PS(e,t){switch(e){case"compositionend":return mw(t);case"keypress":return t.which!==32?null:(Bx=!0,Mx);case"textInput":return e=t.data,e===Mx&&Bx?null:e;default:return null}}function IS(e,t){if(tc)return e==="compositionend"||!F2&&pw(e,t)?(e=hw(),Eh=T2=Qs=null,tc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dw&&t.locale!=="ko"?null:t.data;default:return null}}var jS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ux(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!jS[e.type]:t==="textarea"}function gw(e,t,r,n){Gy(n),t=Vh(t,"onChange"),0<t.length&&(r=new C2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gu=null,v0=null;function RS(e){Nw(e,0)}function Cd(e){var t=ac(e);if(Uy(t))return e}function OS(e,t){if(e==="change")return t}var xw=!1;if(ps){var J1;if(ps){var Q1="oninput"in document;if(!Q1){var zx=document.createElement("div");zx.setAttribute("oninput","return;"),Q1=typeof zx.oninput=="function"}J1=Q1}else J1=!1;xw=J1&&(!document.documentMode||9<document.documentMode)}function $x(){Gu&&(Gu.detachEvent("onpropertychange",vw),v0=Gu=null)}function vw(e){if(e.propertyName==="value"&&Cd(v0)){var t=[];gw(t,v0,e,k2(e)),Jy(RS,t)}}function DS(e,t,r){e==="focusin"?($x(),Gu=t,v0=r,Gu.attachEvent("onpropertychange",vw)):e==="focusout"&&$x()}function MS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Cd(v0)}function BS(e,t){if(e==="click")return Cd(t)}function US(e,t){if(e==="input"||e==="change")return Cd(t)}function zS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _i=typeof Object.is=="function"?Object.is:zS;function y0(e,t){if(_i(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!qp.call(t,a)||!_i(e[a],t[a]))return!1}return!0}function qx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Hx(e,t){var r=qx(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=qx(r)}}function yw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?yw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ww(){for(var e=window,t=Mh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Mh(e.document)}return t}function P2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $S(e){var t=ww(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&yw(r.ownerDocument.documentElement,r)){if(n!==null&&P2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Hx(r,i);var s=Hx(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var qS=ps&&"documentMode"in document&&11>=document.documentMode,rc=null,lm=null,Ku=null,cm=!1;function Vx(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;cm||rc==null||rc!==Mh(n)||(n=rc,"selectionStart"in n&&P2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ku&&y0(Ku,n)||(Ku=n,n=Vh(lm,"onSelect"),0<n.length&&(t=new C2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=rc)))}function Yf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var nc={animationend:Yf("Animation","AnimationEnd"),animationiteration:Yf("Animation","AnimationIteration"),animationstart:Yf("Animation","AnimationStart"),transitionend:Yf("Transition","TransitionEnd")},Z1={},_w={};ps&&(_w=document.createElement("div").style,"AnimationEvent"in window||(delete nc.animationend.animation,delete nc.animationiteration.animation,delete nc.animationstart.animation),"TransitionEvent"in window||delete nc.transitionend.transition);function Ld(e){if(Z1[e])return Z1[e];if(!nc[e])return e;var t=nc[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in _w)return Z1[e]=t[r];return e}var bw=Ld("animationend"),kw=Ld("animationiteration"),Sw=Ld("animationstart"),Ew=Ld("transitionend"),Aw=new Map,Wx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _o(e,t){Aw.set(e,t),ol(t,[e])}for(var ep=0;ep<Wx.length;ep++){var tp=Wx[ep],HS=tp.toLowerCase(),VS=tp[0].toUpperCase()+tp.slice(1);_o(HS,"on"+VS)}_o(bw,"onAnimationEnd");_o(kw,"onAnimationIteration");_o(Sw,"onAnimationStart");_o("dblclick","onDoubleClick");_o("focusin","onFocus");_o("focusout","onBlur");_o(Ew,"onTransitionEnd");Nc("onMouseEnter",["mouseout","mouseover"]);Nc("onMouseLeave",["mouseout","mouseover"]);Nc("onPointerEnter",["pointerout","pointerover"]);Nc("onPointerLeave",["pointerout","pointerover"]);ol("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ol("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ol("onBeforeInput",["compositionend","keypress","textInput","paste"]);ol("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ol("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ol("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mu));function Gx(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Hk(n,t,void 0,e),e.currentTarget=null}function Nw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Gx(a,o,c),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Gx(a,o,c),i=l}}}if(Uh)throw e=am,Uh=!1,am=null,e}function hr(e,t){var r=t[pm];r===void 0&&(r=t[pm]=new Set);var n=e+"__bubble";r.has(n)||(Tw(t,e,2,!1),r.add(n))}function rp(e,t,r){var n=0;t&&(n|=4),Tw(r,e,n,t)}var Jf="_reactListening"+Math.random().toString(36).slice(2);function w0(e){if(!e[Jf]){e[Jf]=!0,Ry.forEach(function(r){r!=="selectionchange"&&(WS.has(r)||rp(r,!1,e),rp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jf]||(t[Jf]=!0,rp("selectionchange",!1,t))}}function Tw(e,t,r,n){switch(fw(t)){case 1:var a=sS;break;case 4:a=oS;break;default:a=N2}r=a.bind(null,t,r,e),a=void 0,!nm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function np(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Ho(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}Jy(function(){var c=i,u=k2(r),h=[];e:{var p=Aw.get(e);if(p!==void 0){var d=C2,y=e;switch(e){case"keypress":if(Ah(r)===0)break e;case"keydown":case"keyup":d=bS;break;case"focusin":y="focus",d=Y1;break;case"focusout":y="blur",d=Y1;break;case"beforeblur":case"afterblur":d=Y1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=Rx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=uS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=ES;break;case bw:case kw:case Sw:d=dS;break;case Ew:d=NS;break;case"scroll":d=lS;break;case"wheel":d=CS;break;case"copy":case"cut":case"paste":d=mS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=Dx}var x=(t&4)!==0,S=!x&&e==="scroll",v=x?p!==null?p+"Capture":null:p;x=[];for(var k=c,_;k!==null;){_=k;var j=_.stateNode;if(_.tag===5&&j!==null&&(_=j,v!==null&&(j=p0(k,v),j!=null&&x.push(_0(k,j,_)))),S)break;k=k.return}0<x.length&&(p=new d(p,y,null,r,u),h.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",p&&r!==tm&&(y=r.relatedTarget||r.fromElement)&&(Ho(y)||y[ms]))break e;if((d||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,d?(y=r.relatedTarget||r.toElement,d=c,y=y?Ho(y):null,y!==null&&(S=ll(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(d=null,y=c),d!==y)){if(x=Rx,j="onMouseLeave",v="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(x=Dx,j="onPointerLeave",v="onPointerEnter",k="pointer"),S=d==null?p:ac(d),_=y==null?p:ac(y),p=new x(j,k+"leave",d,r,u),p.target=S,p.relatedTarget=_,j=null,Ho(u)===c&&(x=new x(v,k+"enter",y,r,u),x.target=_,x.relatedTarget=S,j=x),S=j,d&&y)t:{for(x=d,v=y,k=0,_=x;_;_=Ul(_))k++;for(_=0,j=v;j;j=Ul(j))_++;for(;0<k-_;)x=Ul(x),k--;for(;0<_-k;)v=Ul(v),_--;for(;k--;){if(x===v||v!==null&&x===v.alternate)break t;x=Ul(x),v=Ul(v)}x=null}else x=null;d!==null&&Kx(h,p,d,x,!1),y!==null&&S!==null&&Kx(h,S,y,x,!0)}}e:{if(p=c?ac(c):window,d=p.nodeName&&p.nodeName.toLowerCase(),d==="select"||d==="input"&&p.type==="file")var D=OS;else if(Ux(p))if(xw)D=US;else{D=MS;var z=DS}else(d=p.nodeName)&&d.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(D=BS);if(D&&(D=D(e,c))){gw(h,D,r,u);break e}z&&z(e,p,c),e==="focusout"&&(z=p._wrapperState)&&z.controlled&&p.type==="number"&&Yp(p,"number",p.value)}switch(z=c?ac(c):window,e){case"focusin":(Ux(z)||z.contentEditable==="true")&&(rc=z,lm=c,Ku=null);break;case"focusout":Ku=lm=rc=null;break;case"mousedown":cm=!0;break;case"contextmenu":case"mouseup":case"dragend":cm=!1,Vx(h,r,u);break;case"selectionchange":if(qS)break;case"keydown":case"keyup":Vx(h,r,u)}var I;if(F2)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else tc?pw(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(dw&&r.locale!=="ko"&&(tc||T!=="onCompositionStart"?T==="onCompositionEnd"&&tc&&(I=hw()):(Qs=u,T2="value"in Qs?Qs.value:Qs.textContent,tc=!0)),z=Vh(c,T),0<z.length&&(T=new Ox(T,e,null,r,u),h.push({event:T,listeners:z}),I?T.data=I:(I=mw(r),I!==null&&(T.data=I)))),(I=FS?PS(e,r):IS(e,r))&&(c=Vh(c,"onBeforeInput"),0<c.length&&(u=new Ox("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=I))}Nw(h,t)})}function _0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Vh(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=p0(e,r),i!=null&&n.unshift(_0(e,i,a)),i=p0(e,t),i!=null&&n.push(_0(e,i,a))),e=e.return}return n}function Ul(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Kx(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=p0(r,i),l!=null&&s.unshift(_0(r,l,o))):a||(l=p0(r,i),l!=null&&s.push(_0(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var GS=/\r\n?/g,KS=/\u0000|\uFFFD/g;function Xx(e){return(typeof e=="string"?e:""+e).replace(GS,`
`).replace(KS,"")}function Qf(e,t,r){if(t=Xx(t),Xx(e)!==t&&r)throw Error(Xe(425))}function Wh(){}var um=null,fm=null;function hm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var dm=typeof setTimeout=="function"?setTimeout:void 0,XS=typeof clearTimeout=="function"?clearTimeout:void 0,Yx=typeof Promise=="function"?Promise:void 0,YS=typeof queueMicrotask=="function"?queueMicrotask:typeof Yx<"u"?function(e){return Yx.resolve(null).then(e).catch(JS)}:dm;function JS(e){setTimeout(function(){throw e})}function ap(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),x0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);x0(t)}function oo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var zc=Math.random().toString(36).slice(2),Di="__reactFiber$"+zc,b0="__reactProps$"+zc,ms="__reactContainer$"+zc,pm="__reactEvents$"+zc,QS="__reactListeners$"+zc,ZS="__reactHandles$"+zc;function Ho(e){var t=e[Di];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ms]||r[Di]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jx(e);e!==null;){if(r=e[Di])return r;e=Jx(e)}return t}e=r,r=e.parentNode}return null}function H0(e){return e=e[Di]||e[ms],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ac(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Xe(33))}function Fd(e){return e[b0]||null}var mm=[],ic=-1;function bo(e){return{current:e}}function pr(e){0>ic||(e.current=mm[ic],mm[ic]=null,ic--)}function cr(e,t){ic++,mm[ic]=e.current,e.current=t}var go={},Rn=bo(go),oa=bo(!1),Zo=go;function Tc(e,t){var r=e.type.contextTypes;if(!r)return go;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function la(e){return e=e.childContextTypes,e!=null}function Gh(){pr(oa),pr(Rn)}function Qx(e,t,r){if(Rn.current!==go)throw Error(Xe(168));cr(Rn,t),cr(oa,r)}function Cw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Xe(108,Dk(e)||"Unknown",a));return _r({},r,n)}function Kh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||go,Zo=Rn.current,cr(Rn,e),cr(oa,oa.current),!0}function Zx(e,t,r){var n=e.stateNode;if(!n)throw Error(Xe(169));r?(e=Cw(e,t,Zo),n.__reactInternalMemoizedMergedChildContext=e,pr(oa),pr(Rn),cr(Rn,e)):pr(oa),cr(oa,r)}var os=null,Pd=!1,ip=!1;function Lw(e){os===null?os=[e]:os.push(e)}function e6(e){Pd=!0,Lw(e)}function ko(){if(!ip&&os!==null){ip=!0;var e=0,t=Zt;try{var r=os;for(Zt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}os=null,Pd=!1}catch(a){throw os!==null&&(os=os.slice(e+1)),tw(S2,ko),a}finally{Zt=t,ip=!1}}return null}var sc=[],oc=0,Xh=null,Yh=0,qa=[],Ha=0,el=null,ls=1,cs="";function Do(e,t){sc[oc++]=Yh,sc[oc++]=Xh,Xh=e,Yh=t}function Fw(e,t,r){qa[Ha++]=ls,qa[Ha++]=cs,qa[Ha++]=el,el=e;var n=ls;e=cs;var a=32-vi(n)-1;n&=~(1<<a),r+=1;var i=32-vi(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,ls=1<<32-vi(t)+a|r<<a|n,cs=i+e}else ls=1<<i|r<<a|n,cs=e}function I2(e){e.return!==null&&(Do(e,1),Fw(e,1,0))}function j2(e){for(;e===Xh;)Xh=sc[--oc],sc[oc]=null,Yh=sc[--oc],sc[oc]=null;for(;e===el;)el=qa[--Ha],qa[Ha]=null,cs=qa[--Ha],qa[Ha]=null,ls=qa[--Ha],qa[Ha]=null}var Sa=null,ba=null,gr=!1,pi=null;function Pw(e,t){var r=Va(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ev(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Sa=e,ba=oo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Sa=e,ba=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=el!==null?{id:ls,overflow:cs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Va(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Sa=e,ba=null,!0):!1;default:return!1}}function gm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function xm(e){if(gr){var t=ba;if(t){var r=t;if(!ev(e,t)){if(gm(e))throw Error(Xe(418));t=oo(r.nextSibling);var n=Sa;t&&ev(e,t)?Pw(n,r):(e.flags=e.flags&-4097|2,gr=!1,Sa=e)}}else{if(gm(e))throw Error(Xe(418));e.flags=e.flags&-4097|2,gr=!1,Sa=e}}}function tv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Sa=e}function Zf(e){if(e!==Sa)return!1;if(!gr)return tv(e),gr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hm(e.type,e.memoizedProps)),t&&(t=ba)){if(gm(e))throw Iw(),Error(Xe(418));for(;t;)Pw(e,t),t=oo(t.nextSibling)}if(tv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Xe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ba=oo(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ba=null}}else ba=Sa?oo(e.stateNode.nextSibling):null;return!0}function Iw(){for(var e=ba;e;)e=oo(e.nextSibling)}function Cc(){ba=Sa=null,gr=!1}function R2(e){pi===null?pi=[e]:pi.push(e)}var t6=ws.ReactCurrentBatchConfig;function Cu(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Xe(309));var n=r.stateNode}if(!n)throw Error(Xe(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Xe(284));if(!r._owner)throw Error(Xe(290,e))}return e}function eh(e,t){throw e=Object.prototype.toString.call(t),Error(Xe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rv(e){var t=e._init;return t(e._payload)}function jw(e){function t(v,k){if(e){var _=v.deletions;_===null?(v.deletions=[k],v.flags|=16):_.push(k)}}function r(v,k){if(!e)return null;for(;k!==null;)t(v,k),k=k.sibling;return null}function n(v,k){for(v=new Map;k!==null;)k.key!==null?v.set(k.key,k):v.set(k.index,k),k=k.sibling;return v}function a(v,k){return v=fo(v,k),v.index=0,v.sibling=null,v}function i(v,k,_){return v.index=_,e?(_=v.alternate,_!==null?(_=_.index,_<k?(v.flags|=2,k):_):(v.flags|=2,k)):(v.flags|=1048576,k)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,k,_,j){return k===null||k.tag!==6?(k=hp(_,v.mode,j),k.return=v,k):(k=a(k,_),k.return=v,k)}function l(v,k,_,j){var D=_.type;return D===ec?u(v,k,_.props.children,j,_.key):k!==null&&(k.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===qs&&rv(D)===k.type)?(j=a(k,_.props),j.ref=Cu(v,k,_),j.return=v,j):(j=Ih(_.type,_.key,_.props,null,v.mode,j),j.ref=Cu(v,k,_),j.return=v,j)}function c(v,k,_,j){return k===null||k.tag!==4||k.stateNode.containerInfo!==_.containerInfo||k.stateNode.implementation!==_.implementation?(k=dp(_,v.mode,j),k.return=v,k):(k=a(k,_.children||[]),k.return=v,k)}function u(v,k,_,j,D){return k===null||k.tag!==7?(k=Xo(_,v.mode,j,D),k.return=v,k):(k=a(k,_),k.return=v,k)}function h(v,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return k=hp(""+k,v.mode,_),k.return=v,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case qf:return _=Ih(k.type,k.key,k.props,null,v.mode,_),_.ref=Cu(v,null,k),_.return=v,_;case Zl:return k=dp(k,v.mode,_),k.return=v,k;case qs:var j=k._init;return h(v,j(k._payload),_)}if(Ou(k)||Su(k))return k=Xo(k,v.mode,_,null),k.return=v,k;eh(v,k)}return null}function p(v,k,_,j){var D=k!==null?k.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return D!==null?null:o(v,k,""+_,j);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case qf:return _.key===D?l(v,k,_,j):null;case Zl:return _.key===D?c(v,k,_,j):null;case qs:return D=_._init,p(v,k,D(_._payload),j)}if(Ou(_)||Su(_))return D!==null?null:u(v,k,_,j,null);eh(v,_)}return null}function d(v,k,_,j,D){if(typeof j=="string"&&j!==""||typeof j=="number")return v=v.get(_)||null,o(k,v,""+j,D);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case qf:return v=v.get(j.key===null?_:j.key)||null,l(k,v,j,D);case Zl:return v=v.get(j.key===null?_:j.key)||null,c(k,v,j,D);case qs:var z=j._init;return d(v,k,_,z(j._payload),D)}if(Ou(j)||Su(j))return v=v.get(_)||null,u(k,v,j,D,null);eh(k,j)}return null}function y(v,k,_,j){for(var D=null,z=null,I=k,T=k=0,L=null;I!==null&&T<_.length;T++){I.index>T?(L=I,I=null):L=I.sibling;var O=p(v,I,_[T],j);if(O===null){I===null&&(I=L);break}e&&I&&O.alternate===null&&t(v,I),k=i(O,k,T),z===null?D=O:z.sibling=O,z=O,I=L}if(T===_.length)return r(v,I),gr&&Do(v,T),D;if(I===null){for(;T<_.length;T++)I=h(v,_[T],j),I!==null&&(k=i(I,k,T),z===null?D=I:z.sibling=I,z=I);return gr&&Do(v,T),D}for(I=n(v,I);T<_.length;T++)L=d(I,v,T,_[T],j),L!==null&&(e&&L.alternate!==null&&I.delete(L.key===null?T:L.key),k=i(L,k,T),z===null?D=L:z.sibling=L,z=L);return e&&I.forEach(function(F){return t(v,F)}),gr&&Do(v,T),D}function x(v,k,_,j){var D=Su(_);if(typeof D!="function")throw Error(Xe(150));if(_=D.call(_),_==null)throw Error(Xe(151));for(var z=D=null,I=k,T=k=0,L=null,O=_.next();I!==null&&!O.done;T++,O=_.next()){I.index>T?(L=I,I=null):L=I.sibling;var F=p(v,I,O.value,j);if(F===null){I===null&&(I=L);break}e&&I&&F.alternate===null&&t(v,I),k=i(F,k,T),z===null?D=F:z.sibling=F,z=F,I=L}if(O.done)return r(v,I),gr&&Do(v,T),D;if(I===null){for(;!O.done;T++,O=_.next())O=h(v,O.value,j),O!==null&&(k=i(O,k,T),z===null?D=O:z.sibling=O,z=O);return gr&&Do(v,T),D}for(I=n(v,I);!O.done;T++,O=_.next())O=d(I,v,T,O.value,j),O!==null&&(e&&O.alternate!==null&&I.delete(O.key===null?T:O.key),k=i(O,k,T),z===null?D=O:z.sibling=O,z=O);return e&&I.forEach(function(N){return t(v,N)}),gr&&Do(v,T),D}function S(v,k,_,j){if(typeof _=="object"&&_!==null&&_.type===ec&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case qf:e:{for(var D=_.key,z=k;z!==null;){if(z.key===D){if(D=_.type,D===ec){if(z.tag===7){r(v,z.sibling),k=a(z,_.props.children),k.return=v,v=k;break e}}else if(z.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===qs&&rv(D)===z.type){r(v,z.sibling),k=a(z,_.props),k.ref=Cu(v,z,_),k.return=v,v=k;break e}r(v,z);break}else t(v,z);z=z.sibling}_.type===ec?(k=Xo(_.props.children,v.mode,j,_.key),k.return=v,v=k):(j=Ih(_.type,_.key,_.props,null,v.mode,j),j.ref=Cu(v,k,_),j.return=v,v=j)}return s(v);case Zl:e:{for(z=_.key;k!==null;){if(k.key===z)if(k.tag===4&&k.stateNode.containerInfo===_.containerInfo&&k.stateNode.implementation===_.implementation){r(v,k.sibling),k=a(k,_.children||[]),k.return=v,v=k;break e}else{r(v,k);break}else t(v,k);k=k.sibling}k=dp(_,v.mode,j),k.return=v,v=k}return s(v);case qs:return z=_._init,S(v,k,z(_._payload),j)}if(Ou(_))return y(v,k,_,j);if(Su(_))return x(v,k,_,j);eh(v,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,k!==null&&k.tag===6?(r(v,k.sibling),k=a(k,_),k.return=v,v=k):(r(v,k),k=hp(_,v.mode,j),k.return=v,v=k),s(v)):r(v,k)}return S}var Lc=jw(!0),Rw=jw(!1),Jh=bo(null),Qh=null,lc=null,O2=null;function D2(){O2=lc=Qh=null}function M2(e){var t=Jh.current;pr(Jh),e._currentValue=t}function vm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function xc(e,t){Qh=e,O2=lc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(sa=!0),e.firstContext=null)}function Ga(e){var t=e._currentValue;if(O2!==e)if(e={context:e,memoizedValue:t,next:null},lc===null){if(Qh===null)throw Error(Xe(308));lc=e,Qh.dependencies={lanes:0,firstContext:e}}else lc=lc.next=e;return t}var Vo=null;function B2(e){Vo===null?Vo=[e]:Vo.push(e)}function Ow(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,B2(t)):(r.next=a.next,a.next=r),t.interleaved=r,gs(e,n)}function gs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Hs=!1;function U2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Dw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function lo(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ht&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,gs(e,r)}return a=n.interleaved,a===null?(t.next=t,B2(n)):(t.next=a.next,a.next=t),n.interleaved=t,gs(e,r)}function Nh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,E2(e,r)}}function nv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Zh(e,t,r,n){var a=e.updateQueue;Hs=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=a.baseState;s=0,u=c=l=null,o=i;do{var p=o.lane,d=o.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=e,x=o;switch(p=t,d=r,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(d,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(d,h,p):y,p==null)break e;h=_r({},h,p);break e;case 2:Hs=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else d={eventTime:d,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=d,l=h):u=u.next=d,s|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(1);if(u===null&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);rl|=s,e.lanes=s,e.memoizedState=h}}function av(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Xe(191,a));a.call(n)}}}var V0={},Ui=bo(V0),k0=bo(V0),S0=bo(V0);function Wo(e){if(e===V0)throw Error(Xe(174));return e}function z2(e,t){switch(cr(S0,t),cr(k0,e),cr(Ui,V0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qp(t,e)}pr(Ui),cr(Ui,t)}function Fc(){pr(Ui),pr(k0),pr(S0)}function Mw(e){Wo(S0.current);var t=Wo(Ui.current),r=Qp(t,e.type);t!==r&&(cr(k0,e),cr(Ui,r))}function $2(e){k0.current===e&&(pr(Ui),pr(k0))}var vr=bo(0);function ed(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var sp=[];function q2(){for(var e=0;e<sp.length;e++)sp[e]._workInProgressVersionPrimary=null;sp.length=0}var Th=ws.ReactCurrentDispatcher,op=ws.ReactCurrentBatchConfig,tl=0,yr=null,Jr=null,on=null,td=!1,Xu=!1,E0=0,r6=0;function bn(){throw Error(Xe(321))}function H2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!_i(e[r],t[r]))return!1;return!0}function V2(e,t,r,n,a,i){if(tl=i,yr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Th.current=e===null||e.memoizedState===null?s6:o6,e=r(n,a),Xu){i=0;do{if(Xu=!1,E0=0,25<=i)throw Error(Xe(301));i+=1,on=Jr=null,t.updateQueue=null,Th.current=l6,e=r(n,a)}while(Xu)}if(Th.current=rd,t=Jr!==null&&Jr.next!==null,tl=0,on=Jr=yr=null,td=!1,t)throw Error(Xe(300));return e}function W2(){var e=E0!==0;return E0=0,e}function Oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return on===null?yr.memoizedState=on=e:on=on.next=e,on}function Ka(){if(Jr===null){var e=yr.alternate;e=e!==null?e.memoizedState:null}else e=Jr.next;var t=on===null?yr.memoizedState:on.next;if(t!==null)on=t,Jr=e;else{if(e===null)throw Error(Xe(310));Jr=e,e={memoizedState:Jr.memoizedState,baseState:Jr.baseState,baseQueue:Jr.baseQueue,queue:Jr.queue,next:null},on===null?yr.memoizedState=on=e:on=on.next=e}return on}function A0(e,t){return typeof t=="function"?t(e):t}function lp(e){var t=Ka(),r=t.queue;if(r===null)throw Error(Xe(311));r.lastRenderedReducer=e;var n=Jr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((tl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,s=n):l=l.next=h,yr.lanes|=u,rl|=u}c=c.next}while(c!==null&&c!==i);l===null?s=n:l.next=o,_i(n,t.memoizedState)||(sa=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,yr.lanes|=i,rl|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function cp(e){var t=Ka(),r=t.queue;if(r===null)throw Error(Xe(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);_i(i,t.memoizedState)||(sa=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Bw(){}function Uw(e,t){var r=yr,n=Ka(),a=t(),i=!_i(n.memoizedState,a);if(i&&(n.memoizedState=a,sa=!0),n=n.queue,G2(qw.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||on!==null&&on.memoizedState.tag&1){if(r.flags|=2048,N0(9,$w.bind(null,r,n,a,t),void 0,null),cn===null)throw Error(Xe(349));tl&30||zw(r,t,a)}return a}function zw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=yr.updateQueue,t===null?(t={lastEffect:null,stores:null},yr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function $w(e,t,r,n){t.value=r,t.getSnapshot=n,Hw(t)&&Vw(e)}function qw(e,t,r){return r(function(){Hw(t)&&Vw(e)})}function Hw(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_i(e,r)}catch{return!0}}function Vw(e){var t=gs(e,1);t!==null&&yi(t,e,1,-1)}function iv(e){var t=Oi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:A0,lastRenderedState:e},t.queue=e,e=e.dispatch=i6.bind(null,yr,e),[t.memoizedState,e]}function N0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=yr.updateQueue,t===null?(t={lastEffect:null,stores:null},yr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Ww(){return Ka().memoizedState}function Ch(e,t,r,n){var a=Oi();yr.flags|=e,a.memoizedState=N0(1|t,r,void 0,n===void 0?null:n)}function Id(e,t,r,n){var a=Ka();n=n===void 0?null:n;var i=void 0;if(Jr!==null){var s=Jr.memoizedState;if(i=s.destroy,n!==null&&H2(n,s.deps)){a.memoizedState=N0(t,r,i,n);return}}yr.flags|=e,a.memoizedState=N0(1|t,r,i,n)}function sv(e,t){return Ch(8390656,8,e,t)}function G2(e,t){return Id(2048,8,e,t)}function Gw(e,t){return Id(4,2,e,t)}function Kw(e,t){return Id(4,4,e,t)}function Xw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Yw(e,t,r){return r=r!=null?r.concat([e]):null,Id(4,4,Xw.bind(null,t,e),r)}function K2(){}function Jw(e,t){var r=Ka();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&H2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Qw(e,t){var r=Ka();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&H2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Zw(e,t,r){return tl&21?(_i(r,t)||(r=aw(),yr.lanes|=r,rl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,sa=!0),e.memoizedState=r)}function n6(e,t){var r=Zt;Zt=r!==0&&4>r?r:4,e(!0);var n=op.transition;op.transition={};try{e(!1),t()}finally{Zt=r,op.transition=n}}function e4(){return Ka().memoizedState}function a6(e,t,r){var n=uo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},t4(e))r4(t,r);else if(r=Ow(e,t,r,n),r!==null){var a=Vn();yi(r,e,n,a),n4(r,t,n)}}function i6(e,t,r){var n=uo(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(t4(e))r4(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,_i(o,s)){var l=t.interleaved;l===null?(a.next=a,B2(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=Ow(e,t,a,n),r!==null&&(a=Vn(),yi(r,e,n,a),n4(r,t,n))}}function t4(e){var t=e.alternate;return e===yr||t!==null&&t===yr}function r4(e,t){Xu=td=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function n4(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,E2(e,r)}}var rd={readContext:Ga,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useInsertionEffect:bn,useLayoutEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useMutableSource:bn,useSyncExternalStore:bn,useId:bn,unstable_isNewReconciler:!1},s6={readContext:Ga,useCallback:function(e,t){return Oi().memoizedState=[e,t===void 0?null:t],e},useContext:Ga,useEffect:sv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ch(4194308,4,Xw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ch(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ch(4,2,e,t)},useMemo:function(e,t){var r=Oi();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Oi();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=a6.bind(null,yr,e),[n.memoizedState,e]},useRef:function(e){var t=Oi();return e={current:e},t.memoizedState=e},useState:iv,useDebugValue:K2,useDeferredValue:function(e){return Oi().memoizedState=e},useTransition:function(){var e=iv(!1),t=e[0];return e=n6.bind(null,e[1]),Oi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=yr,a=Oi();if(gr){if(r===void 0)throw Error(Xe(407));r=r()}else{if(r=t(),cn===null)throw Error(Xe(349));tl&30||zw(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,sv(qw.bind(null,n,i,e),[e]),n.flags|=2048,N0(9,$w.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Oi(),t=cn.identifierPrefix;if(gr){var r=cs,n=ls;r=(n&~(1<<32-vi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=E0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=r6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},o6={readContext:Ga,useCallback:Jw,useContext:Ga,useEffect:G2,useImperativeHandle:Yw,useInsertionEffect:Gw,useLayoutEffect:Kw,useMemo:Qw,useReducer:lp,useRef:Ww,useState:function(){return lp(A0)},useDebugValue:K2,useDeferredValue:function(e){var t=Ka();return Zw(t,Jr.memoizedState,e)},useTransition:function(){var e=lp(A0)[0],t=Ka().memoizedState;return[e,t]},useMutableSource:Bw,useSyncExternalStore:Uw,useId:e4,unstable_isNewReconciler:!1},l6={readContext:Ga,useCallback:Jw,useContext:Ga,useEffect:G2,useImperativeHandle:Yw,useInsertionEffect:Gw,useLayoutEffect:Kw,useMemo:Qw,useReducer:cp,useRef:Ww,useState:function(){return cp(A0)},useDebugValue:K2,useDeferredValue:function(e){var t=Ka();return Jr===null?t.memoizedState=e:Zw(t,Jr.memoizedState,e)},useTransition:function(){var e=cp(A0)[0],t=Ka().memoizedState;return[e,t]},useMutableSource:Bw,useSyncExternalStore:Uw,useId:e4,unstable_isNewReconciler:!1};function ui(e,t){if(e&&e.defaultProps){t=_r({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ym(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:_r({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var jd={isMounted:function(e){return(e=e._reactInternals)?ll(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Vn(),a=uo(e),i=fs(n,a);i.payload=t,r!=null&&(i.callback=r),t=lo(e,i,a),t!==null&&(yi(t,e,a,n),Nh(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Vn(),a=uo(e),i=fs(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=lo(e,i,a),t!==null&&(yi(t,e,a,n),Nh(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Vn(),n=uo(e),a=fs(r,n);a.tag=2,t!=null&&(a.callback=t),t=lo(e,a,n),t!==null&&(yi(t,e,n,r),Nh(t,e,n))}};function ov(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!y0(r,n)||!y0(a,i):!0}function a4(e,t,r){var n=!1,a=go,i=t.contextType;return typeof i=="object"&&i!==null?i=Ga(i):(a=la(t)?Zo:Rn.current,n=t.contextTypes,i=(n=n!=null)?Tc(e,a):go),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=jd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function lv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&jd.enqueueReplaceState(t,t.state,null)}function wm(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},U2(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Ga(i):(i=la(t)?Zo:Rn.current,a.context=Tc(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ym(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&jd.enqueueReplaceState(a,a.state,null),Zh(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Pc(e,t){try{var r="",n=t;do r+=Ok(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function up(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function _m(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var c6=typeof WeakMap=="function"?WeakMap:Map;function i4(e,t,r){r=fs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ad||(ad=!0,Fm=n),_m(e,t)},r}function s4(e,t,r){r=fs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){_m(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){_m(e,t),typeof n!="function"&&(co===null?co=new Set([this]):co.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function cv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new c6;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=k6.bind(null,e,t,r),t.then(e,e))}function uv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fv(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fs(-1,1),t.tag=2,lo(r,t,1))),r.lanes|=1),e)}var u6=ws.ReactCurrentOwner,sa=!1;function zn(e,t,r,n){t.child=e===null?Rw(t,null,r,n):Lc(t,e.child,r,n)}function hv(e,t,r,n,a){r=r.render;var i=t.ref;return xc(t,a),n=V2(e,t,r,n,i,a),r=W2(),e!==null&&!sa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,xs(e,t,a)):(gr&&r&&I2(t),t.flags|=1,zn(e,t,n,a),t.child)}function dv(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!rg(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,o4(e,t,i,n,a)):(e=Ih(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:y0,r(s,n)&&e.ref===t.ref)return xs(e,t,a)}return t.flags|=1,e=fo(i,n),e.ref=t.ref,e.return=t,t.child=e}function o4(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(y0(i,n)&&e.ref===t.ref)if(sa=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(sa=!0);else return t.lanes=e.lanes,xs(e,t,a)}return bm(e,t,r,n,a)}function l4(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(uc,ya),ya|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,cr(uc,ya),ya|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,cr(uc,ya),ya|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,cr(uc,ya),ya|=n;return zn(e,t,a,r),t.child}function c4(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function bm(e,t,r,n,a){var i=la(r)?Zo:Rn.current;return i=Tc(t,i),xc(t,a),r=V2(e,t,r,n,i,a),n=W2(),e!==null&&!sa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,xs(e,t,a)):(gr&&n&&I2(t),t.flags|=1,zn(e,t,r,a),t.child)}function pv(e,t,r,n,a){if(la(r)){var i=!0;Kh(t)}else i=!1;if(xc(t,a),t.stateNode===null)Lh(e,t),a4(t,r,n),wm(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ga(c):(c=la(r)?Zo:Rn.current,c=Tc(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&lv(t,s,n,c),Hs=!1;var p=t.memoizedState;s.state=p,Zh(t,n,s,a),l=t.memoizedState,o!==n||p!==l||oa.current||Hs?(typeof u=="function"&&(ym(t,r,u,n),l=t.memoizedState),(o=Hs||ov(t,r,o,n,p,l,c))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Dw(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ui(t.type,o),s.props=c,h=t.pendingProps,p=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ga(l):(l=la(r)?Zo:Rn.current,l=Tc(t,l));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||p!==l)&&lv(t,s,n,l),Hs=!1,p=t.memoizedState,s.state=p,Zh(t,n,s,a);var y=t.memoizedState;o!==h||p!==y||oa.current||Hs?(typeof d=="function"&&(ym(t,r,d,n),y=t.memoizedState),(c=Hs||ov(t,r,c,n,p,y,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,y,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,y,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),s.props=n,s.state=y,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return km(e,t,r,n,i,a)}function km(e,t,r,n,a,i){c4(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&Zx(t,r,!1),xs(e,t,i);n=t.stateNode,u6.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Lc(t,e.child,null,i),t.child=Lc(t,null,o,i)):zn(e,t,o,i),t.memoizedState=n.state,a&&Zx(t,r,!0),t.child}function u4(e){var t=e.stateNode;t.pendingContext?Qx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qx(e,t.context,!1),z2(e,t.containerInfo)}function mv(e,t,r,n,a){return Cc(),R2(a),t.flags|=256,zn(e,t,r,n),t.child}var Sm={dehydrated:null,treeContext:null,retryLane:0};function Em(e){return{baseLanes:e,cachePool:null,transitions:null}}function f4(e,t,r){var n=t.pendingProps,a=vr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),cr(vr,a&1),e===null)return xm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Dd(s,n,0,null),e=Xo(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Em(r),t.memoizedState=Sm,e):X2(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return f6(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=fo(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=fo(o,i):(i=Xo(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?Em(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Sm,n}return i=e.child,e=i.sibling,n=fo(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function X2(e,t){return t=Dd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function th(e,t,r,n){return n!==null&&R2(n),Lc(t,e.child,null,r),e=X2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function f6(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=up(Error(Xe(422))),th(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Dd({mode:"visible",children:n.children},a,0,null),i=Xo(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Lc(t,e.child,null,s),t.child.memoizedState=Em(s),t.memoizedState=Sm,i);if(!(t.mode&1))return th(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Xe(419)),n=up(i,n,void 0),th(e,t,s,n)}if(o=(s&e.childLanes)!==0,sa||o){if(n=cn,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,gs(e,a),yi(n,e,a,-1))}return tg(),n=up(Error(Xe(421))),th(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=S6.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ba=oo(a.nextSibling),Sa=t,gr=!0,pi=null,e!==null&&(qa[Ha++]=ls,qa[Ha++]=cs,qa[Ha++]=el,ls=e.id,cs=e.overflow,el=t),t=X2(t,n.children),t.flags|=4096,t)}function gv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),vm(e.return,t,r)}function fp(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function h4(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(zn(e,t,n.children,r),n=vr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gv(e,r,t);else if(e.tag===19)gv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(cr(vr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&ed(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),fp(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&ed(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}fp(t,!0,r,null,i);break;case"together":fp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Lh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function xs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),rl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Xe(153));if(t.child!==null){for(e=t.child,r=fo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=fo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function h6(e,t,r){switch(t.tag){case 3:u4(t),Cc();break;case 5:Mw(t);break;case 1:la(t.type)&&Kh(t);break;case 4:z2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;cr(Jh,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(cr(vr,vr.current&1),t.flags|=128,null):r&t.child.childLanes?f4(e,t,r):(cr(vr,vr.current&1),e=xs(e,t,r),e!==null?e.sibling:null);cr(vr,vr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return h4(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),cr(vr,vr.current),n)break;return null;case 22:case 23:return t.lanes=0,l4(e,t,r)}return xs(e,t,r)}var d4,Am,p4,m4;d4=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Am=function(){};p4=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Wo(Ui.current);var i=null;switch(r){case"input":a=Kp(e,a),n=Kp(e,n),i=[];break;case"select":a=_r({},a,{value:void 0}),n=_r({},n,{value:void 0}),i=[];break;case"textarea":a=Jp(e,a),n=Jp(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Wh)}Zp(r,n);var s;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(h0.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(h0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&hr("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};m4=function(e,t,r,n){r!==n&&(t.flags|=4)};function Lu(e,t){if(!gr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function kn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function d6(e,t,r){var n=t.pendingProps;switch(j2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(t),null;case 1:return la(t.type)&&Gh(),kn(t),null;case 3:return n=t.stateNode,Fc(),pr(oa),pr(Rn),q2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Zf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,pi!==null&&(jm(pi),pi=null))),Am(e,t),kn(t),null;case 5:$2(t);var a=Wo(S0.current);if(r=t.type,e!==null&&t.stateNode!=null)p4(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Xe(166));return kn(t),null}if(e=Wo(Ui.current),Zf(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Di]=t,n[b0]=i,e=(t.mode&1)!==0,r){case"dialog":hr("cancel",n),hr("close",n);break;case"iframe":case"object":case"embed":hr("load",n);break;case"video":case"audio":for(a=0;a<Mu.length;a++)hr(Mu[a],n);break;case"source":hr("error",n);break;case"img":case"image":case"link":hr("error",n),hr("load",n);break;case"details":hr("toggle",n);break;case"input":Ex(n,i),hr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},hr("invalid",n);break;case"textarea":Nx(n,i),hr("invalid",n)}Zp(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Qf(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Qf(n.textContent,o,e),a=["children",""+o]):h0.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&hr("scroll",n)}switch(r){case"input":Hf(n),Ax(n,i,!0);break;case"textarea":Hf(n),Tx(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Wh)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=qy(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Di]=t,e[b0]=n,d4(e,t,!1,!1),t.stateNode=e;e:{switch(s=em(r,n),r){case"dialog":hr("cancel",e),hr("close",e),a=n;break;case"iframe":case"object":case"embed":hr("load",e),a=n;break;case"video":case"audio":for(a=0;a<Mu.length;a++)hr(Mu[a],e);a=n;break;case"source":hr("error",e),a=n;break;case"img":case"image":case"link":hr("error",e),hr("load",e),a=n;break;case"details":hr("toggle",e),a=n;break;case"input":Ex(e,n),a=Kp(e,n),hr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=_r({},n,{value:void 0}),hr("invalid",e);break;case"textarea":Nx(e,n),a=Jp(e,n),hr("invalid",e);break;default:a=n}Zp(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?Wy(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Hy(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&d0(e,l):typeof l=="number"&&d0(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(h0.hasOwnProperty(i)?l!=null&&i==="onScroll"&&hr("scroll",e):l!=null&&y2(e,i,l,s))}switch(r){case"input":Hf(e),Ax(e,n,!1);break;case"textarea":Hf(e),Tx(e);break;case"option":n.value!=null&&e.setAttribute("value",""+mo(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?dc(e,!!n.multiple,i,!1):n.defaultValue!=null&&dc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Wh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return kn(t),null;case 6:if(e&&t.stateNode!=null)m4(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Xe(166));if(r=Wo(S0.current),Wo(Ui.current),Zf(t)){if(n=t.stateNode,r=t.memoizedProps,n[Di]=t,(i=n.nodeValue!==r)&&(e=Sa,e!==null))switch(e.tag){case 3:Qf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qf(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Di]=t,t.stateNode=n}return kn(t),null;case 13:if(pr(vr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(gr&&ba!==null&&t.mode&1&&!(t.flags&128))Iw(),Cc(),t.flags|=98560,i=!1;else if(i=Zf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Xe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Xe(317));i[Di]=t}else Cc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;kn(t),i=!1}else pi!==null&&(jm(pi),pi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||vr.current&1?Qr===0&&(Qr=3):tg())),t.updateQueue!==null&&(t.flags|=4),kn(t),null);case 4:return Fc(),Am(e,t),e===null&&w0(t.stateNode.containerInfo),kn(t),null;case 10:return M2(t.type._context),kn(t),null;case 17:return la(t.type)&&Gh(),kn(t),null;case 19:if(pr(vr),i=t.memoizedState,i===null)return kn(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Lu(i,!1);else{if(Qr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=ed(e),s!==null){for(t.flags|=128,Lu(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return cr(vr,vr.current&1|2),t.child}e=e.sibling}i.tail!==null&&Rr()>Ic&&(t.flags|=128,n=!0,Lu(i,!1),t.lanes=4194304)}else{if(!n)if(e=ed(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Lu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!gr)return kn(t),null}else 2*Rr()-i.renderingStartTime>Ic&&r!==1073741824&&(t.flags|=128,n=!0,Lu(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Rr(),t.sibling=null,r=vr.current,cr(vr,n?r&1|2:r&1),t):(kn(t),null);case 22:case 23:return eg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ya&1073741824&&(kn(t),t.subtreeFlags&6&&(t.flags|=8192)):kn(t),null;case 24:return null;case 25:return null}throw Error(Xe(156,t.tag))}function p6(e,t){switch(j2(t),t.tag){case 1:return la(t.type)&&Gh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fc(),pr(oa),pr(Rn),q2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $2(t),null;case 13:if(pr(vr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Xe(340));Cc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pr(vr),null;case 4:return Fc(),null;case 10:return M2(t.type._context),null;case 22:case 23:return eg(),null;case 24:return null;default:return null}}var rh=!1,Ln=!1,m6=typeof WeakSet=="function"?WeakSet:Set,ct=null;function cc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nr(e,t,n)}else r.current=null}function Nm(e,t,r){try{r()}catch(n){Nr(e,t,n)}}var xv=!1;function g6(e,t){if(um=qh,e=ww(),P2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,h=e,p=null;t:for(;;){for(var d;h!==r||a!==0&&h.nodeType!==3||(o=s+a),h!==i||n!==0&&h.nodeType!==3||(l=s+n),h.nodeType===3&&(s+=h.nodeValue.length),(d=h.firstChild)!==null;)p=h,h=d;for(;;){if(h===e)break t;if(p===r&&++c===a&&(o=s),p===i&&++u===n&&(l=s),(d=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(fm={focusedElem:e,selectionRange:r},qh=!1,ct=t;ct!==null;)if(t=ct,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ct=e;else for(;ct!==null;){t=ct;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,S=y.memoizedState,v=t.stateNode,k=v.getSnapshotBeforeUpdate(t.elementType===t.type?x:ui(t.type,x),S);v.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Xe(163))}}catch(j){Nr(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,ct=e;break}ct=t.return}return y=xv,xv=!1,y}function Yu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Nm(t,r,i)}a=a.next}while(a!==n)}}function Rd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Tm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function g4(e){var t=e.alternate;t!==null&&(e.alternate=null,g4(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Di],delete t[b0],delete t[pm],delete t[QS],delete t[ZS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function x4(e){return e.tag===5||e.tag===3||e.tag===4}function vv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||x4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Cm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Wh));else if(n!==4&&(e=e.child,e!==null))for(Cm(e,t,r),e=e.sibling;e!==null;)Cm(e,t,r),e=e.sibling}function Lm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Lm(e,t,r),e=e.sibling;e!==null;)Lm(e,t,r),e=e.sibling}var dn=null,hi=!1;function Ds(e,t,r){for(r=r.child;r!==null;)v4(e,t,r),r=r.sibling}function v4(e,t,r){if(Bi&&typeof Bi.onCommitFiberUnmount=="function")try{Bi.onCommitFiberUnmount(Nd,r)}catch{}switch(r.tag){case 5:Ln||cc(r,t);case 6:var n=dn,a=hi;dn=null,Ds(e,t,r),dn=n,hi=a,dn!==null&&(hi?(e=dn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):dn.removeChild(r.stateNode));break;case 18:dn!==null&&(hi?(e=dn,r=r.stateNode,e.nodeType===8?ap(e.parentNode,r):e.nodeType===1&&ap(e,r),x0(e)):ap(dn,r.stateNode));break;case 4:n=dn,a=hi,dn=r.stateNode.containerInfo,hi=!0,Ds(e,t,r),dn=n,hi=a;break;case 0:case 11:case 14:case 15:if(!Ln&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Nm(r,t,s),a=a.next}while(a!==n)}Ds(e,t,r);break;case 1:if(!Ln&&(cc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Nr(r,t,o)}Ds(e,t,r);break;case 21:Ds(e,t,r);break;case 22:r.mode&1?(Ln=(n=Ln)||r.memoizedState!==null,Ds(e,t,r),Ln=n):Ds(e,t,r);break;default:Ds(e,t,r)}}function yv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new m6),t.forEach(function(n){var a=E6.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function ii(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:dn=o.stateNode,hi=!1;break e;case 3:dn=o.stateNode.containerInfo,hi=!0;break e;case 4:dn=o.stateNode.containerInfo,hi=!0;break e}o=o.return}if(dn===null)throw Error(Xe(160));v4(i,s,a),dn=null,hi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Nr(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)y4(t,e),t=t.sibling}function y4(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ii(t,e),Fi(e),n&4){try{Yu(3,e,e.return),Rd(3,e)}catch(x){Nr(e,e.return,x)}try{Yu(5,e,e.return)}catch(x){Nr(e,e.return,x)}}break;case 1:ii(t,e),Fi(e),n&512&&r!==null&&cc(r,r.return);break;case 5:if(ii(t,e),Fi(e),n&512&&r!==null&&cc(r,r.return),e.flags&32){var a=e.stateNode;try{d0(a,"")}catch(x){Nr(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&zy(a,i),em(o,s);var c=em(o,i);for(s=0;s<l.length;s+=2){var u=l[s],h=l[s+1];u==="style"?Wy(a,h):u==="dangerouslySetInnerHTML"?Hy(a,h):u==="children"?d0(a,h):y2(a,u,h,c)}switch(o){case"input":Xp(a,i);break;case"textarea":$y(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var d=i.value;d!=null?dc(a,!!i.multiple,d,!1):p!==!!i.multiple&&(i.defaultValue!=null?dc(a,!!i.multiple,i.defaultValue,!0):dc(a,!!i.multiple,i.multiple?[]:"",!1))}a[b0]=i}catch(x){Nr(e,e.return,x)}}break;case 6:if(ii(t,e),Fi(e),n&4){if(e.stateNode===null)throw Error(Xe(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(x){Nr(e,e.return,x)}}break;case 3:if(ii(t,e),Fi(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{x0(t.containerInfo)}catch(x){Nr(e,e.return,x)}break;case 4:ii(t,e),Fi(e);break;case 13:ii(t,e),Fi(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Q2=Rr())),n&4&&yv(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Ln=(c=Ln)||u,ii(t,e),Ln=c):ii(t,e),Fi(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ct=e,u=e.child;u!==null;){for(h=ct=u;ct!==null;){switch(p=ct,d=p.child,p.tag){case 0:case 11:case 14:case 15:Yu(4,p,p.return);break;case 1:cc(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(x){Nr(n,r,x)}}break;case 5:cc(p,p.return);break;case 22:if(p.memoizedState!==null){_v(h);continue}}d!==null?(d.return=p,ct=d):_v(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Vy("display",s))}catch(x){Nr(e,e.return,x)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Nr(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ii(t,e),Fi(e),n&4&&yv(e);break;case 21:break;default:ii(t,e),Fi(e)}}function Fi(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(x4(r)){var n=r;break e}r=r.return}throw Error(Xe(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(d0(a,""),n.flags&=-33);var i=vv(e);Lm(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=vv(e);Cm(e,o,s);break;default:throw Error(Xe(161))}}catch(l){Nr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function x6(e,t,r){ct=e,w4(e)}function w4(e,t,r){for(var n=(e.mode&1)!==0;ct!==null;){var a=ct,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||rh;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Ln;o=rh;var c=Ln;if(rh=s,(Ln=l)&&!c)for(ct=a;ct!==null;)s=ct,l=s.child,s.tag===22&&s.memoizedState!==null?bv(a):l!==null?(l.return=s,ct=l):bv(a);for(;i!==null;)ct=i,w4(i),i=i.sibling;ct=a,rh=o,Ln=c}wv(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ct=i):wv(e)}}function wv(e){for(;ct!==null;){var t=ct;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ln||Rd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ln)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ui(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&av(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}av(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&x0(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Xe(163))}Ln||t.flags&512&&Tm(t)}catch(p){Nr(t,t.return,p)}}if(t===e){ct=null;break}if(r=t.sibling,r!==null){r.return=t.return,ct=r;break}ct=t.return}}function _v(e){for(;ct!==null;){var t=ct;if(t===e){ct=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ct=r;break}ct=t.return}}function bv(e){for(;ct!==null;){var t=ct;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Rd(4,t)}catch(l){Nr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Nr(t,a,l)}}var i=t.return;try{Tm(t)}catch(l){Nr(t,i,l)}break;case 5:var s=t.return;try{Tm(t)}catch(l){Nr(t,s,l)}}}catch(l){Nr(t,t.return,l)}if(t===e){ct=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ct=o;break}ct=t.return}}var v6=Math.ceil,nd=ws.ReactCurrentDispatcher,Y2=ws.ReactCurrentOwner,Wa=ws.ReactCurrentBatchConfig,Ht=0,cn=null,Wr=null,mn=0,ya=0,uc=bo(0),Qr=0,T0=null,rl=0,Od=0,J2=0,Ju=null,aa=null,Q2=0,Ic=1/0,is=null,ad=!1,Fm=null,co=null,nh=!1,Zs=null,id=0,Qu=0,Pm=null,Fh=-1,Ph=0;function Vn(){return Ht&6?Rr():Fh!==-1?Fh:Fh=Rr()}function uo(e){return e.mode&1?Ht&2&&mn!==0?mn&-mn:t6.transition!==null?(Ph===0&&(Ph=aw()),Ph):(e=Zt,e!==0||(e=window.event,e=e===void 0?16:fw(e.type)),e):1}function yi(e,t,r,n){if(50<Qu)throw Qu=0,Pm=null,Error(Xe(185));$0(e,r,n),(!(Ht&2)||e!==cn)&&(e===cn&&(!(Ht&2)&&(Od|=r),Qr===4&&Ks(e,mn)),ca(e,n),r===1&&Ht===0&&!(t.mode&1)&&(Ic=Rr()+500,Pd&&ko()))}function ca(e,t){var r=e.callbackNode;tS(e,t);var n=$h(e,e===cn?mn:0);if(n===0)r!==null&&Fx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Fx(r),t===1)e.tag===0?e6(kv.bind(null,e)):Lw(kv.bind(null,e)),YS(function(){!(Ht&6)&&ko()}),r=null;else{switch(iw(n)){case 1:r=S2;break;case 4:r=rw;break;case 16:r=zh;break;case 536870912:r=nw;break;default:r=zh}r=T4(r,_4.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function _4(e,t){if(Fh=-1,Ph=0,Ht&6)throw Error(Xe(327));var r=e.callbackNode;if(vc()&&e.callbackNode!==r)return null;var n=$h(e,e===cn?mn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=sd(e,n);else{t=n;var a=Ht;Ht|=2;var i=k4();(cn!==e||mn!==t)&&(is=null,Ic=Rr()+500,Ko(e,t));do try{_6();break}catch(o){b4(e,o)}while(1);D2(),nd.current=i,Ht=a,Wr!==null?t=0:(cn=null,mn=0,t=Qr)}if(t!==0){if(t===2&&(a=im(e),a!==0&&(n=a,t=Im(e,a))),t===1)throw r=T0,Ko(e,0),Ks(e,n),ca(e,Rr()),r;if(t===6)Ks(e,n);else{if(a=e.current.alternate,!(n&30)&&!y6(a)&&(t=sd(e,n),t===2&&(i=im(e),i!==0&&(n=i,t=Im(e,i))),t===1))throw r=T0,Ko(e,0),Ks(e,n),ca(e,Rr()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Xe(345));case 2:Mo(e,aa,is);break;case 3:if(Ks(e,n),(n&130023424)===n&&(t=Q2+500-Rr(),10<t)){if($h(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Vn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=dm(Mo.bind(null,e,aa,is),t);break}Mo(e,aa,is);break;case 4:if(Ks(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-vi(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Rr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*v6(n/1960))-n,10<n){e.timeoutHandle=dm(Mo.bind(null,e,aa,is),n);break}Mo(e,aa,is);break;case 5:Mo(e,aa,is);break;default:throw Error(Xe(329))}}}return ca(e,Rr()),e.callbackNode===r?_4.bind(null,e):null}function Im(e,t){var r=Ju;return e.current.memoizedState.isDehydrated&&(Ko(e,t).flags|=256),e=sd(e,t),e!==2&&(t=aa,aa=r,t!==null&&jm(t)),e}function jm(e){aa===null?aa=e:aa.push.apply(aa,e)}function y6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!_i(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ks(e,t){for(t&=~J2,t&=~Od,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-vi(t),n=1<<r;e[r]=-1,t&=~n}}function kv(e){if(Ht&6)throw Error(Xe(327));vc();var t=$h(e,0);if(!(t&1))return ca(e,Rr()),null;var r=sd(e,t);if(e.tag!==0&&r===2){var n=im(e);n!==0&&(t=n,r=Im(e,n))}if(r===1)throw r=T0,Ko(e,0),Ks(e,t),ca(e,Rr()),r;if(r===6)throw Error(Xe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Mo(e,aa,is),ca(e,Rr()),null}function Z2(e,t){var r=Ht;Ht|=1;try{return e(t)}finally{Ht=r,Ht===0&&(Ic=Rr()+500,Pd&&ko())}}function nl(e){Zs!==null&&Zs.tag===0&&!(Ht&6)&&vc();var t=Ht;Ht|=1;var r=Wa.transition,n=Zt;try{if(Wa.transition=null,Zt=1,e)return e()}finally{Zt=n,Wa.transition=r,Ht=t,!(Ht&6)&&ko()}}function eg(){ya=uc.current,pr(uc)}function Ko(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,XS(r)),Wr!==null)for(r=Wr.return;r!==null;){var n=r;switch(j2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Gh();break;case 3:Fc(),pr(oa),pr(Rn),q2();break;case 5:$2(n);break;case 4:Fc();break;case 13:pr(vr);break;case 19:pr(vr);break;case 10:M2(n.type._context);break;case 22:case 23:eg()}r=r.return}if(cn=e,Wr=e=fo(e.current,null),mn=ya=t,Qr=0,T0=null,J2=Od=rl=0,aa=Ju=null,Vo!==null){for(t=0;t<Vo.length;t++)if(r=Vo[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}Vo=null}return e}function b4(e,t){do{var r=Wr;try{if(D2(),Th.current=rd,td){for(var n=yr.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}td=!1}if(tl=0,on=Jr=yr=null,Xu=!1,E0=0,Y2.current=null,r===null||r.return===null){Qr=1,T0=t,Wr=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=mn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=uv(s);if(d!==null){d.flags&=-257,fv(d,s,o,i,t),d.mode&1&&cv(i,c,t),t=d,l=c;var y=t.updateQueue;if(y===null){var x=new Set;x.add(l),t.updateQueue=x}else y.add(l);break e}else{if(!(t&1)){cv(i,c,t),tg();break e}l=Error(Xe(426))}}else if(gr&&o.mode&1){var S=uv(s);if(S!==null){!(S.flags&65536)&&(S.flags|=256),fv(S,s,o,i,t),R2(Pc(l,o));break e}}i=l=Pc(l,o),Qr!==4&&(Qr=2),Ju===null?Ju=[i]:Ju.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=i4(i,l,t);nv(i,v);break e;case 1:o=l;var k=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof k.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(co===null||!co.has(_)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=s4(i,o,t);nv(i,j);break e}}i=i.return}while(i!==null)}E4(r)}catch(D){t=D,Wr===r&&r!==null&&(Wr=r=r.return);continue}break}while(1)}function k4(){var e=nd.current;return nd.current=rd,e===null?rd:e}function tg(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),cn===null||!(rl&268435455)&&!(Od&268435455)||Ks(cn,mn)}function sd(e,t){var r=Ht;Ht|=2;var n=k4();(cn!==e||mn!==t)&&(is=null,Ko(e,t));do try{w6();break}catch(a){b4(e,a)}while(1);if(D2(),Ht=r,nd.current=n,Wr!==null)throw Error(Xe(261));return cn=null,mn=0,Qr}function w6(){for(;Wr!==null;)S4(Wr)}function _6(){for(;Wr!==null&&!Wk();)S4(Wr)}function S4(e){var t=N4(e.alternate,e,ya);e.memoizedProps=e.pendingProps,t===null?E4(e):Wr=t,Y2.current=null}function E4(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=p6(r,t),r!==null){r.flags&=32767,Wr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qr=6,Wr=null;return}}else if(r=d6(r,t,ya),r!==null){Wr=r;return}if(t=t.sibling,t!==null){Wr=t;return}Wr=t=e}while(t!==null);Qr===0&&(Qr=5)}function Mo(e,t,r){var n=Zt,a=Wa.transition;try{Wa.transition=null,Zt=1,b6(e,t,r,n)}finally{Wa.transition=a,Zt=n}return null}function b6(e,t,r,n){do vc();while(Zs!==null);if(Ht&6)throw Error(Xe(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Xe(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(rS(e,i),e===cn&&(Wr=cn=null,mn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||nh||(nh=!0,T4(zh,function(){return vc(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Wa.transition,Wa.transition=null;var s=Zt;Zt=1;var o=Ht;Ht|=4,Y2.current=null,g6(e,r),y4(r,e),$S(fm),qh=!!um,fm=um=null,e.current=r,x6(r),Gk(),Ht=o,Zt=s,Wa.transition=i}else e.current=r;if(nh&&(nh=!1,Zs=e,id=a),i=e.pendingLanes,i===0&&(co=null),Yk(r.stateNode),ca(e,Rr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(ad)throw ad=!1,e=Fm,Fm=null,e;return id&1&&e.tag!==0&&vc(),i=e.pendingLanes,i&1?e===Pm?Qu++:(Qu=0,Pm=e):Qu=0,ko(),null}function vc(){if(Zs!==null){var e=iw(id),t=Wa.transition,r=Zt;try{if(Wa.transition=null,Zt=16>e?16:e,Zs===null)var n=!1;else{if(e=Zs,Zs=null,id=0,Ht&6)throw Error(Xe(331));var a=Ht;for(Ht|=4,ct=e.current;ct!==null;){var i=ct,s=i.child;if(ct.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ct=c;ct!==null;){var u=ct;switch(u.tag){case 0:case 11:case 15:Yu(8,u,i)}var h=u.child;if(h!==null)h.return=u,ct=h;else for(;ct!==null;){u=ct;var p=u.sibling,d=u.return;if(g4(u),u===c){ct=null;break}if(p!==null){p.return=d,ct=p;break}ct=d}}}var y=i.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}ct=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,ct=s;else e:for(;ct!==null;){if(i=ct,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Yu(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ct=v;break e}ct=i.return}}var k=e.current;for(ct=k;ct!==null;){s=ct;var _=s.child;if(s.subtreeFlags&2064&&_!==null)_.return=s,ct=_;else e:for(s=k;ct!==null;){if(o=ct,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Rd(9,o)}}catch(D){Nr(o,o.return,D)}if(o===s){ct=null;break e}var j=o.sibling;if(j!==null){j.return=o.return,ct=j;break e}ct=o.return}}if(Ht=a,ko(),Bi&&typeof Bi.onPostCommitFiberRoot=="function")try{Bi.onPostCommitFiberRoot(Nd,e)}catch{}n=!0}return n}finally{Zt=r,Wa.transition=t}}return!1}function Sv(e,t,r){t=Pc(r,t),t=i4(e,t,1),e=lo(e,t,1),t=Vn(),e!==null&&($0(e,1,t),ca(e,t))}function Nr(e,t,r){if(e.tag===3)Sv(e,e,r);else for(;t!==null;){if(t.tag===3){Sv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(co===null||!co.has(n))){e=Pc(r,e),e=s4(t,e,1),t=lo(t,e,1),e=Vn(),t!==null&&($0(t,1,e),ca(t,e));break}}t=t.return}}function k6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Vn(),e.pingedLanes|=e.suspendedLanes&r,cn===e&&(mn&r)===r&&(Qr===4||Qr===3&&(mn&130023424)===mn&&500>Rr()-Q2?Ko(e,0):J2|=r),ca(e,t)}function A4(e,t){t===0&&(e.mode&1?(t=Gf,Gf<<=1,!(Gf&130023424)&&(Gf=4194304)):t=1);var r=Vn();e=gs(e,t),e!==null&&($0(e,t,r),ca(e,r))}function S6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),A4(e,r)}function E6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Xe(314))}n!==null&&n.delete(t),A4(e,r)}var N4;N4=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||oa.current)sa=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return sa=!1,h6(e,t,r);sa=!!(e.flags&131072)}else sa=!1,gr&&t.flags&1048576&&Fw(t,Yh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Lh(e,t),e=t.pendingProps;var a=Tc(t,Rn.current);xc(t,r),a=V2(null,t,n,e,a,r);var i=W2();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,la(n)?(i=!0,Kh(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,U2(t),a.updater=jd,t.stateNode=a,a._reactInternals=t,wm(t,n,e,r),t=km(null,t,n,!0,i,r)):(t.tag=0,gr&&i&&I2(t),zn(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Lh(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=N6(n),e=ui(n,e),a){case 0:t=bm(null,t,n,e,r);break e;case 1:t=pv(null,t,n,e,r);break e;case 11:t=hv(null,t,n,e,r);break e;case 14:t=dv(null,t,n,ui(n.type,e),r);break e}throw Error(Xe(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ui(n,a),bm(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ui(n,a),pv(e,t,n,a,r);case 3:e:{if(u4(t),e===null)throw Error(Xe(387));n=t.pendingProps,i=t.memoizedState,a=i.element,Dw(e,t),Zh(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Pc(Error(Xe(423)),t),t=mv(e,t,n,r,a);break e}else if(n!==a){a=Pc(Error(Xe(424)),t),t=mv(e,t,n,r,a);break e}else for(ba=oo(t.stateNode.containerInfo.firstChild),Sa=t,gr=!0,pi=null,r=Rw(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Cc(),n===a){t=xs(e,t,r);break e}zn(e,t,n,r)}t=t.child}return t;case 5:return Mw(t),e===null&&xm(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,hm(n,a)?s=null:i!==null&&hm(n,i)&&(t.flags|=32),c4(e,t),zn(e,t,s,r),t.child;case 6:return e===null&&xm(t),null;case 13:return f4(e,t,r);case 4:return z2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Lc(t,null,n,r):zn(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ui(n,a),hv(e,t,n,a,r);case 7:return zn(e,t,t.pendingProps,r),t.child;case 8:return zn(e,t,t.pendingProps.children,r),t.child;case 12:return zn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,cr(Jh,n._currentValue),n._currentValue=s,i!==null)if(_i(i.value,s)){if(i.children===a.children&&!oa.current){t=xs(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=fs(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),vm(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Xe(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),vm(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}zn(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,xc(t,r),a=Ga(a),n=n(a),t.flags|=1,zn(e,t,n,r),t.child;case 14:return n=t.type,a=ui(n,t.pendingProps),a=ui(n.type,a),dv(e,t,n,a,r);case 15:return o4(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ui(n,a),Lh(e,t),t.tag=1,la(n)?(e=!0,Kh(t)):e=!1,xc(t,r),a4(t,n,a),wm(t,n,a,r),km(null,t,n,!0,e,r);case 19:return h4(e,t,r);case 22:return l4(e,t,r)}throw Error(Xe(156,t.tag))};function T4(e,t){return tw(e,t)}function A6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Va(e,t,r,n){return new A6(e,t,r,n)}function rg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function N6(e){if(typeof e=="function")return rg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===_2)return 11;if(e===b2)return 14}return 2}function fo(e,t){var r=e.alternate;return r===null?(r=Va(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ih(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")rg(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case ec:return Xo(r.children,a,i,t);case w2:s=8,a|=8;break;case Hp:return e=Va(12,r,t,a|2),e.elementType=Hp,e.lanes=i,e;case Vp:return e=Va(13,r,t,a),e.elementType=Vp,e.lanes=i,e;case Wp:return e=Va(19,r,t,a),e.elementType=Wp,e.lanes=i,e;case My:return Dd(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Oy:s=10;break e;case Dy:s=9;break e;case _2:s=11;break e;case b2:s=14;break e;case qs:s=16,n=null;break e}throw Error(Xe(130,e==null?e:typeof e,""))}return t=Va(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Xo(e,t,r,n){return e=Va(7,e,n,t),e.lanes=r,e}function Dd(e,t,r,n){return e=Va(22,e,n,t),e.elementType=My,e.lanes=r,e.stateNode={isHidden:!1},e}function hp(e,t,r){return e=Va(6,e,null,t),e.lanes=r,e}function dp(e,t,r){return t=Va(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function T6(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=G1(0),this.expirationTimes=G1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G1(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function ng(e,t,r,n,a,i,s,o,l){return e=new T6(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Va(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},U2(i),e}function C6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function C4(e){if(!e)return go;e=e._reactInternals;e:{if(ll(e)!==e||e.tag!==1)throw Error(Xe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(la(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Xe(171))}if(e.tag===1){var r=e.type;if(la(r))return Cw(e,r,t)}return t}function L4(e,t,r,n,a,i,s,o,l){return e=ng(r,n,!0,e,a,i,s,o,l),e.context=C4(null),r=e.current,n=Vn(),a=uo(r),i=fs(n,a),i.callback=t??null,lo(r,i,a),e.current.lanes=a,$0(e,a,n),ca(e,n),e}function Md(e,t,r,n){var a=t.current,i=Vn(),s=uo(a);return r=C4(r),t.context===null?t.context=r:t.pendingContext=r,t=fs(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=lo(a,t,s),e!==null&&(yi(e,a,s,i),Nh(e,a,s)),s}function od(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ev(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function ag(e,t){Ev(e,t),(e=e.alternate)&&Ev(e,t)}function L6(){return null}var F4=typeof reportError=="function"?reportError:function(e){console.error(e)};function ig(e){this._internalRoot=e}Bd.prototype.render=ig.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Xe(409));Md(e,t,null,null)};Bd.prototype.unmount=ig.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;nl(function(){Md(null,e,null,null)}),t[ms]=null}};function Bd(e){this._internalRoot=e}Bd.prototype.unstable_scheduleHydration=function(e){if(e){var t=lw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Gs.length&&t!==0&&t<Gs[r].priority;r++);Gs.splice(r,0,e),r===0&&uw(e)}};function sg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ud(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Av(){}function F6(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var c=od(s);i.call(c)}}var s=L4(t,n,e,0,null,!1,!1,"",Av);return e._reactRootContainer=s,e[ms]=s.current,w0(e.nodeType===8?e.parentNode:e),nl(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=od(l);o.call(c)}}var l=ng(e,0,!1,null,null,!1,!1,"",Av);return e._reactRootContainer=l,e[ms]=l.current,w0(e.nodeType===8?e.parentNode:e),nl(function(){Md(t,l,r,n)}),l}function zd(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=od(s);o.call(l)}}Md(t,s,e,a)}else s=F6(r,t,e,a,n);return od(s)}sw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Du(t.pendingLanes);r!==0&&(E2(t,r|1),ca(t,Rr()),!(Ht&6)&&(Ic=Rr()+500,ko()))}break;case 13:nl(function(){var n=gs(e,1);if(n!==null){var a=Vn();yi(n,e,1,a)}}),ag(e,1)}};A2=function(e){if(e.tag===13){var t=gs(e,134217728);if(t!==null){var r=Vn();yi(t,e,134217728,r)}ag(e,134217728)}};ow=function(e){if(e.tag===13){var t=uo(e),r=gs(e,t);if(r!==null){var n=Vn();yi(r,e,t,n)}ag(e,t)}};lw=function(){return Zt};cw=function(e,t){var r=Zt;try{return Zt=e,t()}finally{Zt=r}};rm=function(e,t,r){switch(t){case"input":if(Xp(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Fd(n);if(!a)throw Error(Xe(90));Uy(n),Xp(n,a)}}}break;case"textarea":$y(e,r);break;case"select":t=r.value,t!=null&&dc(e,!!r.multiple,t,!1)}};Xy=Z2;Yy=nl;var P6={usingClientEntryPoint:!1,Events:[H0,ac,Fd,Gy,Ky,Z2]},Fu={findFiberByHostInstance:Ho,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},I6={bundleType:Fu.bundleType,version:Fu.version,rendererPackageName:Fu.rendererPackageName,rendererConfig:Fu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zy(e),e===null?null:e.stateNode},findFiberByHostInstance:Fu.findFiberByHostInstance||L6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{Nd=ah.inject(I6),Bi=ah}catch{}}Ta.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P6;Ta.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sg(t))throw Error(Xe(200));return C6(e,t,null,r)};Ta.createRoot=function(e,t){if(!sg(e))throw Error(Xe(299));var r=!1,n="",a=F4;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=ng(e,1,!1,null,null,r,!1,n,a),e[ms]=t.current,w0(e.nodeType===8?e.parentNode:e),new ig(t)};Ta.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Xe(188)):(e=Object.keys(e).join(","),Error(Xe(268,e)));return e=Zy(t),e=e===null?null:e.stateNode,e};Ta.flushSync=function(e){return nl(e)};Ta.hydrate=function(e,t,r){if(!Ud(t))throw Error(Xe(200));return zd(null,e,t,!0,r)};Ta.hydrateRoot=function(e,t,r){if(!sg(e))throw Error(Xe(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=F4;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=L4(t,null,e,1,r??null,a,!1,i,s),e[ms]=t.current,w0(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Bd(t)};Ta.render=function(e,t,r){if(!Ud(t))throw Error(Xe(200));return zd(null,e,t,!1,r)};Ta.unmountComponentAtNode=function(e){if(!Ud(e))throw Error(Xe(40));return e._reactRootContainer?(nl(function(){zd(null,null,e,!1,function(){e._reactRootContainer=null,e[ms]=null})}),!0):!1};Ta.unstable_batchedUpdates=Z2;Ta.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ud(r))throw Error(Xe(200));if(e==null||e._reactInternals===void 0)throw Error(Xe(38));return zd(e,t,r,!1,n)};Ta.version="18.3.1-next-f1338f8080-20240426";function P4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(P4)}catch(e){console.error(e)}}P4(),Py.exports=Ta;var j6=Py.exports,I4,Nv=j6;I4=Nv.createRoot,Nv.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C0.apply(this,arguments)}var eo;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(eo||(eo={}));const Tv="popstate";function R6(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:s,hash:o}=n.location;return Rm("",{pathname:i,search:s,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:ld(a)}return D6(t,r,null,e)}function wr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function j4(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function O6(){return Math.random().toString(36).substr(2,8)}function Cv(e,t){return{usr:e.state,key:e.key,idx:t}}function Rm(e,t,r,n){return r===void 0&&(r=null),C0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?$c(t):t,{state:r,key:t&&t.key||n||O6()})}function ld(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function $c(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function D6(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,o=eo.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(C0({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function h(){o=eo.Pop;let S=u(),v=S==null?null:S-c;c=S,l&&l({action:o,location:x.location,delta:v})}function p(S,v){o=eo.Push;let k=Rm(x.location,S,v);r&&r(k,S),c=u()+1;let _=Cv(k,c),j=x.createHref(k);try{s.pushState(_,"",j)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;a.location.assign(j)}i&&l&&l({action:o,location:x.location,delta:1})}function d(S,v){o=eo.Replace;let k=Rm(x.location,S,v);r&&r(k,S),c=u();let _=Cv(k,c),j=x.createHref(k);s.replaceState(_,"",j),i&&l&&l({action:o,location:x.location,delta:0})}function y(S){let v=a.location.origin!=="null"?a.location.origin:a.location.href,k=typeof S=="string"?S:ld(S);return k=k.replace(/ $/,"%20"),wr(v,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,v)}let x={get action(){return o},get location(){return e(a,s)},listen(S){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Tv,h),l=S,()=>{a.removeEventListener(Tv,h),l=null}},createHref(S){return t(a,S)},createURL:y,encodeLocation(S){let v=y(S);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:d,go(S){return s.go(S)}};return x}var Lv;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Lv||(Lv={}));function M6(e,t,r){return r===void 0&&(r="/"),B6(e,t,r,!1)}function B6(e,t,r,n){let a=typeof t=="string"?$c(t):t,i=jc(a.pathname||"/",r);if(i==null)return null;let s=R4(e);U6(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let c=J6(i);o=X6(s[l],c,n)}return o}function R4(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};l.relativePath.startsWith("/")&&(wr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ho([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(wr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),R4(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:G6(c,i.index),routesMeta:u})};return e.forEach((i,s)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,s);else for(let l of O4(i.path))a(i,s,l)}),t}function O4(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=O4(n.join("/")),o=[];return o.push(...s.map(l=>l===""?i:[i,l].join("/"))),a&&o.push(...s),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function U6(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:K6(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const z6=/^:[\w-]+$/,$6=3,q6=2,H6=1,V6=10,W6=-2,Fv=e=>e==="*";function G6(e,t){let r=e.split("/"),n=r.length;return r.some(Fv)&&(n+=W6),t&&(n+=q6),r.filter(a=>!Fv(a)).reduce((a,i)=>a+(z6.test(i)?$6:i===""?H6:V6),n)}function K6(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function X6(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,a={},i="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",h=cd({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=cd({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(a,h.params),s.push({params:a,pathname:ho([i,h.pathname]),pathnameBase:tE(ho([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=ho([i,h.pathnameBase]))}return s}function cd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Y6(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:p,isOptional:d}=u;if(p==="*"){let x=o[h]||"";s=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const y=o[h];return d&&!y?c[p]=void 0:c[p]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:s,pattern:e}}function Y6(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),j4(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function J6(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return j4(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function jc(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Q6(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?$c(e):e;return{pathname:r?r.startsWith("/")?r:Z6(r,t):t,search:rE(n),hash:nE(a)}}function Z6(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function pp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function eE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function og(e,t){let r=eE(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function lg(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=$c(e):(a=C0({},e),wr(!a.pathname||!a.pathname.includes("?"),pp("?","pathname","search",a)),wr(!a.pathname||!a.pathname.includes("#"),pp("#","pathname","hash",a)),wr(!a.search||!a.search.includes("#"),pp("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,o;if(s==null)o=r;else{let h=t.length-1;if(!n&&s.startsWith("..")){let p=s.split("/");for(;p[0]==="..";)p.shift(),h-=1;a.pathname=p.join("/")}o=h>=0?t[h]:"/"}let l=Q6(a,o),c=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ho=e=>e.join("/").replace(/\/\/+/g,"/"),tE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),rE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,nE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function aE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const D4=["post","put","patch","delete"];new Set(D4);const iE=["get",...D4];new Set(iE);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function L0(){return L0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L0.apply(this,arguments)}const $d=ge.createContext(null),M4=ge.createContext(null),_s=ge.createContext(null),qd=ge.createContext(null),qi=ge.createContext({outlet:null,matches:[],isDataRoute:!1}),B4=ge.createContext(null);function sE(e,t){let{relative:r}=t===void 0?{}:t;qc()||wr(!1);let{basename:n,navigator:a}=ge.useContext(_s),{hash:i,pathname:s,search:o}=Hd(e,{relative:r}),l=s;return n!=="/"&&(l=s==="/"?n:ho([n,s])),a.createHref({pathname:l,search:o,hash:i})}function qc(){return ge.useContext(qd)!=null}function cl(){return qc()||wr(!1),ge.useContext(qd).location}function U4(e){ge.useContext(_s).static||ge.useLayoutEffect(e)}function Rt(){let{isDataRoute:e}=ge.useContext(qi);return e?_E():oE()}function oE(){qc()||wr(!1);let e=ge.useContext($d),{basename:t,future:r,navigator:n}=ge.useContext(_s),{matches:a}=ge.useContext(qi),{pathname:i}=cl(),s=JSON.stringify(og(a,r.v7_relativeSplatPath)),o=ge.useRef(!1);return U4(()=>{o.current=!0}),ge.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=lg(c,JSON.parse(s),i,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ho([t,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[t,n,s,i,e])}const lE=ge.createContext(null);function cE(e){let t=ge.useContext(qi).outlet;return t&&ge.createElement(lE.Provider,{value:e},t)}function z4(){let{matches:e}=ge.useContext(qi),t=e[e.length-1];return t?t.params:{}}function Hd(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=ge.useContext(_s),{matches:a}=ge.useContext(qi),{pathname:i}=cl(),s=JSON.stringify(og(a,n.v7_relativeSplatPath));return ge.useMemo(()=>lg(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function uE(e,t){return fE(e,t)}function fE(e,t,r,n){qc()||wr(!1);let{navigator:a,static:i}=ge.useContext(_s),{matches:s}=ge.useContext(qi),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=cl(),h;if(t){var p;let v=typeof t=="string"?$c(t):t;c==="/"||(p=v.pathname)!=null&&p.startsWith(c)||wr(!1),h=v}else h=u;let d=h.pathname||"/",y=d;if(c!=="/"){let v=c.replace(/^\//,"").split("/");y="/"+d.replace(/^\//,"").split("/").slice(v.length).join("/")}let x=!i&&r&&r.matches&&r.matches.length>0?r.matches:M6(e,{pathname:y}),S=gE(x&&x.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:ho([c,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:ho([c,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,r,n);return t&&S?ge.createElement(qd.Provider,{value:{location:L0({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:eo.Pop}},S):S}function hE(){let e=wE(),t=aE(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return ge.createElement(ge.Fragment,null,ge.createElement("h2",null,"Unexpected Application Error!"),ge.createElement("h3",{style:{fontStyle:"italic"}},t),r?ge.createElement("pre",{style:a},r):null,i)}const dE=ge.createElement(hE,null);class pE extends ge.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?ge.createElement(qi.Provider,{value:this.props.routeContext},ge.createElement(B4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mE(e){let{routeContext:t,match:r,children:n}=e,a=ge.useContext($d);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),ge.createElement(qi.Provider,{value:t},n)}function gE(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let u=s.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||wr(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<s.length;u++){let h=s[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:p,errors:d}=r,y=h.route.loader&&p[h.route.id]===void 0&&(!d||d[h.route.id]===void 0);if(h.route.lazy||y){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,h,p)=>{let d,y=!1,x=null,S=null;r&&(d=o&&h.route.id?o[h.route.id]:void 0,x=h.route.errorElement||dE,l&&(c<0&&p===0?(bE("route-fallback",!1),y=!0,S=null):c===p&&(y=!0,S=h.route.hydrateFallbackElement||null)));let v=t.concat(s.slice(0,p+1)),k=()=>{let _;return d?_=x:y?_=S:h.route.Component?_=ge.createElement(h.route.Component,null):h.route.element?_=h.route.element:_=u,ge.createElement(mE,{match:h,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:_})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?ge.createElement(pE,{location:r.location,revalidation:r.revalidation,component:x,error:d,children:k(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):k()},null)}var $4=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}($4||{}),ud=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ud||{});function xE(e){let t=ge.useContext($d);return t||wr(!1),t}function vE(e){let t=ge.useContext(M4);return t||wr(!1),t}function yE(e){let t=ge.useContext(qi);return t||wr(!1),t}function q4(e){let t=yE(),r=t.matches[t.matches.length-1];return r.route.id||wr(!1),r.route.id}function wE(){var e;let t=ge.useContext(B4),r=vE(ud.UseRouteError),n=q4(ud.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function _E(){let{router:e}=xE($4.UseNavigateStable),t=q4(ud.UseNavigateStable),r=ge.useRef(!1);return U4(()=>{r.current=!0}),ge.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,L0({fromRouteId:t},i)))},[e,t])}const Pv={};function bE(e,t,r){!t&&!Pv[e]&&(Pv[e]=!0)}function kE(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Xr(e){let{to:t,replace:r,state:n,relative:a}=e;qc()||wr(!1);let{future:i,static:s}=ge.useContext(_s),{matches:o}=ge.useContext(qi),{pathname:l}=cl(),c=Rt(),u=lg(t,og(o,i.v7_relativeSplatPath),l,a==="path"),h=JSON.stringify(u);return ge.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:a}),[c,h,a,r,n]),null}function SE(e){return cE(e.context)}function dt(e){wr(!1)}function EE(e){let{basename:t="/",children:r=null,location:n,navigationType:a=eo.Pop,navigator:i,static:s=!1,future:o}=e;qc()&&wr(!1);let l=t.replace(/^\/*/,"/"),c=ge.useMemo(()=>({basename:l,navigator:i,static:s,future:L0({v7_relativeSplatPath:!1},o)}),[l,o,i,s]);typeof n=="string"&&(n=$c(n));let{pathname:u="/",search:h="",hash:p="",state:d=null,key:y="default"}=n,x=ge.useMemo(()=>{let S=jc(u,l);return S==null?null:{location:{pathname:S,search:h,hash:p,state:d,key:y},navigationType:a}},[l,u,h,p,d,y,a]);return x==null?null:ge.createElement(_s.Provider,{value:c},ge.createElement(qd.Provider,{children:r,value:x}))}function H4(e){let{children:t,location:r}=e;return uE(Om(t),r)}new Promise(()=>{});function Om(e,t){t===void 0&&(t=[]);let r=[];return ge.Children.forEach(e,(n,a)=>{if(!ge.isValidElement(n))return;let i=[...t,a];if(n.type===ge.Fragment){r.push.apply(r,Om(n.props.children,i));return}n.type!==dt&&wr(!1),!n.props.index||!n.props.children||wr(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Om(n.props.children,i)),r.push(s)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fd(){return fd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fd.apply(this,arguments)}function V4(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function AE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function NE(e,t){return e.button===0&&(!t||t==="_self")&&!AE(e)}const TE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],CE=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],LE="6";try{window.__reactRouterVersion=LE}catch{}const FE=ge.createContext({isTransitioning:!1}),PE="startTransition",Iv=kk[PE];function IE(e){let{basename:t,children:r,future:n,window:a}=e,i=ge.useRef();i.current==null&&(i.current=R6({window:a,v5Compat:!0}));let s=i.current,[o,l]=ge.useState({action:s.action,location:s.location}),{v7_startTransition:c}=n||{},u=ge.useCallback(h=>{c&&Iv?Iv(()=>l(h)):l(h)},[l,c]);return ge.useLayoutEffect(()=>s.listen(u),[s,u]),ge.useEffect(()=>kE(n),[n]),ge.createElement(EE,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}const jE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",RE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,W4=ge.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:s,state:o,target:l,to:c,preventScrollReset:u,viewTransition:h}=t,p=V4(t,TE),{basename:d}=ge.useContext(_s),y,x=!1;if(typeof c=="string"&&RE.test(c)&&(y=c,jE))try{let _=new URL(window.location.href),j=c.startsWith("//")?new URL(_.protocol+c):new URL(c),D=jc(j.pathname,d);j.origin===_.origin&&D!=null?c=D+j.search+j.hash:x=!0}catch{}let S=sE(c,{relative:a}),v=DE(c,{replace:s,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:h});function k(_){n&&n(_),_.defaultPrevented||v(_)}return ge.createElement("a",fd({},p,{href:y||S,onClick:x||i?n:k,ref:r,target:l}))}),Vs=ge.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:i="",end:s=!1,style:o,to:l,viewTransition:c,children:u}=t,h=V4(t,CE),p=Hd(l,{relative:h.relative}),d=cl(),y=ge.useContext(M4),{navigator:x,basename:S}=ge.useContext(_s),v=y!=null&&ME(p)&&c===!0,k=x.encodeLocation?x.encodeLocation(p).pathname:p.pathname,_=d.pathname,j=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;a||(_=_.toLowerCase(),j=j?j.toLowerCase():null,k=k.toLowerCase()),j&&S&&(j=jc(j,S)||j);const D=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let z=_===k||!s&&_.startsWith(k)&&_.charAt(D)==="/",I=j!=null&&(j===k||!s&&j.startsWith(k)&&j.charAt(k.length)==="/"),T={isActive:z,isPending:I,isTransitioning:v},L=z?n:void 0,O;typeof i=="function"?O=i(T):O=[i,z?"active":null,I?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let F=typeof o=="function"?o(T):o;return ge.createElement(W4,fd({},h,{"aria-current":L,className:O,ref:r,style:F,to:l,viewTransition:c}),typeof u=="function"?u(T):u)});var Dm;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Dm||(Dm={}));var jv;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(jv||(jv={}));function OE(e){let t=ge.useContext($d);return t||wr(!1),t}function DE(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:s,viewTransition:o}=t===void 0?{}:t,l=Rt(),c=cl(),u=Hd(e,{relative:s});return ge.useCallback(h=>{if(NE(h,r)){h.preventDefault();let p=n!==void 0?n:ld(c)===ld(u);l(e,{replace:p,state:a,preventScrollReset:i,relative:s,viewTransition:o})}},[c,l,u,n,a,r,e,i,s,o])}function ME(e,t){t===void 0&&(t={});let r=ge.useContext(FE);r==null&&wr(!1);let{basename:n}=OE(Dm.useViewTransitionState),a=Hd(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=jc(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=jc(r.nextLocation.pathname,n)||r.nextLocation.pathname;return cd(a.pathname,s)!=null||cd(a.pathname,i)!=null}const BE="modulepreload",UE=function(e){return"/"+e},Rv={},vs=function(t,r,n){if(!r||r.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=UE(i),i in Rv)return;Rv[i]=!0;const s=i.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(!!n)for(let u=a.length-1;u>=0;u--){const h=a[u];if(h.href===i&&(!s||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${o}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":BE,s||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),s)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})},zE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>vs(()=>Promise.resolve().then(()=>Hc),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class cg extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class $E extends cg{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class qE extends cg{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class HE extends cg{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Mm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Mm||(Mm={}));var VE=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class WE{constructor(t,{headers:r={},customFetch:n,region:a=Mm.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=zE(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return VE(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=s):typeof s=="string"?(o["Content-Type"]="text/plain",c=s):typeof FormData<"u"&&s instanceof FormData?c=s:(o["Content-Type"]="application/json",c=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:c}).catch(y=>{throw new $E(y)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new qE(u);if(!u.ok)throw new HE(u);let p=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),d;return p==="application/json"?d=yield u.json():p==="application/octet-stream"?d=yield u.blob():p==="text/event-stream"?d=u:p==="multipart/form-data"?d=yield u.formData():d=yield u.text(),{data:d,error:null}}catch(a){return{data:null,error:a}}})}}var ia={},ug={},Vd={},W0={},Wd={},Gd={},GE=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Rc=GE();const KE=Rc.fetch,G4=Rc.fetch.bind(Rc),K4=Rc.Headers,XE=Rc.Request,YE=Rc.Response,Hc=Object.freeze(Object.defineProperty({__proto__:null,Headers:K4,Request:XE,Response:YE,default:G4,fetch:KE},Symbol.toStringTag,{value:"Module"})),JE=sk(Hc);var Kd={};Object.defineProperty(Kd,"__esModule",{value:!0});let QE=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Kd.default=QE;var X4=Ea&&Ea.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gd,"__esModule",{value:!0});const ZE=X4(JE),e8=X4(Kd);let t8=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=ZE.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,o,l;let c=null,u=null,h=null,p=i.status,d=i.statusText;if(i.ok){if(this.method!=="HEAD"){const v=await i.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=v:u=JSON.parse(v))}const x=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),S=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");x&&S&&S.length>1&&(h=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,p=406,d="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const x=await i.text();try{c=JSON.parse(x),Array.isArray(c)&&i.status===404&&(u=[],c=null,p=200,d="OK")}catch{i.status===404&&x===""?(p=204,d="No Content"):c={message:x}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,d="OK"),c&&this.shouldThrowOnError)throw new e8.default(c)}return{error:c,data:u,count:h,status:p,statusText:d}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,o,l;return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Gd.default=t8;var r8=Ea&&Ea.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wd,"__esModule",{value:!0});const n8=r8(Gd);let a8=class extends n8.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Wd.default=a8;var i8=Ea&&Ea.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(W0,"__esModule",{value:!0});const s8=i8(Wd);let o8=class extends s8.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};W0.default=o8;var l8=Ea&&Ea.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vd,"__esModule",{value:!0});const Pu=l8(W0);let c8=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const s=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new Pu.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const s=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(s.length>0){const o=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Pu.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){const s="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Pu.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new Pu.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Pu.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Vd.default=c8;var Xd={},Yd={};Object.defineProperty(Yd,"__esModule",{value:!0});Yd.version=void 0;Yd.version="0.0.0-automated";Object.defineProperty(Xd,"__esModule",{value:!0});Xd.DEFAULT_HEADERS=void 0;const u8=Yd;Xd.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${u8.version}`};var Y4=Ea&&Ea.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ug,"__esModule",{value:!0});const f8=Y4(Vd),h8=Y4(W0),d8=Xd;let p8=class J4{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},d8.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new f8.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new J4(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){let s;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(s=n?"HEAD":"GET",Object.entries(r).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{o.searchParams.append(u,h)})):(s="POST",l=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new h8.default({method:s,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};ug.default=p8;var Vc=Ea&&Ea.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ia,"__esModule",{value:!0});ia.PostgrestError=ia.PostgrestBuilder=ia.PostgrestTransformBuilder=ia.PostgrestFilterBuilder=ia.PostgrestQueryBuilder=ia.PostgrestClient=void 0;const Q4=Vc(ug);ia.PostgrestClient=Q4.default;const Z4=Vc(Vd);ia.PostgrestQueryBuilder=Z4.default;const e_=Vc(W0);ia.PostgrestFilterBuilder=e_.default;const t_=Vc(Wd);ia.PostgrestTransformBuilder=t_.default;const r_=Vc(Gd);ia.PostgrestBuilder=r_.default;const n_=Vc(Kd);ia.PostgrestError=n_.default;var m8=ia.default={PostgrestClient:Q4.default,PostgrestQueryBuilder:Z4.default,PostgrestFilterBuilder:e_.default,PostgrestTransformBuilder:t_.default,PostgrestBuilder:r_.default,PostgrestError:n_.default};const{PostgrestClient:g8,PostgrestQueryBuilder:CD,PostgrestFilterBuilder:LD,PostgrestTransformBuilder:FD,PostgrestBuilder:PD,PostgrestError:ID}=m8,x8="2.11.2",v8={"X-Client-Info":`realtime-js/${x8}`},y8="1.0.0",a_=1e4,w8=1e3;var yc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(yc||(yc={}));var va;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(va||(va={}));var di;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(di||(di={}));var Bm;(function(e){e.websocket="websocket"})(Bm||(Bm={}));var zo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(zo||(zo={}));class _8{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(t.slice(s,s+a));s=s+a;const l=n.decode(t.slice(s,s+i));s=s+i;const c=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class i_{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var lr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(lr||(lr={}));const Ov=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,s)=>(i[s]=b8(s,e,t,a),i),{})},b8=(e,t,r,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?s_(i,s):Um(s)},s_=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return A8(t,r)}switch(e){case lr.bool:return k8(t);case lr.float4:case lr.float8:case lr.int2:case lr.int4:case lr.int8:case lr.numeric:case lr.oid:return S8(t);case lr.json:case lr.jsonb:return E8(t);case lr.timestamp:return N8(t);case lr.abstime:case lr.date:case lr.daterange:case lr.int4range:case lr.int8range:case lr.money:case lr.reltime:case lr.text:case lr.time:case lr.timestamptz:case lr.timetz:case lr.tsrange:case lr.tstzrange:return Um(t);default:return Um(t)}},Um=e=>e,k8=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},S8=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},E8=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},A8=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>s_(t,o))}return e},N8=e=>typeof e=="string"?e.replace(" ","T"):e,o_=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class mp{constructor(t,r,n={},a=a_){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Dv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Dv||(Dv={}));class Zu{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zu.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=Zu.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Zu.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const h=i[c];if(h){const p=u.map(S=>S.presence_ref),d=h.map(S=>S.presence_ref),y=u.filter(S=>d.indexOf(S.presence_ref)<0),x=h.filter(S=>p.indexOf(S.presence_ref)<0);y.length>0&&(o[c]=y),x.length>0&&(l[c]=x)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const h=t[o].map(d=>d.presence_ref),p=u.filter(d=>h.indexOf(d.presence_ref)<0);t[o].unshift(...p)}n(o,u,l)}),this.map(s,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Mv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Mv||(Mv={}));var Bv;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Bv||(Bv={}));var ss;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ss||(ss={}));class fg{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=va.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new mp(this,di.join,this.params,this.timeout),this.rejoinTimer=new i_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=va.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=va.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=va.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=va.errored,this.rejoinTimer.scheduleTimeout())}),this._on(di.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Zu(this),this.broadcastEndpointURL=o_(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:s,private:o}}=this.params;this._onError(u=>t==null?void 0:t(ss.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(ss.CLOSED));const l={},c={broadcast:i,presence:s,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){t==null||t(ss.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,d=(h=p==null?void 0:p.length)!==null&&h!==void 0?h:0,y=[];for(let x=0;x<d;x++){const S=p[x],{filter:{event:v,schema:k,table:_,filter:j}}=S,D=u&&u[x];if(D&&D.event===v&&D.schema===k&&D.table===_&&D.filter===j)y.push(Object.assign(Object.assign({},S),{id:D.id}));else{this.unsubscribe(),t==null||t(ss.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(ss.SUBSCRIBED);return}}).receive("error",u=>{t==null||t(ss.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ss.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=va.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(di.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const a=new mp(this,di.leave,{},t);a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new mp(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=di;if(n&&[o,l,c,u].indexOf(s)>=0&&n!==this._joinRef())return;let p=this._onMessage(s,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(d=>{var y,x,S;return((y=d.filter)===null||y===void 0?void 0:y.event)==="*"||((S=(x=d.filter)===null||x===void 0?void 0:x.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===s}).map(d=>d.callback(p,n)):(i=this.bindings[s])===null||i===void 0||i.filter(d=>{var y,x,S,v,k,_;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in d){const j=d.id,D=(y=d.filter)===null||y===void 0?void 0:y.event;return j&&((x=r.ids)===null||x===void 0?void 0:x.includes(j))&&(D==="*"||(D==null?void 0:D.toLocaleLowerCase())===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const j=(k=(v=d==null?void 0:d.filter)===null||v===void 0?void 0:v.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return j==="*"||j===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===s}).map(d=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:x,table:S,commit_timestamp:v,type:k,errors:_}=y;p=Object.assign(Object.assign({},{schema:x,table:S,commit_timestamp:v,eventType:k,new:{},old:{},errors:_}),this._getPayloadRecords(y))}d.callback(p,n)})}_isClosed(){return this.state===va.closed}_isJoined(){return this.state===va.joined}_isJoining(){return this.state===va.joining}_isLeaving(){return this.state===va.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&fg.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(di.close,{},t)}_onError(t){this._on(di.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=va.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ov(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ov(t.columns,t.old_record)),r}}const T8=()=>{},C8=typeof WebSocket<"u",L8=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class F8{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=v8,this.params={},this.timeout=a_,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=T8,this.conn=null,this.sendBuffer=[],this.serializer=new _8,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...o)=>vs(()=>Promise.resolve().then(()=>Hc),void 0).then(({default:l})=>l(...o)):s=fetch,(...o)=>s(...o)},this.endPoint=`${t}/${Bm.websocket}`,this.httpEndpoint=o_(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,s)=>s(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new i_(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(C8){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new P8(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),vs(()=>import("./browser-4f61f842.js").then(t=>t.b),[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:y8}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case yc.connecting:return zo.Connecting;case yc.open:return zo.Open;case yc.closing:return zo.Closing;default:return zo.Closed}}isConnected(){return this.connectionState()===zo.Open}channel(t,r={config:{}}){const n=new fg(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(di.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(w8,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:i,ref:s}=r;s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${a} ${s&&"("+s+")"||""}`,i),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,i,s)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(di.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([L8],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class P8{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=yc.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class hg extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function an(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class I8 extends hg{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class zm extends hg{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var j8=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const l_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>vs(()=>Promise.resolve().then(()=>Hc),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},R8=()=>j8(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield vs(()=>Promise.resolve().then(()=>Hc),void 0)).Response:Response}),$m=e=>{if(Array.isArray(e))return e.map(r=>$m(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=$m(n)}),t};var ul=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const gp=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),O8=(e,t,r)=>ul(void 0,void 0,void 0,function*(){const n=yield R8();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new I8(gp(a),e.status||500))}).catch(a=>{t(new zm(gp(a),a))}):t(new zm(gp(e),e))}),D8=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function G0(e,t,r,n,a,i){return ul(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,D8(t,n,a,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>O8(l,o,n))})})}function hd(e,t,r,n){return ul(this,void 0,void 0,function*(){return G0(e,"GET",t,r,n)})}function Ws(e,t,r,n,a){return ul(this,void 0,void 0,function*(){return G0(e,"POST",t,n,a,r)})}function M8(e,t,r,n,a){return ul(this,void 0,void 0,function*(){return G0(e,"PUT",t,n,a,r)})}function B8(e,t,r,n){return ul(this,void 0,void 0,function*(){return G0(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function c_(e,t,r,n,a){return ul(this,void 0,void 0,function*(){return G0(e,"DELETE",t,n,a,r)})}var ra=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const U8={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Uv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class z8{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=l_(a)}uploadOrUpdate(t,r,n,a){return ra(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},Uv),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:i,headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{})),p=yield h.json();return h.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(an(i))return{data:null,error:i};throw i}})}upload(t,r,n){return ra(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return ra(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Uv.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),p=yield h.json();return h.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(an(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return ra(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield Ws(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new hg("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:o},error:null}}catch(n){if(an(n))return{data:null,error:n};throw n}})}update(t,r,n){return ra(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return ra(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(an(a))return{data:null,error:a};throw a}})}copy(t,r,n){return ra(this,void 0,void 0,function*(){try{return{data:{path:(yield Ws(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(an(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return ra(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield Ws(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(an(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return ra(this,void 0,void 0,function*(){try{const a=yield Ws(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(an(a))return{data:null,error:a};throw a}})}download(t,r){return ra(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield hd(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(an(o))return{data:null,error:o};throw o}})}info(t){return ra(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield hd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:$m(n),error:null}}catch(n){if(an(n))return{data:null,error:n};throw n}})}exists(t){return ra(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield B8(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(an(n)&&n instanceof zm){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return ra(this,void 0,void 0,function*(){try{return{data:yield c_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}list(t,r,n){return ra(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},U8),r),{prefix:t||""});return{data:yield Ws(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(an(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const $8="2.7.1",q8={"X-Client-Info":`storage-js/${$8}`};var zl=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class H8{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},q8),r),this.fetch=l_(n)}listBuckets(){return zl(this,void 0,void 0,function*(){try{return{data:yield hd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(an(t))return{data:null,error:t};throw t}})}getBucket(t){return zl(this,void 0,void 0,function*(){try{return{data:yield hd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return zl(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(an(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return zl(this,void 0,void 0,function*(){try{return{data:yield M8(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(an(n))return{data:null,error:n};throw n}})}emptyBucket(t){return zl(this,void 0,void 0,function*(){try{return{data:yield Ws(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}deleteBucket(t){return zl(this,void 0,void 0,function*(){try{return{data:yield c_(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(an(r))return{data:null,error:r};throw r}})}}class V8 extends H8{constructor(t,r={},n){super(t,r,n)}from(t){return new z8(this.url,this.headers,t,this.fetch)}}const W8="2.49.4";let Bu="";typeof Deno<"u"?Bu="deno":typeof document<"u"?Bu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bu="react-native":Bu="node";const G8={"X-Client-Info":`supabase-js-${Bu}/${W8}`},K8={headers:G8},X8={schema:"public"},Y8={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},J8={};var Q8=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Z8=e=>{let t;return e?t=e:typeof fetch>"u"?t=G4:t=fetch,(...r)=>t(...r)},eA=()=>typeof Headers>"u"?K4:Headers,tA=(e,t,r)=>{const n=Z8(r),a=eA();return(i,s)=>Q8(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:c}))})};var rA=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function nA(e){return e.replace(/\/$/,"")}function aA(e,t){const{db:r,auth:n,realtime:a,global:i}=e,{db:s,auth:o,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),i),accessToken:()=>rA(this,void 0,void 0,function*(){return""})};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}const u_="2.69.1",Xl=30*1e3,qm=3,xp=qm*Xl,iA="http://localhost:9999",sA="supabase.auth.token",oA={"X-Client-Info":`gotrue-js/${u_}`},Hm="X-Supabase-Api-Version",f_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,cA=6e5;class dg extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Pt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class uA extends dg{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function fA(e){return Pt(e)&&e.name==="AuthApiError"}class h_ extends dg{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class So extends dg{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class zs extends So{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function hA(e){return Pt(e)&&e.name==="AuthSessionMissingError"}class vp extends So{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ih extends So{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class sh extends So{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function dA(e){return Pt(e)&&e.name==="AuthImplicitGrantRedirectError"}class zv extends So{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vm extends So{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function yp(e){return Pt(e)&&e.name==="AuthRetryableFetchError"}class $v extends So{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class e0 extends So{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const qv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hv=` 	
\r=`.split(""),pA=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Hv.length;t+=1)e[Hv[t].charCodeAt(0)]=-2;for(let t=0;t<qv.length;t+=1)e[qv[t].charCodeAt(0)]=t;return e})();function d_(e,t,r){const n=pA[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Vv(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{xA(s,n,r)};for(let s=0;s<e.length;s+=1)d_(e.charCodeAt(s),a,i);return t.join("")}function mA(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function gA(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}mA(n,t)}}function xA(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function vA(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)d_(e.charCodeAt(a),r,n);return new Uint8Array(t)}function yA(e){const t=[];return gA(e,r=>t.push(r)),new Uint8Array(t)}function wA(e){return Math.round(Date.now()/1e3)+e}function _A(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Ii=()=>typeof window<"u"&&typeof document<"u",Oo={tested:!1,writable:!1},t0=()=>{if(!Ii())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oo.tested)return Oo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Oo.tested=!0,Oo.writable=!0}catch{Oo.tested=!0,Oo.writable=!1}return Oo.writable};function bA(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const p_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>vs(()=>Promise.resolve().then(()=>Hc),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},kA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",m_=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},oh=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},lh=async(e,t)=>{await e.removeItem(t)};class Jd{constructor(){this.promise=new Jd.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Jd.promiseConstructor=Promise;function wp(e){const t=e.split(".");if(t.length!==3)throw new e0("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!lA.test(t[n]))throw new e0("JWT not in base64url format");return{header:JSON.parse(Vv(t[0])),payload:JSON.parse(Vv(t[1])),signature:vA(t[2]),raw:{header:t[0],payload:t[1]}}}async function SA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function EA(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function AA(e){return("0"+e.toString(16)).substr(-2)}function NA(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,AA).join("")}async function TA(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function CA(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await TA(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $l(e,t,r=!1){const n=NA();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await m_(e,`${t}-code-verifier`,a);const i=await CA(n);return[i,n===i?"plain":"s256"]}const LA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function FA(e){const t=e.headers.get(Hm);if(!t||!t.match(LA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function PA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function IA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var jA=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Bo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),RA=[502,503,504];async function Wv(e){var t;if(!kA(e))throw new Vm(Bo(e),0);if(RA.includes(e.status))throw new Vm(Bo(e),e.status);let r;try{r=await e.json()}catch(i){throw new h_(Bo(i),i)}let n;const a=FA(e);if(a&&a.getTime()>=f_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new $v(Bo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new zs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new $v(Bo(r),e.status,r.weak_password.reasons);throw new uA(Bo(r),e.status||500,n)}const OA=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Dt(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[Hm]||(i[Hm]=f_["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await DA(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function DA(e,t,r,n,a,i){const s=OA(t,n,a,i);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new Vm(Bo(l),0)}if(o.ok||await Wv(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Wv(l)}}function $s(e){var t;let r=null;zA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=wA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Gv(e){const t=$s(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Xs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function MA(e){return{data:e,error:null}}function BA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=jA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function UA(e){return e}function zA(e){return e.access_token&&e.refresh_token&&e.expires_in}var $A=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class qA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=p_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Dt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Xs})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=$A(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:BA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Pt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Dt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Xs})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:UA});if(u.error)throw u.error;const h=await u.json(),p=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(y=>{const x=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(y.split(";")[1].split("=")[1]);c[`${S}Page`]=x}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Pt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Dt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Xs})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Dt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Xs})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Dt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Xs})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Dt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Dt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}}const HA={getItem:e=>t0()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{t0()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{t0()&&globalThis.localStorage.removeItem(e)}};function Kv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function VA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ql={debug:!!(globalThis&&t0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class g_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class WA extends g_{}async function GA(e,t,r){ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ql.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw ql.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new WA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ql.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}VA();const KA={url:iA,storageKey:sA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:oA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Xv(e,t,r){return await r()}class F0{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=F0.nextInstanceID,F0.nextInstanceID+=1,this.instanceID>0&&Ii()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},KA),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new qA({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=p_(a.fetch),this.lock=a.lock||Xv,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Ii()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=GA:this.lock=Xv,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:t0()?this.storage=HA:(this.memoryStorage={},this.storage=Kv(this.memoryStorage)):(this.memoryStorage={},this.storage=Kv(this.memoryStorage)),Ii()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${u_}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=bA(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ii()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),dA(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pt(r)?{error:r}:{error:new h_("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:$s}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Pt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:h,options:p}=t;let d=null,y=null;this.flowType==="pkce"&&([d,y]=await $l(this.storage,this.storageKey)),i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:d,code_challenge_method:y},xform:$s})}else if("phone"in t){const{phone:u,password:h,options:p}=t;i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:$s})}else throw new ih("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Pt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:o}=t;r=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Gv})}else if("phone"in t){const{phone:i,password:s,options:o}=t;r=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Gv})}else throw new ih("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new vp}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await oh(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:$s});if(await lh(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new vp}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(Pt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,o=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:$s}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new vp}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await $l(this.storage,this.storageKey));const{error:h}=await Dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new ih("You must provide either an email or phone number.")}catch(o){if(Pt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await Dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:$s});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Pt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await $l(this.storage,this.storageKey)),await Dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:MA})}catch(i){if(Pt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new zs;const{error:a}=await Dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Pt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await Dt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:o}=await Dt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new ih("You must provide either an email or phone number and a type")}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await oh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<xp:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Xs}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new zs}:await Dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Xs})})}catch(r){if(Pt(r))return hA(r)&&(await this._removeSession(),await lh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new zs;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await $l(this.storage,this.storageKey));const{data:c,error:u}=await Dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:Xs});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new zs;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=wp(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Pt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new zs;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Pt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Ii())throw new sh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new sh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new zv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new sh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new zv("No code detected.");const{data:k,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!s||!c)throw new sh("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let p=u+h;l&&(p=parseInt(l));const d=p-u;d*1e3<=Xl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const y=p-h;u-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,u):u-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,u);const{data:x,error:S}=await this._getUser(i);if(S)throw S;const v={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:p,refresh_token:s,token_type:c,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(n){if(Pt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await oh(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(fA(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await lh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=_A(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await $l(this.storage,this.storageKey,!0));try{return await Dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Pt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,c,u;const{data:h,error:p}=i;if(p)throw p;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Dt(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Ii()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Pt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await Dt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await EA(async a=>(a>0&&await SA(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:$s})),(a,i)=>{const s=200*Math.pow(2,a);return i&&yp(i)&&Date.now()+s-n<Xl})}catch(n){if(this._debug(r,"error",n),Pt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ii()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await oh(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<xp;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${xp}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),yp(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new zs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Jd;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new zs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),Pt(i)){const s={session:null,error:i};return yp(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await m_(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await lh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ii()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Xl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Xl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Xl}ms, refresh threshold is ${qm} ticks`),a<=qm&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof g_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ii()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await $l(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Dt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Dt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await Dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=wp(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(s=>s.kid===t);if(n||(n=this.jwks.keys.find(s=>s.kid===t),n&&this.jwks_cached_at+cA>Date.now()))return n;const{data:a,error:i}=await Dt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new e0("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(s=>s.kid===t),!n)throw new e0("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:d,error:y}=await this.getSession();if(y||!d.session)return{data:null,error:y};n=d.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=wp(n);if(PA(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:i,header:a,signature:s},error:null}}const c=IA(a.alg),u=await this.fetchJwk(a.kid,r),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,s,yA(`${o}.${l}`)))throw new e0("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}}F0.nextInstanceID=0;const XA=F0;class YA extends XA{constructor(t){super(t)}}var JA=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(h){s(h)}}function l(u){try{c(n.throw(u))}catch(h){s(h)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class QA{constructor(t,r,n){var a,i,s;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=nA(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:X8,realtime:J8,auth:Object.assign(Object.assign({},Y8),{storageKey:l}),global:K8},u=aA(n??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=tA(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new g8(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new WE(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new V8(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return JA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:i,flowType:s,lock:o,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new YA({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:s,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new F8(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ZA=(e,t,r)=>new QA(e,t,r),eN="https://jtfucttzaswmqqhmmhfb.supabase.co",tN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0ZnVjdHR6YXN3bXFxaG1taGZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU5NDQ4NzMsImV4cCI6MjA2MTUyMDg3M30.6-CAPYefAektlh3dLRVFZbPKYSnhIAzp3knohc3NDEg",Je=ZA(eN,tN);function pg(){const[e,t]=ge.useState(null),[r,n]=ge.useState(null),[a,i]=ge.useState(!0);return ge.useEffect(()=>{(async()=>{const{data:{session:l}}=await Je.auth.getSession();t((l==null?void 0:l.user)||null),i(!1)})();const{data:o}=Je.auth.onAuthStateChange((l,c)=>{t((c==null?void 0:c.user)||null)});return()=>o.subscription.unsubscribe()},[]),ge.useEffect(()=>{e?Je.from("profiles").select("*").eq("id",e.id).single().then(({data:s})=>n(s)):n(null)},[e]),{user:e,profile:r,loading:a}}function rN(){const e=Rt(),{user:t}=pg();ge.useEffect(()=>{t&&e("/dashboard")},[t,e]);const r=async n=>{n.preventDefault();const a=n.target.email.value,i=n.target.password.value,{error:s}=await Je.auth.signInWithPassword({email:a,password:i});s?alert(s.message):e("/dashboard")};return m.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:m.jsxs("form",{onSubmit:r,className:"bg-white p-8 rounded shadow-md w-80",children:[m.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Login"}),m.jsx("input",{name:"email",type:"email",placeholder:"Email",required:!0,className:"mb-4 w-full p-2 border rounded"}),m.jsx("input",{name:"password",type:"password",placeholder:"Password",required:!0,className:"mb-4 w-full p-2 border rounded"}),m.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",children:"Login"})]})})}function nN(e){if(!e.length)return;const t=["AccountNumber","CustomerListID","customer_number","barcode","name","contact_details","phone"],r=e.map(o=>[o.CustomerListID,o.CustomerListID,o.customer_number,o.barcode,o.name,o.contact_details,o.phone]),n=[t.join(","),...r.map(o=>o.map(l=>`"${(l??"").toString().replace(/"/g,'""')}"`).join(","))].join(`
`),a=new Blob([n],{type:"text/csv"}),i=URL.createObjectURL(a),s=document.createElement("a");s.href=i,s.download=`customers_export_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}function aN({profile:e}){const[t,r]=ge.useState([]),[n,a]=ge.useState({CustomerListID:"",name:"",contact_details:"",phone:""}),[i,s]=ge.useState(null),[o,l]=ge.useState(!0),[c,u]=ge.useState(null),[h,p]=ge.useState([]),[d,y]=ge.useState(""),[x,S]=ge.useState(!1),[v,k]=ge.useState(null),_=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager",j=Rt();ge.useEffect(()=>{(async()=>{l(!0);const{data:K,error:he}=await Je.from("customers").select("*").order("customer_number");he?u(he.message):r(K),l(!1)})()},[]);const D=M=>a({...n,[M.target.name]:M.target.value}),z=async M=>{if(M.preventDefault(),u(null),!n.CustomerListID||!n.CustomerListID.trim()){u("CustomerListID is required.");return}const{error:K}=await Je.from("customers").insert([n]);if(K)u(K.message);else{a({CustomerListID:"",name:"",contact_details:"",phone:""});const{data:he}=await Je.from("customers").select("*").order("customer_number");r(he)}},I=M=>{s(M.CustomerListID),a(M)},T=async M=>{if(M.preventDefault(),u(null),!n.CustomerListID||!n.CustomerListID.trim()){u("CustomerListID is required.");return}const{error:K}=await Je.from("customers").update(n).eq("CustomerListID",i);if(K)u(K.message);else{s(null),a({CustomerListID:"",name:"",contact_details:"",phone:""});const{data:he}=await Je.from("customers").select("*").order("customer_number");r(he)}},L=async M=>{u(null);const{error:K}=await Je.from("customers").delete().eq("CustomerListID",M);K?u(K.message):r(t.filter(he=>he.CustomerListID!==M))},O=M=>{p(K=>K.includes(M)?K.filter(he=>he!==M):[...K,M])},F=()=>{h.length===t.length?p([]):p(t.map(M=>M.CustomerListID))},N=async()=>{if(!window.confirm(`Delete ${h.length} selected customers? This cannot be undone.`))return;u(null);const{error:M}=await Je.from("customers").delete().in("CustomerListID",h);M?u(M.message):(r(t.filter(K=>!h.includes(K.CustomerListID))),p([]))};return o?m.jsx("div",{children:"Loading customers..."}):c?m.jsxs("div",{className:"text-red-600",children:["Error: ",c]}):m.jsxs("div",{className:"max-w-7xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100 w-full",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h2",{className:"text-3xl font-extrabold text-blue-900 tracking-tight",children:"Customers"}),m.jsx("button",{onClick:()=>nN(t),className:"bg-blue-600 text-white px-6 py-2 rounded-lg shadow-md font-semibold transition ml-4",style:{background:"var(--accent)"},children:"Export Customers"}),m.jsx("button",{onClick:()=>j("/"),className:"bg-gradient-to-r from-gray-400 to-gray-300 text-white px-6 py-2 rounded-lg shadow-md hover:from-gray-500 hover:to-gray-400 font-semibold transition",children:"Back to Dashboard"})]}),m.jsxs("div",{className:"mb-6 relative max-w-md",children:[m.jsx("input",{type:"text",value:d,onChange:M=>{y(M.target.value),S(!0)},onFocus:()=>S(!0),onBlur:()=>setTimeout(()=>S(!1),150),placeholder:"Search customers by name, ID, or phone...",className:"w-full border border-blue-200 bg-white/80 p-3 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-300 transition"}),x&&d&&m.jsxs("div",{className:"absolute z-10 w-full bg-white border border-blue-200 rounded-lg shadow max-h-60 overflow-y-auto",children:[t.filter(M=>{var K,he,le;return((K=M.name)==null?void 0:K.toLowerCase().includes(d.toLowerCase()))||((he=M.CustomerListID)==null?void 0:he.toLowerCase().includes(d.toLowerCase()))||((le=M.phone)==null?void 0:le.toLowerCase().includes(d.toLowerCase()))}).slice(0,10).map(M=>m.jsxs("div",{className:"px-4 py-2 cursor-pointer hover:bg-blue-100 text-blue-900",onMouseDown:()=>{k(M.CustomerListID),S(!1),y("");const K=document.getElementById(`customer-row-${M.CustomerListID}`);K&&K.scrollIntoView({behavior:"smooth",block:"center"})},children:[m.jsx("span",{className:"font-semibold",children:M.name})," ",m.jsxs("span",{className:"text-xs text-blue-600",children:["(",M.CustomerListID,")"]})," ",m.jsx("span",{className:"text-xs text-gray-500",children:M.phone})]},M.CustomerListID)),t.filter(M=>{var K,he,le;return((K=M.name)==null?void 0:K.toLowerCase().includes(d.toLowerCase()))||((he=M.CustomerListID)==null?void 0:he.toLowerCase().includes(d.toLowerCase()))||((le=M.phone)==null?void 0:le.toLowerCase().includes(d.toLowerCase()))}).length===0&&m.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No matches found."})]})]}),_&&m.jsxs("form",{onSubmit:i?T:z,className:"mb-8 grid grid-cols-1 md:grid-cols-4 gap-4 items-end w-full",children:[m.jsx("input",{name:"CustomerListID",value:n.CustomerListID,onChange:D,placeholder:"CustomerListID",className:"border border-blue-200 bg-white/80 p-3 rounded-lg w-full shadow-sm focus:ring-2 focus:ring-blue-300 transition",required:!0}),m.jsx("input",{name:"name",value:n.name,onChange:D,placeholder:"Name",className:"border border-blue-200 bg-white/80 p-3 rounded-lg w-full shadow-sm focus:ring-2 focus:ring-blue-300 transition"}),m.jsx("input",{name:"contact_details",value:n.contact_details,onChange:D,placeholder:"Address",className:"border border-blue-200 bg-white/80 p-3 rounded-lg w-full shadow-sm focus:ring-2 focus:ring-blue-300 transition"}),m.jsx("input",{name:"phone",value:n.phone,onChange:D,placeholder:"Phone",className:"border border-blue-200 bg-white/80 p-3 rounded-lg w-full shadow-sm focus:ring-2 focus:ring-blue-300 transition"}),m.jsxs("div",{className:"col-span-1 md:col-span-4 flex gap-3 mt-2",children:[m.jsx("button",{type:"submit",className:"bg-gradient-to-r from-blue-600 to-blue-400 text-white px-6 py-2 rounded-lg shadow-md hover:from-blue-700 hover:to-blue-500 font-semibold transition w-full md:w-auto",children:i?"Update":"Add"}),i&&m.jsx("button",{type:"button",onClick:()=>{s(null),a({CustomerListID:"",name:"",contact_details:"",phone:""})},className:"bg-gradient-to-r from-gray-400 to-gray-300 text-white px-6 py-2 rounded-lg shadow-md hover:from-gray-500 hover:to-gray-400 font-semibold transition w-full md:w-auto",children:"Cancel"})]})]}),h.length>0&&m.jsxs("button",{onClick:N,className:"mb-4 bg-gradient-to-r from-red-600 to-red-400 text-white px-6 py-2 rounded-lg shadow-md hover:from-red-700 hover:to-red-500 font-semibold transition w-full md:w-auto",children:["Delete Selected (",h.length,")"]}),m.jsx("div",{className:"overflow-x-auto rounded-2xl border border-blue-100 bg-white/70 w-full",children:m.jsxs("table",{className:"min-w-full w-full border-separate border-spacing-0 rounded-2xl text-sm",children:[m.jsx("thead",{className:"bg-gradient-to-r from-blue-200 to-blue-100 sticky top-0 z-10 shadow-sm",children:m.jsxs("tr",{children:[m.jsx("th",{className:"border-b px-4 py-3",children:m.jsx("input",{type:"checkbox",checked:h.length===t.length&&t.length>0,onChange:F})}),m.jsx("th",{className:"border-b px-4 py-3 font-semibold text-blue-900 text-xs tracking-wider uppercase bg-blue-50 rounded-tl-2xl",children:"CustomerListID"}),m.jsx("th",{className:"border-b px-4 py-3 font-semibold text-blue-900 text-xs tracking-wider uppercase",children:"Name"}),m.jsx("th",{className:"border-b px-4 py-3 font-semibold text-blue-900 text-xs tracking-wider uppercase",children:"Address"}),m.jsx("th",{className:"border-b px-4 py-3 font-semibold text-blue-900 text-xs tracking-wider uppercase",children:"Phone"}),_&&m.jsx("th",{className:"border-b px-4 py-3 font-semibold text-blue-900 text-xs tracking-wider uppercase rounded-tr-2xl",children:"Actions"})]})}),m.jsx("tbody",{children:t.map((M,K)=>m.jsxs("tr",{id:`customer-row-${M.CustomerListID}`,className:v===M.CustomerListID?"bg-yellow-200 animate-pulse":K%2===0?"bg-white/80 hover:bg-blue-50":"bg-blue-50/60 hover:bg-blue-100",onClick:()=>j(`/customers/${M.CustomerListID}`),onAnimationEnd:()=>k(null),style:{cursor:"pointer"},children:[m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsx("input",{type:"checkbox",checked:h.includes(M.CustomerListID),onChange:()=>O(M.CustomerListID)})}),m.jsx("td",{className:"px-4 py-3 font-mono text-xs text-blue-800 whitespace-nowrap rounded-l-xl",children:M.CustomerListID}),m.jsx("td",{className:"px-4 py-3 text-blue-900 whitespace-nowrap",children:M.name}),m.jsx("td",{className:"px-4 py-3 text-blue-900 whitespace-nowrap",children:M.contact_details}),m.jsx("td",{className:"px-4 py-3 text-blue-900 whitespace-nowrap",children:M.phone}),_&&m.jsxs("td",{className:"px-4 py-3 space-x-2 rounded-r-xl flex items-center",children:[m.jsxs("button",{onClick:()=>I(M),className:"inline-flex items-center gap-1 bg-gradient-to-r from-yellow-400 to-yellow-300 text-yellow-900 px-4 py-2 rounded-lg shadow hover:from-yellow-500 hover:to-yellow-400 transition font-semibold text-xs",children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 112.828 2.828L11.828 15.828a4 4 0 01-2.828 1.172H7v-2a4 4 0 011.172-2.828z"})}),"Edit/View"]}),m.jsxs("button",{onClick:()=>L(M.CustomerListID),className:"inline-flex items-center gap-1 bg-gradient-to-r from-red-600 to-red-400 text-white px-4 py-2 rounded-lg shadow hover:from-red-700 hover:to-red-500 transition font-semibold text-xs",children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Delete"]})]})]},M.CustomerListID))})]})})]})}var x_={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,n)=>{e.exports=n()})(Ea,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},a,i=!n.document&&!!n.postMessage,s=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(T){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(L){var O=D(L);O.chunkSize=parseInt(O.chunkSize),L.step||L.chunk||(O.chunkSize=null),this._handle=new x(O),(this._handle.streamer=this)._config=O}).call(this,T),this.parseChunk=function(L,O){var F=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<F){let M=this._config.newline;M||(N=this._config.quoteChar||'"',M=this._handle.guessLineEndings(L,N)),L=[...L.split(M).slice(F)].join(M)}this.isFirstChunk&&I(this._config.beforeFirstChunk)&&(N=this._config.beforeFirstChunk(L))!==void 0&&(L=N),this.isFirstChunk=!1,this._halted=!1;var F=this._partialLine+L,N=(this._partialLine="",this._handle.parse(F,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(L=N.meta.cursor,F=(this._finished||(this._partialLine=F.substring(L-this._baseIndex),this._baseIndex=L),N&&N.data&&(this._rowCount+=N.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),s)n.postMessage({results:N,workerId:c.WORKER_ID,finished:F});else if(I(this._config.chunk)&&!O){if(this._config.chunk(N,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=N=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(N.data),this._completeResults.errors=this._completeResults.errors.concat(N.errors),this._completeResults.meta=N.meta),this._completed||!F||!I(this._config.complete)||N&&N.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),F||N&&N.meta.paused||this._nextChunk(),N}this._halted=!0},this._sendError=function(L){I(this._config.error)?this._config.error(L):s&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:L,finished:!1})}}function h(T){var L;(T=T||{}).chunkSize||(T.chunkSize=c.RemoteChunkSize),u.call(this,T),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(O){this._input=O,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(L=new XMLHttpRequest,this._config.withCredentials&&(L.withCredentials=this._config.withCredentials),i||(L.onload=z(this._chunkLoaded,this),L.onerror=z(this._chunkError,this)),L.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var O,F=this._config.downloadRequestHeaders;for(O in F)L.setRequestHeader(O,F[O])}var N;this._config.chunkSize&&(N=this._start+this._config.chunkSize-1,L.setRequestHeader("Range","bytes="+this._start+"-"+N));try{L.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}i&&L.status===0&&this._chunkError()}},this._chunkLoaded=function(){L.readyState===4&&(L.status<200||400<=L.status?this._chunkError():(this._start+=this._config.chunkSize||L.responseText.length,this._finished=!this._config.chunkSize||this._start>=(O=>(O=O.getResponseHeader("Content-Range"))!==null?parseInt(O.substring(O.lastIndexOf("/")+1)):-1)(L),this.parseChunk(L.responseText)))},this._chunkError=function(O){O=L.statusText||O,this._sendError(new Error(O))}}function p(T){(T=T||{}).chunkSize||(T.chunkSize=c.LocalChunkSize),u.call(this,T);var L,O,F=typeof FileReader<"u";this.stream=function(N){this._input=N,O=N.slice||N.webkitSlice||N.mozSlice,F?((L=new FileReader).onload=z(this._chunkLoaded,this),L.onerror=z(this._chunkError,this)):L=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var N=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),N=O.call(N,this._start,M)),L.readAsText(N,this._config.encoding));F||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(N){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(N.target.result)},this._chunkError=function(){this._sendError(L.error)}}function d(T){var L;u.call(this,T=T||{}),this.stream=function(O){return L=O,this._nextChunk()},this._nextChunk=function(){var O,F;if(!this._finished)return O=this._config.chunkSize,L=O?(F=L.substring(0,O),L.substring(O)):(F=L,""),this._finished=!L,this.parseChunk(F)}}function y(T){u.call(this,T=T||{});var L=[],O=!0,F=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(N){this._input=N,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){F&&L.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),L.length?this.parseChunk(L.shift()):O=!0},this._streamData=z(function(N){try{L.push(typeof N=="string"?N:N.toString(this._config.encoding)),O&&(O=!1,this._checkIsFinished(),this.parseChunk(L.shift()))}catch(M){this._streamError(M)}},this),this._streamError=z(function(N){this._streamCleanUp(),this._sendError(N)},this),this._streamEnd=z(function(){this._streamCleanUp(),F=!0,this._streamData("")},this),this._streamCleanUp=z(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function x(T){var L,O,F,N,M=Math.pow(2,53),K=-M,he=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,le=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,fe=this,ie=0,q=0,Z=!1,oe=!1,b=[],A={data:[],errors:[],meta:{}};function C(ae){return T.skipEmptyLines==="greedy"?ae.join("").trim()==="":ae.length===1&&ae[0].length===0}function R(){if(A&&F&&(re("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),F=!1),T.skipEmptyLines&&(A.data=A.data.filter(function(we){return!C(we)})),H()){let we=function(X,Ie){I(T.transformHeader)&&(X=T.transformHeader(X,Ie)),b.push(X)};if(A)if(Array.isArray(A.data[0])){for(var ae=0;H()&&ae<A.data.length;ae++)A.data[ae].forEach(we);A.data.splice(0,1)}else A.data.forEach(we)}function ne(we,X){for(var Ie=T.header?{}:[],Se=0;Se<we.length;Se++){var _e=Se,Q=we[Se],Q=((Oe,Pe)=>(De=>(T.dynamicTypingFunction&&T.dynamicTyping[De]===void 0&&(T.dynamicTyping[De]=T.dynamicTypingFunction(De)),(T.dynamicTyping[De]||T.dynamicTyping)===!0))(Oe)?Pe==="true"||Pe==="TRUE"||Pe!=="false"&&Pe!=="FALSE"&&((De=>{if(he.test(De)&&(De=parseFloat(De),K<De&&De<M))return 1})(Pe)?parseFloat(Pe):le.test(Pe)?new Date(Pe):Pe===""?null:Pe):Pe)(_e=T.header?Se>=b.length?"__parsed_extra":b[Se]:_e,Q=T.transform?T.transform(Q,_e):Q);_e==="__parsed_extra"?(Ie[_e]=Ie[_e]||[],Ie[_e].push(Q)):Ie[_e]=Q}return T.header&&(Se>b.length?re("FieldMismatch","TooManyFields","Too many fields: expected "+b.length+" fields but parsed "+Se,q+X):Se<b.length&&re("FieldMismatch","TooFewFields","Too few fields: expected "+b.length+" fields but parsed "+Se,q+X)),Ie}var me;A&&(T.header||T.dynamicTyping||T.transform)&&(me=1,!A.data.length||Array.isArray(A.data[0])?(A.data=A.data.map(ne),me=A.data.length):A.data=ne(A.data,0),T.header&&A.meta&&(A.meta.fields=b),q+=me)}function H(){return T.header&&b.length===0}function re(ae,ne,me,we){ae={type:ae,code:ne,message:me},we!==void 0&&(ae.row=we),A.errors.push(ae)}I(T.step)&&(N=T.step,T.step=function(ae){A=ae,H()?R():(R(),A.data.length!==0&&(ie+=ae.data.length,T.preview&&ie>T.preview?O.abort():(A.data=A.data[0],N(A,fe))))}),this.parse=function(ae,ne,me){var we=T.quoteChar||'"',we=(T.newline||(T.newline=this.guessLineEndings(ae,we)),F=!1,T.delimiter?I(T.delimiter)&&(T.delimiter=T.delimiter(ae),A.meta.delimiter=T.delimiter):((we=((X,Ie,Se,_e,Q)=>{var Oe,Pe,De,qe;Q=Q||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Ke=0;Ke<Q.length;Ke++){for(var Ge,st=Q[Ke],rt=0,ft=0,lt=0,gt=(De=void 0,new v({comments:_e,delimiter:st,newline:Ie,preview:10}).parse(X)),xt=0;xt<gt.data.length;xt++)Se&&C(gt.data[xt])?lt++:(Ge=gt.data[xt].length,ft+=Ge,De===void 0?De=Ge:0<Ge&&(rt+=Math.abs(Ge-De),De=Ge));0<gt.data.length&&(ft/=gt.data.length-lt),(Pe===void 0||rt<=Pe)&&(qe===void 0||qe<ft)&&1.99<ft&&(Pe=rt,Oe=st,qe=ft)}return{successful:!!(T.delimiter=Oe),bestDelimiter:Oe}})(ae,T.newline,T.skipEmptyLines,T.comments,T.delimitersToGuess)).successful?T.delimiter=we.bestDelimiter:(F=!0,T.delimiter=c.DefaultDelimiter),A.meta.delimiter=T.delimiter),D(T));return T.preview&&T.header&&we.preview++,L=ae,O=new v(we),A=O.parse(L,ne,me),R(),Z?{meta:{paused:!0}}:A||{meta:{paused:!1}}},this.paused=function(){return Z},this.pause=function(){Z=!0,O.abort(),L=I(T.chunk)?"":L.substring(O.getCharIndex())},this.resume=function(){fe.streamer._halted?(Z=!1,fe.streamer.parseChunk(L,!0)):setTimeout(fe.resume,3)},this.aborted=function(){return oe},this.abort=function(){oe=!0,O.abort(),A.meta.aborted=!0,I(T.complete)&&T.complete(A),L=""},this.guessLineEndings=function(X,we){X=X.substring(0,1048576);var we=new RegExp(S(we)+"([^]*?)"+S(we),"gm"),me=(X=X.replace(we,"")).split("\r"),we=X.split(`
`),X=1<we.length&&we[0].length<me[0].length;if(me.length===1||X)return`
`;for(var Ie=0,Se=0;Se<me.length;Se++)me[Se][0]===`
`&&Ie++;return Ie>=me.length/2?`\r
`:"\r"}}function S(T){return T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(T){var L=(T=T||{}).delimiter,O=T.newline,F=T.comments,N=T.step,M=T.preview,K=T.fastMode,he=null,le=!1,fe=T.quoteChar==null?'"':T.quoteChar,ie=fe;if(T.escapeChar!==void 0&&(ie=T.escapeChar),(typeof L!="string"||-1<c.BAD_DELIMITERS.indexOf(L))&&(L=","),F===L)throw new Error("Comment character same as delimiter");F===!0?F="#":(typeof F!="string"||-1<c.BAD_DELIMITERS.indexOf(F))&&(F=!1),O!==`
`&&O!=="\r"&&O!==`\r
`&&(O=`
`);var q=0,Z=!1;this.parse=function(oe,b,A){if(typeof oe!="string")throw new Error("Input must be a string");var C=oe.length,R=L.length,H=O.length,re=F.length,ae=I(N),ne=[],me=[],we=[],X=q=0;if(!oe)return rt();if(K||K!==!1&&oe.indexOf(fe)===-1){for(var Ie=oe.split(O),Se=0;Se<Ie.length;Se++){if(we=Ie[Se],q+=we.length,Se!==Ie.length-1)q+=O.length;else if(A)return rt();if(!F||we.substring(0,re)!==F){if(ae){if(ne=[],qe(we.split(L)),ft(),Z)return rt()}else qe(we.split(L));if(M&&M<=Se)return ne=ne.slice(0,M),rt(!0)}}return rt()}for(var _e=oe.indexOf(L,q),Q=oe.indexOf(O,q),Oe=new RegExp(S(ie)+S(fe),"g"),Pe=oe.indexOf(fe,q);;)if(oe[q]===fe)for(Pe=q,q++;;){if((Pe=oe.indexOf(fe,Pe+1))===-1)return A||me.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ne.length,index:q}),Ge();if(Pe===C-1)return Ge(oe.substring(q,Pe).replace(Oe,fe));if(fe===ie&&oe[Pe+1]===ie)Pe++;else if(fe===ie||Pe===0||oe[Pe-1]!==ie){_e!==-1&&_e<Pe+1&&(_e=oe.indexOf(L,Pe+1));var De=Ke((Q=Q!==-1&&Q<Pe+1?oe.indexOf(O,Pe+1):Q)===-1?_e:Math.min(_e,Q));if(oe.substr(Pe+1+De,R)===L){we.push(oe.substring(q,Pe).replace(Oe,fe)),oe[q=Pe+1+De+R]!==fe&&(Pe=oe.indexOf(fe,q)),_e=oe.indexOf(L,q),Q=oe.indexOf(O,q);break}if(De=Ke(Q),oe.substring(Pe+1+De,Pe+1+De+H)===O){if(we.push(oe.substring(q,Pe).replace(Oe,fe)),st(Pe+1+De+H),_e=oe.indexOf(L,q),Pe=oe.indexOf(fe,q),ae&&(ft(),Z))return rt();if(M&&ne.length>=M)return rt(!0);break}me.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ne.length,index:q}),Pe++}}else if(F&&we.length===0&&oe.substring(q,q+re)===F){if(Q===-1)return rt();q=Q+H,Q=oe.indexOf(O,q),_e=oe.indexOf(L,q)}else if(_e!==-1&&(_e<Q||Q===-1))we.push(oe.substring(q,_e)),q=_e+R,_e=oe.indexOf(L,q);else{if(Q===-1)break;if(we.push(oe.substring(q,Q)),st(Q+H),ae&&(ft(),Z))return rt();if(M&&ne.length>=M)return rt(!0)}return Ge();function qe(lt){ne.push(lt),X=q}function Ke(lt){var gt=0;return gt=lt!==-1&&(lt=oe.substring(Pe+1,lt))&&lt.trim()===""?lt.length:gt}function Ge(lt){return A||(lt===void 0&&(lt=oe.substring(q)),we.push(lt),q=C,qe(we),ae&&ft()),rt()}function st(lt){q=lt,qe(we),we=[],Q=oe.indexOf(O,q)}function rt(lt){if(T.header&&!b&&ne.length&&!le){var gt=ne[0],xt={},ht=new Set(gt);let Ze=!1;for(let He=0;He<gt.length;He++){let It=gt[He];if(xt[It=I(T.transformHeader)?T.transformHeader(It,He):It]){let pt,br=xt[It];for(;pt=It+"_"+br,br++,ht.has(pt););ht.add(pt),gt[He]=pt,xt[It]++,Ze=!0,(he=he===null?{}:he)[pt]=It}else xt[It]=1,gt[He]=It;ht.add(It)}Ze&&console.warn("Duplicate headers found and renamed."),le=!0}return{data:ne,errors:me,meta:{delimiter:L,linebreak:O,aborted:Z,truncated:!!lt,cursor:X+(b||0),renamedHeaders:he}}}function ft(){N(rt()),ne=[],me=[]}},this.abort=function(){Z=!0},this.getCharIndex=function(){return q}}function k(T){var L=T.data,O=o[L.workerId],F=!1;if(L.error)O.userError(L.error,L.file);else if(L.results&&L.results.data){var N={abort:function(){F=!0,_(L.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:j,resume:j};if(I(O.userStep)){for(var M=0;M<L.results.data.length&&(O.userStep({data:L.results.data[M],errors:L.results.errors,meta:L.results.meta},N),!F);M++);delete L.results}else I(O.userChunk)&&(O.userChunk(L.results,N,L.file),delete L.results)}L.finished&&!F&&_(L.workerId,L.results)}function _(T,L){var O=o[T];I(O.userComplete)&&O.userComplete(L),O.terminate(),delete o[T]}function j(){throw new Error("Not implemented.")}function D(T){if(typeof T!="object"||T===null)return T;var L,O=Array.isArray(T)?[]:{};for(L in T)O[L]=D(T[L]);return O}function z(T,L){return function(){T.apply(L,arguments)}}function I(T){return typeof T=="function"}return c.parse=function(T,L){var O=(L=L||{}).dynamicTyping||!1;if(I(O)&&(L.dynamicTypingFunction=O,O={}),L.dynamicTyping=O,L.transform=!!I(L.transform)&&L.transform,!L.worker||!c.WORKERS_SUPPORTED)return O=null,c.NODE_STREAM_INPUT,typeof T=="string"?(T=(F=>F.charCodeAt(0)!==65279?F:F.slice(1))(T),O=new(L.download?h:d)(L)):T.readable===!0&&I(T.read)&&I(T.on)?O=new y(L):(n.File&&T instanceof File||T instanceof Object)&&(O=new p(L)),O.stream(T);(O=(()=>{var F;return!!c.WORKERS_SUPPORTED&&(F=(()=>{var N=n.URL||n.webkitURL||null,M=r.toString();return c.BLOB_URL||(c.BLOB_URL=N.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(F=new n.Worker(F)).onmessage=k,F.id=l++,o[F.id]=F)})()).userStep=L.step,O.userChunk=L.chunk,O.userComplete=L.complete,O.userError=L.error,L.step=I(L.step),L.chunk=I(L.chunk),L.complete=I(L.complete),L.error=I(L.error),delete L.worker,O.postMessage({input:T,config:L,workerId:O.id})},c.unparse=function(T,L){var O=!1,F=!0,N=",",M=`\r
`,K='"',he=K+K,le=!1,fe=null,ie=!1,q=((()=>{if(typeof L=="object"){if(typeof L.delimiter!="string"||c.BAD_DELIMITERS.filter(function(b){return L.delimiter.indexOf(b)!==-1}).length||(N=L.delimiter),typeof L.quotes!="boolean"&&typeof L.quotes!="function"&&!Array.isArray(L.quotes)||(O=L.quotes),typeof L.skipEmptyLines!="boolean"&&typeof L.skipEmptyLines!="string"||(le=L.skipEmptyLines),typeof L.newline=="string"&&(M=L.newline),typeof L.quoteChar=="string"&&(K=L.quoteChar),typeof L.header=="boolean"&&(F=L.header),Array.isArray(L.columns)){if(L.columns.length===0)throw new Error("Option columns is empty");fe=L.columns}L.escapeChar!==void 0&&(he=L.escapeChar+K),L.escapeFormulae instanceof RegExp?ie=L.escapeFormulae:typeof L.escapeFormulae=="boolean"&&L.escapeFormulae&&(ie=/^[=+\-@\t\r].*$/)}})(),new RegExp(S(K),"g"));if(typeof T=="string"&&(T=JSON.parse(T)),Array.isArray(T)){if(!T.length||Array.isArray(T[0]))return Z(null,T,le);if(typeof T[0]=="object")return Z(fe||Object.keys(T[0]),T,le)}else if(typeof T=="object")return typeof T.data=="string"&&(T.data=JSON.parse(T.data)),Array.isArray(T.data)&&(T.fields||(T.fields=T.meta&&T.meta.fields||fe),T.fields||(T.fields=Array.isArray(T.data[0])?T.fields:typeof T.data[0]=="object"?Object.keys(T.data[0]):[]),Array.isArray(T.data[0])||typeof T.data[0]=="object"||(T.data=[T.data])),Z(T.fields||[],T.data||[],le);throw new Error("Unable to serialize unrecognized input");function Z(b,A,C){var R="",H=(typeof b=="string"&&(b=JSON.parse(b)),typeof A=="string"&&(A=JSON.parse(A)),Array.isArray(b)&&0<b.length),re=!Array.isArray(A[0]);if(H&&F){for(var ae=0;ae<b.length;ae++)0<ae&&(R+=N),R+=oe(b[ae],ae);0<A.length&&(R+=M)}for(var ne=0;ne<A.length;ne++){var me=(H?b:A[ne]).length,we=!1,X=H?Object.keys(A[ne]).length===0:A[ne].length===0;if(C&&!H&&(we=C==="greedy"?A[ne].join("").trim()==="":A[ne].length===1&&A[ne][0].length===0),C==="greedy"&&H){for(var Ie=[],Se=0;Se<me;Se++){var _e=re?b[Se]:Se;Ie.push(A[ne][_e])}we=Ie.join("").trim()===""}if(!we){for(var Q=0;Q<me;Q++){0<Q&&!X&&(R+=N);var Oe=H&&re?b[Q]:Q;R+=oe(A[ne][Oe],Q)}ne<A.length-1&&(!C||0<me&&!X)&&(R+=M)}}return R}function oe(b,A){var C,R;return b==null?"":b.constructor===Date?JSON.stringify(b).slice(1,25):(R=!1,ie&&typeof b=="string"&&ie.test(b)&&(b="'"+b,R=!0),C=b.toString().replace(q,he),(R=R||O===!0||typeof O=="function"&&O(b,A)||Array.isArray(O)&&O[A]||((H,re)=>{for(var ae=0;ae<re.length;ae++)if(-1<H.indexOf(re[ae]))return!0;return!1})(C,c.BAD_DELIMITERS)||-1<C.indexOf(N)||C.charAt(0)===" "||C.charAt(C.length-1)===" ")?K+C+K:C)}},c.RECORD_SEP=String.fromCharCode(30),c.UNIT_SEP=String.fromCharCode(31),c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=v,c.ParserHandle=x,c.NetworkStreamer=h,c.FileStreamer=p,c.StringStreamer=d,c.ReadableStreamStreamer=y,n.jQuery&&((a=n.jQuery).fn.parse=function(T){var L=T.config||{},O=[];return this.each(function(M){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var K=0;K<this.files.length;K++)O.push({file:this.files[K],inputElem:this,instanceConfig:a.extend({},L)})}),F(),this;function F(){if(O.length===0)I(T.complete)&&T.complete();else{var M,K,he,le,fe=O[0];if(I(T.before)){var ie=T.before(fe.file,fe.inputElem);if(typeof ie=="object"){if(ie.action==="abort")return M="AbortError",K=fe.file,he=fe.inputElem,le=ie.reason,void(I(T.error)&&T.error({name:M},K,he,le));if(ie.action==="skip")return void N();typeof ie.config=="object"&&(fe.instanceConfig=a.extend(fe.instanceConfig,ie.config))}else if(ie==="skip")return void N()}var q=fe.instanceConfig.complete;fe.instanceConfig.complete=function(Z){I(q)&&q(Z,fe.file,fe.inputElem),N()},c.parse(fe.file,fe.instanceConfig)}}function N(){O.splice(0,1),F()}}),s&&(n.onmessage=function(T){T=T.data,c.WORKER_ID===void 0&&T&&(c.WORKER_ID=T.workerId),typeof T.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(T.input,T.config),finished:!0}):(n.File&&T.input instanceof File||T.input instanceof Object)&&(T=c.parse(T.input,T.config))&&n.postMessage({workerId:c.WORKER_ID,results:T,finished:!0})}),(h.prototype=Object.create(u.prototype)).constructor=h,(p.prototype=Object.create(u.prototype)).constructor=p,(d.prototype=Object.create(d.prototype)).constructor=d,(y.prototype=Object.create(u.prototype)).constructor=y,c})})(x_);var iN=x_.exports;const sN=wy(iN);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var v_=1252,oN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],mg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},gg=function(e){oN.indexOf(e)!=-1&&(v_=mg[0]=e)};function lN(){gg(1252)}var gi=function(e){gg(e)};function y_(){gi(1200),lN()}function Yv(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function cN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function w_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Uu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?cN(e.slice(2)):t==254&&r==255?w_(e.slice(2)):t==65279?e.slice(1):e},ch=function(t){return String.fromCharCode(t)},Jv=function(t){return String.fromCharCode(t)},Ys,to="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qv(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=to.charAt(i)+to.charAt(s)+to.charAt(o)+to.charAt(l);return t}function Na(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=to.indexOf(e.charAt(c++)),s=to.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=to.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=to.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),fl=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function xo(e){return Mt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Zv(e){return Mt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var mi=function(t){return Mt?fl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function hl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function xg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return xg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Js=Mt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:fl(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function uN(e){for(var t=[],r=0,n=e.length+250,a=xo(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=xo(65535),n=65530)}return t.push(a.slice(0,r)),Js(t)}var Wn=/\u0000/g,zu=/[\u0001-\u0006]/g;function wc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function xi(e,t){var r=""+e;return r.length>=t?r:Tr("0",t-r.length)+r}function vg(e,t){var r=""+e;return r.length>=t?r:Tr(" ",t-r.length)+r}function dd(e,t){var r=""+e;return r.length>=t?r:r+Tr(" ",t-r.length)}function fN(e,t){var r=""+Math.round(e);return r.length>=t?r:Tr("0",t-r.length)+r}function hN(e,t){var r=""+e;return r.length>=t?r:Tr("0",t-r.length)+r}var e5=Math.pow(2,32);function Hl(e,t){if(e>e5||e<-e5)return fN(e,t);var r=Math.round(e);return hN(r,t)}function pd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var t5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},r5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},pN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function md(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(h=Math.floor(a),o=h*s+i,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var p=Math.floor(n*o/u);return[p,n*o-p*u,u]}function Go(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=wN(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var __=new Date(1899,11,31,0,0,0),mN=__.getTime(),gN=new Date(1900,2,1,0,0,0);function b_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=gN&&(r+=24*60*60*1e3),(r-(mN+(e.getTimezoneOffset()-__.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function yg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xN(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function vN(e){var t=e<0?12:11,r=yg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function yN(e){var t=yg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function P0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=vN(e):t===10?r=e.toFixed(10).substr(0,12):r=yN(e),yg(xN(r.toUpperCase()))}function al(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):P0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Xa(14,b_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function wN(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function _N(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return _p[r.m-1][1];case 5:return _p[r.m-1][0];default:return _p[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return t5[r.q][0];default:return t5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?xi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=xi(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?xi(l,c):"";return u}function ro(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var k_=/%/g;function bN(e,t,r){var n=t.replace(k_,""),a=t.length-n.length;return hs(e,n,r*Math.pow(10,2*a))+Tr("%",a)}function kN(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function S_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var E_=/# (\?+)( ?)\/( ?)(\d+)/;function SN(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Tr(" ",e[1].length+1+e[4].length):vg(s,e[1].length)+e[2]+"/"+e[3]+xi(o,e[4].length))}function EN(e,t,r){return r+(t===0?"":""+t)+Tr(" ",e[1].length+2+e[4].length)}var A_=/^#*0*\.([0#]+)/,N_=/\).*[0#]/,T_=/\(###\) ###\\?-####/;function $n(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function n5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function a5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function AN(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function NN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function za(e,t,r){if(e.charCodeAt(0)===40&&!t.match(N_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?za("n",n,r):"("+za("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return kN(e,t,r);if(t.indexOf("%")!==-1)return bN(e,t,r);if(t.indexOf("E")!==-1)return S_(t,r);if(t.charCodeAt(0)===36)return"$"+za(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Hl(l,t.length);if(t.match(/^[#?]+$/))return a=Hl(r,0),a==="0"&&(a=""),a.length>t.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(E_))return SN(i,l,c);if(t.match(/^#+0+$/))return c+Hl(l,t.length-t.indexOf("0"));if(i=t.match(A_))return a=n5(r,i[1].length).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+Tr("0",$n(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+n5(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+ro(Hl(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+za(e,t,-r):ro(""+(Math.floor(r)+AN(r,i[1].length)))+"."+xi(a5(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return za(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=wc(za(e,t.replace(/[\\-]/g,""),r)),s=0,wc(wc(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(T_))return a=za(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=md(l,Math.pow(10,s)-1,!1),a=""+c,u=hs("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=dd(o[2],s),u.length<i[4].length&&(u=$n(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=md(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vg(o[1],s)+i[2]+"/"+i[3]+dd(o[2],s):Tr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Hl(r,0),t.length<=a.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return $n(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=a5(r,i[1].length),r<0?"-"+za(e,t,-r):ro(NN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?xi(0,3-y.length):"")+y})+"."+xi(s,i[1].length);switch(t){case"###,##0.00":return za(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=ro(Hl(l,0));return d!=="0"?c+d:"";case"###,###.00":return za(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return za(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function TN(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function CN(e,t,r){var n=t.replace(k_,""),a=t.length-n.length;return hs(e,n,r*Math.pow(10,2*a))+Tr("%",a)}function C_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ji(e,t,r){if(e.charCodeAt(0)===40&&!t.match(N_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ji("n",n,r):"("+ji("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return TN(e,t,r);if(t.indexOf("%")!==-1)return CN(e,t,r);if(t.indexOf("E")!==-1)return C_(t,r);if(t.charCodeAt(0)===36)return"$"+ji(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+xi(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(E_))return EN(i,l,c);if(t.match(/^#+0+$/))return c+xi(l,t.length-t.indexOf("0"));if(i=t.match(A_))return a=(""+r).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])),a=a.replace(/\.(\d*)$/,function(y,x){return"."+x+Tr("0",$n(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+ro(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ji(e,t,-r):ro(""+r)+"."+Tr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ji(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=wc(ji(e,t.replace(/[\\-]/g,""),r)),s=0,wc(wc(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return s<a.length?a.charAt(s++):y==="0"?"0":""}));if(t.match(T_))return a=ji(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=md(l,Math.pow(10,s)-1,!1),a=""+c,u=hs("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=dd(o[2],s),u.length<i[4].length&&(u=$n(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=md(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vg(o[1],s)+i[2]+"/"+i[3]+dd(o[2],s):Tr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:$n(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return $n(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ji(e,t,-r):ro(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?xi(0,3-y.length):"")+y})+"."+xi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=ro(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return ji(e,t.slice(0,t.lastIndexOf(".")),r)+$n(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function hs(e,t,r){return(r|0)===r?ji(e,t,r):za(e,t,r)}function LN(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var L_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":pd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(L_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function FN(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,u,h,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!pd(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);a[a.length]={t:"t",v:i},++s;break;case"\\":var d=e.charAt(++s),y=d==="("||d===")"?d:"t";a[a.length]={t:y,v:d},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=Go(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Go(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=Go(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",s+=5,p="h"):(x.t="t",++s),c==null&&x.t==="T")return"";a[a.length]=x,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(L_)){if(c==null&&(c=Go(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wc(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var S=0,v=0,k;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,l="h",S<1&&(S=1);break;case"s":(k=a[s].v.match(/\.0+$/))&&(v=Math.max(v,k[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[s].v.match(/[Hh]/)&&(S=1),S<2&&a[s].v.match(/[Mm]/)&&(S=2),S<3&&a[s].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var _="",j;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=_N(a[s].t.charCodeAt(0),a[s].v,c,v),a[s].t="t";break;case"n":case"?":for(j=s+1;a[j]!=null&&((o=a[j].t)==="?"||o==="D"||(o===" "||o==="t")&&a[j+1]!=null&&(a[j+1].t==="?"||a[j+1].t==="t"&&a[j+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[j].v==="/"||a[j].v===" "&&a[j+1]!=null&&a[j+1].t=="?"));)a[s].v+=a[j].v,a[j]={v:"",t:";"},++j;_+=a[s].v,s=j-1;break;case"G":a[s].t="t",a[s].v=al(t,r);break}var D="",z,I;if(_.length>0){_.charCodeAt(0)==40?(z=t<0&&_.charCodeAt(0)===45?-t:t,I=hs("n",_,z)):(z=t<0&&n>1?-t:t,I=hs("n",_,z),z<0&&a[0]&&a[0].t=="t"&&(I=I.substr(1),a[0].v="-"+a[0].v)),j=I.length-1;var T=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){T=s;break}var L=a.length;if(T===a.length&&I.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(j>=a[s].v.length-1?(j-=a[s].v.length,a[s].v=I.substr(j+1,a[s].v.length)):j<0?a[s].v="":(a[s].v=I.substr(0,j+1),j=-1),a[s].t="t",L=s);j>=0&&L<a.length&&(a[L].v=I.substr(0,j+1)+a[L].v)}else if(T!==a.length&&I.indexOf("E")===-1){for(j=I.indexOf(".")-1,s=T;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===T?a[s].v.indexOf(".")-1:a[s].v.length-1,D=a[s].v.substr(u+1);u>=0;--u)j>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(D=I.charAt(j--)+D);a[s].v=D,a[s].t="t",L=s}for(j>=0&&L<a.length&&(a[L].v=I.substr(0,j+1)+a[L].v),j=I.indexOf(".")+1,s=T;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==T)){for(u=a[s].v.indexOf(".")>-1&&s===T?a[s].v.indexOf(".")+1:0,D=a[s].v.substr(0,u);u<a[s].v.length;++u)j<I.length&&(D+=I.charAt(j++));a[s].v=D,a[s].t="t",L=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(z=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=hs(a[s].t,a[s].v,z),a[s].t="t");var O="";for(s=0;s!==a.length;++s)a[s]!=null&&(O+=a[s].v);return O}var i5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function s5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function PN(e,t){var r=LN(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(i5),o=r[1].match(i5);return s5(t,s)?[n,r[0]]:s5(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Xa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ft)[e],n==null&&(n=r.table&&r.table[r5[e]]||Ft[r5[e]]),n==null&&(n=pN[e]||"General");break}if(pd(n,0))return al(t,r);t instanceof Date&&(t=b_(t,r.date1904));var a=PN(n,t);if(pd(a[1]))return al(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return FN(a[1],t,r,a[0])}function Yo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ft[r]==null){t<0&&(t=r);continue}if(Ft[r]==e){t=r;break}}t<0&&(t=391)}return Ft[t]=e,t}function F_(){Ft=dN()}var IN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},P_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function jN(e){var t=typeof e=="number"?Ft[e]:e;return t=t.replace(P_,"(\\d+)"),new RegExp("^"+t+"$")}function RN(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(P_)||[]).forEach(function(h,p){var d=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":i=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?o=d:a=d;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?u:c+"T"+u}var ON=function(){var e={};e.version="1.2.0";function t(){for(var I=0,T=new Array(256),L=0;L!=256;++L)I=L,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,T[L]=I;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(I){var T=0,L=0,O=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)F[O]=I[O];for(O=0;O!=256;++O)for(L=I[O],T=256+O;T<4096;T+=256)L=F[T]=L>>>8^I[L&255];var N=[];for(O=1;O!=16;++O)N[O-1]=typeof Int32Array<"u"?F.subarray(O*256,O*256+256):F.slice(O*256,O*256+256);return N}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],u=a[5],h=a[6],p=a[7],d=a[8],y=a[9],x=a[10],S=a[11],v=a[12],k=a[13],_=a[14];function j(I,T){for(var L=T^-1,O=0,F=I.length;O<F;)L=L>>>8^r[(L^I.charCodeAt(O++))&255];return~L}function D(I,T){for(var L=T^-1,O=I.length-15,F=0;F<O;)L=_[I[F++]^L&255]^k[I[F++]^L>>8&255]^v[I[F++]^L>>16&255]^S[I[F++]^L>>>24]^x[I[F++]]^y[I[F++]]^d[I[F++]]^p[I[F++]]^h[I[F++]]^u[I[F++]]^c[I[F++]]^l[I[F++]]^o[I[F++]]^s[I[F++]]^i[I[F++]]^r[I[F++]];for(O+=15;F<O;)L=L>>>8^r[(L^I[F++])&255];return~L}function z(I,T){for(var L=T^-1,O=0,F=I.length,N=0,M=0;O<F;)N=I.charCodeAt(O++),N<128?L=L>>>8^r[(L^N)&255]:N<2048?(L=L>>>8^r[(L^(192|N>>6&31))&255],L=L>>>8^r[(L^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,M=I.charCodeAt(O++)&1023,L=L>>>8^r[(L^(240|N>>8&7))&255],L=L>>>8^r[(L^(128|N>>2&63))&255],L=L>>>8^r[(L^(128|M>>6&15|(N&3)<<4))&255],L=L>>>8^r[(L^(128|M&63))&255]):(L=L>>>8^r[(L^(224|N>>12&15))&255],L=L>>>8^r[(L^(128|N>>6&63))&255],L=L>>>8^r[(L^(128|N&63))&255]);return~L}return e.table=r,e.bstr=j,e.buf=D,e.str=z,e}(),Ut=function(){var t={};t.version="1.2.1";function r(W,ue){for(var ee=W.split("/"),te=ue.split("/"),ce=0,de=0,Ne=Math.min(ee.length,te.length);ce<Ne;++ce){if(de=ee[ce].length-te[ce].length)return de;if(ee[ce]!=te[ce])return ee[ce]<te[ce]?-1:1}return ee.length-te.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var ue=W.lastIndexOf("/");return ue===-1?W:W.slice(0,ue+1)}function a(W){if(W.charAt(W.length-1)=="/")return a(W.slice(0,-1));var ue=W.lastIndexOf("/");return ue===-1?W:W.slice(ue+1)}function i(W,ue){typeof ue=="string"&&(ue=new Date(ue));var ee=ue.getHours();ee=ee<<6|ue.getMinutes(),ee=ee<<5|ue.getSeconds()>>>1,W.write_shift(2,ee);var te=ue.getFullYear()-1980;te=te<<4|ue.getMonth()+1,te=te<<5|ue.getDate(),W.write_shift(2,te)}function s(W){var ue=W.read_shift(2)&65535,ee=W.read_shift(2)&65535,te=new Date,ce=ee&31;ee>>>=5;var de=ee&15;ee>>>=4,te.setMilliseconds(0),te.setFullYear(ee+1980),te.setMonth(de-1),te.setDate(ce);var Ne=ue&31;ue>>>=5;var je=ue&63;return ue>>>=6,te.setHours(ue),te.setMinutes(je),te.setSeconds(Ne<<1),te}function o(W){pn(W,0);for(var ue={},ee=0;W.l<=W.length-4;){var te=W.read_shift(2),ce=W.read_shift(2),de=W.l+ce,Ne={};switch(te){case 21589:ee=W.read_shift(1),ee&1&&(Ne.mtime=W.read_shift(4)),ce>5&&(ee&2&&(Ne.atime=W.read_shift(4)),ee&4&&(Ne.ctime=W.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}W.l=de,ue[te]=Ne}return ue}var l;function c(){return l||(l={})}function u(W,ue){if(W[0]==80&&W[1]==75)return fr(W,ue);if((W[0]|32)==109&&(W[1]|32)==105)return Pa(W,ue);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var ee=3,te=512,ce=0,de=0,Ne=0,je=0,Ae=0,Le=[],Fe=W.slice(0,512);pn(Fe,0);var We=h(Fe);switch(ee=We[0],ee){case 3:te=512;break;case 4:te=4096;break;case 0:if(We[1]==0)return fr(W,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}te!==512&&(Fe=W.slice(0,te),pn(Fe,28));var Qe=W.slice(0,te);p(Fe,ee);var at=Fe.read_shift(4,"i");if(ee===3&&at!==0)throw new Error("# Directory Sectors: Expected 0 saw "+at);Fe.l+=4,Ne=Fe.read_shift(4,"i"),Fe.l+=4,Fe.chk("00100000","Mini Stream Cutoff Size: "),je=Fe.read_shift(4,"i"),ce=Fe.read_shift(4,"i"),Ae=Fe.read_shift(4,"i"),de=Fe.read_shift(4,"i");for(var Ye=-1,nt=0;nt<109&&(Ye=Fe.read_shift(4,"i"),!(Ye<0));++nt)Le[nt]=Ye;var kt=d(W,te);S(Ae,de,kt,te,Le);var Xt=k(kt,Ne,Le,te);Xt[Ne].name="!Directory",ce>0&&je!==M&&(Xt[je].name="!MiniFAT"),Xt[Le[0]].name="!FAT",Xt.fat_addrs=Le,Xt.ssz=te;var er={},Br=[],Qa=[],Ki=[];_(Ne,Xt,kt,Br,ce,er,Qa,je),y(Qa,Ki,Br),Br.shift();var Ei={FileIndex:Qa,FullPaths:Ki};return ue&&ue.raw&&(Ei.raw={header:Qe,sectors:kt}),Ei}function h(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(K,"Header Signature: "),W.l+=16;var ue=W.read_shift(2,"u");return[W.read_shift(2,"u"),ue]}function p(W,ue){var ee=9;switch(W.l+=2,ee=W.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function d(W,ue){for(var ee=Math.ceil(W.length/ue)-1,te=[],ce=1;ce<ee;++ce)te[ce-1]=W.slice(ce*ue,(ce+1)*ue);return te[ee-1]=W.slice(ee*ue),te}function y(W,ue,ee){for(var te=0,ce=0,de=0,Ne=0,je=0,Ae=ee.length,Le=[],Fe=[];te<Ae;++te)Le[te]=Fe[te]=te,ue[te]=ee[te];for(;je<Fe.length;++je)te=Fe[je],ce=W[te].L,de=W[te].R,Ne=W[te].C,Le[te]===te&&(ce!==-1&&Le[ce]!==ce&&(Le[te]=Le[ce]),de!==-1&&Le[de]!==de&&(Le[te]=Le[de])),Ne!==-1&&(Le[Ne]=te),ce!==-1&&te!=Le[te]&&(Le[ce]=Le[te],Fe.lastIndexOf(ce)<je&&Fe.push(ce)),de!==-1&&te!=Le[te]&&(Le[de]=Le[te],Fe.lastIndexOf(de)<je&&Fe.push(de));for(te=1;te<Ae;++te)Le[te]===te&&(de!==-1&&Le[de]!==de?Le[te]=Le[de]:ce!==-1&&Le[ce]!==ce&&(Le[te]=Le[ce]));for(te=1;te<Ae;++te)if(W[te].type!==0){if(je=te,je!=Le[je])do je=Le[je],ue[te]=ue[je]+"/"+ue[te];while(je!==0&&Le[je]!==-1&&je!=Le[je]);Le[te]=-1}for(ue[0]+="/",te=1;te<Ae;++te)W[te].type!==2&&(ue[te]+="/")}function x(W,ue,ee){for(var te=W.start,ce=W.size,de=[],Ne=te;ee&&ce>0&&Ne>=0;)de.push(ue.slice(Ne*N,Ne*N+N)),ce-=N,Ne=$o(ee,Ne*4);return de.length===0?Yr(0):Js(de).slice(0,W.size)}function S(W,ue,ee,te,ce){var de=M;if(W===M){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var Ne=ee[W],je=(te>>>2)-1;if(!Ne)return;for(var Ae=0;Ae<je&&(de=$o(Ne,Ae*4))!==M;++Ae)ce.push(de);S($o(Ne,te-4),ue-1,ee,te,ce)}}function v(W,ue,ee,te,ce){var de=[],Ne=[];ce||(ce=[]);var je=te-1,Ae=0,Le=0;for(Ae=ue;Ae>=0;){ce[Ae]=!0,de[de.length]=Ae,Ne.push(W[Ae]);var Fe=ee[Math.floor(Ae*4/te)];if(Le=Ae*4&je,te<4+Le)throw new Error("FAT boundary crossed: "+Ae+" 4 "+te);if(!W[Fe])break;Ae=$o(W[Fe],Le)}return{nodes:de,data:g5([Ne])}}function k(W,ue,ee,te){var ce=W.length,de=[],Ne=[],je=[],Ae=[],Le=te-1,Fe=0,We=0,Qe=0,at=0;for(Fe=0;Fe<ce;++Fe)if(je=[],Qe=Fe+ue,Qe>=ce&&(Qe-=ce),!Ne[Qe]){Ae=[];var Ye=[];for(We=Qe;We>=0;){Ye[We]=!0,Ne[We]=!0,je[je.length]=We,Ae.push(W[We]);var nt=ee[Math.floor(We*4/te)];if(at=We*4&Le,te<4+at)throw new Error("FAT boundary crossed: "+We+" 4 "+te);if(!W[nt]||(We=$o(W[nt],at),Ye[We]))break}de[Qe]={nodes:je,data:g5([Ae])}}return de}function _(W,ue,ee,te,ce,de,Ne,je){for(var Ae=0,Le=te.length?2:0,Fe=ue[W].data,We=0,Qe=0,at;We<Fe.length;We+=128){var Ye=Fe.slice(We,We+128);pn(Ye,64),Qe=Ye.read_shift(2),at=Sg(Ye,0,Qe-Le),te.push(at);var nt={name:at,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},kt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);kt!==0&&(nt.ct=j(Ye,Ye.l-8));var Xt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);Xt!==0&&(nt.mt=j(Ye,Ye.l-8)),nt.start=Ye.read_shift(4,"i"),nt.size=Ye.read_shift(4,"i"),nt.size<0&&nt.start<0&&(nt.size=nt.type=0,nt.start=M,nt.name=""),nt.type===5?(Ae=nt.start,ce>0&&Ae!==M&&(ue[Ae].name="!StreamData")):nt.size>=4096?(nt.storage="fat",ue[nt.start]===void 0&&(ue[nt.start]=v(ee,nt.start,ue.fat_addrs,ue.ssz)),ue[nt.start].name=nt.name,nt.content=ue[nt.start].data.slice(0,nt.size)):(nt.storage="minifat",nt.size<0?nt.size=0:Ae!==M&&nt.start!==M&&ue[Ae]&&(nt.content=x(nt,ue[Ae].data,(ue[je]||{}).data))),nt.content&&pn(nt.content,0),de[at]=nt,Ne.push(nt)}}function j(W,ue){return new Date((wa(W,ue+4)/1e7*Math.pow(2,32)+wa(W,ue)/1e7-11644473600)*1e3)}function D(W,ue){return c(),u(l.readFileSync(W),ue)}function z(W,ue){var ee=ue&&ue.type;switch(ee||Mt&&Buffer.isBuffer(W)&&(ee="buffer"),ee||"base64"){case"file":return D(W,ue);case"base64":return u(mi(Na(W)),ue);case"binary":return u(mi(W),ue)}return u(W,ue)}function I(W,ue){var ee=ue||{},te=ee.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=te+"/",W.FileIndex[0]={name:te,type:5}),ee.CLSID&&(W.FileIndex[0].clsid=ee.CLSID),T(W)}function T(W){var ue="Sh33tJ5";if(!Ut.find(W,"/"+ue)){var ee=Yr(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,W.FileIndex.push({name:ue,type:2,content:ee,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+ue),L(W)}}function L(W,ue){I(W);for(var ee=!1,te=!1,ce=W.FullPaths.length-1;ce>=0;--ce){var de=W.FileIndex[ce];switch(de.type){case 0:te?ee=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(de.R*de.L*de.C)&&(ee=!0),de.R>-1&&de.L>-1&&de.R==de.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!ue)){var Ne=new Date(1987,1,19),je=0,Ae=Object.create?Object.create(null):{},Le=[];for(ce=0;ce<W.FullPaths.length;++ce)Ae[W.FullPaths[ce]]=!0,W.FileIndex[ce].type!==0&&Le.push([W.FullPaths[ce],W.FileIndex[ce]]);for(ce=0;ce<Le.length;++ce){var Fe=n(Le[ce][0]);te=Ae[Fe],te||(Le.push([Fe,{name:a(Fe).replace("/",""),type:1,clsid:le,ct:Ne,mt:Ne,content:null}]),Ae[Fe]=!0)}for(Le.sort(function(at,Ye){return r(at[0],Ye[0])}),W.FullPaths=[],W.FileIndex=[],ce=0;ce<Le.length;++ce)W.FullPaths[ce]=Le[ce][0],W.FileIndex[ce]=Le[ce][1];for(ce=0;ce<Le.length;++ce){var We=W.FileIndex[ce],Qe=W.FullPaths[ce];if(We.name=a(Qe).replace("/",""),We.L=We.R=We.C=-(We.color=1),We.size=We.content?We.content.length:0,We.start=0,We.clsid=We.clsid||le,ce===0)We.C=Le.length>1?1:-1,We.size=0,We.type=5;else if(Qe.slice(-1)=="/"){for(je=ce+1;je<Le.length&&n(W.FullPaths[je])!=Qe;++je);for(We.C=je>=Le.length?-1:je,je=ce+1;je<Le.length&&n(W.FullPaths[je])!=n(Qe);++je);We.R=je>=Le.length?-1:je,We.type=1}else n(W.FullPaths[ce+1]||"")==n(Qe)&&(We.R=ce+1),We.type=2}}}function O(W,ue){var ee=ue||{};if(ee.fileType=="mad")return vt(W,ee);switch(L(W),ee.fileType){case"zip":return Ja(W,ee)}var te=function(at){for(var Ye=0,nt=0,kt=0;kt<at.FileIndex.length;++kt){var Xt=at.FileIndex[kt];if(Xt.content){var er=Xt.content.length;er>0&&(er<4096?Ye+=er+63>>6:nt+=er+511>>9)}}for(var Br=at.FullPaths.length+3>>2,Qa=Ye+7>>3,Ki=Ye+127>>7,Ei=Qa+nt+Br+Ki,Za=Ei+127>>7,Ai=Za<=109?0:Math.ceil((Za-109)/127);Ei+Za+Ai+127>>7>Za;)Ai=++Za<=109?0:Math.ceil((Za-109)/127);var da=[1,Ai,Za,Ki,Br,nt,Ye,0];return at.FileIndex[0].size=Ye<<6,da[7]=(at.FileIndex[0].start=da[0]+da[1]+da[2]+da[3]+da[4]+da[5])+(da[6]+7>>3),da}(W),ce=Yr(te[7]<<9),de=0,Ne=0;{for(de=0;de<8;++de)ce.write_shift(1,he[de]);for(de=0;de<8;++de)ce.write_shift(2,0);for(ce.write_shift(2,62),ce.write_shift(2,3),ce.write_shift(2,65534),ce.write_shift(2,9),ce.write_shift(2,6),de=0;de<3;++de)ce.write_shift(2,0);for(ce.write_shift(4,0),ce.write_shift(4,te[2]),ce.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),ce.write_shift(4,0),ce.write_shift(4,4096),ce.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:M),ce.write_shift(4,te[3]),ce.write_shift(-4,te[1]?te[0]-1:M),ce.write_shift(4,te[1]),de=0;de<109;++de)ce.write_shift(-4,de<te[2]?te[1]+de:-1)}if(te[1])for(Ne=0;Ne<te[1];++Ne){for(;de<236+Ne*127;++de)ce.write_shift(-4,de<te[2]?te[1]+de:-1);ce.write_shift(-4,Ne===te[1]-1?M:Ne+1)}var je=function(at){for(Ne+=at;de<Ne-1;++de)ce.write_shift(-4,de+1);at&&(++de,ce.write_shift(-4,M))};for(Ne=de=0,Ne+=te[1];de<Ne;++de)ce.write_shift(-4,fe.DIFSECT);for(Ne+=te[2];de<Ne;++de)ce.write_shift(-4,fe.FATSECT);je(te[3]),je(te[4]);for(var Ae=0,Le=0,Fe=W.FileIndex[0];Ae<W.FileIndex.length;++Ae)Fe=W.FileIndex[Ae],Fe.content&&(Le=Fe.content.length,!(Le<4096)&&(Fe.start=Ne,je(Le+511>>9)));for(je(te[6]+7>>3);ce.l&511;)ce.write_shift(-4,fe.ENDOFCHAIN);for(Ne=de=0,Ae=0;Ae<W.FileIndex.length;++Ae)Fe=W.FileIndex[Ae],Fe.content&&(Le=Fe.content.length,!(!Le||Le>=4096)&&(Fe.start=Ne,je(Le+63>>6)));for(;ce.l&511;)ce.write_shift(-4,fe.ENDOFCHAIN);for(de=0;de<te[4]<<2;++de){var We=W.FullPaths[de];if(!We||We.length===0){for(Ae=0;Ae<17;++Ae)ce.write_shift(4,0);for(Ae=0;Ae<3;++Ae)ce.write_shift(4,-1);for(Ae=0;Ae<12;++Ae)ce.write_shift(4,0);continue}Fe=W.FileIndex[de],de===0&&(Fe.start=Fe.size?Fe.start-1:M);var Qe=de===0&&ee.root||Fe.name;if(Le=2*(Qe.length+1),ce.write_shift(64,Qe,"utf16le"),ce.write_shift(2,Le),ce.write_shift(1,Fe.type),ce.write_shift(1,Fe.color),ce.write_shift(-4,Fe.L),ce.write_shift(-4,Fe.R),ce.write_shift(-4,Fe.C),Fe.clsid)ce.write_shift(16,Fe.clsid,"hex");else for(Ae=0;Ae<4;++Ae)ce.write_shift(4,0);ce.write_shift(4,Fe.state||0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,Fe.start),ce.write_shift(4,Fe.size),ce.write_shift(4,0)}for(de=1;de<W.FileIndex.length;++de)if(Fe=W.FileIndex[de],Fe.size>=4096)if(ce.l=Fe.start+1<<9,Mt&&Buffer.isBuffer(Fe.content))Fe.content.copy(ce,ce.l,0,Fe.size),ce.l+=Fe.size+511&-512;else{for(Ae=0;Ae<Fe.size;++Ae)ce.write_shift(1,Fe.content[Ae]);for(;Ae&511;++Ae)ce.write_shift(1,0)}for(de=1;de<W.FileIndex.length;++de)if(Fe=W.FileIndex[de],Fe.size>0&&Fe.size<4096)if(Mt&&Buffer.isBuffer(Fe.content))Fe.content.copy(ce,ce.l,0,Fe.size),ce.l+=Fe.size+63&-64;else{for(Ae=0;Ae<Fe.size;++Ae)ce.write_shift(1,Fe.content[Ae]);for(;Ae&63;++Ae)ce.write_shift(1,0)}if(Mt)ce.l=ce.length;else for(;ce.l<ce.length;)ce.write_shift(1,0);return ce}function F(W,ue){var ee=W.FullPaths.map(function(Ae){return Ae.toUpperCase()}),te=ee.map(function(Ae){var Le=Ae.split("/");return Le[Le.length-(Ae.slice(-1)=="/"?2:1)]}),ce=!1;ue.charCodeAt(0)===47?(ce=!0,ue=ee[0].slice(0,-1)+ue):ce=ue.indexOf("/")!==-1;var de=ue.toUpperCase(),Ne=ce===!0?ee.indexOf(de):te.indexOf(de);if(Ne!==-1)return W.FileIndex[Ne];var je=!de.match(zu);for(de=de.replace(Wn,""),je&&(de=de.replace(zu,"!")),Ne=0;Ne<ee.length;++Ne)if((je?ee[Ne].replace(zu,"!"):ee[Ne]).replace(Wn,"")==de||(je?te[Ne].replace(zu,"!"):te[Ne]).replace(Wn,"")==de)return W.FileIndex[Ne];return null}var N=64,M=-2,K="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],le="00000000000000000000000000000000",fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(W,ue,ee){c();var te=O(W,ee);l.writeFileSync(ue,te)}function q(W){for(var ue=new Array(W.length),ee=0;ee<W.length;++ee)ue[ee]=String.fromCharCode(W[ee]);return ue.join("")}function Z(W,ue){var ee=O(W,ue);switch(ue&&ue.type||"buffer"){case"file":return c(),l.writeFileSync(ue.filename,ee),ee;case"binary":return typeof ee=="string"?ee:q(ee);case"base64":return Qv(typeof ee=="string"?ee:q(ee));case"buffer":if(Mt)return Buffer.isBuffer(ee)?ee:fl(ee);case"array":return typeof ee=="string"?mi(ee):ee}return ee}var oe;function b(W){try{var ue=W.InflateRaw,ee=new ue;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)oe=W;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function A(W,ue){if(!oe)return $t(W,ue);var ee=oe.InflateRaw,te=new ee,ce=te._processChunk(W.slice(W.l),te._finishFlushFlag);return W.l+=te.bytesRead,ce}function C(W){return oe?oe.deflateRawSync(W):Ze(W)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(W){var ue=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var ne=typeof Uint8Array<"u",me=ne?new Uint8Array(256):[],we=0;we<256;++we)me[we]=ae(we);function X(W,ue){var ee=me[W&255];return ue<=8?ee>>>8-ue:(ee=ee<<8|me[W>>8&255],ue<=16?ee>>>16-ue:(ee=ee<<8|me[W>>16&255],ee>>>24-ue))}function Ie(W,ue){var ee=ue&7,te=ue>>>3;return(W[te]|(ee<=6?0:W[te+1]<<8))>>>ee&3}function Se(W,ue){var ee=ue&7,te=ue>>>3;return(W[te]|(ee<=5?0:W[te+1]<<8))>>>ee&7}function _e(W,ue){var ee=ue&7,te=ue>>>3;return(W[te]|(ee<=4?0:W[te+1]<<8))>>>ee&15}function Q(W,ue){var ee=ue&7,te=ue>>>3;return(W[te]|(ee<=3?0:W[te+1]<<8))>>>ee&31}function Oe(W,ue){var ee=ue&7,te=ue>>>3;return(W[te]|(ee<=1?0:W[te+1]<<8))>>>ee&127}function Pe(W,ue,ee){var te=ue&7,ce=ue>>>3,de=(1<<ee)-1,Ne=W[ce]>>>te;return ee<8-te||(Ne|=W[ce+1]<<8-te,ee<16-te)||(Ne|=W[ce+2]<<16-te,ee<24-te)||(Ne|=W[ce+3]<<24-te),Ne&de}function De(W,ue,ee){var te=ue&7,ce=ue>>>3;return te<=5?W[ce]|=(ee&7)<<te:(W[ce]|=ee<<te&255,W[ce+1]=(ee&7)>>8-te),ue+3}function qe(W,ue,ee){var te=ue&7,ce=ue>>>3;return ee=(ee&1)<<te,W[ce]|=ee,ue+1}function Ke(W,ue,ee){var te=ue&7,ce=ue>>>3;return ee<<=te,W[ce]|=ee&255,ee>>>=8,W[ce+1]=ee,ue+8}function Ge(W,ue,ee){var te=ue&7,ce=ue>>>3;return ee<<=te,W[ce]|=ee&255,ee>>>=8,W[ce+1]=ee&255,W[ce+2]=ee>>>8,ue+16}function st(W,ue){var ee=W.length,te=2*ee>ue?2*ee:ue+5,ce=0;if(ee>=ue)return W;if(Mt){var de=Zv(te);if(W.copy)W.copy(de);else for(;ce<W.length;++ce)de[ce]=W[ce];return de}else if(ne){var Ne=new Uint8Array(te);if(Ne.set)Ne.set(W);else for(;ce<ee;++ce)Ne[ce]=W[ce];return Ne}return W.length=te,W}function rt(W){for(var ue=new Array(W),ee=0;ee<W;++ee)ue[ee]=0;return ue}function ft(W,ue,ee){var te=1,ce=0,de=0,Ne=0,je=0,Ae=W.length,Le=ne?new Uint16Array(32):rt(32);for(de=0;de<32;++de)Le[de]=0;for(de=Ae;de<ee;++de)W[de]=0;Ae=W.length;var Fe=ne?new Uint16Array(Ae):rt(Ae);for(de=0;de<Ae;++de)Le[ce=W[de]]++,te<ce&&(te=ce),Fe[de]=0;for(Le[0]=0,de=1;de<=te;++de)Le[de+16]=je=je+Le[de-1]<<1;for(de=0;de<Ae;++de)je=W[de],je!=0&&(Fe[de]=Le[je+16]++);var We=0;for(de=0;de<Ae;++de)if(We=W[de],We!=0)for(je=X(Fe[de],te)>>te-We,Ne=(1<<te+4-We)-1;Ne>=0;--Ne)ue[je|Ne<<We]=We&15|de<<4;return te}var lt=ne?new Uint16Array(512):rt(512),gt=ne?new Uint16Array(32):rt(32);if(!ne){for(var xt=0;xt<512;++xt)lt[xt]=0;for(xt=0;xt<32;++xt)gt[xt]=0}(function(){for(var W=[],ue=0;ue<32;ue++)W.push(5);ft(W,gt,32);var ee=[];for(ue=0;ue<=143;ue++)ee.push(8);for(;ue<=255;ue++)ee.push(9);for(;ue<=279;ue++)ee.push(7);for(;ue<=287;ue++)ee.push(8);ft(ee,lt,288)})();var ht=function(){for(var ue=ne?new Uint8Array(32768):[],ee=0,te=0;ee<re.length-1;++ee)for(;te<re[ee+1];++te)ue[te]=ee;for(;te<32768;++te)ue[te]=29;var ce=ne?new Uint8Array(259):[];for(ee=0,te=0;ee<H.length-1;++ee)for(;te<H[ee+1];++te)ce[te]=ee;function de(je,Ae){for(var Le=0;Le<je.length;){var Fe=Math.min(65535,je.length-Le),We=Le+Fe==je.length;for(Ae.write_shift(1,+We),Ae.write_shift(2,Fe),Ae.write_shift(2,~Fe&65535);Fe-- >0;)Ae[Ae.l++]=je[Le++]}return Ae.l}function Ne(je,Ae){for(var Le=0,Fe=0,We=ne?new Uint16Array(32768):[];Fe<je.length;){var Qe=Math.min(65535,je.length-Fe);if(Qe<10){for(Le=De(Ae,Le,+(Fe+Qe==je.length)),Le&7&&(Le+=8-(Le&7)),Ae.l=Le/8|0,Ae.write_shift(2,Qe),Ae.write_shift(2,~Qe&65535);Qe-- >0;)Ae[Ae.l++]=je[Fe++];Le=Ae.l*8;continue}Le=De(Ae,Le,+(Fe+Qe==je.length)+2);for(var at=0;Qe-- >0;){var Ye=je[Fe];at=(at<<5^Ye)&32767;var nt=-1,kt=0;if((nt=We[at])&&(nt|=Fe&-32768,nt>Fe&&(nt-=32768),nt<Fe))for(;je[nt+kt]==je[Fe+kt]&&kt<250;)++kt;if(kt>2){Ye=ce[kt],Ye<=22?Le=Ke(Ae,Le,me[Ye+1]>>1)-1:(Ke(Ae,Le,3),Le+=5,Ke(Ae,Le,me[Ye-23]>>5),Le+=3);var Xt=Ye<8?0:Ye-4>>2;Xt>0&&(Ge(Ae,Le,kt-H[Ye]),Le+=Xt),Ye=ue[Fe-nt],Le=Ke(Ae,Le,me[Ye]>>3),Le-=3;var er=Ye<4?0:Ye-2>>1;er>0&&(Ge(Ae,Le,Fe-nt-re[Ye]),Le+=er);for(var Br=0;Br<kt;++Br)We[at]=Fe&32767,at=(at<<5^je[Fe])&32767,++Fe;Qe-=kt-1}else Ye<=143?Ye=Ye+48:Le=qe(Ae,Le,1),Le=Ke(Ae,Le,me[Ye]),We[at]=Fe&32767,++Fe}Le=Ke(Ae,Le,0)-1}return Ae.l=(Le+7)/8|0,Ae.l}return function(Ae,Le){return Ae.length<8?de(Ae,Le):Ne(Ae,Le)}}();function Ze(W){var ue=Yr(50+Math.floor(W.length*1.1)),ee=ht(W,ue);return ue.slice(0,ee)}var He=ne?new Uint16Array(32768):rt(32768),It=ne?new Uint16Array(32768):rt(32768),pt=ne?new Uint16Array(128):rt(128),br=1,Kt=1;function ir(W,ue){var ee=Q(W,ue)+257;ue+=5;var te=Q(W,ue)+1;ue+=5;var ce=_e(W,ue)+4;ue+=4;for(var de=0,Ne=ne?new Uint8Array(19):rt(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ae=1,Le=ne?new Uint8Array(8):rt(8),Fe=ne?new Uint8Array(8):rt(8),We=Ne.length,Qe=0;Qe<ce;++Qe)Ne[R[Qe]]=de=Se(W,ue),Ae<de&&(Ae=de),Le[de]++,ue+=3;var at=0;for(Le[0]=0,Qe=1;Qe<=Ae;++Qe)Fe[Qe]=at=at+Le[Qe-1]<<1;for(Qe=0;Qe<We;++Qe)(at=Ne[Qe])!=0&&(je[Qe]=Fe[at]++);var Ye=0;for(Qe=0;Qe<We;++Qe)if(Ye=Ne[Qe],Ye!=0){at=me[je[Qe]]>>8-Ye;for(var nt=(1<<7-Ye)-1;nt>=0;--nt)pt[at|nt<<Ye]=Ye&7|Qe<<3}var kt=[];for(Ae=1;kt.length<ee+te;)switch(at=pt[Oe(W,ue)],ue+=at&7,at>>>=3){case 16:for(de=3+Ie(W,ue),ue+=2,at=kt[kt.length-1];de-- >0;)kt.push(at);break;case 17:for(de=3+Se(W,ue),ue+=3;de-- >0;)kt.push(0);break;case 18:for(de=11+Oe(W,ue),ue+=7;de-- >0;)kt.push(0);break;default:kt.push(at),Ae<at&&(Ae=at);break}var Xt=kt.slice(0,ee),er=kt.slice(ee);for(Qe=ee;Qe<286;++Qe)Xt[Qe]=0;for(Qe=te;Qe<30;++Qe)er[Qe]=0;return br=ft(Xt,He,286),Kt=ft(er,It,30),ue}function La(W,ue){if(W[0]==3&&!(W[1]&3))return[xo(ue),2];for(var ee=0,te=0,ce=Zv(ue||1<<18),de=0,Ne=ce.length>>>0,je=0,Ae=0;!(te&1);){if(te=Se(W,ee),ee+=3,te>>>1)te>>1==1?(je=9,Ae=5):(ee=ir(W,ee),je=br,Ae=Kt);else{ee&7&&(ee+=8-(ee&7));var Le=W[ee>>>3]|W[(ee>>>3)+1]<<8;if(ee+=32,Le>0)for(!ue&&Ne<de+Le&&(ce=st(ce,de+Le),Ne=ce.length);Le-- >0;)ce[de++]=W[ee>>>3],ee+=8;continue}for(;;){!ue&&Ne<de+32767&&(ce=st(ce,de+32767),Ne=ce.length);var Fe=Pe(W,ee,je),We=te>>>1==1?lt[Fe]:He[Fe];if(ee+=We&15,We>>>=4,!(We>>>8&255))ce[de++]=We;else{if(We==256)break;We-=257;var Qe=We<8?0:We-4>>2;Qe>5&&(Qe=0);var at=de+H[We];Qe>0&&(at+=Pe(W,ee,Qe),ee+=Qe),Fe=Pe(W,ee,Ae),We=te>>>1==1?gt[Fe]:It[Fe],ee+=We&15,We>>>=4;var Ye=We<4?0:We-2>>1,nt=re[We];for(Ye>0&&(nt+=Pe(W,ee,Ye),ee+=Ye),!ue&&Ne<at&&(ce=st(ce,at+100),Ne=ce.length);de<at;)ce[de]=ce[de-nt],++de}}}return ue?[ce,ee+7>>>3]:[ce.slice(0,de),ee+7>>>3]}function $t(W,ue){var ee=W.slice(W.l||0),te=La(ee,ue);return W.l+=te[1],te[0]}function Si(W,ue){if(W)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function fr(W,ue){var ee=W;pn(ee,0);var te=[],ce=[],de={FileIndex:te,FullPaths:ce};I(de,{root:ue.root});for(var Ne=ee.length-4;(ee[Ne]!=80||ee[Ne+1]!=75||ee[Ne+2]!=5||ee[Ne+3]!=6)&&Ne>=0;)--Ne;ee.l=Ne+4,ee.l+=4;var je=ee.read_shift(2);ee.l+=6;var Ae=ee.read_shift(4);for(ee.l=Ae,Ne=0;Ne<je;++Ne){ee.l+=20;var Le=ee.read_shift(4),Fe=ee.read_shift(4),We=ee.read_shift(2),Qe=ee.read_shift(2),at=ee.read_shift(2);ee.l+=8;var Ye=ee.read_shift(4),nt=o(ee.slice(ee.l+We,ee.l+We+Qe));ee.l+=We+Qe+at;var kt=ee.l;ee.l=Ye+4,fa(ee,Le,Fe,de,nt),ee.l=kt}return de}function fa(W,ue,ee,te,ce){W.l+=2;var de=W.read_shift(2),Ne=W.read_shift(2),je=s(W);if(de&8257)throw new Error("Unsupported ZIP encryption");for(var Ae=W.read_shift(4),Le=W.read_shift(4),Fe=W.read_shift(4),We=W.read_shift(2),Qe=W.read_shift(2),at="",Ye=0;Ye<We;++Ye)at+=String.fromCharCode(W[W.l++]);if(Qe){var nt=o(W.slice(W.l,W.l+Qe));(nt[21589]||{}).mt&&(je=nt[21589].mt),((ce||{})[21589]||{}).mt&&(je=ce[21589].mt)}W.l+=Qe;var kt=W.slice(W.l,W.l+Le);switch(Ne){case 8:kt=A(W,Fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var Xt=!1;de&8&&(Ae=W.read_shift(4),Ae==134695760&&(Ae=W.read_shift(4),Xt=!0),Le=W.read_shift(4),Fe=W.read_shift(4)),Le!=ue&&Si(Xt,"Bad compressed size: "+ue+" != "+Le),Fe!=ee&&Si(Xt,"Bad uncompressed size: "+ee+" != "+Fe),Yn(te,at,kt,{unsafe:!0,mt:je})}function Ja(W,ue){var ee=ue||{},te=[],ce=[],de=Yr(1),Ne=ee.compression?8:0,je=0,Ae=0,Le=0,Fe=0,We=0,Qe=W.FullPaths[0],at=Qe,Ye=W.FileIndex[0],nt=[],kt=0;for(Ae=1;Ae<W.FullPaths.length;++Ae)if(at=W.FullPaths[Ae].slice(Qe.length),Ye=W.FileIndex[Ae],!(!Ye.size||!Ye.content||at=="Sh33tJ5")){var Xt=Fe,er=Yr(at.length);for(Le=0;Le<at.length;++Le)er.write_shift(1,at.charCodeAt(Le)&127);er=er.slice(0,er.l),nt[We]=ON.buf(Ye.content,0);var Br=Ye.content;Ne==8&&(Br=C(Br)),de=Yr(30),de.write_shift(4,67324752),de.write_shift(2,20),de.write_shift(2,je),de.write_shift(2,Ne),Ye.mt?i(de,Ye.mt):de.write_shift(4,0),de.write_shift(-4,nt[We]),de.write_shift(4,Br.length),de.write_shift(4,Ye.content.length),de.write_shift(2,er.length),de.write_shift(2,0),Fe+=de.length,te.push(de),Fe+=er.length,te.push(er),Fe+=Br.length,te.push(Br),de=Yr(46),de.write_shift(4,33639248),de.write_shift(2,0),de.write_shift(2,20),de.write_shift(2,je),de.write_shift(2,Ne),de.write_shift(4,0),de.write_shift(-4,nt[We]),de.write_shift(4,Br.length),de.write_shift(4,Ye.content.length),de.write_shift(2,er.length),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(4,0),de.write_shift(4,Xt),kt+=de.l,ce.push(de),kt+=er.length,ce.push(er),++We}return de=Yr(22),de.write_shift(4,101010256),de.write_shift(2,0),de.write_shift(2,0),de.write_shift(2,We),de.write_shift(2,We),de.write_shift(4,kt),de.write_shift(4,Fe),de.write_shift(2,0),Js([Js(te),Js(ce),de])}var rr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function St(W,ue){if(W.ctype)return W.ctype;var ee=W.name||"",te=ee.match(/\.([^\.]+)$/);return te&&rr[te[1]]||ue&&(te=(ee=ue).match(/[\.\\]([^\.\\])+$/),te&&rr[te[1]])?rr[te[1]]:"application/octet-stream"}function Wt(W){for(var ue=Qv(W),ee=[],te=0;te<ue.length;te+=76)ee.push(ue.slice(te,te+76));return ee.join(`\r
`)+`\r
`}function Gi(W){var ue=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Le){var Fe=Le.charCodeAt(0).toString(16).toUpperCase();return"="+(Fe.length==1?"0"+Fe:Fe)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],te=ue.split(`\r
`),ce=0;ce<te.length;++ce){var de=te[ce];if(de.length==0){ee.push("");continue}for(var Ne=0;Ne<de.length;){var je=76,Ae=de.slice(Ne,Ne+je);Ae.charAt(je-1)=="="?je--:Ae.charAt(je-2)=="="?je-=2:Ae.charAt(je-3)=="="&&(je-=3),Ae=de.slice(Ne,Ne+je),Ne+=je,Ne<de.length&&(Ae+="="),ee.push(Ae)}}return ee.join(`\r
`)}function Gr(W){for(var ue=[],ee=0;ee<W.length;++ee){for(var te=W[ee];ee<=W.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+W[++ee];ue.push(te)}for(var ce=0;ce<ue.length;++ce)ue[ce]=ue[ce].replace(/[=][0-9A-Fa-f]{2}/g,function(de){return String.fromCharCode(parseInt(de.slice(1),16))});return mi(ue.join(`\r
`))}function Fa(W,ue,ee){for(var te="",ce="",de="",Ne,je=0;je<10;++je){var Ae=ue[je];if(!Ae||Ae.match(/^\s*$/))break;var Le=Ae.match(/^(.*?):\s*([^\s].*)$/);if(Le)switch(Le[1].toLowerCase()){case"content-location":te=Le[2].trim();break;case"content-type":de=Le[2].trim();break;case"content-transfer-encoding":ce=Le[2].trim();break}}switch(++je,ce.toLowerCase()){case"base64":Ne=mi(Na(ue.slice(je).join("")));break;case"quoted-printable":Ne=Gr(ue.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ce)}var Fe=Yn(W,te.slice(ee.length),Ne,{unsafe:!0});de&&(Fe.ctype=de)}function Pa(W,ue){if(q(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=ue&&ue.root||"",te=(Mt&&Buffer.isBuffer(W)?W.toString("binary"):q(W)).split(`\r
`),ce=0,de="";for(ce=0;ce<te.length;++ce)if(de=te[ce],!!/^Content-Location:/i.test(de)&&(de=de.slice(de.indexOf("file")),ee||(ee=de.slice(0,de.lastIndexOf("/")+1)),de.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),de.slice(0,ee.length)!=ee););var Ne=(te[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var je="--"+(Ne[1]||""),Ae=[],Le=[],Fe={FileIndex:Ae,FullPaths:Le};I(Fe);var We,Qe=0;for(ce=0;ce<te.length;++ce){var at=te[ce];at!==je&&at!==je+"--"||(Qe++&&Fa(Fe,te.slice(We,ce),ee),We=ce)}return Fe}function vt(W,ue){var ee=ue||{},te=ee.boundary||"SheetJS";te="------="+te;for(var ce=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],de=W.FullPaths[0],Ne=de,je=W.FileIndex[0],Ae=1;Ae<W.FullPaths.length;++Ae)if(Ne=W.FullPaths[Ae].slice(de.length),je=W.FileIndex[Ae],!(!je.size||!je.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(kt){return"_x"+kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(kt){return"_u"+kt.charCodeAt(0).toString(16)+"_"});for(var Le=je.content,Fe=Mt&&Buffer.isBuffer(Le)?Le.toString("binary"):q(Le),We=0,Qe=Math.min(1024,Fe.length),at=0,Ye=0;Ye<=Qe;++Ye)(at=Fe.charCodeAt(Ye))>=32&&at<128&&++We;var nt=We>=Qe*4/5;ce.push(te),ce.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+Ne),ce.push("Content-Transfer-Encoding: "+(nt?"quoted-printable":"base64")),ce.push("Content-Type: "+St(je,Ne)),ce.push(""),ce.push(nt?Gi(Fe):Wt(Fe))}return ce.push(te+`--\r
`),ce.join(`\r
`)}function ha(W){var ue={};return I(ue,W),ue}function Yn(W,ue,ee,te){var ce=te&&te.unsafe;ce||I(W);var de=!ce&&Ut.find(W,ue);if(!de){var Ne=W.FullPaths[0];ue.slice(0,Ne.length)==Ne?Ne=ue:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+ue).replace("//","/")),de={name:a(ue),type:2},W.FileIndex.push(de),W.FullPaths.push(Ne),ce||Ut.utils.cfb_gc(W)}return de.content=ee,de.size=ee?ee.length:0,te&&(te.CLSID&&(de.clsid=te.CLSID),te.mt&&(de.mt=te.mt),te.ct&&(de.ct=te.ct)),de}function yn(W,ue){I(W);var ee=Ut.find(W,ue);if(ee){for(var te=0;te<W.FileIndex.length;++te)if(W.FileIndex[te]==ee)return W.FileIndex.splice(te,1),W.FullPaths.splice(te,1),!0}return!1}function Lr(W,ue,ee){I(W);var te=Ut.find(W,ue);if(te){for(var ce=0;ce<W.FileIndex.length;++ce)if(W.FileIndex[ce]==te)return W.FileIndex[ce].name=a(ee),W.FullPaths[ce]=ee,!0}return!1}function kr(W){L(W,!0)}return t.find=F,t.read=z,t.parse=u,t.write=Z,t.writeFile=ie,t.utils={cfb_new:ha,cfb_add:Yn,cfb_del:yn,cfb_mov:Lr,cfb_gc:kr,ReadShift:r0,CheckField:t3,prep_blob:pn,bconcat:Js,use_zlib:b,_deflateRaw:Ze,_inflateRaw:$t,consts:fe},t}();function DN(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function $i(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function wg(e){for(var t=[],r=$i(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var gd=new Date(1899,11,30,0,0,0);function Gn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=gd.getTime()+(e.getTimezoneOffset()-gd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var I_=new Date,MN=gd.getTime()+(I_.getTimezoneOffset()-gd.getTimezoneOffset())*6e4,o5=I_.getTimezoneOffset();function Qd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+MN),t.getTimezoneOffset()!==o5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-o5)*6e4),t}function BN(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var l5=new Date("2017-02-19T19:06:09.000Z"),j_=isNaN(l5.getFullYear())?new Date("2/19/17"):l5,UN=j_.getFullYear()==2017;function un(e,t){var r=new Date(e);if(UN)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(j_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function il(e,t){if(Mt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return qu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return qu(w_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return qu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return qu(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function gn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=gn(e[r]));return t}function Tr(e,t){for(var r="";r.length<t;)r+=e;return r}function wi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var zN=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&zN.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var $N=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function R_(e){return e?e.content&&e.type?il(e.content,!0):e.data?Uu(e.data):e.asNodeBuffer&&Mt?Uu(e.asNodeBuffer().toString("binary")):e.asBinary?Uu(e.asBinary()):e._data&&e._data.getContent?Uu(il(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function O_(e){if(!e)return null;if(e.data)return Yv(e.data);if(e.asNodeBuffer&&Mt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Yv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function qN(e){return e&&e.name.slice(-4)===".bin"?O_(e):R_(e)}function $a(e,t){for(var r=e.FullPaths||$i(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function _g(e,t){var r=$a(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Hr(e,t,r){if(!r)return qN(_g(e,t));if(!t)return null;try{return Hr(e,t)}catch{return null}}function _a(e,t,r){if(!r)return R_(_g(e,t));if(!t)return null;try{return _a(e,t)}catch{return null}}function D_(e,t,r){if(!r)return O_(_g(e,t));if(!t)return null;try{return D_(e,t)}catch{return null}}function c5(e){for(var t=e.FullPaths||$i(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function HN(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Mt?n=fl(r):n=uN(r),Ut.utils.cfb_add(e,t,n)}Ut.utils.cfb_add(e,t,r)}else e.file(t,r)}function M_(e,t){switch(t.type){case"base64":return Ut.read(e,{type:"base64"});case"binary":return Ut.read(e,{type:"binary"});case"buffer":case"array":return Ut.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function $u(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var B_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,VN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,u5=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,WN=/<[^>]*>/g,Dn=B_.match(u5)?u5:WN,GN=/<\w*:/,KN=/<(\/?)\w+:/;function bt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(VN),o=0,l="",c=0,u="",h="",p=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(u=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(p=(a=h.charCodeAt(i+1))==34||a==39?1:0,l=h.slice(i+1+p,h.length-p),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[d]&&u.slice(o-3,o)=="ext")continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function Hi(e){return e.replace(KN,"<$1")}var U_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},XN=wg(U_),Vt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,l){return U_[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),YN=/[&<>'"]/g,JN=/[\u0000-\u001f]/g;function bg(e){var t=e+"";return t.replace(YN,function(r){return XN[r]}).replace(/\n/g,"<br/>").replace(JN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var f5=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function mr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bp(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function h5(e){var t=xo(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function d5(e){return fl(e,"binary").toString("utf8")}var uh="foo bar baz",ur=Mt&&(d5(uh)==bp(uh)&&d5||h5(uh)==bp(uh)&&h5)||bp,qu=Mt?function(e){return fl(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},I0=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),z_=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),QN=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ZN=/<\/?(?:vt:)?variant>/g,eT=/<(?:vt:)([^>]*)>([\s\S]*)</;function p5(e,t){var r=bt(e),n=e.match(QN(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(ZN,"").match(eT);s&&a.push({v:ur(s[2]),t:s[1]})}),a}var tT=/(^\s|\s$|\n)/;function rT(e){return $i(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function nT(e,t,r){return"<"+e+(r!=null?rT(r):"")+(t!=null?(t.match(tT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function kg(e){if(Mt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ur(hl(xg(e)));throw new Error("Bad input format: expected Buffer or string")}var j0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,aT={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},iT=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function sT(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function oT(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var m5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},g5=Mt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:fl(t)})):m5(e)}:m5,x5=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(us(e,a)));return n.join("").replace(Wn,"")},Sg=Mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Wn,""):x5(e,t,r)}:x5,v5=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},$_=Mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):v5(e,t,r)}:v5,y5=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Yl(e,a)));return n.join("")},K0=Mt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):y5(t,r,n)}:y5,q_=function(e,t){var r=wa(e,t);return r>0?K0(e,t+4,t+4+r-1):""},H_=q_,V_=function(e,t){var r=wa(e,t);return r>0?K0(e,t+4,t+4+r-1):""},W_=V_,G_=function(e,t){var r=2*wa(e,t);return r>0?K0(e,t+4,t+4+r-1):""},K_=G_,X_=function(t,r){var n=wa(t,r);return n>0?Sg(t,r+4,r+4+n):""},Y_=X_,J_=function(e,t){var r=wa(e,t);return r>0?K0(e,t+4,t+4+r):""},Q_=J_,Z_=function(e,t){return sT(e,t)},xd=Z_,e3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Mt&&(H_=function(t,r){if(!Buffer.isBuffer(t))return q_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},W_=function(t,r){if(!Buffer.isBuffer(t))return V_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},K_=function(t,r){if(!Buffer.isBuffer(t))return G_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Y_=function(t,r){if(!Buffer.isBuffer(t))return X_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Q_=function(t,r){if(!Buffer.isBuffer(t))return J_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},xd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Z_(t,r)},e3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Yl=function(e,t){return e[t]},us=function(e,t){return e[t+1]*256+e[t]},lT=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},wa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},$o=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},cT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function r0(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,Mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(us(this,c)),c+=2;e*=2;break;case"utf8":r=K0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Sg(this,this.l,this.l+e);break;case"wstr":return r0.call(this,e,"dbcs");case"lpstr-ansi":r=H_(this,this.l),e=4+wa(this,this.l);break;case"lpstr-cp":r=W_(this,this.l),e=4+wa(this,this.l);break;case"lpwstr":r=K_(this,this.l),e=4+2*wa(this,this.l);break;case"lpp4":e=4+wa(this,this.l),r=Y_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+wa(this,this.l),r=Q_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Yl(this,this.l+e++))!==0;)i.push(ch(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=us(this,this.l+e))!==0;)i.push(ch(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Yl(this,c),this.l=c+1,o=r0.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ch(us(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Yl(this,c),this.l=c+1,o=r0.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ch(Yl(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=Yl(this,this.l),this.l++,n;case 2:return n=(t==="i"?lT:us)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?$o:cT)(this,this.l),this.l+=4,n):(a=wa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=xd(this,this.l):a=xd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=$_(this,this.l,e);break}}return this.l+=e,r}var uT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},fT=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},hT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function dT(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)hT(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,uT(this,t,this.l);break;case 8:if(n=8,r==="f"){oT(this,t,this.l);break}case 16:break;case-4:n=4,fT(this,t,this.l);break}return this.l+=n,this}function t3(e,t){var r=$_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function pn(e,t){e.l=t,e.read_shift=r0,e.chk=t3,e.write_shift=dT}function On(e,t){e.l+=t}function Yr(e){var t=xo(e);return pn(t,0),t}function bs(e,t,r){if(e){var n,a,i;pn(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=kd[o]||kd[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function Wm(){var e=[],t=Mt?256:2048,r=function(c){var u=Yr(c);return pn(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),Js(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function n0(e,t,r){var n=gn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function w5(e,t,r){var n=gn(e);return n.s=n0(n.s,t.s,r),n.e=n0(n.e,t.s,r),n}function a0(e,t){if(e.cRel&&e.c<0)for(e=gn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=gn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Tt(e);return!e.cRel&&e.cRel!=null&&(r=gT(r)),!e.rRel&&e.rRel!=null&&(r=pT(r)),r}function kp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Zr(e.s.c)+":"+(e.e.cRel?"":"$")+Zr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xn(e.s.r)+":"+(e.e.rRel?"":"$")+xn(e.e.r):a0(e.s,t.biff)+":"+a0(e.e,t.biff)}function Eg(e){return parseInt(mT(e),10)-1}function xn(e){return""+(e+1)}function pT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function mT(e){return e.replace(/\$(\d+)$/,"$1")}function Ag(e){for(var t=xT(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Zr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function gT(e){return e.replace(/^([A-Z])/,"$$$1")}function xT(e){return e.replace(/^\$([A-Z])/,"$1")}function vT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hn(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Tt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Gc(e){var t=e.indexOf(":");return t==-1?{s:Hn(e),e:Hn(e)}:{s:Hn(e.slice(0,t)),e:Hn(e.slice(t+1))}}function zt(e,t){return typeof t>"u"||typeof t=="number"?zt(e.s,e.e):(typeof e!="string"&&(e=Tt(e)),typeof t!="string"&&(t=Tt(t)),e==t?e:e+":"+t)}function Cr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function _5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Xa(e.z,r?Gn(t):t)}catch{}try{return e.w=Xa((e.XF||{}).numFmtId||(r?14:0),r?Gn(t):t)}catch{return""+t}}function ys(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ml[e.v]||e.v:t==null?_5(e,e.v):_5(e,t))}function Eo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function r3(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Hn(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Cr(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var d={v:t[h][p]},y=s+h,x=o+p;if(c.s.r>y&&(c.s.r=y),c.s.c>x&&(c.s.c=x),c.e.r<y&&(c.e.r=y),c.e.c<x&&(c.e.c=x),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))d=t[h][p];else if(Array.isArray(d.v)&&(d.f=t[h][p][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ft[14],n.cellDates?(d.t="d",d.w=Xa(d.z,Gn(d.v))):(d.t="n",d.v=Gn(d.v),d.w=Xa(d.z,d.v))):d.t="s";if(a)i[y]||(i[y]=[]),i[y][x]&&i[y][x].z&&(d.z=i[y][x].z),i[y][x]=d;else{var S=Tt({c:x,r:y});i[S]&&i[S].z&&(d.z=i[S].z),i[S]=d}}}return c.s.c<1e7&&(i["!ref"]=zt(c)),i}function Kc(e,t){return r3(null,e,t)}function yT(e){return e.read_shift(4,"i")}function jn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ng(e,t){var r=e.l,n=e.read_shift(1),a=jn(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(wT(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var _T=Ng;function Ya(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function dl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var bT=jn;function Tg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var kT=jn,Gm=Tg;function Cg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?xd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):$o(t,0)>>2;return r?a/100:a}function n3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var pl=n3;function Fn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ST(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Jo[a];c&&(t.rgb=O0(c));break;case 2:t.rgb=O0([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function ET(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function a3(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function AT(e){return a3(e,1)}function NT(e){return a3(e,2)}var Lg=2,na=3,fh=11,b5=12,vd=19,hh=64,TT=65,CT=71,LT=4108,FT=4126,sn=80,i3=81,PT=[sn,i3],IT={1:{n:"CodePage",t:Lg},2:{n:"Category",t:sn},3:{n:"PresentationFormat",t:sn},4:{n:"ByteCount",t:na},5:{n:"LineCount",t:na},6:{n:"ParagraphCount",t:na},7:{n:"SlideCount",t:na},8:{n:"NoteCount",t:na},9:{n:"HiddenCount",t:na},10:{n:"MultimediaClipCount",t:na},11:{n:"ScaleCrop",t:fh},12:{n:"HeadingPairs",t:LT},13:{n:"TitlesOfParts",t:FT},14:{n:"Manager",t:sn},15:{n:"Company",t:sn},16:{n:"LinksUpToDate",t:fh},17:{n:"CharacterCount",t:na},19:{n:"SharedDoc",t:fh},22:{n:"HyperlinksChanged",t:fh},23:{n:"AppVersion",t:na,p:"version"},24:{n:"DigSig",t:TT},26:{n:"ContentType",t:sn},27:{n:"ContentStatus",t:sn},28:{n:"Language",t:sn},29:{n:"Version",t:sn},255:{},2147483648:{n:"Locale",t:vd},2147483651:{n:"Behavior",t:vd},1919054434:{}},jT={1:{n:"CodePage",t:Lg},2:{n:"Title",t:sn},3:{n:"Subject",t:sn},4:{n:"Author",t:sn},5:{n:"Keywords",t:sn},6:{n:"Comments",t:sn},7:{n:"Template",t:sn},8:{n:"LastAuthor",t:sn},9:{n:"RevNumber",t:sn},10:{n:"EditTime",t:hh},11:{n:"LastPrinted",t:hh},12:{n:"CreatedDate",t:hh},13:{n:"ModifiedDate",t:hh},14:{n:"PageCount",t:na},15:{n:"WordCount",t:na},16:{n:"CharCount",t:na},17:{n:"Thumbnail",t:CT},18:{n:"Application",t:sn},19:{n:"DocSecurity",t:na},255:{},2147483648:{n:"Locale",t:vd},2147483651:{n:"Behavior",t:vd},1919054434:{}},k5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},RT=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function OT(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var DT=OT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Jo=gn(DT),ml={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},s3={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},S5={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function MT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function BT(e){var t=MT();if(!e||!e.match)return t;var r={};if((e.match(Dn)||[]).forEach(function(n){var a=bt(n);switch(a[0].replace(GN,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[S5[a.ContentType]]!==void 0&&t[S5[a.ContentType]].push(a.PartName);break}}),t.xmlns!==aT.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var fc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Km(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function i0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Dn)||[]).forEach(function(a){var i=bt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:$u(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}var UT="application/vnd.oasis.opendocument.spreadsheet";function zT(e,t){for(var r=kg(e),n,a;n=j0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=bt(n[0],!1),a.path=="/"&&a.type!==UT)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var s0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],$T=function(){for(var e=new Array(s0.length),t=0;t<s0.length;++t){var r=s0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function o3(e){var t={};e=ur(e);for(var r=0;r<s0.length;++r){var n=s0[r],a=e.match($T[r]);a!=null&&a.length>0&&(t[n[1]]=Vt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=un(t[n[1]]))}return t}var qT=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function l3(e,t,r,n){var a=[];if(typeof e=="string")a=p5(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var s=typeof t=="string"?p5(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function HT(e,t,r){var n={};return t||(t={}),e=ur(e),qT.forEach(function(a){var i=(e.match(I0(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Vt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&l3(n.HeadingPairs,n.TitlesOfParts,t,r),t}var VT=/<[^>]+>[^<]*/g;function WT(e,t){var r={},n="",a=e.match(VT);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=bt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Vt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Vt(u);break;case"bool":r[n]=mr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=un(u);break;case"cy":case"error":r[n]=Vt(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var GT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sp;function KT(e,t,r){Sp||(Sp=wg(GT)),t=Sp[t]||t,e[t]=r}function Fg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function c3(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function u3(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function f3(e,t,r){return t===31?u3(e):c3(e,t,r)}function Xm(e,t,r){return f3(e,t,r===!1?0:4)}function XT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return f3(e,t,0)}function YT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Wn,""),e.l-a&2&&(e.l+=2)}return r}function JT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Wn,"");return r}function QT(e){var t=e.l,r=yd(e,i3);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=yd(e,na);return[r,n]}function ZT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(QT(e));return r}function E5(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Wn,"").replace(zu,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function h3(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function eC(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function yd(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==b5&&n!==t&&PT.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===b5?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return c3(e,n,4).replace(Wn,"");case 31:return u3(e);case 64:return Fg(e);case 65:return h3(e);case 71:return eC(e);case 80:return Xm(e,n,!i.raw).replace(Wn,"");case 81:return XT(e,n).replace(Wn,"");case 4108:return ZT(e);case 4126:case 4127:return n==4127?YT(e):JT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function A5(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),h=e.read_shift(4);i[s]=[u,h+r]}i.sort(function(k,_){return k[1]-_[1]});var p={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var d=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,d=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],d=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],d=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(d=!1,e.l=i[s][1]),d)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var y=t[i[s][0]];if(p[y.n]=yd(e,y.t,{raw:!0}),y.p==="version"&&(p[y.n]=String(p[y.n]>>16)+"."+("0000"+String(p[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(p[y.n]){case 0:p[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:gi(o=p[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[y.n])}}else if(i[s][0]===1){if(o=p.CodePage=yd(e,Lg),gi(o),l!==-1){var x=e.l;e.l=i[l][1],c=E5(e,o),e.l=x}}else if(i[s][0]===0){if(o===0){l=s,e.l=i[s+1][1];continue}c=E5(e,o)}else{var S=c[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=h3(e);break;case 30:e.l+=4,v=Xm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Xm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=jr(e,4);break;case 64:e.l+=4,v=un(Fg(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[S]=v}}return e.l=r+n,p}function N5(e,t,r){var n=e.content;if(!n)return{};pn(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Ut.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var h=A5(n,t),p={SystemIdentifier:c};for(var d in h)p[d]=h[d];if(p.FMTID=i,a===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var y;try{y=A5(n,null)}catch{}for(d in y)p[d]=y[d];return p.FMTID=[i,s],p}function Ms(e,t){return e.read_shift(t),null}function tC(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function jr(e,t){return e.read_shift(t)===1}function Vr(e){return e.read_shift(2,"u")}function d3(e,t){return tC(e,t,Vr)}function rC(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function X0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function nC(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,l={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*s),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function sl(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Y0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):sl(e,n,r)}function gl(e,t,r){if(r.biff>5)return Y0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function aC(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function iC(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Wn,"");return n&&(e.l+=24),a}function sC(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Wn,"");return r+s}function oC(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return iC(e);case"0303000000000000c000000000000046":return sC(e);default:throw new Error("Unsupported Moniker "+r)}}function dh(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Wn,""):"";return r}function lC(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c="",u,h;a&16&&(i=dh(e,r-e.l)),a&128&&(s=dh(e,r-e.l)),(a&257)===257&&(o=dh(e,r-e.l)),(a&257)===1&&(l=oC(e,r-e.l)),a&8&&(c=dh(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(h=Fg(e)),e.l=r;var p=s||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var d={Target:p};return u&&(d.guid=u),h&&(d.time=h),i&&(d.Tooltip=i),d}function p3(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function m3(e,t){var r=p3(e);return r[3]=0,r}function Vi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function cC(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function uC(e,t,r){return t===0?"":gl(e,t,r)}function fC(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function g3(e){var t=e.read_shift(2),r=Cg(e);return[t,r]}function hC(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=X0(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Zd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function x3(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var dC=x3;function v3(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function pC(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function mC(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Sn(e){e.l+=2,e.l+=e.read_shift(2)}var gC={0:Sn,4:Sn,5:Sn,6:Sn,7:mC,8:Sn,9:Sn,10:Sn,11:Sn,12:Sn,13:pC,14:Sn,15:Sn,16:Sn,17:Sn,18:Sn,19:Sn,20:Sn,21:v3};function xC(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(gC[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ph(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function vC(e,t){return t===0||e.read_shift(2),1200}function yC(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=gl(e,0,r);return e.read_shift(t+n-e.l),a}function wC(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function _C(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=X0(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function bC(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(nC(e));return i.Count=n,i.Unique=a,i}function kC(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function SC(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function EC(e){var t=cC(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function AC(e){return e.read_shift(2),e.read_shift(4)}function T5(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function NC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function TC(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function CC(){}function LC(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=X0(e,0,r),n}function FC(e){var t=Vi(e);return t.isst=e.read_shift(4),t}function PC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Vi(e);r.biff==2&&e.l++;var i=Y0(e,n-e.l,r);return a.val=i,a}function IC(e,t,r){var n=e.read_shift(2),a=gl(e,0,r);return[n,a]}var jC=gl;function C5(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function RC(e){var t=e.read_shift(2),r=e.read_shift(2),n=g3(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function OC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(g3(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function DC(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function MC(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=RT[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function BC(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=MC(e,t,n.fStyle,r),n}function UC(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function L5(e,t,r){var n=Vi(e);(r.biff==2||t==9)&&++e.l;var a=rC(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function zC(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Vi(e),a=Fn(e);return n.val=a,n}var F5=uC;function $C(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=sl(e,i),o=[];n>e.l;)o.push(Y0(e));return[i,a,s,o]}function P5(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=hC(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var qC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function I5(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=sl(e,s,r);a&32&&(c=qC[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||o===0||!(u>0)?[]:SP(e,u,r,o);return{chKey:i,Name:c,itab:l,rgce:h}}function y3(e,t,r){if(r.biff<8)return HC(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(fC(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function HC(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=X0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function VC(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=sl(e,n,r),s=sl(e,a,r);return[i,s]}function WC(e,t,r){var n=x3(e);e.l++;var a=e.read_shift(1);return t-=8,[EP(e,t,r),a,n]}function j5(e,t,r){var n=dC(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,bP(e,t,r)]}function GC(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function KC(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=gl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function XC(e,t,r){return KC(e,t,r)}function YC(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Zd(e));return r}function JC(e,t,r){if(r&&r.biff<8)return ZC(e,t,r);var n=v3(e),a=xC(e,t-22,n[1]);return{cmo:n,ft:a}}var QC={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function ZC(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((QC[n]||On)(e,t,r)),{cmo:[a,n,i],ft:s}}function eL(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=aC(e,6,r);var o=e.read_shift(2);e.read_shift(2),Vr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],h=sl(e,e.lens[c+1]-e.lens[c]-1);if(a+=h,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function tL(e,t){var r=Zd(e);e.l+=16;var n=lC(e,t-24);return[r,n]}function rL(e,t){e.read_shift(2);var r=Zd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Wn,""),[r,n]}function nL(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=k5[r]||r,r=e.read_shift(2),t[1]=k5[r]||r,t}function aL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(m3(e));return r}function iL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(m3(e));return r}function sL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function w3(e,t,r){if(!r.cellStyles)return On(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function oL(e,t){var r={};return t<32||(e.l+=16,r.header=Fn(e),r.footer=Fn(e),e.l+=2),r}function lL(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var cL=Vi,uL=d3,fL=Y0;function hL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function dL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Vi(e);++e.l;var a=gl(e,t-7,r);return n.t="str",n.val=a,n}function pL(e){var t=Vi(e);++e.l;var r=Fn(e);return t.t="n",t.val=r,t}function mL(e){var t=Vi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function gL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function xL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function vL(e,t,r){var n=e.l+t,a=Vi(e),i=e.read_shift(2),s=sl(e,i,r);return e.l=n,a.t="str",a.val=s,a}var yL=[2,3,48,49,131,139,140,245],R5=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=wg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=xo(1);switch(l.type){case"base64":u=mi(Na(o));break;case"binary":u=mi(o);break;case"buffer":case"array":u=o;break}pn(u,0);var h=u.read_shift(1),p=!!(h&136),d=!1,y=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,p=!0;break;case 49:d=!0,p=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,S=521;h==2&&(x=u.read_shift(2)),u.l+=3,h!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(S=u.read_shift(2));var v=u.read_shift(2),k=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(k=e[u[u.l]]),u.l+=1,u.l+=2),y&&(u.l+=36);for(var _=[],j={},D=Math.min(u.length,h==2?521:S-10-(d?264:0)),z=y?32:11;u.l<D&&u[u.l]!=13;)switch(j={},j.name=Ys.utils.decode(k,u.slice(u.l,u.l+z)).replace(/[\u0000\r\n].*$/g,""),u.l+=z,j.type=String.fromCharCode(u.read_shift(1)),h!=2&&!y&&(j.offset=u.read_shift(4)),j.len=u.read_shift(1),h==2&&(j.offset=u.read_shift(2)),j.dec=u.read_shift(1),j.name.length&&_.push(j),h!=2&&(u.l+=y?13:14),j.type){case"B":(!d||j.len!=8)&&l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(u[u.l]!==13&&(u.l=S-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=S;var I=0,T=0;for(c[0]=[],T=0;T!=_.length;++T)c[0][T]=_[T].name;for(;x-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,c[++I]=[],T=0,T=0;T!=_.length;++T){var L=u.slice(u.l,u.l+_[T].len);u.l+=_[T].len,pn(L,0);var O=Ys.utils.decode(k,L);switch(_[T].type){case"C":O.trim().length&&(c[I][T]=O.replace(/\s+$/,""));break;case"D":O.length===8?c[I][T]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):c[I][T]=O;break;case"F":c[I][T]=parseFloat(O.trim());break;case"+":case"I":c[I][T]=y?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":c[I][T]=!0;break;case"N":case"F":c[I][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[I][T]="##MEMO##"+(y?parseInt(O.trim(),10):L.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(c[I][T]=+O||0);break;case"@":c[I][T]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":c[I][T]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":c[I][T]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[I][T]=-L.read_shift(-8,"f");break;case"B":if(d&&_[T].len==8){c[I][T]=L.read_shift(8,"f");break}case"G":case"P":L.l+=_[T].len;break;case"0":if(_[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[T].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=_,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Kc(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function a(o,l){try{return Eo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&gi(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Wm(),h=t2(o,{header:1,raw:!0,cellDates:!0}),p=h[0],d=h.slice(1),y=o["!cols"]||[],x=0,S=0,v=0,k=1;for(x=0;x<p.length;++x){if(((y[x]||{}).DBF||{}).name){p[x]=y[x].DBF.name,++v;continue}if(p[x]!=null){if(++v,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(S=0;S<1024;++S)if(p.indexOf(p[x]+"_"+S)==-1){p[x]+="_"+S;break}}}}var _=Cr(o["!ref"]),j=[],D=[],z=[];for(x=0;x<=_.e.c-_.s.c;++x){var I="",T="",L=0,O=[];for(S=0;S<d.length;++S)d[S][x]!=null&&O.push(d[S][x]);if(O.length==0||p[x]==null){j[x]="?";continue}for(S=0;S<O.length;++S){switch(typeof O[S]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=O[S]instanceof Date?"D":"C";break;default:T="C"}L=Math.max(L,String(O[S]).length),I=I&&I!=T?"C":T}L>250&&(L=250),T=((y[x]||{}).DBF||{}).type,T=="C"&&y[x].DBF.len>L&&(L=y[x].DBF.len),I=="B"&&T=="N"&&(I="N",z[x]=y[x].DBF.dec,L=y[x].DBF.len),D[x]=I=="C"||T=="N"?L:i[I]||0,k+=D[x],j[x]=I}var F=u.next(32);for(F.write_shift(4,318902576),F.write_shift(4,d.length),F.write_shift(2,296+32*v),F.write_shift(2,k),x=0;x<4;++x)F.write_shift(4,0);for(F.write_shift(4,0|(+t[v_]||3)<<8),x=0,S=0;x<p.length;++x)if(p[x]!=null){var N=u.next(32),M=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,M,"sbcs"),N.write_shift(1,j[x]=="?"?"C":j[x],"sbcs"),N.write_shift(4,S),N.write_shift(1,D[x]||i[j[x]]||0),N.write_shift(1,z[x]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),S+=D[x]||i[j[x]]||0}var K=u.next(264);for(K.write_shift(4,13),x=0;x<65;++x)K.write_shift(4,0);for(x=0;x<d.length;++x){var he=u.next(k);for(he.write_shift(1,0),S=0;S<p.length;++S)if(p[S]!=null)switch(j[S]){case"L":he.write_shift(1,d[x][S]==null?63:d[x][S]?84:70);break;case"B":he.write_shift(8,d[x][S]||0,"f");break;case"N":var le="0";for(typeof d[x][S]=="number"&&(le=d[x][S].toFixed(z[S]||0)),v=0;v<D[S]-le.length;++v)he.write_shift(1,32);he.write_shift(1,le,"sbcs");break;case"D":d[x][S]?(he.write_shift(4,("0000"+d[x][S].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(d[x][S].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+d[x][S].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var fe=String(d[x][S]!=null?d[x][S]:"").slice(0,D[S]);for(he.write_shift(1,fe,"sbcs"),v=0;v<D[S]-fe.length;++v)he.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),wL=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+$i(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,d){var y=e[d];return typeof y=="number"?Jv(y):y},n=function(p,d,y){var x=d.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return x==59?p:Jv(x)};e["|"]=254;function a(p,d){switch(d.type){case"base64":return i(Na(p),d);case"binary":return i(p,d);case"buffer":return i(Mt&&Buffer.isBuffer(p)?p.toString("binary"):hl(p),d);case"array":return i(il(p),d)}throw new Error("Unrecognized type "+d.type)}function i(p,d){var y=p.split(/[\n\r]+/),x=-1,S=-1,v=0,k=0,_=[],j=[],D=null,z={},I=[],T=[],L=[],O=0,F;for(+d.codepage>=0&&gi(+d.codepage);v!==y.length;++v){O=0;var N=y[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=N.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),K=M[0],he;if(N.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&j.push(N.slice(3).replace(/;;/g,";"));break;case"C":var le=!1,fe=!1,ie=!1,q=!1,Z=-1,oe=-1;for(k=1;k<M.length;++k)switch(M[k].charAt(0)){case"A":break;case"X":S=parseInt(M[k].slice(1))-1,fe=!0;break;case"Y":for(x=parseInt(M[k].slice(1))-1,fe||(S=0),F=_.length;F<=x;++F)_[F]=[];break;case"K":he=M[k].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(wi(he))?isNaN(Oc(he).getDate())||(he=un(he)):(he=wi(he),D!==null&&Wc(D)&&(he=Qd(he))),le=!0;break;case"E":q=!0;var b=_c(M[k].slice(1),{r:x,c:S});_[x][S]=[_[x][S],b];break;case"S":ie=!0,_[x][S]=[_[x][S],"S5S"];break;case"G":break;case"R":Z=parseInt(M[k].slice(1))-1;break;case"C":oe=parseInt(M[k].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}if(le&&(_[x][S]&&_[x][S].length==2?_[x][S][0]=he:_[x][S]=he,D=null),ie){if(q)throw new Error("SYLK shared formula cannot have own formula");var A=Z>-1&&_[Z][oe];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");_[x][S][1]=L3(A[1],{r:x-Z,c:S-oe})}break;case"F":var C=0;for(k=1;k<M.length;++k)switch(M[k].charAt(0)){case"X":S=parseInt(M[k].slice(1))-1,++C;break;case"Y":for(x=parseInt(M[k].slice(1))-1,F=_.length;F<=x;++F)_[F]=[];break;case"M":O=parseInt(M[k].slice(1))/20;break;case"F":break;case"G":break;case"P":D=j[parseInt(M[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=M[k].slice(1).split(" "),F=parseInt(L[0],10);F<=parseInt(L[1],10);++F)O=parseInt(L[2],10),T[F-1]=O===0?{hidden:!0}:{wch:O},Dc(T[F-1]);break;case"C":S=parseInt(M[k].slice(1))-1,T[S]||(T[S]={});break;case"R":x=parseInt(M[k].slice(1))-1,I[x]||(I[x]={}),O>0?(I[x].hpt=O,I[x].hpx=D0(O)):O===0&&(I[x].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}C<1&&(D=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}}return I.length>0&&(z["!rows"]=I),T.length>0&&(z["!cols"]=T),d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),[_,z]}function s(p,d){var y=a(p,d),x=y[0],S=y[1],v=Kc(x,d);return $i(S).forEach(function(k){v[k]=S[k]}),v}function o(p,d){return Eo(s(p,d),d)}function l(p,d,y,x){var S="C;Y"+(y+1)+";X"+(x+1)+";K";switch(p.t){case"n":S+=p.v||0,p.f&&!p.F&&(S+=";E"+sF(p.f,{r:y,c:x}));break;case"b":S+=p.v?"TRUE":"FALSE";break;case"e":S+=p.w||p.v;break;case"d":S+='"'+(p.w||p.v)+'"';break;case"s":S+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function c(p,d){d.forEach(function(y,x){var S="F;W"+(x+1)+" "+(x+1)+" ";y.hidden?S+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=_d(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=bd(y.wpx)),typeof y.wch=="number"&&(S+=Math.round(y.wch))),S.charAt(S.length-1)!=" "&&p.push(S)})}function u(p,d){d.forEach(function(y,x){var S="F;";y.hidden?S+="M0;":y.hpt?S+="M"+20*y.hpt+";":y.hpx&&(S+="M"+20*N3(y.hpx)+";"),S.length>2&&p.push(S+"R"+(x+1))})}function h(p,d){var y=["ID;PWXL;N;E"],x=[],S=Cr(p["!ref"]),v,k=Array.isArray(p),_=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),p["!cols"]&&c(y,p["!cols"]),p["!rows"]&&u(y,p["!rows"]),y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var j=S.s.r;j<=S.e.r;++j)for(var D=S.s.c;D<=S.e.c;++D){var z=Tt({r:j,c:D});v=k?(p[j]||[])[D]:p[z],!(!v||v.v==null&&(!v.f||v.F))&&x.push(l(v,p,j,D))}return y.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),_L=function(){function e(i,s){switch(s.type){case"base64":return t(Na(i),s);case"binary":return t(i,s);case"buffer":return t(Mt&&Buffer.isBuffer(i)?i.toString("binary"):hl(i),s);case"array":return t(il(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[u].trim().split(","),d=p[0],y=p[1];++u;for(var x=o[u]||"";(x.match(/["]/g)||[]).length&1&&u<o.length-1;)x+=`
`+o[++u];switch(x=x.trim(),+d){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(wi(y))?isNaN(Oc(y).getDate())?h[l][c]=y:h[l][c]=un(y):h[l][c]=wi(y),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(i,s){return Kc(e(i,s),s)}function n(i,s){return Eo(r(i,s),s)}var a=function(){var i=function(l,c,u,h,p){l.push(c),l.push(u+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Cr(l["!ref"]),h,p=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){s(c,-1,0,"BOT");for(var y=u.s.c;y<=u.e.c;++y){var x=Tt({r:d,c:y});if(h=p?(l[d]||[])[y]:l[x],!h){s(c,1,0,"");continue}switch(h.t){case"n":var S=h.w;!S&&h.v!=null&&(S=h.v),S==null?h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,S,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Xa(h.z||Ft[14],Gn(un(h.v)))),s(c,0,h.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var v=`\r
`,k=c.join(v);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),bL=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var d=h.split(`
`),y=-1,x=-1,S=0,v=[];S!==d.length;++S){var k=d[S].trim().split(":");if(k[0]==="cell"){var _=Hn(k[1]);if(v.length<=_.r)for(y=v.length;y<=_.r;++y)v[y]||(v[y]=[]);switch(y=_.r,x=_.c,k[2]){case"t":v[y][x]=e(k[3]);break;case"v":v[y][x]=+k[3];break;case"vtf":var j=k[k.length-1];case"vtc":switch(k[3]){case"nl":v[y][x]=!!+k[4];break;default:v[y][x]=+k[4];break}k[2]=="vtf"&&(v[y][x]=[v[y][x],j])}}}return p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}function n(h,p){return Kc(r(h,p),p)}function a(h,p){return Eo(n(h,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],d=[],y,x="",S=Gc(h["!ref"]),v=Array.isArray(h),k=S.s.r;k<=S.e.r;++k)for(var _=S.s.c;_<=S.e.c;++_)if(x=Tt({r:k,c:_}),y=v?(h[k]||[])[_]:h[x],!(!y||y.v==null||y.t==="z")){switch(d=["cell",x,"t"],y.t){case"s":case"str":d.push(t(y.v));break;case"n":y.f?(d[2]="vtf",d[3]="n",d[4]=y.v,d[5]=t(y.f)):(d[2]="v",d[3]=y.v);break;case"b":d[2]="vt"+(y.f?"f":"c"),d[3]="nl",d[4]=y.v?"1":"0",d[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var j=Gn(un(y.v));d[2]="vtc",d[3]="nd",d[4]=""+j,d[5]=y.w||Xa(y.z||Ft[14],j);break;case"e":continue}p.push(d.join(":"))}return p.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(h){return[i,s,o,s,c(h),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),R0=function(){function e(u,h,p,d,y){y.raw?h[p][d]=u:u===""||(u==="TRUE"?h[p][d]=!0:u==="FALSE"?h[p][d]=!1:isNaN(wi(u))?isNaN(Oc(u).getDate())?h[p][d]=u:h[p][d]=un(u):h[p][d]=wi(u))}function t(u,h){var p=h||{},d=[];if(!u||u.length===0)return d;for(var y=u.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var S=10,v=0,k=0;k<=x;++k)v=y[k].indexOf(" "),v==-1?v=y[k].length:v++,S=Math.max(S,v);for(k=0;k<=x;++k){d[k]=[];var _=0;for(e(y[k].slice(0,S).trim(),d,k,_,p),_=1;_<=(y[k].length-S)/10+1;++_)e(y[k].slice(S+(_-1)*10,S+_*10).trim(),d,k,_,p)}return p.sheetRows&&(d=d.slice(0,p.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var h={},p=!1,d=0,y=0;d<u.length;++d)(y=u.charCodeAt(d))==34?p=!p:!p&&y in r&&(h[y]=(h[y]||0)+1);y=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&y.push([h[d],d]);if(!y.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&y.push([h[d],d])}return y.sort(function(x,S){return x[0]-S[0]||n[x[1]]-n[S[1]]}),r[y.pop()[1]]||44}function i(u,h){var p=h||{},d="",y=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=a(u.slice(0,1024)):p&&p.FS?d=p.FS:d=a(u.slice(0,1024));var S=0,v=0,k=0,_=0,j=0,D=d.charCodeAt(0),z=!1,I=0,T=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var L=p.dateNF!=null?jN(p.dateNF):null;function O(){var F=u.slice(_,j),N={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)N.t="z";else if(p.raw)N.t="s",N.v=F;else if(F.trim().length===0)N.t="s",N.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(N.t="s",N.v=F.slice(2,-1).replace(/""/g,'"')):lF(F)?(N.t="n",N.f=F.slice(1)):(N.t="s",N.v=F);else if(F=="TRUE")N.t="b",N.v=!0;else if(F=="FALSE")N.t="b",N.v=!1;else if(!isNaN(k=wi(F)))N.t="n",p.cellText!==!1&&(N.w=F),N.v=k;else if(!isNaN(Oc(F).getDate())||L&&F.match(L)){N.z=p.dateNF||Ft[14];var M=0;L&&F.match(L)&&(F=RN(F,p.dateNF,F.match(L)||[]),M=1),p.cellDates?(N.t="d",N.v=un(F,M)):(N.t="n",N.v=Gn(un(F,M))),p.cellText!==!1&&(N.w=Xa(N.z,N.v instanceof Date?Gn(N.v):N.v)),p.cellNF||delete N.z}else N.t="s",N.v=F;if(N.t=="z"||(p.dense?(y[S]||(y[S]=[]),y[S][v]=N):y[Tt({c:v,r:S})]=N),_=j+1,T=u.charCodeAt(_),x.e.c<v&&(x.e.c=v),x.e.r<S&&(x.e.r=S),I==D)++v;else if(v=0,++S,p.sheetRows&&p.sheetRows<=S)return!0}e:for(;j<u.length;++j)switch(I=u.charCodeAt(j)){case 34:T===34&&(z=!z);break;case D:case 10:case 13:if(!z&&O())break e;break}return j-_>0&&O(),y["!ref"]=zt(x),y}function s(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):Kc(t(u,h),h)}function o(u,h){var p="",d=h.type=="string"?[0,0,0,0]:Bg(u,h);switch(h.type){case"base64":p=Na(u);break;case"binary":p=u;break;case"buffer":h.codepage==65001?p=u.toString("utf8"):h.codepage&&typeof Ys<"u"?p=Ys.utils.decode(h.codepage,u):p=Mt&&Buffer.isBuffer(u)?u.toString("binary"):hl(u);break;case"array":p=il(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?p=ur(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=ur(p):h.type=="binary"&&typeof Ys<"u"&&h.codepage&&(p=Ys.utils.decode(h.codepage,Ys.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?bL.to_sheet(h.type=="string"?p:ur(p),h):s(p,h)}function l(u,h){return Eo(o(u,h),h)}function c(u){for(var h=[],p=Cr(u["!ref"]),d,y=Array.isArray(u),x=p.s.r;x<=p.e.r;++x){for(var S=[],v=p.s.c;v<=p.e.c;++v){var k=Tt({r:x,c:v});if(d=y?(u[x]||[])[v]:u[k],!d||d.v==null){S.push("          ");continue}for(var _=(d.w||(ys(d),d.w)||"").slice(0,10);_.length<10;)_+=" ";S.push(_+(v===0?" ":""))}h.push(S.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function kL(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=wL.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return R0.to_workbook(e,t)}}var o0=function(){function e(b,A,C){if(b){pn(b,b.l||0);for(var R=C.Enum||Z;b.l<b.length;){var H=b.read_shift(2),re=R[H]||R[65535],ae=b.read_shift(2),ne=b.l+ae,me=re.f&&re.f(b,ae,C);if(b.l=ne,A(me,re,H))return}}}function t(b,A){switch(A.type){case"base64":return r(mi(Na(b)),A);case"binary":return r(mi(b),A);case"buffer":case"array":return r(b,A)}throw"Unsupported type "+A.type}function r(b,A){if(!b)return b;var C=A||{},R=C.dense?[]:{},H="Sheet1",re="",ae=0,ne={},me=[],we=[],X={s:{r:0,c:0},e:{r:0,c:0}},Ie=C.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)C.Enum=Z,e(b,function(Oe,Pe,De){switch(De){case 0:C.vers=Oe,Oe>=4096&&(C.qpro=!0);break;case 6:X=Oe;break;case 204:Oe&&(re=Oe);break;case 222:re=Oe;break;case 15:case 51:C.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:De==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=C.dateNF||Ft[14],C.cellDates&&(Oe[1].t="d",Oe[1].v=Qd(Oe[1].v))),C.qpro&&Oe[3]>ae&&(R["!ref"]=zt(X),ne[H]=R,me.push(H),R=C.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},ae=Oe[3],H=re||"Sheet"+(ae+1),re="");var qe=C.dense?(R[Oe[0].r]||[])[Oe[0].c]:R[Tt(Oe[0])];if(qe){qe.t=Oe[1].t,qe.v=Oe[1].v,Oe[1].z!=null&&(qe.z=Oe[1].z),Oe[1].f!=null&&(qe.f=Oe[1].f);break}C.dense?(R[Oe[0].r]||(R[Oe[0].r]=[]),R[Oe[0].r][Oe[0].c]=Oe[1]):R[Tt(Oe[0])]=Oe[1];break}},C);else if(b[2]==26||b[2]==14)C.Enum=oe,b[2]==14&&(C.qpro=!0,b.l=0),e(b,function(Oe,Pe,De){switch(De){case 204:H=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>ae&&(R["!ref"]=zt(X),ne[H]=R,me.push(H),R=C.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},ae=Oe[3],H="Sheet"+(ae+1)),Ie>0&&Oe[0].r>=Ie)break;C.dense?(R[Oe[0].r]||(R[Oe[0].r]=[]),R[Oe[0].r][Oe[0].c]=Oe[1]):R[Tt(Oe[0])]=Oe[1],X.e.c<Oe[0].c&&(X.e.c=Oe[0].c),X.e.r<Oe[0].r&&(X.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(we[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:we[Oe[0]]=Oe[1],Oe[0]==ae&&(H=Oe[1]);break}},C);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(R["!ref"]=zt(X),ne[re||H]=R,me.push(re||H),!we.length)return{SheetNames:me,Sheets:ne};for(var Se={},_e=[],Q=0;Q<we.length;++Q)ne[me[Q]]?(_e.push(we[Q]||me[Q]),Se[we[Q]]=ne[we[Q]]||ne[me[Q]]):(_e.push(we[Q]),Se[we[Q]]={"!ref":"A1"});return{SheetNames:_e,Sheets:Se}}function n(b,A){var C=A||{};if(+C.codepage>=0&&gi(+C.codepage),C.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Wm(),H=Cr(b["!ref"]),re=Array.isArray(b),ae=[];oi(R,0,i(1030)),oi(R,6,l(H));for(var ne=Math.min(H.e.r,8191),me=H.s.r;me<=ne;++me)for(var we=xn(me),X=H.s.c;X<=H.e.c;++X){me===H.s.r&&(ae[X]=Zr(X));var Ie=ae[X]+we,Se=re?(b[me]||[])[X]:b[Ie];if(!(!Se||Se.t=="z"))if(Se.t=="n")(Se.v|0)==Se.v&&Se.v>=-32768&&Se.v<=32767?oi(R,13,d(me,X,Se.v)):oi(R,14,x(me,X,Se.v));else{var _e=ys(Se);oi(R,15,h(me,X,_e.slice(0,239)))}}return oi(R,1),R.end()}function a(b,A){var C=A||{};if(+C.codepage>=0&&gi(+C.codepage),C.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Wm();oi(R,0,s(b));for(var H=0,re=0;H<b.SheetNames.length;++H)(b.Sheets[b.SheetNames[H]]||{})["!ref"]&&oi(R,27,q(b.SheetNames[H],re++));var ae=0;for(H=0;H<b.SheetNames.length;++H){var ne=b.Sheets[b.SheetNames[H]];if(!(!ne||!ne["!ref"])){for(var me=Cr(ne["!ref"]),we=Array.isArray(ne),X=[],Ie=Math.min(me.e.r,8191),Se=me.s.r;Se<=Ie;++Se)for(var _e=xn(Se),Q=me.s.c;Q<=me.e.c;++Q){Se===me.s.r&&(X[Q]=Zr(Q));var Oe=X[Q]+_e,Pe=we?(ne[Se]||[])[Q]:ne[Oe];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")oi(R,23,O(Se,Q,ae,Pe.v));else{var De=ys(Pe);oi(R,22,I(Se,Q,ae,De.slice(0,239)))}}++ae}}return oi(R,1),R.end()}function i(b){var A=Yr(2);return A.write_shift(2,b),A}function s(b){var A=Yr(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var C=0,R=0,H=0,re=0;re<b.SheetNames.length;++re){var ae=b.SheetNames[re],ne=b.Sheets[ae];if(!(!ne||!ne["!ref"])){++H;var me=Gc(ne["!ref"]);C<me.e.r&&(C=me.e.r),R<me.e.c&&(R=me.e.c)}}return C>8191&&(C=8191),A.write_shift(2,C),A.write_shift(1,H),A.write_shift(1,R),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function o(b,A,C){var R={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&C.qpro?(R.s.c=b.read_shift(1),b.l++,R.s.r=b.read_shift(2),R.e.c=b.read_shift(1),b.l++,R.e.r=b.read_shift(2),R):(R.s.c=b.read_shift(2),R.s.r=b.read_shift(2),A==12&&C.qpro&&(b.l+=2),R.e.c=b.read_shift(2),R.e.r=b.read_shift(2),A==12&&C.qpro&&(b.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function l(b){var A=Yr(8);return A.write_shift(2,b.s.c),A.write_shift(2,b.s.r),A.write_shift(2,b.e.c),A.write_shift(2,b.e.r),A}function c(b,A,C){var R=[{c:0,r:0},{t:"n",v:0},0,0];return C.qpro&&C.vers!=20768?(R[0].c=b.read_shift(1),R[3]=b.read_shift(1),R[0].r=b.read_shift(2),b.l+=2):(R[2]=b.read_shift(1),R[0].c=b.read_shift(2),R[0].r=b.read_shift(2)),R}function u(b,A,C){var R=b.l+A,H=c(b,A,C);if(H[1].t="s",C.vers==20768){b.l++;var re=b.read_shift(1);return H[1].v=b.read_shift(re,"utf8"),H}return C.qpro&&b.l++,H[1].v=b.read_shift(R-b.l,"cstr"),H}function h(b,A,C){var R=Yr(7+C.length);R.write_shift(1,255),R.write_shift(2,A),R.write_shift(2,b),R.write_shift(1,39);for(var H=0;H<R.length;++H){var re=C.charCodeAt(H);R.write_shift(1,re>=128?95:re)}return R.write_shift(1,0),R}function p(b,A,C){var R=c(b,A,C);return R[1].v=b.read_shift(2,"i"),R}function d(b,A,C){var R=Yr(7);return R.write_shift(1,255),R.write_shift(2,A),R.write_shift(2,b),R.write_shift(2,C,"i"),R}function y(b,A,C){var R=c(b,A,C);return R[1].v=b.read_shift(8,"f"),R}function x(b,A,C){var R=Yr(13);return R.write_shift(1,255),R.write_shift(2,A),R.write_shift(2,b),R.write_shift(8,C,"f"),R}function S(b,A,C){var R=b.l+A,H=c(b,A,C);if(H[1].v=b.read_shift(8,"f"),C.qpro)b.l=R;else{var re=b.read_shift(2);j(b.slice(b.l,b.l+re),H),b.l+=re}return H}function v(b,A,C){var R=A&32768;return A&=-32769,A=(R?b:0)+(A>=8192?A-16384:A),(R?"":"$")+(C?Zr(A):xn(A))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(b,A){pn(b,0);for(var C=[],R=0,H="",re="",ae="",ne="";b.l<b.length;){var me=b[b.l++];switch(me){case 0:C.push(b.read_shift(8,"f"));break;case 1:re=v(A[0].c,b.read_shift(2),!0),H=v(A[0].r,b.read_shift(2),!1),C.push(re+H);break;case 2:{var we=v(A[0].c,b.read_shift(2),!0),X=v(A[0].r,b.read_shift(2),!1);re=v(A[0].c,b.read_shift(2),!0),H=v(A[0].r,b.read_shift(2),!1),C.push(we+X+":"+re+H)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:C.push("("+C.pop()+")");break;case 5:C.push(b.read_shift(2));break;case 6:{for(var Ie="";me=b[b.l++];)Ie+=String.fromCharCode(me);C.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:C.push("-"+C.pop());break;case 23:C.push("+"+C.pop());break;case 22:C.push("NOT("+C.pop()+")");break;case 20:case 21:ne=C.pop(),ae=C.pop(),C.push(["AND","OR"][me-20]+"("+ae+","+ne+")");break;default:if(me<32&&_[me])ne=C.pop(),ae=C.pop(),C.push(ae+_[me]+ne);else if(k[me]){if(R=k[me][1],R==69&&(R=b[b.l++]),R>C.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+C.join("|")+"|");return}var Se=C.slice(-R);C.length-=R,C.push(k[me][0]+"("+Se.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}C.length==1?A[1].f=""+C[0]:console.error("WK1 bad formula parse |"+C.join("|")+"|")}function D(b){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=b.read_shift(2),A[3]=b[b.l++],A[0].c=b[b.l++],A}function z(b,A){var C=D(b);return C[1].t="s",C[1].v=b.read_shift(A-4,"cstr"),C}function I(b,A,C,R){var H=Yr(6+R.length);H.write_shift(2,b),H.write_shift(1,C),H.write_shift(1,A),H.write_shift(1,39);for(var re=0;re<R.length;++re){var ae=R.charCodeAt(re);H.write_shift(1,ae>=128?95:ae)}return H.write_shift(1,0),H}function T(b,A){var C=D(b);C[1].v=b.read_shift(2);var R=C[1].v>>1;if(C[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return C[1].v=R,C}function L(b,A){var C=D(b),R=b.read_shift(4),H=b.read_shift(4),re=b.read_shift(2);if(re==65535)return R===0&&H===3221225472?(C[1].t="e",C[1].v=15):R===0&&H===3489660928?(C[1].t="e",C[1].v=42):C[1].v=0,C;var ae=re&32768;return re=(re&32767)-16446,C[1].v=(1-ae*2)*(H*Math.pow(2,re+32)+R*Math.pow(2,re)),C}function O(b,A,C,R){var H=Yr(14);if(H.write_shift(2,b),H.write_shift(1,C),H.write_shift(1,A),R==0)return H.write_shift(4,0),H.write_shift(4,0),H.write_shift(2,65535),H;var re=0,ae=0,ne=0,me=0;return R<0&&(re=1,R=-R),ae=Math.log2(R)|0,R/=Math.pow(2,ae-31),me=R>>>0,me&2147483648||(R/=2,++ae,me=R>>>0),R-=me,me|=2147483648,me>>>=0,R*=Math.pow(2,32),ne=R>>>0,H.write_shift(4,ne),H.write_shift(4,me),ae+=16383+(re?32768:0),H.write_shift(2,ae),H}function F(b,A){var C=L(b);return b.l+=A-14,C}function N(b,A){var C=D(b),R=b.read_shift(4);return C[1].v=R>>6,C}function M(b,A){var C=D(b),R=b.read_shift(8,"f");return C[1].v=R,C}function K(b,A){var C=M(b);return b.l+=A-10,C}function he(b,A){return b[b.l+A-1]==0?b.read_shift(A,"cstr"):""}function le(b,A){var C=b[b.l++];C>A-1&&(C=A-1);for(var R="";R.length<C;)R+=String.fromCharCode(b[b.l++]);return R}function fe(b,A,C){if(!(!C.qpro||A<21)){var R=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var H=b.read_shift(A-21,"cstr");return[R,H]}}function ie(b,A){for(var C={},R=b.l+A;b.l<R;){var H=b.read_shift(2);if(H==14e3){for(C[H]=[0,""],C[H][0]=b.read_shift(2);b[b.l];)C[H][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return C}function q(b,A){var C=Yr(5+b.length);C.write_shift(2,14e3),C.write_shift(2,A);for(var R=0;R<b.length;++R){var H=b.charCodeAt(R);C[C.l++]=H>127?95:H}return C[C.l++]=0,C}var Z={0:{n:"BOF",f:Vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:le},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function SL(e){var t={},r=e.match(Dn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=bt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=mg[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var EL=function(){var e=I0("t"),t=I0("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Vt(s[1])},l=i.match(t);return l&&(o.s=SL(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),AL=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),NL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,TL=/<(?:\w+:)?r>/,CL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Pg(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Vt(ur(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ur(e),r&&(n.h=bg(n.t))):e.match(TL)&&(n.r=ur(e),n.t=Vt(ur((e.replace(CL,"").match(NL)||[]).join("").replace(Dn,""))),r&&(n.h=AL(EL(n.r)))),n):{t:""}}var LL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,FL=/<(?:\w+:)?(?:si|sstItem)>/g,PL=/<\/(?:\w+:)?(?:si|sstItem)>/;function IL(e,t){var r=[],n="";if(!e)return r;var a=e.match(LL);if(a){n=a[2].replace(FL,"").split(PL);for(var i=0;i!=n.length;++i){var s=Pg(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=bt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function jL(e){return[e.read_shift(4),e.read_shift(4)]}function RL(e,t){var r=[],n=!1;return bs(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function _3(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ds(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function OL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ds(e,4),t.U=ds(e,4),t.W=ds(e,4),t}function DL(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function ML(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(DL(e));return t}function BL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function UL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ds(e,4),t.U=ds(e,4),t.W=ds(e,4),t}function zL(e){var t=UL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function b3(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function k3(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function $L(e){var t=ds(e);switch(t.Minor){case 2:return[t.Minor,qL(e)];case 3:return[t.Minor,HL()];case 4:return[t.Minor,VL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function qL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=b3(e,r),a=k3(e,e.length-e.l);return{t:"Std",h:n,v:a}}function HL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function VL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Dn,function(i){var s=bt(i);switch(Hi(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function WL(e,t){var r={},n=r.EncryptionVersionInfo=ds(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=b3(e,a),t-=a,r.EncryptionVerifier=k3(e,t),r}function GL(e){var t={},r=t.EncryptionVersionInfo=ds(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function KL(e){var t=0,r,n=_3(e),a=n.length+1,i,s,o,l,c;for(r=xo(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var S3=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=_3(s),l=i(o),c=o.length,u=xo(16),h=0;h!=16;++h)u[h]=0;var p,d,y;for((c&1)===1&&(p=l>>8,u[c]=a(e[0],p),--c,p=l&255,d=o[o.length-1],u[c]=a(d,p));c>0;)--c,p=l>>8,u[c]=a(o[c],p),--c,p=l&255,u[c]=a(o[c],p);for(c=15,y=15-o.length;y>0;)p=l>>8,u[c]=a(e[y],p),--c,--y,p=l&255,u[c]=a(o[c],p),--c,--y;return u}}(),XL=function(e,t,r,n,a){a||(a=t),n||(n=S3(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},YL=function(e){var t=0,r=S3(e);return function(n){var a=XL("",n,t,r);return t=a[1],a[0]}};function JL(e,t,r,n){var a={key:Vr(e),verificationBytes:Vr(e)};return r.password&&(a.verifier=KL(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=YL(r.password)),a}function QL(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=GL(e):n.Data=WL(e,t),n}function ZL(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?QL(e,t-2,n):JL(e,r.biff>=8?t:t-2,r,n),n}var e7=function(){function e(a,i){switch(i.type){case"base64":return t(Na(a),i);case"binary":return t(a,i);case"buffer":return t(Mt&&Buffer.isBuffer(a)?a.toString("binary"):hl(a),i);case"array":return t(il(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,d=0,y,x=-1;y=p.exec(u);){switch(y[0]){case"\\cell":var S=u.slice(d,p.lastIndex-y[0].length);if(S[0]==" "&&(S=S.slice(1)),++x,S.length){var v={v:S,t:"s"};Array.isArray(o)?o[h][x]=v:o[Tt({r:h,c:x})]=v}break}d=p.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=zt(c),o}function r(a,i){return Eo(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Cr(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var h=Tt({r:c,c:u});o=l?(a[c]||[])[u]:a[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(ys(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function t7(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function O0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function r7(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,l=0,c=a+i;switch(l=s/(c>1?2-c:c),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,c/2]}function n7(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-o),s[0]+=l,s[1]+=a;break;case 2:l=a*(o-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-o),s[1]+=l,s[2]+=a;break;case 4:l=a*(o-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-o),s[2]+=l,s[0]+=a;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function wd(e,t){if(t===0)return e;var r=r7(t7(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),O0(n7(r))}var E3=6,a7=15,i7=1,qn=E3;function _d(e){return Math.floor((e+Math.round(128/qn)/256)*qn)}function bd(e){return Math.floor((e-5)/qn*100+.5)/100}function Ym(e){return Math.round((e*qn+5)/qn*256)/256}function Ep(e){return Ym(bd(_d(e)))}function Ig(e){var t=Math.abs(e-Ep(e)),r=qn;if(t>.005)for(qn=i7;qn<a7;++qn)Math.abs(e-Ep(e))<=t&&(t=Math.abs(e-Ep(e)),r=qn);qn=r}function Dc(e){e.width?(e.wpx=_d(e.width),e.wch=bd(e.wpx),e.MDW=qn):e.wpx?(e.wch=bd(e.wpx),e.width=Ym(e.wch),e.MDW=qn):typeof e.wch=="number"&&(e.width=Ym(e.wch),e.wpx=_d(e.width),e.MDW=qn),e.customWidth&&delete e.customWidth}var s7=96,A3=s7;function N3(e){return e*96/A3}function D0(e){return e*A3/96}var o7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function l7(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Dn)||[]).forEach(function(s){var o=bt(s);switch(Hi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=mr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=mr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function c7(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Dn)||[]).forEach(function(s){var o=bt(s);switch(Hi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function u7(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Dn)||[]).forEach(function(s){var o=bt(s);switch(Hi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ur(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?mr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?mr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?mr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?mr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?mr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?mr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?mr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=mg[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=mr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Jo[a.color.index];a.color.index==81&&(l=Jo[1]),l||(l=Jo[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=wd(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function f7(e,t,r){t.NumberFmt=[];for(var n=$i(Ft),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ft[n[a]];var i=e[0].match(Dn);if(i)for(a=0;a<i.length;++a){var s=bt(i[a]);switch(Hi(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Vt(ur(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Yo(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var mh=["numFmtId","fillId","fontId","borderId","xfId"],gh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function h7(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Dn)||[]).forEach(function(i){var s=bt(i),o=0;switch(Hi(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<mh.length;++o)n[mh[o]]&&(n[mh[o]]=parseInt(n[mh[o]],10));for(o=0;o<gh.length;++o)n[gh[o]]&&(n[gh[o]]=mr(n[gh[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=mr(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var d7=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&f7(h,u,c),(h=o.match(a))&&u7(h,u,l,c),(h=o.match(n))&&c7(h,u,l,c),(h=o.match(i))&&l7(h,u,l,c),(h=o.match(r))&&h7(h,u,c),u}}();function p7(e,t){var r=e.read_shift(2),n=jn(e);return[r,n]}function m7(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=ET(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=ST(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jn(e),n}var g7=On;function x7(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var v7=On;function y7(e,t,r){var n={};n.NumberFmt=[];for(var a in Ft)n.NumberFmt[a]=Ft[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return bs(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Yo(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=wd(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var w7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _7(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Dn)||[]).forEach(function(a){var i=bt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[w7.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function b7(){}function k7(){}var S7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,E7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,A7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function N7(e,t,r){t.themeElements={};var n;[["clrScheme",S7,_7],["fontScheme",E7,b7],["fmtScheme",A7,k7]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var T7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function T3(e,t){(!e||e.length===0)&&(e=C7());var r,n={};if(!(r=e.match(T7)))throw new Error("themeElements not found in theme");return N7(r[0],n,t),n.raw=e,n}function C7(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[B_];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function L7(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=M_(i,{type:"array"})}catch{return}var o=_a(s,"theme/theme/theme1.xml",!0);if(o)return T3(o,r)}}function F7(e){return e.read_shift(4)}function P7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=I7(e,4);break;case 2:t.xclrValue=p3(e);break;case 3:t.xclrValue=F7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function I7(e,t){return On(e,t)}function j7(e,t){return On(e,t)}function R7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=P7(e);break;case 6:n[1]=j7(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function O7(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(R7(e,r-e.l));return{ixfe:n,ext:i}}function D7(e,t){t.forEach(function(r){switch(r[0]){}})}function M7(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:jn(e)}}function B7(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function U7(e){return e.l+=4,e.read_shift(4)!=0}function z7(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return bs(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!c.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function $7(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Dn,function(o){var l=bt(o);switch(Hi(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function q7(e){var t=[];if(!e)return t;var r=1;return(e.match(Dn)||[]).forEach(function(n){var a=bt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function H7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Tt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function V7(e,t,r){var n=[];return bs(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function W7(e,t,r,n){if(!e)return e;var a=n||{},i=!1;bs(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function G7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function O5(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=Hn(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var l=Cr(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=zt(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}i.c.push(u)})}function K7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=bt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Hn(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&Pg(h[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function X7(e,t){var r=[],n=!1,a={},i=0;return e.replace(Dn,function(o,l){var c=bt(o);switch(Hi(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Y7(e,t){var r=[],n=!1;return e.replace(Dn,function(i){var s=bt(i);switch(Hi(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function J7(e){var t={};t.iauthor=e.read_shift(4);var r=pl(e);return t.rfx=r.s,t.ref=Tt(r.s),e.l+=16,t}var Q7=jn;function Z7(e,t){var r=[],n=[],a={},i=!1;return bs(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var eF="application/vnd.ms-office.vbaProject";function tF(e){var t=Ut.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ut.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ut.write(t)}function rF(){return{"!type":"dialog"}}function nF(){return{"!type":"dialog"}}function aF(){return{"!type":"macro"}}function iF(){return{"!type":"macro"}}var _c=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+Zr(u)+(l?"":"$")+xn(c)}return function(a,i){return t=i,a.replace(e,r)}}(),C3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sF=function(){return function(t,r){return t.replace(C3,function(n,a,i,s,o,l){var c=Ag(s)-(i?0:r.c),u=Eg(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",p=c==0?"":i?c+1:"["+c+"]";return a+"R"+h+"C"+p})}}();function L3(e,t){return e.replace(C3,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Zr(Ag(i)+t.c))+(s=="$"?s+o:xn(Eg(o)+t.r))})}function oF(e,t,r){var n=Gc(t),a=n.s,i=Hn(r),s={r:i.r-a.r,c:i.c-a.c};return L3(e,s)}function lF(e){return e.length!=1}function D5(e){return e.replace(/_xlfn\./g,"")}function qr(e){e.l+=1}function vo(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function F3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return P3(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=vo(e,2),o=vo(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function P3(e){var t=vo(e,2),r=vo(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function cF(e,t,r){if(r.biff<8)return P3(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=vo(e,2),s=vo(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function I3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return uF(e);var n=e.read_shift(r&&r.biff==12?4:2),a=vo(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function uF(e){var t=vo(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function fF(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hF(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return dF(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function dF(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function pF(e,t,r){var n=(e[e.l++]&96)>>5,a=F3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function mF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=F3(e,i,r);return[n,a,s]}function gF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function xF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function vF(e,t,r){var n=(e[e.l++]&96)>>5,a=cF(e,t-1,r);return[n,a]}function yF(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function M5(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function wF(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function _F(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function bF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function SF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function j3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function EF(e){return e.read_shift(2),j3(e)}function AF(e){return e.read_shift(2),j3(e)}function NF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=I3(e,0,r);return[n,a]}function TF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=hF(e,0,r);return[n,a]}function CF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=I3(e,0,r);return[n,a,i]}function LF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[FP[a],D3[a],n]}function FF(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:PF(e);return[a,(i[0]===0?D3:LP)[i[1]]]}function PF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function IF(e,t,r){e.l+=r&&r.biff==2?3:4}function jF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function RF(e){return e.l++,ml[e.read_shift(1)]}function OF(e){return e.l++,e.read_shift(2)}function DF(e){return e.l++,e.read_shift(1)!==0}function MF(e){return e.l++,Fn(e)}function BF(e,t,r){return e.l++,X0(e,t-1,r)}function UF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=jr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ml[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Fn(e);break;case 2:r[1]=gl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?pl:Zd)(e));return a}function $F(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=UF(e,r.biff);return s}function qF(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function HF(e,t,r){if(r.biff==5)return VF(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function VF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function WF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function GF(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function KF(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function XF(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var YF=On,JF=On,QF=On;function J0(e,t,r){return e.l+=2,[fF(e)]}function jg(e){return e.l+=6,[]}var ZF=J0,eP=jg,tP=jg,rP=J0;function R3(e){return e.l+=2,[Vr(e),e.read_shift(2)&1]}var nP=J0,aP=R3,iP=jg,sP=J0,oP=J0,lP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function cP(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=lP[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function uP(e){return e.l+=2,[e.read_shift(4)]}function fP(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function hP(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function dP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pP(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function mP(e){return e.l+=4,[0,0]}var B5={1:{n:"PtgExp",f:jF},2:{n:"PtgTbl",f:QF},3:{n:"PtgAdd",f:qr},4:{n:"PtgSub",f:qr},5:{n:"PtgMul",f:qr},6:{n:"PtgDiv",f:qr},7:{n:"PtgPower",f:qr},8:{n:"PtgConcat",f:qr},9:{n:"PtgLt",f:qr},10:{n:"PtgLe",f:qr},11:{n:"PtgEq",f:qr},12:{n:"PtgGe",f:qr},13:{n:"PtgGt",f:qr},14:{n:"PtgNe",f:qr},15:{n:"PtgIsect",f:qr},16:{n:"PtgUnion",f:qr},17:{n:"PtgRange",f:qr},18:{n:"PtgUplus",f:qr},19:{n:"PtgUminus",f:qr},20:{n:"PtgPercent",f:qr},21:{n:"PtgParen",f:qr},22:{n:"PtgMissArg",f:qr},23:{n:"PtgStr",f:BF},26:{n:"PtgSheet",f:fP},27:{n:"PtgEndSheet",f:hP},28:{n:"PtgErr",f:RF},29:{n:"PtgBool",f:DF},30:{n:"PtgInt",f:OF},31:{n:"PtgNum",f:MF},32:{n:"PtgArray",f:yF},33:{n:"PtgFunc",f:LF},34:{n:"PtgFuncVar",f:FF},35:{n:"PtgName",f:qF},36:{n:"PtgRef",f:NF},37:{n:"PtgArea",f:pF},38:{n:"PtgMemArea",f:WF},39:{n:"PtgMemErr",f:YF},40:{n:"PtgMemNoMem",f:JF},41:{n:"PtgMemFunc",f:GF},42:{n:"PtgRefErr",f:KF},43:{n:"PtgAreaErr",f:gF},44:{n:"PtgRefN",f:TF},45:{n:"PtgAreaN",f:vF},46:{n:"PtgMemAreaN",f:dP},47:{n:"PtgMemNoMemN",f:pP},57:{n:"PtgNameX",f:HF},58:{n:"PtgRef3d",f:CF},59:{n:"PtgArea3d",f:mF},60:{n:"PtgRefErr3d",f:XF},61:{n:"PtgAreaErr3d",f:xF},255:{}},gP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xP={1:{n:"PtgElfLel",f:R3},2:{n:"PtgElfRw",f:sP},3:{n:"PtgElfCol",f:ZF},6:{n:"PtgElfRwV",f:oP},7:{n:"PtgElfColV",f:rP},10:{n:"PtgElfRadical",f:nP},11:{n:"PtgElfRadicalS",f:iP},13:{n:"PtgElfColS",f:eP},15:{n:"PtgElfColSV",f:tP},16:{n:"PtgElfRadicalLel",f:aP},25:{n:"PtgList",f:cP},29:{n:"PtgSxName",f:uP},255:{}},vP={0:{n:"PtgAttrNoop",f:mP},1:{n:"PtgAttrSemi",f:SF},2:{n:"PtgAttrIf",f:bF},4:{n:"PtgAttrChoose",f:wF},8:{n:"PtgAttrGoto",f:_F},16:{n:"PtgAttrSum",f:IF},32:{n:"PtgAttrBaxcel",f:M5},33:{n:"PtgAttrBaxcel",f:M5},64:{n:"PtgAttrSpace",f:EF},65:{n:"PtgAttrSpaceSemi",f:AF},128:{n:"PtgAttrIfError",f:kF},255:{}};function Q0(e,t,r,n){if(n.biff<8)return On(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=$F(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=zF(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(On(e,t)),i}function Z0(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=B5[i]||B5[gP[i]],(i===24||i===25)&&(a=(i===24?xP:vP)[e[e.l+1]]),!a||!a.f?On(e,t):s.push([a.n,a.f(e,t,r)]);return s}function yP(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var wP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _P(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function O3(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function U5(e,t,r){var n=O3(e,t,r);return n=="#REF"?n:_P(n,r)}function Cn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,h=0,p=0,d,y="";if(!e[0]||!e[0][0])return"";for(var x=-1,S="",v=0,k=e[0].length;v<k;++v){var _=e[0][v];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:S=Tr(" ",e[0][x][1][1]);break;case 1:S=Tr("\r",e[0][x][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+S,x=-1}o.push(c+wP[_[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=n0(_[1][1],s,a),o.push(a0(u,i));break;case"PtgRefN":u=r?n0(_[1][1],r,a):_[1][1],o.push(a0(u,i));break;case"PtgRef3d":h=_[1][1],u=n0(_[1][2],s,a),y=U5(n,h,a),o.push(y+"!"+a0(u,i));break;case"PtgFunc":case"PtgFuncVar":var j=_[1][0],D=_[1][1];j||(j=0),j&=127;var z=j==0?[]:o.slice(-j);o.length-=j,D==="User"&&(D=z.shift()),o.push(D+"("+z.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":d=w5(_[1][1],r?{s:r}:s,a),o.push(kp(d,a));break;case"PtgArea":d=w5(_[1][1],s,a),o.push(kp(d,a));break;case"PtgArea3d":h=_[1][1],d=_[1][2],y=U5(n,h,a),o.push(y+"!"+kp(d,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=_[1][2];var I=(n.names||[])[p-1]||(n[0]||[])[p],T=I?I.Name:"SH33TJSNAME"+String(p);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var L=_[1][1];p=_[1][2];var O;if(a.biff<=5)L<0&&(L=-L),n[L]&&(O=n[L][p]);else{var F="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][p]&&n[L][p].itab>0&&(F=n.SheetNames[n[L][p].itab-1]+"!"):F=n.SheetNames[p-1]+"!"),n[L]&&n[L][p])F+=n[L][p].Name;else if(n[0]&&n[0][p])F+=n[0][p].Name;else{var N=(O3(n,L,a)||"").split(";;");N[p-1]?F=N[p-1]:F+="SH33TJSERRX"}o.push(F);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var M="(",K=")";if(x>=0){switch(S="",e[0][x][1][0]){case 2:M=Tr(" ",e[0][x][1][1])+M;break;case 3:M=Tr("\r",e[0][x][1][1])+M;break;case 4:K=Tr(" ",e[0][x][1][1])+K;break;case 5:K=Tr("\r",e[0][x][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(M+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:_[1][1],r:_[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[Tt(u)]){var le=n.sharedf[Tt(u)];o.push(Cn(le,s,he,n,a))}else{var fe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Cn(c[1],s,he,n,a)),fe=!0;break}fe||o.push(_[1])}break;case"PtgArray":o.push("{"+yP(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&ie.indexOf(e[0][v][0])==-1){_=e[0][x];var q=!0;switch(_[1][0]){case 4:q=!1;case 0:S=Tr(" ",_[1][1]);break;case 5:q=!1;case 1:S=Tr("\r",_[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((q?S:"")+o.pop()+(q?"":S)),x=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function bP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],On(e,t-2)];var o=Z0(e,s,r);return t!==s+a&&(i=Q0(e,t-s-a,o,r)),e.l=n,[o,i]}function kP(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],On(e,t-2)];var o=Z0(e,s,r);return t!==s+a&&(i=Q0(e,t-s-a,o,r)),e.l=n,[o,i]}function SP(e,t,r,n){var a=e.l+t,i=Z0(e,n,r),s;return a!==e.l&&(s=Q0(e,a-e.l,i,r)),[i,s]}function EP(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Z0(e,i,r);return i==65535?[[],On(e,t-2)]:(t!==i+2&&(a=Q0(e,n-i-2,s,r)),[s,a])}function AP(e){var t;if(us(e,e.l+6)!==65535)return[Fn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Ap(e,t,r){var n=e.l+t,a=Vi(e);r.biff==2&&++e.l;var i=AP(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=kP(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function e1(e,t,r){var n=e.read_shift(4),a=Z0(e,n,r),i=e.read_shift(4),s=i>0?Q0(e,i,a,r):null;return[a,s]}var NP=e1,t1=e1,TP=e1,CP=e1,LP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},D3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function z5(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Np(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var l0={},bc={};function c0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function M3(e,t,r,n,a,i){try{n.cellNF&&(e.z=Ft[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=un(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ft[t]==null&&Yo(IN[t]||"General",t),e.t==="e")e.w=e.w||ml[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=P0(e.v);else if(e.t==="d"){var s=Gn(e.v);(s|0)===s?e.w=s.toString(10):e.w=P0(s)}else{if(e.v===void 0)return"";e.w=al(e.v,bc)}else e.t==="d"?e.w=Xa(t,Gn(e.v),bc):e.w=Xa(t,e.v,bc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=wd(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=wd(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function PP(e,t){var r=Cr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=zt(r))}var IP=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,jP=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,RP=/<(?:\w:)?hyperlink [^>]*>/mg,OP=/"(\w*:\w*)"/,DP=/<(?:\w:)?col\b[^>]*[\/]?>/g,MP=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,BP=/<(?:\w:)?pageMargins[^>]*\/>/g,B3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,UP=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,zP=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $P(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(jP);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var p=c.match(B3);p?Rg(p[0],o,a,r):(p=c.match(UP))&&qP(p[0],p[1]||"",o,a,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var y=c.slice(d,d+50).match(OP);y&&PP(o,y[1])}var x=c.match(zP);x&&x[1]&&XP(x[1],a);var S=[];if(t.cellStyles){var v=c.match(DP);v&&WP(S,v)}h&&YP(h[1],o,t,l,i,s);var k=u.match(MP);k&&(o["!autofilter"]=GP(k[0]));var _=[],j=u.match(IP);if(j)for(d=0;d!=j.length;++d)_[d]=Cr(j[d].slice(j[d].indexOf('"')+1));var D=u.match(RP);D&&HP(o,D,n);var z=u.match(BP);if(z&&(o["!margins"]=VP(bt(z[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=zt(l)),t.sheetRows>0&&o["!ref"]){var I=Cr(o["!ref"]);t.sheetRows<=+I.e.r&&(I.e.r=t.sheetRows-1,I.e.r>l.e.r&&(I.e.r=l.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>l.e.c&&(I.e.c=l.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),o["!fullref"]=o["!ref"],o["!ref"]=zt(I))}return S.length>0&&(o["!cols"]=S),_.length>0&&(o["!merges"]=_),o}function Rg(e,t,r,n){var a=bt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Vt(ur(a.codeName)))}function qP(e,t,r,n,a){Rg(e.slice(0,e.indexOf(">")),r,n,a)}function HP(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=bt(ur(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Vt(i.location))):(i.Target="#"+Vt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Cr(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Tt({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function VP(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function WP(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=bt(t[n],!0);a.hidden&&(a.hidden=mr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Ig(a.width)),Dc(a);i<=s;)e[i++]=gn(a)}}function GP(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var KP=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function XP(e,t){t.Views||(t.Views=[{}]),(e.match(KP)||[]).forEach(function(r,n){var a=bt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),mr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var YP=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=I0("v"),s=I0("f");return function(l,c,u,h,p,d){for(var y=0,x="",S=[],v=[],k=0,_=0,j=0,D="",z,I,T=0,L=0,O,F,N=0,M=0,K=Array.isArray(d.CellXf),he,le=[],fe=[],ie=Array.isArray(c),q=[],Z={},oe=!1,b=!!u.sheetStubs,A=l.split(t),C=0,R=A.length;C!=R;++C){x=A[C].trim();var H=x.length;if(H!==0){var re=0;e:for(y=0;y<H;++y)switch(x[y]){case">":if(x[y-1]!="/"){++y;break e}if(u&&u.cellStyles){if(I=bt(x.slice(re,y),!0),T=I.r!=null?parseInt(I.r,10):T+1,L=-1,u.sheetRows&&u.sheetRows<T)continue;Z={},oe=!1,I.ht&&(oe=!0,Z.hpt=parseFloat(I.ht),Z.hpx=D0(Z.hpt)),I.hidden=="1"&&(oe=!0,Z.hidden=!0),I.outlineLevel!=null&&(oe=!0,Z.level=+I.outlineLevel),oe&&(q[T-1]=Z)}break;case"<":re=y;break}if(re>=y)break;if(I=bt(x.slice(re,y),!0),T=I.r!=null?parseInt(I.r,10):T+1,L=-1,!(u.sheetRows&&u.sheetRows<T)){h.s.r>T-1&&(h.s.r=T-1),h.e.r<T-1&&(h.e.r=T-1),u&&u.cellStyles&&(Z={},oe=!1,I.ht&&(oe=!0,Z.hpt=parseFloat(I.ht),Z.hpx=D0(Z.hpt)),I.hidden=="1"&&(oe=!0,Z.hidden=!0),I.outlineLevel!=null&&(oe=!0,Z.level=+I.outlineLevel),oe&&(q[T-1]=Z)),S=x.slice(y).split(e);for(var ae=0;ae!=S.length&&S[ae].trim().charAt(0)=="<";++ae);for(S=S.slice(ae),y=0;y!=S.length;++y)if(x=S[y].trim(),x.length!==0){if(v=x.match(r),k=y,_=0,j=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,v!=null&&v.length===2){for(k=0,D=v[1],_=0;_!=D.length&&!((j=D.charCodeAt(_)-64)<1||j>26);++_)k=26*k+j;--k,L=k}else++L;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,I=bt(x.slice(0,_),!0),I.r||(I.r=Tt({r:T-1,c:L})),D=x.slice(_),z={t:""},(v=D.match(i))!=null&&v[1]!==""&&(z.v=Vt(v[1])),u.cellFormula){if((v=D.match(s))!=null&&v[1]!==""){if(z.f=Vt(ur(v[1])).replace(/\r\n/g,`
`),u.xlfn||(z.f=D5(z.f)),v[0].indexOf('t="array"')>-1)z.F=(D.match(a)||[])[1],z.F.indexOf(":")>-1&&le.push([Cr(z.F),z.F]);else if(v[0].indexOf('t="shared"')>-1){F=bt(v[0]);var ne=Vt(ur(v[1]));u.xlfn||(ne=D5(ne)),fe[parseInt(F.si,10)]=[F,ne,I.r]}}else(v=D.match(/<f[^>]*\/>/))&&(F=bt(v[0]),fe[F.si]&&(z.f=oF(fe[F.si][1],fe[F.si][2],I.r)));var me=Hn(I.r);for(_=0;_<le.length;++_)me.r>=le[_][0].s.r&&me.r<=le[_][0].e.r&&me.c>=le[_][0].s.c&&me.c<=le[_][0].e.c&&(z.F=le[_][1])}if(I.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(b)z.t="z";else continue;else z.t=I.t||"n";switch(h.s.c>L&&(h.s.c=L),h.e.c<L&&(h.e.c=L),z.t){case"n":if(z.v==""||z.v==null){if(!b)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!b)continue;z.t="z"}else O=l0[parseInt(z.v,10)],z.v=O.t,z.r=O.r,u.cellHTML&&(z.h=O.h);break;case"str":z.t="s",z.v=z.v!=null?ur(z.v):"",u.cellHTML&&(z.h=bg(z.v));break;case"inlineStr":v=D.match(n),z.t="s",v!=null&&(O=Pg(v[1]))?(z.v=O.t,u.cellHTML&&(z.h=O.h)):z.v="";break;case"b":z.v=mr(z.v);break;case"d":u.cellDates?z.v=un(z.v,1):(z.v=Gn(un(z.v,1)),z.t="n");break;case"e":(!u||u.cellText!==!1)&&(z.w=z.v),z.v=s3[z.v];break}if(N=M=0,he=null,K&&I.s!==void 0&&(he=d.CellXf[I.s],he!=null&&(he.numFmtId!=null&&(N=he.numFmtId),u.cellStyles&&he.fillId!=null&&(M=he.fillId))),M3(z,N,M,u,p,d),u.cellDates&&K&&z.t=="n"&&Wc(Ft[N])&&(z.t="d",z.v=Qd(z.v)),I.cm&&u.xlmeta){var we=(u.xlmeta.Cell||[])[+I.cm-1];we&&we.type=="XLDAPR"&&(z.D=!0)}if(ie){var X=Hn(I.r);c[X.r]||(c[X.r]=[]),c[X.r][X.c]=z}else c[I.r]=z}}}}q.length>0&&(c["!rows"]=q)}}();function JP(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var QP=pl;function ZP(){}function eI(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=bT(e),r}function tI(e){var t=Ya(e);return[t]}function rI(e){var t=dl(e);return[t]}function nI(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"b"]}function aI(e){var t=dl(e),r=e.read_shift(1);return[t,r,"b"]}function iI(e){var t=Ya(e),r=e.read_shift(1);return[t,r,"e"]}function sI(e){var t=dl(e),r=e.read_shift(1);return[t,r,"e"]}function oI(e){var t=Ya(e),r=e.read_shift(4);return[t,r,"s"]}function lI(e){var t=dl(e),r=e.read_shift(4);return[t,r,"s"]}function cI(e){var t=Ya(e),r=Fn(e);return[t,r,"n"]}function U3(e){var t=dl(e),r=Fn(e);return[t,r,"n"]}function uI(e){var t=Ya(e),r=Cg(e);return[t,r,"n"]}function fI(e){var t=dl(e),r=Cg(e);return[t,r,"n"]}function hI(e){var t=Ya(e),r=Ng(e);return[t,r,"is"]}function dI(e){var t=Ya(e),r=jn(e);return[t,r,"str"]}function pI(e){var t=dl(e),r=jn(e);return[t,r,"str"]}function mI(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=t1(e,n-e.l,r);s[3]=Cn(o,null,a,r.supbooks,r)}else e.l=n;return s}function gI(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=t1(e,n-e.l,r);s[3]=Cn(o,null,a,r.supbooks,r)}else e.l=n;return s}function xI(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=Fn(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=t1(e,n-e.l,r);s[3]=Cn(o,null,a,r.supbooks,r)}else e.l=n;return s}function vI(e,t,r){var n=e.l+t,a=Ya(e);a.r=r["!row"];var i=jn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=t1(e,n-e.l,r);s[3]=Cn(o,null,a,r.supbooks,r)}else e.l=n;return s}var yI=pl;function wI(e,t){var r=e.l+t,n=pl(e),a=Tg(e),i=jn(e),s=jn(e),o=jn(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function _I(){}function bI(e,t,r){var n=e.l+t,a=n3(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=NP(e,n-e.l,r);s[1]=o}else e.l=n;return s}function kI(e,t,r){var n=e.l+t,a=pl(e),i=[a];if(r.cellFormula){var s=CP(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}var SI=["left","right","top","bottom","header","footer"];function EI(e){var t={};return SI.forEach(function(r){t[r]=Fn(e)}),t}function AI(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function NI(){}function TI(){}function CI(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,d,y,x,S,v,k,_,j,D,z=[];o.biff=12,o["!row"]=0;var I=0,T=!1,L=[],O={},F=o.supbooks||a.supbooks||[[]];if(F.sharedf=O,F.arrayf=L,F.SheetNames=a.SheetNames||a.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=F,a.Names))for(var N=0;N<a.Names.length;++N)F[0][N+1]=a.Names[N];var M=[],K=[],he=!1;kd[16]={n:"BrtShortReal",f:U3};var le;if(bs(e,function(q,Z,oe){if(!p)switch(oe){case 148:c=q;break;case 0:d=q,o.sheetRows&&o.sheetRows<=d.r&&(p=!0),j=xn(S=d.r),o["!row"]=d.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=D0(q.hpt)),K[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:q[2]},q[2]){case"n":y.v=q[1];break;case"s":_=l0[q[1]],y.v=_.t,y.r=_.r;break;case"b":y.v=!!q[1];break;case"e":y.v=q[1],o.cellText!==!1&&(y.w=ml[y.v]);break;case"str":y.t="s",y.v=q[1];break;case"is":y.t="s",y.v=q[1].t;break}if((x=s.CellXf[q[0].iStyleRef])&&M3(y,x.numFmtId,null,o,i,s),v=q[0].c==-1?v+1:q[0].c,o.dense?(l[S]||(l[S]=[]),l[S][v]=y):l[Zr(v)+j]=y,o.cellFormula){for(T=!1,I=0;I<L.length;++I){var b=L[I];d.r>=b[0].s.r&&d.r<=b[0].e.r&&v>=b[0].s.c&&v<=b[0].e.c&&(y.F=zt(b[0]),T=!0)}!T&&q.length>3&&(y.f=q[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>v&&(u.s.c=v),u.e.r<d.r&&(u.e.r=d.r),u.e.c<v&&(u.e.c=v),o.cellDates&&x&&y.t=="n"&&Wc(Ft[x.numFmtId])){var A=Go(y.v);A&&(y.t="d",y.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}le&&(le.type=="XLDAPR"&&(y.D=!0),le=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;y={t:"z",v:void 0},v=q[0].c==-1?v+1:q[0].c,o.dense?(l[S]||(l[S]=[]),l[S][v]=y):l[Zr(v)+j]=y,u.s.r>d.r&&(u.s.r=d.r),u.s.c>v&&(u.s.c=v),u.e.r<d.r&&(u.e.r=d.r),u.e.c<v&&(u.e.c=v),le&&(le.type=="XLDAPR"&&(y.D=!0),le=void 0);break;case 176:z.push(q);break;case 49:le=((o.xlmeta||{}).Cell||[])[q-1];break;case 494:var C=n["!id"][q.relId];for(C?(q.Target=C.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=C):q.relId==""&&(q.Target="#"+q.loc),S=q.rfx.s.r;S<=q.rfx.e.r;++S)for(v=q.rfx.s.c;v<=q.rfx.e.c;++v)o.dense?(l[S]||(l[S]=[]),l[S][v]||(l[S][v]={t:"z",v:void 0}),l[S][v].l=q):(k=Tt({c:v,r:S}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=q);break;case 426:if(!o.cellFormula)break;L.push(q),D=o.dense?l[S][v]:l[Zr(v)+j],D.f=Cn(q[1],u,{r:d.r,c:v},F,o),D.F=zt(q[0]);break;case 427:if(!o.cellFormula)break;O[Tt(q[0].s)]=q[1],D=o.dense?l[S][v]:l[Zr(v)+j],D.f=Cn(q[1],u,{r:d.r,c:v},F,o);break;case 60:if(!o.cellStyles)break;for(;q.e>=q.s;)M[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},he||(he=!0,Ig(q.w/256)),Dc(M[q.e+1]);break;case 161:l["!autofilter"]={ref:zt(q)};break;case 476:l["!margins"]=q;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),q.name&&(a.Sheets[r].CodeName=q.name),(q.above||q.left)&&(l["!outline"]={above:q.above,left:q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!Z.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+oe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=zt(c||u)),o.sheetRows&&l["!ref"]){var fe=Cr(l["!ref"]);o.sheetRows<=+fe.e.r&&(fe.e.r=o.sheetRows-1,fe.e.r>u.e.r&&(fe.e.r=u.e.r),fe.e.r<fe.s.r&&(fe.s.r=fe.e.r),fe.e.c>u.e.c&&(fe.e.c=u.e.c),fe.e.c<fe.s.c&&(fe.s.c=fe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=zt(fe))}return z.length>0&&(l["!merges"]=z),M.length>0&&(l["!cols"]=M),K.length>0&&(l["!rows"]=K),l}function LI(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Vt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function FI(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=LI(h);u.s.r=u.s.c=0,u.e.c=o,c=Zr(o),p[0].forEach(function(d,y){s[c+xn(y)]={t:"n",v:d,z:p[1]},l=y}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=zt(u)),s}function PI(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(B3);return o&&Rg(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function II(e,t){e.l+=10;var r=jn(e);return{name:r}}function jI(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return bs(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var z3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],RI=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],OI=[],DI=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function $5(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=mr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function q5(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=mr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function $3(e){q5(e.WBProps,z3),q5(e.CalcPr,DI),$5(e.WBView,RI),$5(e.Sheets,OI),bc.date1904=mr(e.WBProps.date1904)}var MI="][*?/\\".split("");function BI(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return MI.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var UI=/<\w+:workbook/;function zI(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Dn,function(l,c){var u=bt(l);switch(Hi(u[0])){case"<?xml":break;case"<workbook":l.match(UI)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":z3.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=mr(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=ur(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Vt(ur(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ur(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),mr(u.hidden||"0")&&(i.Hidden=!0),s=c+l.length;break;case"</definedName>":i.Ref=Vt(ur(e.slice(s,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),iT.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $3(r),r}function $I(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Gm(e),r.name=jn(e),r}function qI(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?jn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function HI(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function VI(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=kT(e),s=TP(e,0,r),o=Tg(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function WI(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],kd[16]={n:"BrtFRTArchID$",f:HI},bs(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Cn(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),$3(r),r.Names=i,r.supbooks=s,r}function GI(e,t,r){return t.slice(-4)===".bin"?WI(e,r):zI(e,r)}function KI(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?CI(e,n,r,a,i,s,o):$P(e,n,r,a,i,s,o)}function XI(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?jI(e,n,r,a,i):PI(e,n,r,a,i)}function YI(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?aF():iF()}function JI(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?rF():nF()}function QI(e,t,r,n){return t.slice(-4)===".bin"?y7(e,r,n):d7(e,r,n)}function ZI(e,t,r){return T3(e,r)}function ej(e,t,r){return t.slice(-4)===".bin"?RL(e,r):IL(e,r)}function tj(e,t,r){return t.slice(-4)===".bin"?Z7(e,r):K7(e,r)}function rj(e,t,r){return t.slice(-4)===".bin"?V7(e):q7(e)}function nj(e,t,r,n){return r.slice(-4)===".bin"?W7(e,t,r,n):void 0}function aj(e,t,r){return t.slice(-4)===".bin"?z7(e,t,r):$7(e,t,r)}var q3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,H3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function si(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var a=e.match(q3),i,s,o,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(H3),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function ij(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(q3),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(H3),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var u0;function sj(e,t){var r=u0[e]||Vt(e);return r==="General"?al(t):Xa(r,t)}function oj(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=un(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Vt(t)]=a}function lj(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ml[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=P0(e.v):e.w=al(e.v):e.w=sj(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=u0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Wc(n)){var a=Go(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function cj(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=o7[n.Pattern]||n.Pattern)}e[t.ID]=t}function uj(e,t,r,n,a,i,s,o,l,c){var u="General",h=n.StyleID,p={};c=c||{};var d=[],y=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&s&&(h=s.StyleID);i[h]!==void 0&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&d.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mr(e);break;case"String":n.t="s",n.r=f5(Vt(e)),n.v=e.indexOf("<")>-1?Vt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(un(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Vt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=s3[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=f5(t||e));break}if(lj(n,u,c),c.cellFormula!==!1)if(n.Formula){var x=Vt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=_c(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=_c("RC:RC",a):n.ArrayRange&&(n.F=_c(n.ArrayRange,a),l.push([Cr(n.F),n.F]))}else for(y=0;y<l.length;++y)a.r>=l[y][0].s.r&&a.r<=l[y][0].e.r&&a.c>=l[y][0].s.c&&a.c<=l[y][0].e.c&&(n.F=l[y][1]);c.cellStyles&&(d.forEach(function(S){!p.patternType&&S.patternType&&(p.patternType=S.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fj(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Tp(e,t){var r=t||{};F_();var n=Uu(kg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ur(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=gn(r);return s.type="string",R0.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Pe){a.indexOf("<"+Pe)>=0&&(i=!0)}),i)return wj(n,r);u0={"General Number":"General","General Date":Ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ft[15],"Short Date":Ft[14],"Long Time":Ft[19],"Medium Time":Ft[18],"Short Time":Ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ft[2],Standard:Ft[4],Percent:Ft[10],Scientific:Ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],p=r.dense?[]:{},d="",y={},x={},S=si('<Data ss:Type="String">'),v=0,k=0,_=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},z={},I="",T=0,L=[],O={},F={},N=0,M=[],K=[],he={},le=[],fe,ie=!1,q=[],Z=[],oe={},b=0,A=0,C={Sheets:[],WBProps:{date1904:!1}},R={};j0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var H="";o=j0.exec(n);)switch(o[3]=(H=o[3]).toLowerCase()){case"data":if(H=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?uj(n.slice(v,o.index),I,S,l[l.length-1][0]=="comment"?he:y,{c:k,r:_},D,le[k],x,q,r):(I="",S=si(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(K.length>0&&(y.c=K),(!r.sheetRows||r.sheetRows>_)&&y.v!==void 0&&(r.dense?(p[_]||(p[_]=[]),p[_][k]=y):p[Zr(k)+xn(_)]=y),y.HRef&&(y.l={Target:Vt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(b=k+(parseInt(y.MergeAcross,10)|0),A=_+(parseInt(y.MergeDown,10)|0),L.push({s:{c:k,r:_},e:{c:b,r:A}})),!r.sheetStubs)y.MergeAcross?k=b+1:++k;else if(y.MergeAcross||y.MergeDown){for(var re=k;re<=b;++re)for(var ae=_;ae<=A;++ae)(re>k||ae>_)&&(r.dense?(p[ae]||(p[ae]=[]),p[ae][re]={t:"z"}):p[Zr(re)+xn(ae)]={t:"z"});k=b+1}else++k;else y=ij(o[0]),y.Index&&(k=+y.Index-1),k<j.s.c&&(j.s.c=k),k>j.e.c&&(j.e.c=k),o[0].slice(-2)==="/>"&&++k,K=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<j.s.r&&(j.s.r=_),_>j.e.r&&(j.e.r=_),o[0].slice(-2)==="/>"&&(x=si(o[0]),x.Index&&(_=+x.Index-1)),k=0,++_):(x=si(o[0]),x.Index&&(_=+x.Index-1),oe={},(x.AutoFitHeight=="0"||x.Height)&&(oe.hpx=parseInt(x.Height,10),oe.hpt=N3(oe.hpx),Z[_]=oe),x.Hidden=="1"&&(oe.hidden=!0,Z[_]=oe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(d),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(p["!ref"]=zt(j),r.sheetRows&&r.sheetRows<=j.e.r&&(p["!fullref"]=p["!ref"],j.e.r=r.sheetRows-1,p["!ref"]=zt(j))),L.length&&(p["!merges"]=L),le.length>0&&(p["!cols"]=le),Z.length>0&&(p["!rows"]=Z),u[d]=p}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,l.push([o[3],!1]),c=si(o[0]),d=Vt(c.Name),p=r.dense?[]:{},L=[],q=[],Z=[],R={name:d,Hidden:0},C.Sheets.push(R);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),le=[],ie=!1}break;case"style":o[1]==="/"?cj(D,z,r):z=si(o[0]);break;case"numberformat":z.nf=Vt(si(o[0]).Format||"General"),u0[z.nf]&&(z.nf=u0[z.nf]);for(var ne=0;ne!=392&&Ft[ne]!=z.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(Ft[ne]==null){Yo(z.nf,ne);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(fe=si(o[0]),fe.Hidden&&(fe.hidden=!0,delete fe.Hidden),fe.Width&&(fe.wpx=parseInt(fe.Width,10)),!ie&&fe.wpx>10){ie=!0,qn=E3;for(var me=0;me<le.length;++me)le[me]&&Dc(le[me])}ie&&Dc(fe),le[fe.Index-1||le.length]=fe;for(var we=0;we<+fe.Span;++we)le[le.length]=gn(fe);break;case"namedrange":if(o[1]==="/")break;C.Names||(C.Names=[]);var X=bt(o[0]),Ie={Name:X.Name,Ref:_c(X.RefersTo.slice(1),{r:0,c:0})};C.Sheets.length>0&&(Ie.Sheet=C.Sheets.length-1),C.Names.push(Ie);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?I+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;z.Interior=si(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?KT(O,H,n.slice(N,o.index)):N=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));fj(he),K.push(he)}else l.push([o[3],!1]),c=si(o[0]),he={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Se=si(o[0]);p["!autofilter"]={ref:_c(Se.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return X5(n,r);var _e=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:_e=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:_e=!1}break;case"excelworkbook":switch(o[3]){case"date1904":C.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:_e=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:_e=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(N,o.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else N=o.index+o[0].length;break;case"header":p["!margins"]||c0(p["!margins"]={},"xlml"),isNaN(+bt(o[0]).Margin)||(p["!margins"].header=+bt(o[0]).Margin);break;case"footer":p["!margins"]||c0(p["!margins"]={},"xlml"),isNaN(+bt(o[0]).Margin)||(p["!margins"].footer=+bt(o[0]).Margin);break;case"pagemargins":var Q=bt(o[0]);p["!margins"]||c0(p["!margins"]={},"xlml"),isNaN(+Q.Top)||(p["!margins"].top=+Q.Top),isNaN(+Q.Left)||(p["!margins"].left=+Q.Left),isNaN(+Q.Right)||(p["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(p["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":C.Views||(C.Views=[]),C.Views[0]||(C.Views[0]={}),C.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:_e=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:_e=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:_e=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:_e=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:_e=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:_e=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:_e=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:_e=!1}break;case"smarttags":break;default:_e=!1;break}if(_e||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?oj(F,H,M,n.slice(N,o.index)):(M=o,N=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Oe={};return!r.bookSheets&&!r.bookProps&&(Oe.Sheets=u),Oe.SheetNames=h,Oe.Workbook=C,Oe.SSF=gn(Ft),Oe.Props=O,Oe.Custprops=F,Oe}function Jm(e,t){switch(Mg(t=t||{}),t.type||"base64"){case"base64":return Tp(Na(e),t);case"binary":case"buffer":case"file":return Tp(e,t);case"array":return Tp(hl(e),t)}}function hj(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=AT(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=NT(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var dj=[60,1084,2066,2165,2175];function pj(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=us(r,r.l),c=Qm[l],u=0;c!=null&&dj.indexOf(l)>-1;)i=us(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=Qm[l=us(r,r.l)];var h=Js(s);pn(h,0);var p=0;h.lens=[];for(var d=0;d<s.length;++d)h.lens.push(p),p+=s[d].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function Pi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ft[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ml[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=P0(e.v):e.w=al(e.v):e.w=Xa(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Wc(Ft[n]||String(n))){var a=Go(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function xh(e,t,r){return{v:e,ixfe:t,t:r}}function mj(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,l=[],c="",u={},h,p="",d,y,x,S,v={},k=[],_,j,D=[],z=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},L=function(Ze){return Ze<8?Jo[Ze]:Ze<64&&z[Ze-8]||Jo[Ze]},O=function(Ze,He,It){var pt=He.XF.data;if(!(!pt||!pt.patternType||!It||!It.cellStyles)){He.s={},He.s.patternType=pt.patternType;var br;(br=O0(L(pt.icvFore)))&&(He.s.fgColor={rgb:br}),(br=O0(L(pt.icvBack)))&&(He.s.bgColor={rgb:br})}},F=function(Ze,He,It){if(!(oe>1)&&!(It.sheetRows&&Ze.r>=It.sheetRows)){if(It.cellStyles&&He.XF&&He.XF.data&&O(Ze,He,It),delete He.ixfe,delete He.XF,h=Ze,p=Tt(Ze),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<s.s.r&&(s.s.r=Ze.r),Ze.c<s.s.c&&(s.s.c=Ze.c),Ze.r+1>s.e.r&&(s.e.r=Ze.r+1),Ze.c+1>s.e.c&&(s.e.c=Ze.c+1),It.cellFormula&&He.f){for(var pt=0;pt<k.length;++pt)if(!(k[pt][0].s.c>Ze.c||k[pt][0].s.r>Ze.r)&&!(k[pt][0].e.c<Ze.c||k[pt][0].e.r<Ze.r)){He.F=zt(k[pt][0]),(k[pt][0].s.c!=Ze.c||k[pt][0].s.r!=Ze.r)&&delete He.f,He.f&&(He.f=""+Cn(k[pt][1],s,Ze,q,N));break}}It.dense?(a[Ze.r]||(a[Ze.r]=[]),a[Ze.r][Ze.c]=He):a[p]=He}},N={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(N.password=t.password);var M,K=[],he=[],le=[],fe=[],ie=!1,q=[];q.SheetNames=N.snames,q.sharedf=N.sharedf,q.arrayf=N.arrayf,q.names=[],q.XTI=[];var Z=0,oe=0,b=0,A=[],C=[],R;N.codepage=1200,gi(1200);for(var H=!1;e.l<e.length-1;){var re=e.l,ae=e.read_shift(2);if(ae===0&&Z===10)break;var ne=e.l===e.length?0:e.read_shift(2),me=Qm[ae];if(me&&me.f){if(t.bookSheets&&Z===133&&ae!==133)break;if(Z=ae,me.r===2||me.r==12){var we=e.read_shift(2);if(ne-=2,!N.enc&&we!==ae&&((we&255)<<8|we>>8)!==ae)throw new Error("rt mismatch: "+we+"!="+ae);me.r==12&&(e.l+=10,ne-=10)}var X={};if(ae===10?X=me.f(e,ne,N):X=pj(ae,me,e,ne,N),oe==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(ae){case 34:r.opts.Date1904=I.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(e.l=0),N.enc=X,!t.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=X;break;case 66:var Ie=Number(X);switch(Ie){case 21010:Ie=1200;break;case 32768:Ie=1e4;break;case 32769:Ie=1252;break}gi(N.codepage=Ie),H=!0;break;case 317:N.rrtabid=X;break;case 25:N.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:N.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(a["!type"]="dialog"),X.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),X.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:D.push(X);break;case 430:q.push([X]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(X);break;case 24:case 536:R={Name:X.Name,Ref:Cn(X.rgce,s,null,q,N)},X.itab>0&&(R.Sheet=X.itab-1),q.names.push(R),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(C[X.itab-1]={ref:zt(X.rgce[0][0][1][2])});break;case 22:N.ExternCount=X;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(X),q.XTI=q.XTI.concat(X);break;case 2196:if(N.biff<8)break;R!=null&&(R.Comment=X[1]);break;case 18:a["!protect"]=X;break;case 19:X!==0&&N.WTF&&console.error("Password verifier: "+X);break;case 133:i[X.pos]=X,N.snames.push(X.name);break;case 10:{if(--oe)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=zt(s),t.sheetRows&&t.sheetRows<=s.e.r){var Se=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=zt(s),s.e.r=Se}s.e.r++,s.e.c++}K.length>0&&(a["!merges"]=K),he.length>0&&(a["!objects"]=he),le.length>0&&(a["!cols"]=le),fe.length>0&&(a["!rows"]=fe),I.Sheets.push(T)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),N.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(N.biff=5,H=!0,gi(N.codepage=28591)),N.biff==8&&X.BIFFVer==0&&X.dt==16&&(N.biff=2),oe++)break;if(a=t.dense?[]:{},N.biff<8&&!H&&(H=!0,gi(N.codepage=t.codepage||1252)),N.biff<5||X.BIFFVer==0&&X.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var _e={pos:e.l-ne,name:c};i[_e.pos]=_e,N.snames.push(c)}else c=(i[re]||{name:""}).name;X.dt==32&&(a["!type"]="chart"),X.dt==64&&(a["!type"]="macro"),K=[],he=[],N.arrayf=k=[],le=[],fe=[],ie=!1,T={Hidden:(i[re]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[X.r]||[])[X.c]:a[Tt({c:X.c,r:X.r})])&&++X.c,_={ixfe:X.ixfe,XF:D[X.ixfe]||{},v:X.val,t:"n"},b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:X.c,r:X.r},_,t);break;case 5:case 517:_={ixfe:X.ixfe,XF:D[X.ixfe],v:X.val,t:X.t},b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:X.c,r:X.r},_,t);break;case 638:_={ixfe:X.ixfe,XF:D[X.ixfe],v:X.rknum,t:"n"},b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:X.c,r:X.r},_,t);break;case 189:for(var Q=X.c;Q<=X.C;++Q){var Oe=X.rkrec[Q-X.c][0];_={ixfe:Oe,XF:D[Oe],v:X.rkrec[Q-X.c][1],t:"n"},b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:Q,r:X.r},_,t)}break;case 6:case 518:case 1030:{if(X.val=="String"){o=X;break}if(_=xh(X.val,X.cell.ixfe,X.tt),_.XF=D[_.ixfe],t.cellFormula){var Pe=X.formula;if(Pe&&Pe[0]&&Pe[0][0]&&Pe[0][0][0]=="PtgExp"){var De=Pe[0][0][1][0],qe=Pe[0][0][1][1],Ke=Tt({r:De,c:qe});v[Ke]?_.f=""+Cn(X.formula,s,X.cell,q,N):_.F=((t.dense?(a[De]||[])[qe]:a[Ke])||{}).F}else _.f=""+Cn(X.formula,s,X.cell,q,N)}b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F(X.cell,_,t),o=X}break;case 7:case 519:if(o)o.val=X,_=xh(X,o.cell.ixfe,"s"),_.XF=D[_.ixfe],t.cellFormula&&(_.f=""+Cn(o.formula,s,o.cell,q,N)),b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(X);var Ge=Tt(X[0].s);if(d=t.dense?(a[X[0].s.r]||[])[X[0].s.c]:a[Ge],t.cellFormula&&d){if(!o||!Ge||!d)break;d.f=""+Cn(X[1],s,X[0],q,N),d.F=zt(X[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;v[Tt(o.cell)]=X[0],d=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Tt(o.cell)],(d||{}).f=""+Cn(X[0],s,h,q,N)}}break;case 253:_=xh(l[X.isst].t,X.ixfe,"s"),l[X.isst].h&&(_.h=l[X.isst].h),_.XF=D[_.ixfe],b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:X.c,r:X.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:X.ixfe,XF:D[X.ixfe],t:"z"},b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:X.c,r:X.r},_,t));break;case 190:if(t.sheetStubs)for(var st=X.c;st<=X.C;++st){var rt=X.ixfe[st-X.c];_={ixfe:rt,XF:D[rt],t:"z"},b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:st,r:X.r},_,t)}break;case 214:case 516:case 4:_=xh(X.val,X.ixfe,"s"),_.XF=D[_.ixfe],b>0&&(_.z=A[_.ixfe>>8&63]),Pi(_,t,r.opts.Date1904),F({c:X.c,r:X.r},_,t);break;case 0:case 512:oe===1&&(s=X);break;case 252:l=X;break;case 1054:if(N.biff==4){A[b++]=X[1];for(var ft=0;ft<b+163&&Ft[ft]!=X[1];++ft);ft>=163&&Yo(X[1],b+163)}else Yo(X[1],X[0]);break;case 30:{A[b++]=X;for(var lt=0;lt<b+163&&Ft[lt]!=X;++lt);lt>=163&&Yo(X,b+163)}break;case 229:K=K.concat(X);break;case 93:he[X.cmo[0]]=N.lastobj=X;break;case 438:N.lastobj.TxO=X;break;case 127:N.lastobj.ImData=X;break;case 440:for(S=X[0].s.r;S<=X[0].e.r;++S)for(x=X[0].s.c;x<=X[0].e.c;++x)d=t.dense?(a[S]||[])[x]:a[Tt({c:x,r:S})],d&&(d.l=X[1]);break;case 2048:for(S=X[0].s.r;S<=X[0].e.r;++S)for(x=X[0].s.c;x<=X[0].e.c;++x)d=t.dense?(a[S]||[])[x]:a[Tt({c:x,r:S})],d&&d.l&&(d.l.Tooltip=X[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;d=t.dense?(a[X[0].r]||[])[X[0].c]:a[Tt(X[0])];var gt=he[X[2]];d||(t.dense?(a[X[0].r]||(a[X[0].r]=[]),d=a[X[0].r][X[0].c]={t:"z"}):d=a[Tt(X[0])]={t:"z"},s.e.r=Math.max(s.e.r,X[0].r),s.s.r=Math.min(s.s.r,X[0].r),s.e.c=Math.max(s.e.c,X[0].c),s.s.c=Math.min(s.s.c,X[0].c)),d.c||(d.c=[]),y={a:X[1],t:gt.TxO.t},d.c.push(y)}break;case 2173:D7(D[X.ixfe],X.ext);break;case 125:{if(!N.cellStyles)break;for(;X.e>=X.s;)le[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},ie||(ie=!0,Ig(X.w/256)),Dc(le[X.e+1])}break;case 520:{var xt={};X.level!=null&&(fe[X.r]=xt,xt.level=X.level),X.hidden&&(fe[X.r]=xt,xt.hidden=!0),X.hpt&&(fe[X.r]=xt,xt.hpt=X.hpt,xt.hpx=D0(X.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||c0(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=X;break;case 161:a["!margins"]||c0(a["!margins"]={}),a["!margins"].header=X.header,a["!margins"].footer=X.footer;break;case 574:X.RTL&&(I.Views[0].RTL=!0);break;case 146:z=X;break;case 2198:M=X;break;case 140:j=X;break;case 442:c?T.CodeName=X||T.name:I.WBProps.CodeName=X||"ThisWorkbook";break}}else me||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=ne}return r.SheetNames=$i(i).sort(function(ht,Ze){return Number(ht)-Number(Ze)}).map(function(ht){return i[ht].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&C.forEach(function(ht,Ze){r.Sheets[r.SheetNames[Ze]]["!autofilter"]=ht}),r.Strings=l,r.SSF=gn(Ft),N.enc&&(r.Encryption=N.enc),M&&(r.Themes=M),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),q.names.length>0&&(I.Names=q.names),r.Workbook=I,r}var H5={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gj(e,t,r){var n=Ut.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=N5(n,IT,H5.DSI);for(var i in a)t[i]=a[i]}catch(c){if(r.WTF)throw c}var s=Ut.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=N5(s,jT,H5.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(l3(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function V3(e,t){t||(t={}),Mg(t),y_(),t.codepage&&gg(t.codepage);var r,n;if(e.FullPaths){if(Ut.find(e,"/encryption"))throw new Error("File is password-protected");r=Ut.find(e,"!CompObj"),n=Ut.find(e,"/Workbook")||Ut.find(e,"/Book")}else{switch(t.type){case"base64":e=mi(Na(e));break;case"binary":e=mi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}pn(e,0),n={content:e}}var a,i;if(r&&hj(r),t.bookProps&&!t.bookSheets)a={};else{var s=Mt?"buffer":"array";if(n&&n.content)a=mj(n.content,t);else if((i=Ut.find(e,"PerfectOffice_MAIN"))&&i.content)a=o0.to_workbook(i.content,(t.type=s,t));else if((i=Ut.find(e,"NativeContent_MAIN"))&&i.content)a=o0.to_workbook(i.content,(t.type=s,t));else throw(i=Ut.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ut.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=tF(e))}var o={};return e.FullPaths&&gj(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var kd={0:{f:JP},1:{f:tI},2:{f:uI},3:{f:iI},4:{f:nI},5:{f:cI},6:{f:dI},7:{f:oI},8:{f:vI},9:{f:xI},10:{f:mI},11:{f:gI},12:{f:rI},13:{f:fI},14:{f:sI},15:{f:aI},16:{f:U3},17:{f:pI},18:{f:lI},19:{f:Ng},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VI},40:{},42:{},43:{f:m7},44:{f:p7},45:{f:g7},46:{f:v7},47:{f:x7},48:{},49:{f:yT},50:{},51:{f:B7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:w3},62:{f:hI},63:{f:H7},64:{f:NI},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:On,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:AI},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:eI},148:{f:QP,p:16},151:{f:_I},152:{},153:{f:qI},154:{},155:{},156:{f:$I},157:{},158:{},159:{T:1,f:jL},160:{T:-1},161:{T:1,f:pl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:M7},336:{T:-1},337:{f:U7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Gm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:y3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bI},427:{f:kI},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:EI},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ZP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wI},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Gm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Q7},633:{T:1},634:{T:-1},635:{T:1,f:J7},636:{T:-1},637:{f:_T},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:II},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:TI},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Qm={6:{f:Ap},10:{f:Ms},12:{f:Vr},13:{f:Vr},14:{f:jr},15:{f:jr},16:{f:Fn},17:{f:jr},18:{f:jr},19:{f:Vr},20:{f:F5},21:{f:F5},23:{f:y3},24:{f:I5},25:{f:jr},26:{},27:{},28:{f:XC},29:{},34:{f:jr},35:{f:P5},38:{f:Fn},39:{f:Fn},40:{f:Fn},41:{f:Fn},42:{f:jr},43:{f:jr},47:{f:ZL},49:{f:LC},51:{f:Vr},60:{},61:{f:NC},64:{f:jr},65:{f:CC},66:{f:Vr},77:{},80:{},81:{},82:{},85:{f:Vr},89:{},90:{},91:{},92:{f:yC},93:{f:JC},94:{},95:{f:jr},96:{},97:{},99:{f:jr},125:{f:w3},128:{f:UC},129:{f:wC},130:{f:Vr},131:{f:jr},132:{f:jr},133:{f:_C},134:{},140:{f:nL},141:{f:Vr},144:{},146:{f:iL},151:{},152:{},153:{},154:{},155:{},156:{f:Vr},157:{},158:{},160:{f:uL},161:{f:oL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:OC},190:{f:DC},193:{f:Ms},197:{},198:{},199:{},200:{},201:{},202:{f:jr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Vr},220:{},221:{f:jr},222:{},224:{f:BC},225:{f:vC},226:{f:Ms},227:{},229:{f:YC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:bC},253:{f:FC},255:{f:kC},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:d3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jr},353:{f:Ms},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$C},431:{f:jr},432:{},433:{},434:{},437:{},438:{f:eL},439:{f:jr},440:{f:tL},441:{},442:{f:Y0},443:{},444:{f:Vr},445:{},446:{},448:{f:Ms},449:{f:AC,r:2},450:{f:Ms},512:{f:C5},513:{f:cL},515:{f:zC},516:{f:PC},517:{f:L5},519:{f:fL},520:{f:SC},523:{},545:{f:j5},549:{f:T5},566:{},574:{f:TC},638:{f:RC},659:{},1048:{},1054:{f:IC},1084:{},1212:{f:WC},2048:{f:rL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ph},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ms},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sL,r:12},2173:{f:O7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:VC,r:12},2197:{},2198:{f:L7,r:12},2199:{},2200:{},2201:{},2202:{f:GC,r:12},2203:{f:Ms},2204:{},2205:{},2206:{},2207:{},2211:{f:EC},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Vr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:lL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:aL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:C5},1:{},2:{f:mL},3:{f:pL},4:{f:dL},5:{f:L5},7:{f:gL},8:{},9:{f:ph},11:{},22:{f:Vr},30:{f:jC},31:{},32:{},33:{f:j5},36:{},37:{f:T5},50:{f:xL},62:{},52:{},67:{},68:{f:Vr},69:{},86:{},126:{},127:{f:hL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vL},223:{},234:{},354:{},421:{},518:{f:Ap},521:{f:ph},536:{f:I5},547:{f:P5},561:{},579:{},1030:{f:Ap},1033:{f:ph},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function oi(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&e3(r)&&e.push(r)}}function V5(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=$N(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,p=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(s=0;s<l.length;++s){var x=l[s].trim(),S=x.slice(0,3).toLowerCase();if(S=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(S!="<td"&&S!="<th")){var v=x.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var k=v[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,j=0;_.charAt(0)=="<"&&(j=_.indexOf(">"))>-1;)_=_.slice(j+1);for(var D=0;D<y.length;++D){var z=y[D];z.s.c==u&&z.s.r<c&&c<=z.e.r&&(u=z.e.c+1,D=-1)}var I=bt(k.slice(0,k.indexOf(">")));p=I.colspan?+I.colspan:1,((h=+I.rowspan)>1||p>1)&&y.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+p-1}});var T=I.t||I["data-t"]||"";if(!_.length){u+=p;continue}if(_=z_(_),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!_.length){u+=p;continue}var L={t:"s",v:_};r.raw||!_.trim().length||T=="s"||(_==="TRUE"?L={t:"b",v:!0}:_==="FALSE"?L={t:"b",v:!1}:isNaN(wi(_))?isNaN(Oc(_).getDate())||(L={t:"d",v:un(_)},r.cellDates||(L={t:"n",v:Gn(L.v)}),L.z=r.dateNF||Ft[14]):L={t:"n",v:wi(_)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=L):n[Tt({r:c,c:u})]=L,u+=p}}}}return n["!ref"]=zt(d),y.length&&(n["!merges"]=y),n}function xj(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Tt({r,c:s}),h=n.dense?(e[r]||[])[s]:e[u],p=h&&h.v!=null&&(h.h||bg(h.w||(ys(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),d.id=(n.id||"sjs")+"-"+u,i.push(nT("td",p,d))}}var y="<tr>";return y+i.join("")+"</tr>"}var vj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',yj="</body></html>";function wj(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Eo(V5(r[0],t),t);var n=Ug();return r.forEach(function(a,i){zg(n,V5(a,t),"Sheet"+(i+1))}),n}function _j(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function bj(e,t){var r=t||{},n=r.header!=null?r.header:vj,a=r.footer!=null?r.footer:yj,i=[n],s=Gc(e["!ref"]);r.dense=Array.isArray(e),i.push(_j(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(xj(e,s,o,r));return i.push("</table>"+a),i.join("")}function W3(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Hn(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Gc(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var h=[],p=0,d=e["!rows"]||(e["!rows"]=[]),y=0,x=0,S=0,v=0,k=0,_=0;for(e["!cols"]||(e["!cols"]=[]);y<o.length&&x<l;++y){var j=o[y];if(W5(j)){if(n.display)continue;d[x]={hidden:!0}}var D=j.children;for(S=v=0;S<D.length;++S){var z=D[S];if(!(n.display&&W5(z))){var I=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):z_(z.innerHTML),T=z.getAttribute("data-z")||z.getAttribute("z");for(p=0;p<h.length;++p){var L=h[p];L.s.c==v+i&&L.s.r<x+a&&x+a<=L.e.r&&(v=L.e.c+1-i,p=-1)}_=+z.getAttribute("colspan")||1,((k=+z.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:x+a,c:v+i},e:{r:x+a+(k||1)-1,c:v+i+(_||1)-1}});var O={t:"s",v:I},F=z.getAttribute("data-t")||z.getAttribute("t")||"";I!=null&&(I.length==0?O.t=F||"z":n.raw||I.trim().length==0||F=="s"||(I==="TRUE"?O={t:"b",v:!0}:I==="FALSE"?O={t:"b",v:!1}:isNaN(wi(I))?isNaN(Oc(I).getDate())||(O={t:"d",v:un(I)},n.cellDates||(O={t:"n",v:Gn(O.v)}),O.z=n.dateNF||Ft[14]):O={t:"n",v:wi(I)})),O.z===void 0&&T!=null&&(O.z=T);var N="",M=z.getElementsByTagName("A");if(M&&M.length)for(var K=0;K<M.length&&!(M[K].hasAttribute("href")&&(N=M[K].getAttribute("href"),N.charAt(0)!="#"));++K);N&&N.charAt(0)!="#"&&(O.l={Target:N}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][v+i]=O):e[Tt({c:v+i,r:x+a})]=O,c.e.c<v+i&&(c.e.c=v+i),v+=_}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+a),e["!ref"]=zt(c),x>=l&&(e["!fullref"]=zt((c.e.r=o.length-y+x-1+a,c))),e}function G3(e,t){var r=t||{},n=r.dense?[]:{};return W3(n,e,t)}function kj(e,t){return Eo(G3(e,t),t)}function W5(e){var t="",r=Sj(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Sj(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Ej(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Vt(t.replace(/<[^>]*>/g,""));return[r]}var G5={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function K3(e,t){var r=t||{},n=kg(e),a=[],i,s,o={name:""},l="",c=0,u,h,p={},d=[],y=r.dense?[]:{},x,S,v={value:""},k="",_=0,j=[],D=-1,z=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,L={},O=[],F={},N=0,M=0,K=[],he=1,le=1,fe=[],ie={Names:[]},q={},Z=["",""],oe=[],b={},A="",C=0,R=!1,H=!1,re=0;for(j0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=j0.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(I.e.c>=I.s.c&&I.e.r>=I.s.r?y["!ref"]=zt(I):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=I.e.r&&(y["!fullref"]=y["!ref"],I.e.r=r.sheetRows-1,y["!ref"]=zt(I)),O.length&&(y["!merges"]=O),K.length&&(y["!rows"]=K),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),p[u.name]=y,H=!1):x[0].charAt(x[0].length-2)!=="/"&&(u=bt(x[0],!1),D=z=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,y=r.dense?[]:{},O=[],K=[],H=!0);break;case"table-row-group":x[1]==="/"?--T:++T;break;case"table-row":case"":if(x[1]==="/"){D+=he,he=1;break}if(h=bt(x[0],!1),h.?D=h.-1:D==-1&&(D=0),he=+h["number-rows-repeated"]||1,he<10)for(re=0;re<he;++re)T>0&&(K[D+re]={level:T});z=-1;break;case"covered-table-cell":x[1]!=="/"&&++z,r.sheetStubs&&(r.dense?(y[D]||(y[D]=[]),y[D][z]={t:"z"}):y[Tt({r:D,c:z})]={t:"z"}),k="",j=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++z,v=bt(x[0],!1),le=parseInt(v["number-columns-repeated"]||"1",10),S={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(S.f=z5(Vt(v.formula))),(v.||v["value-type"])=="string"&&(S.t="s",S.v=Vt(v["string-value"]||""),r.dense?(y[D]||(y[D]=[]),y[D][z]=S):y[Tt({r:D,c:z})]=S),z+=le-1;else if(x[1]!=="/"){++z,k="",_=0,j=[],le=1;var ae=he?D+he-1:D;if(z>I.e.c&&(I.e.c=z),z<I.s.c&&(I.s.c=z),D<I.s.r&&(I.s.r=D),ae>I.e.r&&(I.e.r=ae),v=bt(x[0],!1),oe=[],b={},S={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Vt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(N=parseInt(v["number-matrix-rows-spanned"],10)||0,M=parseInt(v["number-matrix-columns-spanned"],10)||0,F={s:{r:D,c:z},e:{r:D+N-1,c:z+M-1}},S.F=zt(F),fe.push([F,S.F])),v.formula)S.f=z5(v.formula);else for(re=0;re<fe.length;++re)D>=fe[re][0].s.r&&D<=fe[re][0].e.r&&z>=fe[re][0].s.c&&z<=fe[re][0].e.c&&(S.F=fe[re][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(N=parseInt(v["number-rows-spanned"],10)||0,M=parseInt(v["number-columns-spanned"],10)||0,F={s:{r:D,c:z},e:{r:D+N-1,c:z+M-1}},O.push(F)),v["number-columns-repeated"]&&(le=parseInt(v["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=mr(v["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(v.value);break;case"percentage":S.t="n",S.v=parseFloat(v.value);break;case"currency":S.t="n",S.v=parseFloat(v.value);break;case"date":S.t="d",S.v=un(v["date-value"]),r.cellDates||(S.t="n",S.v=Gn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=BN(v["time-value"])/86400,r.cellDates&&(S.t="d",S.v=Qd(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(v.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",v["string-value"]!=null&&(k=Vt(v["string-value"]),j=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(R=!1,S.t==="s"&&(S.v=k||"",j.length&&(S.R=j),R=_==0),q.Target&&(S.l=q),oe.length>0&&(S.c=oe,oe=[]),k&&r.cellText!==!1&&(S.w=k),R&&(S.t="z",delete S.v),(!R||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var ne=0;ne<he;++ne){if(le=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(y[D+ne]||(y[D+ne]=[]),y[D+ne][z]=ne==0?S:gn(S);--le>0;)y[D+ne][z+le]=gn(S);else for(y[Tt({r:D+ne,c:z})]=S;--le>0;)y[Tt({r:D+ne,c:z+le})]=gn(S);I.e.c<=z&&(I.e.c=z)}le=parseInt(v["number-columns-repeated"]||"1",10),z+=le-1,le=0,S={},k="",j=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i;b.t=k,j.length&&(b.R=j),b.a=A,oe.push(b)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);A="",C=0,k="",_=0,j=[];break;case"creator":x[1]==="/"?A=n.slice(C,x.index):C=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);k="",_=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(L[o.name]=l,(i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=bt(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=bt(x[0],!1),l+=G5[x[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=bt(x[0],!1),l+=G5[x[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":s=bt(x[0],!1),Z=Np(s["cell-range-address"]);var me={Name:s.name,Ref:Z[0]+"!"+Z[1]};H&&(me.Sheet=d.length),ie.Names.push(me);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!v||!v["string-value"])){var we=Ej(n.slice(_,x.index));k=(k.length>0?k+`
`:"")+we[0]}else bt(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Z=Np(bt(x[0])["target-range-address"]),p[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(q=bt(x[0],!1),!q.href)break;q.Target=Vt(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(Z=Np(q.Target.slice(1)),q.Target="#"+Z[0]+"!"+Z[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var X={Sheets:p,SheetNames:d,Workbook:ie};return r.bookSheets&&delete X.Sheets,X}function K5(e,t){t=t||{},$a(e,"META-INF/manifest.xml")&&zT(Hr(e,"META-INF/manifest.xml"),t);var r=_a(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=K3(ur(r),t);return $a(e,"meta.xml")&&(n.Props=o3(Hr(e,"meta.xml"))),n}function X5(e,t){return K3(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Og(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ur(hl(e))}function e2(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Y5(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Aj(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function M0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function en(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function In(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=M0(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=M0(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Dg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Nj(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=M0(e,n),i=In(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:en(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=In(o.data),c=en(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=en(i[3][0].data)>>>0>0),r.push(s)}return r}function Tj(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=M0(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[e2(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=e2(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Cj(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Tj(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return e2(t)}function Lj(e,t,r,n){var a=Og(e),i=a.getUint32(4,!0),s=(n>1?12:8)+Y5(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=Y5(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(c=a.getFloat64(s,!0),s+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function Fj(e,t,r){var n=Og(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=Aj(e,i),i+=16),a&2&&(c=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(s>-1)h={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return h}function Pj(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Lj(e,t,r,e[0]);case 5:return Fj(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function po(e){var t=In(e);return M0(t[1][0].data)}function J5(e,t){var r=In(t.data),n=en(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=In(s.data),l=en(o[1][0].data)>>>0;switch(n){case 1:i[l]=Zm(o[3][0].data);break;case 8:{var c=e[po(o[9][0].data)][0],u=In(c.data),h=e[po(u[1][0].data)][0],p=en(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var d=In(h.data);i[l]=d[3].map(function(y){return Zm(y.data)}).join("")}break}}),i}function Ij(e,t){var r,n,a,i,s,o,l,c,u,h,p,d,y,x,S=In(e),v=en(S[1][0].data)>>>0,k=en(S[2][0].data)>>>0,_=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&en(S[8][0].data)>0||!1,j,D;if((i=(a=S[7])==null?void 0:a[0])!=null&&i.data&&t!=0)j=(o=(s=S[7])==null?void 0:s[0])==null?void 0:o.data,D=(c=(l=S[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=S[4])==null?void 0:u[0])!=null&&h.data&&t!=1)j=(d=(p=S[4])==null?void 0:p[0])==null?void 0:d.data,D=(x=(y=S[3])==null?void 0:y[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var z=_?4:1,I=Og(j),T=[],L=0;L<j.length/2;++L){var O=I.getUint16(L*2,!0);O<65535&&T.push([L,O])}if(T.length!=k)throw"Expected ".concat(k," cells, found ").concat(T.length);var F=[];for(L=0;L<T.length-1;++L)F[T[L][0]]=D.subarray(T[L][1]*z,T[L+1][1]*z);return T.length>=1&&(F[T[T.length-1][0]]=D.subarray(T[T.length-1][1]*z)),{R:v,cells:F}}function jj(e,t){var r,n=In(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?en(n[7][0].data)>>>0>0?1:0:-1,i=Dg(n[5],function(s){return Ij(s,a)});return{nrows:en(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function Rj(e,t,r){var n,a=In(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(en(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(en(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=zt(i);var s=In(a[4][0].data),o=J5(e,e[po(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?J5(e,e[po(s[17][0].data)][0]):[],c=In(s[3][0].data),u=0;c[1].forEach(function(h){var p=In(h.data),d=e[po(p[2][0].data)][0],y=en(d.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var x=jj(e,d);x.data.forEach(function(S,v){S.forEach(function(k,_){var j=Tt({r:u+v,c:_}),D=Pj(k,o,l);D&&(r[j]=D)})}),u+=x.nrows})}function Oj(e,t){var r=In(t.data),n={"!ref":"A1"},a=e[po(r[2][0].data)],i=en(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Rj(e,a[0],n),n}function Dj(e,t){var r,n=In(t.data),a={name:(r=n[1])!=null&&r[0]?Zm(n[1][0].data):"",sheets:[]},i=Dg(n[2],po);return i.forEach(function(s){e[s].forEach(function(o){var l=en(o.meta[1][0].data);l==6e3&&a.sheets.push(Oj(e,o))})}),a}function Mj(e,t){var r=Ug(),n=In(t.data),a=Dg(n[1],po);if(a.forEach(function(i){e[i].forEach(function(s){var o=en(s.meta[1][0].data);if(o==2){var l=Dj(e,s);l.sheets.forEach(function(c,u){zg(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Cp(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Cj(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=Nj(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){i[h.id]=h.messages,s.push(h.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&en(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(l){i[l].forEach(function(c){var u=en(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Mj(i,o)}function Bj(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Mg(e){Bj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Uj(e){return fc.WS.indexOf(e)>-1?"sheet":e==fc.CS?"chart":e==fc.DS?"dialog":e==fc.MS?"macro":e&&e.length?e:"sheet"}function zj(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Uj(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function $j(e,t,r,n,a,i,s,o,l,c,u,h){try{i[n]=i0(_a(e,r,!0),t);var p=Hr(e,t),d;switch(o){case"sheet":d=KI(p,t,a,l,i[n],c,u,h);break;case"chart":if(d=XI(p,t,a,l,i[n],c,u,h),!d||!d["!drawel"])break;var y=$u(d["!drawel"].Target,t),x=Km(y),S=G7(_a(e,y,!0),i0(_a(e,x,!0),y)),v=$u(S,y),k=Km(v);d=FI(_a(e,v,!0),v,l,i0(_a(e,k,!0),v),c,d);break;case"macro":d=YI(p,t,a,l,i[n],c,u,h);break;case"dialog":d=JI(p,t,a,l,i[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=d;var _=[];i&&i[n]&&$i(i[n]).forEach(function(j){var D="";if(i[n][j].Type==fc.CMNT){D=$u(i[n][j].Target,t);var z=tj(Hr(e,D,!0),D,l);if(!z||!z.length)return;O5(d,z,!1)}i[n][j].Type==fc.TCMNT&&(D=$u(i[n][j].Target,t),_=_.concat(X7(Hr(e,D,!0),l)))}),_&&_.length&&O5(d,_,!0,l.people||[])}catch(j){if(l.WTF)throw j}}function Ua(e){return e.charAt(0)=="/"?e.slice(1):e}function qj(e,t){if(F_(),t=t||{},Mg(t),$a(e,"META-INF/manifest.xml")||$a(e,"objectdata.xml"))return K5(e,t);if($a(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cp<"u"){if(e.FileIndex)return Cp(e);var r=Ut.utils.cfb_new();return c5(e).forEach(function(K){HN(r,K,D_(e,K))}),Cp(r)}throw new Error("Unsupported NUMBERS file")}if(!$a(e,"[Content_Types].xml"))throw $a(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):$a(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=c5(e),a=BT(_a(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Hr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Hr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(l0=[],a.sst)try{l0=ej(Hr(e,Ua(a.sst)),a.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&a.themes.length&&(l=ZI(_a(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=QI(Hr(e,Ua(a.style)),a.style,l,t))}a.links.map(function(K){try{var he=i0(_a(e,Km(Ua(K))),K);return nj(Hr(e,Ua(K)),he,K,t)}catch{}});var u=GI(Hr(e,Ua(a.workbooks[0])),a.workbooks[0],t),h={},p="";a.coreprops.length&&(p=Hr(e,Ua(a.coreprops[0]),!0),p&&(h=o3(p)),a.extprops.length!==0&&(p=Hr(e,Ua(a.extprops[0]),!0),p&&HT(p,h,t)));var d={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(p=_a(e,Ua(a.custprops[0]),!0),p&&(d=WT(p,t)));var y={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(s=h.SheetNames),t.bookProps&&(y.Props=h,y.Custprops=d),t.bookSheets&&typeof s<"u"&&(y.SheetNames=s),t.bookSheets?y.SheetNames:t.bookProps))return y;s={};var x={};t.bookDeps&&a.calcchain&&(x=rj(Hr(e,Ua(a.calcchain)),a.calcchain));var S=0,v={},k,_;{var j=u.Sheets;h.Worksheets=j.length,h.SheetNames=[];for(var D=0;D!=j.length;++D)h.SheetNames[D]=j[D].name}var z=i?"bin":"xml",I=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,I+1)+"_rels/"+a.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");$a(e,T)||(T="xl/_rels/workbook."+z+".rels");var L=i0(_a(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=aj(Hr(e,Ua(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Y7(Hr(e,Ua(a.people[0])),t)),L&&(L=zj(L,u.Sheets));var O=Hr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=h.Worksheets;++S){var F="sheet";if(L&&L[S]?(k="xl/"+L[S][1].replace(/[\/]?xl\//,""),$a(e,k)||(k=L[S][1]),$a(e,k)||(k=T.replace(/_rels\/.*$/,"")+L[S][1]),F=L[S][2]):(k="xl/worksheets/sheet"+(S+1-O)+"."+z,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(h.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var N=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==S&&(N=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==h.SheetNames[S].toLowerCase()&&(N=1);if(!N)continue e}}$j(e,k,_,h.SheetNames[S],S,v,s,F,t,u,l,c)}return y={Directory:a,Workbook:u,Props:h,Custprops:d,Deps:x,Sheets:s,SheetNames:h.SheetNames,Strings:l0,Styles:c,Themes:l,SSF:gn(Ft)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(K,he){K=K.replace(/^Root Entry[\/]/,""),y.keys.push(K),y.files[K]=e.FileIndex[he]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=Hr(e,Ua(a.vba[0]),!0):a.defaults&&a.defaults.bin===eF&&(y.vbaraw=Hr(e,"xl/vbaProject.bin",!0))),y}function Hj(e,t){var r=t||{},n="Workbook",a=Ut.find(e,n);try{if(n="/!DataSpaces/Version",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(OL(a.content),n="/!DataSpaces/DataSpaceMap",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=ML(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=BL(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);zL(a.content)}catch{}if(n="/EncryptionInfo",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=$L(a.content);if(n="/EncryptedPackage",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Bg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Na(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Vj(e,t){return Ut.find(e,"EncryptedPackage")?Hj(e,t):V3(e,t)}function Wj(e,t){var r,n=e,a=t||{};return a.type||(a.type=Mt&&Buffer.isBuffer(e)?"buffer":"base64"),r=M_(n,a),qj(r,a)}function X3(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Jm(e.slice(r),t);default:break e}return R0.to_workbook(e,t)}function Gj(e,t){var r="",n=Bg(e,t);switch(t.type){case"base64":r=Na(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=il(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ur(r)),t.type="binary",X3(r,t)}function Kj(e,t){var r=e;return t.type=="base64"&&(r=Na(r)),r=Ys.utils.decode(1200,r.slice(2),"str"),t.type="binary",X3(r,t)}function Xj(e){return e.match(/[^\x00-\x7F]/)?qu(e):e}function Lp(e,t,r,n){return n?(r.type="string",R0.to_workbook(e,r)):R0.to_workbook(t,r)}function Mc(e,t){y_();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Mc(new Uint8Array(e),(r=gn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),bc={},r.dateNF&&(bc.dateNF=r.dateNF),r.type||(r.type=Mt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Mt?"buffer":"binary",n=DN(e),typeof Uint8Array<"u"&&!Mt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Xj(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=gn(r),r.type="array",Mc(xg(n),r)}switch((a=Bg(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Vj(Ut.read(n,r),r);break;case 9:if(a[1]<=8)return V3(n,r);break;case 60:return Jm(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return kL(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _L.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Wj(n,r):Lp(e,n,r,i);case 239:return a[3]===60?Jm(n,r):Lp(e,n,r,i);case 255:if(a[1]===254)return Kj(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return o0.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return o0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return R5.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return e7.to_workbook(n,r);break;case 10:case 13:case 32:return Gj(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return yL.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?R5.to_workbook(n,r):Lp(e,n,r,i)}function Yj(e,t,r,n,a,i,s,o){var l=xn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var d=t.s.c;d<=t.e.c;++d){var y=s?e[r][d]:e[n[d]+l];if(y===void 0||y.t===void 0){if(c===void 0)continue;i[d]!=null&&(p[i[d]]=c);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[d]!=null){if(x==null)if(y.t=="e"&&x===null)p[i[d]]=null;else if(c!==void 0)p[i[d]]=c;else if(u&&x===null)p[i[d]]=null;else continue;else p[i[d]]=u&&(y.t!=="n"||y.t==="n"&&o.rawNumbers!==!1)?x:ys(y,x,o);x!=null&&(h=!1)}}return{row:p,isempty:h}}function t2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Cr(u);break;case"number":l=Cr(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var h=xn(l.s.r),p=[],d=[],y=0,x=0,S=Array.isArray(e),v=l.s.r,k=0,_={};S&&!e[v]&&(e[v]=[]);var j=c.skipHidden&&e["!cols"]||[],D=c.skipHidden&&e["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(j[k]||{}).hidden)switch(p[k]=Zr(k),r=S?e[v][k]:e[p[k]+h],n){case 1:i[k]=k-l.s.c;break;case 2:i[k]=p[k];break;case 3:i[k]=c.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=ys(r,null,c),x=_[s]||0,!x)_[s]=1;else{do o=s+"_"+x++;while(_[o]);_[s]=x,_[o]=1}i[k]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(D[v]||{}).hidden){var z=Yj(e,l,v,p,n,i,S,c);(z.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[y++]=z.row)}return d.length=y,d}var Q5=/"/g;function Jj(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",h=xn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var d=o.dense?(e[r]||[])[p]:e[n[p]+h];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:ys(d,null,o));for(var y=0,x=0;y!==u.length;++y)if((x=u.charCodeAt(y))===a||x===i||x===34||o.forceQuotes){u='"'+u.replace(Q5,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(Q5,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function Y3(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Cr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(p[y]||{}).hidden||(h[y]=Zr(y));for(var x=0,S=a.s.r;S<=a.e.r;++S)(d[S]||{}).hidden||(u=Jj(e,a,S,h,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((x++?o:"")+u)));return delete n.dense,r.join("")}function Qj(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Y3(e,t);return r}function Zj(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Cr(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Zr(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=xn(u),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function J3(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Hn(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var h=Cr(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(s=h.e.r+1,u.e.r=s+t.length-1+a)}else s==-1&&(s=0,u.e.r=t.length-1+a);var p=n.header||[],d=0;t.forEach(function(x,S){$i(x).forEach(function(v){(d=p.indexOf(v))==-1&&(p[d=p.length]=v);var k=x[v],_="z",j="",D=Tt({c:o+d,r:s+S+a});c=B0(i,D),k&&typeof k=="object"&&!(k instanceof Date)?i[D]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=Gn(k)),j=n.dateNF||Ft[14]):k===null&&n.nullError&&(_="e",k=0),c?(c.t=_,c.v=k,delete c.w,delete c.R,j&&(c.z=j)):i[D]=c={t:_,v:k},j&&(c.z=j))})}),u.e.c=Math.max(u.e.c,o+p.length-1);var y=xn(s);if(a)for(d=0;d<p.length;++d)i[Zr(d+o)+y]={t:"s",v:p[d]};return i["!ref"]=zt(u),i}function eR(e,t){return J3(null,e,t)}function B0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Hn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?B0(e,Tt(t)):B0(e,Tt({r:t,c:r||0}))}function tR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ug(){return{SheetNames:[],Sheets:{}}}function zg(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(BI(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function rR(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=tR(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function nR(e,t){return e.z=t,e}function Q3(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function aR(e,t,r){return Q3(e,"#"+t,r)}function iR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sR(e,t,r,n){for(var a=typeof t!="string"?t:Cr(t),i=typeof t=="string"?t:zt(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=B0(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var r1={encode_col:Zr,encode_row:xn,encode_cell:Tt,encode_range:zt,decode_col:Ag,decode_row:Eg,split_cell:vT,decode_cell:Hn,decode_range:Gc,format_cell:ys,sheet_add_aoa:r3,sheet_add_json:J3,sheet_add_dom:W3,aoa_to_sheet:Kc,json_to_sheet:eR,table_to_sheet:G3,table_to_book:kj,sheet_to_csv:Y3,sheet_to_txt:Qj,sheet_to_json:t2,sheet_to_html:bj,sheet_to_formulae:Zj,sheet_to_row_object_array:t2,sheet_get_cell:B0,book_new:Ug,book_append_sheet:zg,book_set_sheet_visibility:rR,cell_set_number_format:nR,cell_set_hyperlink:Q3,cell_set_internal_link:aR,cell_add_comment:iR,sheet_set_array_formula:sR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function oR({profile:e}){const[t,r]=ge.useState([]),[n,a]=ge.useState([]),[i,s]=ge.useState({serial_number:"",barcode_number:"",gas_type:""}),[o,l]=ge.useState(null),[c,u]=ge.useState(!0),[h,p]=ge.useState(null),[d,y]=ge.useState({customer_id:"",rental_start_date:""}),[x,S]=ge.useState(!1),[v,k]=ge.useState(null),[_,j]=ge.useState([]),[D,z]=ge.useState(null),[I,T]=ge.useState(null),[L,O]=ge.useState([]),F=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager",N=Rt();ge.useEffect(()=>{(async()=>{u(!0),p(null);try{const{data:C,error:R}=await Je.from("cylinders").select(`
            *,
            assigned_customer (
              CustomerListID,
              name,
              customer_number
            )
          `).order("serial_number");if(R)throw R;const{data:H,error:re}=await Je.from("customers").select("CustomerListID, name, customer_number").order("name");if(re)throw re;r(C),a(H)}catch(C){p(C.message)}u(!1)})()},[]);const M=A=>s({...i,[A.target.name]:A.target.value}),K=async A=>{A.preventDefault(),p(null);const{error:C}=await Je.from("cylinders").insert([i]);if(C)p(C.message);else{s({serial_number:"",barcode_number:"",gas_type:""});const{data:R}=await Je.from("cylinders").select("*, assigned_customer (CustomerListID, name, customer_number)").order("serial_number");r(R)}},he=A=>{l(A.id),s({serial_number:A.serial_number,barcode_number:A.barcode_number,gas_type:A.gas_type})},le=async A=>{A.preventDefault(),p(null);const{error:C}=await Je.from("cylinders").update(i).eq("id",o);if(C)p(C.message);else{l(null),s({serial_number:"",barcode_number:"",gas_type:""});const{data:R}=await Je.from("cylinders").select("*, assigned_customer (CustomerListID, name, customer_number)").order("serial_number");r(R)}},fe=async A=>{p(null);const{error:C}=await Je.from("cylinders").delete().eq("id",A);C?p(C.message):r(t.filter(R=>R.id!==A))},ie=A=>{var C;k(A),y({customer_id:((C=A.assigned_customer)==null?void 0:C.CustomerListID)||"",rental_start_date:A.rental_start_date||new Date().toISOString().split("T")[0]}),S(!0)},q=async A=>{A.preventDefault(),p(null);const{error:C}=await Je.from("cylinders").update({assigned_customer:d.customer_id||null,rental_start_date:d.customer_id?d.rental_start_date:null}).eq("id",v.id);if(C)p(C.message);else{S(!1);const{data:R}=await Je.from("cylinders").select("*, assigned_customer (CustomerListID, name, customer_number)").order("serial_number");r(R)}},Z=A=>{z(null),T(null);const C=A.target.files[0];if(!C)return;const R=C.name.split(".").pop().toLowerCase();if(R==="csv"||R==="txt")sN.parse(C,{header:!0,skipEmptyLines:!0,complete:H=>{j(H.data)},error:H=>z(H.message)});else if(R==="xlsx"||R==="xls"){const H=new FileReader;H.onload=re=>{const ae=new Uint8Array(re.target.result),ne=Mc(ae,{type:"array"}),me=ne.Sheets[ne.SheetNames[0]],we=r1.sheet_to_json(me);j(we)},H.readAsArrayBuffer(C)}else z("Unsupported file type.")},oe=async()=>{if(z(null),T(null),!_.length)return;const A=_.map(H=>({category:H.Category||"",group_name:H.Group||"",type:H.Type||"",product_code:H["Product Code"]||"",description:H.Description||"",in_house_total:Number(H["In-House Total"])||0,with_customer_total:Number(H["With Customer Total"])||0,lost_total:Number(H["Lost Total"])||0,total:Number(H.Total)||0,dock_stock:H["Dock Stock"]||""})),C=Array.from(A.reduce((H,re)=>H.set(re.product_code,re),new Map).values()),{error:R}=await Je.from("cylinders").upsert(C,{onConflict:["product_code"]});R?z(R.message):T("Assets imported!"),j([])},b=async()=>{if(!window.confirm(`Delete ${L.length} selected assets? This cannot be undone.`))return;p(null);const{error:A}=await Je.from("cylinders").delete().in("id",L);A?p(A.message):(r(t.filter(C=>!L.includes(C.id))),O([]))};return c?m.jsx("div",{children:"Loading cylinders..."}):h?m.jsxs("div",{className:"text-red-600",children:["Error: ",h]}):m.jsxs("div",{className:"relative max-w-7xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100 w-full",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h2",{className:"text-xl font-bold",children:"Cylinders"}),m.jsx("button",{onClick:()=>N("/"),className:"bg-gradient-to-r from-gray-400 to-gray-300 text-white px-6 py-2 rounded-lg shadow-md hover:from-gray-500 hover:to-gray-400 font-semibold transition",children:"Back to Dashboard"})]}),m.jsxs("div",{className:"mb-4 flex gap-2",children:[L.length>0&&m.jsxs("button",{onClick:b,className:"bg-red-600 text-white px-4 py-2 rounded",children:["Delete Selected (",L.length,")"]}),t.length>0&&m.jsx("button",{onClick:async()=>{if(!window.confirm("Delete ALL assets? This cannot be undone."))return;p(null);const{error:A}=await Je.from("cylinders").delete();A?p(A.message):(r([]),O([]))},className:"bg-red-800 text-white px-4 py-2 rounded",children:"Delete All"})]}),m.jsxs("div",{className:"mb-8 p-4 bg-white/80 rounded-xl shadow border border-blue-100",children:[m.jsx("h3",{className:"font-bold mb-2 text-blue-800",children:"Import Assets"}),m.jsx("input",{type:"file",accept:".csv,.xlsx,.xls,.txt",onChange:Z,className:"mb-2"}),D&&m.jsx("div",{className:"text-red-600 mb-2",children:D}),_.length>0&&m.jsxs("div",{className:"mb-2",children:[m.jsxs("div",{className:"font-semibold mb-1",children:["Preview (",_.length," rows):"]}),m.jsxs("div",{className:"overflow-x-auto",children:[m.jsxs("table",{className:"min-w-full bg-white border text-xs",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"Category"}),m.jsx("th",{children:"Group"}),m.jsx("th",{children:"Type"}),m.jsx("th",{children:"Product Code"}),m.jsx("th",{children:"Description"}),m.jsx("th",{children:"In-House Total"}),m.jsx("th",{children:"With Customer Total"}),m.jsx("th",{children:"Lost Total"}),m.jsx("th",{children:"Total"}),m.jsx("th",{children:"Dock Stock"})]})}),m.jsx("tbody",{children:_.slice(0,5).map((A,C)=>m.jsxs("tr",{children:[m.jsx("td",{children:A.Category}),m.jsx("td",{children:A.Group}),m.jsx("td",{children:A.Type}),m.jsx("td",{children:A["Product Code"]}),m.jsx("td",{children:A.Description}),m.jsx("td",{children:A["In-House Total"]}),m.jsx("td",{children:A["With Customer Total"]}),m.jsx("td",{children:A["Lost Total"]}),m.jsx("td",{children:A.Total}),m.jsx("td",{children:A["Dock Stock"]})]},C))})]}),_.length>5&&m.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Showing first 5 rows only."})]}),m.jsx("button",{onClick:oe,className:"mt-2 bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700",children:"Import All"})]}),I&&m.jsx("div",{className:"text-green-700 font-semibold",children:I})]}),F&&m.jsxs("form",{onSubmit:o?le:K,className:"mb-4 flex gap-2",children:[m.jsx("input",{name:"serial_number",value:i.serial_number,onChange:M,placeholder:"Serial Number",className:"border p-2 rounded",required:!0}),m.jsx("input",{name:"barcode_number",value:i.barcode_number,onChange:M,placeholder:"Barcode",className:"border p-2 rounded"}),m.jsx("input",{name:"gas_type",value:i.gas_type,onChange:M,placeholder:"Gas Type",className:"border p-2 rounded",required:!0}),m.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:o?"Update":"Add"}),o&&m.jsx("button",{type:"button",onClick:()=>{l(null),s({serial_number:"",barcode_number:"",gas_type:""})},className:"bg-gray-400 text-white px-4 py-2 rounded",children:"Cancel"})]}),m.jsxs("table",{className:"min-w-full bg-white border",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:m.jsx("input",{type:"checkbox",checked:L.length===t.length&&t.length>0,onChange:()=>{L.length===t.length?O([]):O(t.map(A=>A.id))}})}),m.jsx("th",{className:"border px-4 py-2",children:"Category"}),m.jsx("th",{className:"border px-4 py-2",children:"Group"}),m.jsx("th",{className:"border px-4 py-2",children:"Type"}),m.jsx("th",{className:"border px-4 py-2",children:"Product Code"}),m.jsx("th",{className:"border px-4 py-2",children:"Description"}),m.jsx("th",{className:"border px-4 py-2",children:"In-House Total"}),m.jsx("th",{className:"border px-4 py-2",children:"With Customer Total"}),m.jsx("th",{className:"border px-4 py-2",children:"Lost Total"}),m.jsx("th",{className:"border px-4 py-2",children:"Total"}),m.jsx("th",{className:"border px-4 py-2",children:"Dock Stock"}),F&&m.jsx("th",{className:"border px-4 py-2",children:"Actions"})]})}),m.jsx("tbody",{children:t.map(A=>m.jsxs("tr",{children:[m.jsx("td",{children:m.jsx("input",{type:"checkbox",checked:L.includes(A.id),onChange:()=>{O(C=>C.includes(A.id)?C.filter(R=>R!==A.id):[...C,A.id])}})}),m.jsx("td",{className:"border px-4 py-2",children:A.category}),m.jsx("td",{className:"border px-4 py-2",children:A.group_name}),m.jsx("td",{className:"border px-4 py-2",children:A.type}),m.jsx("td",{className:"border px-4 py-2",children:A.product_code}),m.jsx("td",{className:"border px-4 py-2",children:A.description}),m.jsx("td",{className:"border px-4 py-2",children:A.in_house_total}),m.jsx("td",{className:"border px-4 py-2",children:A.with_customer_total}),m.jsx("td",{className:"border px-4 py-2",children:A.lost_total}),m.jsx("td",{className:"border px-4 py-2",children:A.total}),m.jsx("td",{className:"border px-4 py-2",children:A.dock_stock}),F&&m.jsxs("td",{className:"border px-4 py-2",children:[m.jsx("button",{onClick:()=>he(A),className:"bg-yellow-400 text-white px-2 py-1 rounded mr-2",children:"Edit"}),m.jsx("button",{onClick:()=>ie(A),className:"bg-blue-500 text-white px-2 py-1 rounded mr-2",children:"Assign"}),m.jsx("button",{onClick:()=>fe(A.id),className:"bg-red-600 text-white px-2 py-1 rounded",children:"Delete"})]})]},A.id))})]}),x&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:m.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[m.jsx("h3",{className:"text-lg font-bold mb-4",children:"Assign Cylinder"}),m.jsxs("form",{onSubmit:q,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2",children:"Customer"}),m.jsxs("select",{value:d.customer_id,onChange:A=>y({...d,customer_id:A.target.value}),className:"w-full border p-2 rounded",children:[m.jsx("option",{value:"",children:"-- Unassign --"}),n.map(A=>m.jsxs("option",{value:A.CustomerListID,children:[A.name," (",A.customer_number,")"]},A.CustomerListID))]})]}),d.customer_id&&m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2",children:"Rental Start Date"}),m.jsx("input",{type:"date",value:d.rental_start_date,onChange:A=>y({...d,rental_start_date:A.target.value}),className:"w-full border p-2 rounded",required:!0})]}),m.jsxs("div",{className:"flex justify-end gap-2",children:[m.jsx("button",{type:"button",onClick:()=>S(!1),className:"bg-gray-400 text-white px-4 py-2 rounded",children:"Cancel"}),m.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Save"})]})]})]})})]})}function lR({profile:e}){const[t,r]=ge.useState([]),[n,a]=ge.useState(!0),[i,s]=ge.useState(null),[o,l]=ge.useState("active"),[c,u]=ge.useState(!1),[h,p]=ge.useState(null),[d,y]=ge.useState(""),x=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager",S=Rt();ge.useEffect(()=>{(async()=>{a(!0),s(null);try{const{data:j,error:D}=await Je.from("rentals").select(`
            *,
            customer:customer_id (
              CustomerListID,
              name,
              customer_number
            ),
            cylinder:cylinder_id (
              id,
              serial_number,
              gas_type
            )
          `).eq("status",o).order("rental_start_date",{ascending:!1});if(D)throw D;r(j)}catch(j){s(j.message)}a(!1)})()},[o]);const v=_=>{p(_),y(new Date().toISOString().split("T")[0]),u(!0)},k=async _=>{_.preventDefault(),s(null);try{const{error:j}=await Je.from("rentals").update({status:"ended",rental_end_date:d}).eq("id",h.id);if(j)throw j;const{error:D}=await Je.from("cylinders").update({assigned_customer:null,rental_start_date:null}).eq("id",h.cylinder.id);if(D)throw D;u(!1);const{data:z,error:I}=await Je.from("rentals").select(`
          *,
          customer:customer_id (
            CustomerListID,
            name,
            customer_number
          ),
          cylinder:cylinder_id (
            id,
            serial_number,
            gas_type
          )
        `).eq("status",o).order("rental_start_date",{ascending:!1});if(I)throw I;r(z)}catch(j){s(j.message)}};return n?m.jsx("div",{children:"Loading rentals..."}):i?m.jsxs("div",{className:"text-red-600",children:["Error: ",i]}):m.jsxs("div",{className:"relative max-w-7xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100 w-full",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h2",{className:"text-xl font-bold",children:"Rentals"}),m.jsx("button",{onClick:()=>S("/"),className:"bg-gradient-to-r from-gray-400 to-gray-300 text-white px-6 py-2 rounded-lg shadow-md hover:from-gray-500 hover:to-gray-400 font-semibold transition",children:"Back to Dashboard"})]}),m.jsx("div",{className:"flex justify-between items-center mb-4",children:m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:()=>l("active"),className:`px-4 py-2 rounded ${o==="active"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Active"}),m.jsx("button",{onClick:()=>l("ended"),className:`px-4 py-2 rounded ${o==="ended"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Ended"})]})}),m.jsxs("table",{className:"min-w-full bg-white border",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{className:"border px-4 py-2",children:"Customer"}),m.jsx("th",{className:"border px-4 py-2",children:"Cylinder"}),m.jsx("th",{className:"border px-4 py-2",children:"Gas Type"}),m.jsx("th",{className:"border px-4 py-2",children:"Type"}),m.jsx("th",{className:"border px-4 py-2",children:"Start Date"}),m.jsx("th",{className:"border px-4 py-2",children:"End Date"}),x&&o==="active"&&m.jsx("th",{className:"border px-4 py-2",children:"Actions"})]})}),m.jsx("tbody",{children:t.map(_=>m.jsxs("tr",{children:[m.jsxs("td",{className:"border px-4 py-2",children:[_.customer.name,m.jsx("br",{}),m.jsxs("span",{className:"text-sm text-gray-500",children:["(",_.customer.customer_number,")"]})]}),m.jsx("td",{className:"border px-4 py-2",children:_.cylinder.serial_number}),m.jsx("td",{className:"border px-4 py-2",children:_.cylinder.gas_type}),m.jsx("td",{className:"border px-4 py-2",children:m.jsx("span",{className:`capitalize ${_.rental_type==="monthly"?"text-blue-600":"text-green-600"}`,children:_.rental_type})}),m.jsx("td",{className:"border px-4 py-2",children:_.rental_start_date}),m.jsx("td",{className:"border px-4 py-2",children:_.rental_end_date||"-"}),x&&o==="active"&&m.jsx("td",{className:"border px-4 py-2",children:m.jsx("button",{onClick:()=>v(_),className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600",children:"End Rental"})})]},_.id))})]}),c&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:m.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[m.jsx("h3",{className:"text-lg font-bold mb-4",children:"End Rental"}),m.jsxs("p",{className:"mb-4",children:["End rental for cylinder ",h.cylinder.serial_number,m.jsx("br",{}),m.jsxs("span",{className:"text-sm text-gray-600",children:["Rented to: ",h.customer.name]})]}),m.jsxs("form",{onSubmit:k,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2",children:"End Date"}),m.jsx("input",{type:"date",value:d,onChange:_=>y(_.target.value),className:"w-full border p-2 rounded",required:!0})]}),m.jsxs("div",{className:"flex justify-end gap-2",children:[m.jsx("button",{type:"button",onClick:()=>u(!1),className:"bg-gray-400 text-white px-4 py-2 rounded",children:"Cancel"}),m.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:"End Rental"})]})]})]})})]})}function Qt(e){"@babel/helpers - typeof";return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(e)}var Pn=Uint8Array,ka=Uint16Array,$g=Int32Array,n1=new Pn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a1=new Pn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),r2=new Pn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Z3=function(e,t){for(var r=new ka(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new $g(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},eb=Z3(n1,2),tb=eb.b,n2=eb.r;tb[28]=258,n2[258]=28;var rb=Z3(a1,0),cR=rb.b,Z5=rb.r,a2=new ka(32768);for(var dr=0;dr<32768;++dr){var Bs=(dr&43690)>>1|(dr&21845)<<1;Bs=(Bs&52428)>>2|(Bs&13107)<<2,Bs=(Bs&61680)>>4|(Bs&3855)<<4,a2[dr]=((Bs&65280)>>8|(Bs&255)<<8)>>1}var zi=function(e,t,r){for(var n=e.length,a=0,i=new ka(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new ka(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new ka(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],h=s[e[a]-1]++<<u,p=h|(1<<u)-1;h<=p;++h)o[a2[h]>>l]=c}else for(o=new ka(n),a=0;a<n;++a)e[a]&&(o[a]=a2[s[e[a]-1]++]>>15-e[a]);return o},yo=new Pn(288);for(var dr=0;dr<144;++dr)yo[dr]=8;for(var dr=144;dr<256;++dr)yo[dr]=9;for(var dr=256;dr<280;++dr)yo[dr]=7;for(var dr=280;dr<288;++dr)yo[dr]=8;var U0=new Pn(32);for(var dr=0;dr<32;++dr)U0[dr]=5;var uR=zi(yo,9,0),fR=zi(yo,9,1),hR=zi(U0,5,0),dR=zi(U0,5,1),Fp=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},li=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},Pp=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},qg=function(e){return(e+7)/8|0},nb=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new Pn(e.subarray(t,r))},pR=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],fi=function(e,t,r){var n=new Error(t||pR[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,fi),!r)throw n;return n},mR=function(e,t,r,n){var a=e.length,i=n?n.length:0;if(!a||t.f&&!t.l)return r||new Pn(0);var s=!r,o=s||t.i!=2,l=t.i;s&&(r=new Pn(a*3));var c=function(we){var X=r.length;if(we>X){var Ie=new Pn(Math.max(X*2,we));Ie.set(r),r=Ie}},u=t.f||0,h=t.p||0,p=t.b||0,d=t.l,y=t.d,x=t.m,S=t.n,v=a*8;do{if(!d){u=li(e,h,1);var k=li(e,h+1,3);if(h+=3,k)if(k==1)d=fR,y=dR,x=9,S=5;else if(k==2){var z=li(e,h,31)+257,I=li(e,h+10,15)+4,T=z+li(e,h+5,31)+1;h+=14;for(var L=new Pn(T),O=new Pn(19),F=0;F<I;++F)O[r2[F]]=li(e,h+F*3,7);h+=I*3;for(var N=Fp(O),M=(1<<N)-1,K=zi(O,N,1),F=0;F<T;){var he=K[li(e,h,M)];h+=he&15;var _=he>>4;if(_<16)L[F++]=_;else{var le=0,fe=0;for(_==16?(fe=3+li(e,h,3),h+=2,le=L[F-1]):_==17?(fe=3+li(e,h,7),h+=3):_==18&&(fe=11+li(e,h,127),h+=7);fe--;)L[F++]=le}}var ie=L.subarray(0,z),q=L.subarray(z);x=Fp(ie),S=Fp(q),d=zi(ie,x,1),y=zi(q,S,1)}else fi(1);else{var _=qg(h)+4,j=e[_-4]|e[_-3]<<8,D=_+j;if(D>a){l&&fi(0);break}o&&c(p+j),r.set(e.subarray(_,D),p),t.b=p+=j,t.p=h=D*8,t.f=u;continue}if(h>v){l&&fi(0);break}}o&&c(p+131072);for(var Z=(1<<x)-1,oe=(1<<S)-1,b=h;;b=h){var le=d[Pp(e,h)&Z],A=le>>4;if(h+=le&15,h>v){l&&fi(0);break}if(le||fi(2),A<256)r[p++]=A;else if(A==256){b=h,d=null;break}else{var C=A-254;if(A>264){var F=A-257,R=n1[F];C=li(e,h,(1<<R)-1)+tb[F],h+=R}var H=y[Pp(e,h)&oe],re=H>>4;H||fi(3),h+=H&15;var q=cR[re];if(re>3){var R=a1[re];q+=Pp(e,h)&(1<<R)-1,h+=R}if(h>v){l&&fi(0);break}o&&c(p+131072);var ae=p+C;if(p<q){var ne=i-q,me=Math.min(q,ae);for(ne+p<0&&fi(3);p<me;++p)r[p]=n[ne+p]}for(;p<ae;++p)r[p]=r[p-q]}}t.l=d,t.p=b,t.b=p,t.f=u,d&&(u=1,t.m=x,t.d=y,t.n=S)}while(!u);return p!=r.length&&s?nb(r,0,p):r.subarray(0,p)},as=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Iu=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Ip=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:ib,l:0};if(a==1){var s=new Pn(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(D,z){return D.f-z.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,h=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=a-1;)o=r[r[c].f<r[h].f?c++:h++],l=r[c!=u&&r[c].f<r[h].f?c++:h++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=i[0].s,n=1;n<a;++n)i[n].s>p&&(p=i[n].s);var d=new ka(p+1),y=i2(r[u-1],d,0);if(y>t){var n=0,x=0,S=y-t,v=1<<S;for(i.sort(function(z,I){return d[I.s]-d[z.s]||z.f-I.f});n<a;++n){var k=i[n].s;if(d[k]>t)x+=v-(1<<y-d[k]),d[k]=t;else break}for(x>>=S;x>0;){var _=i[n].s;d[_]<t?x-=1<<t-d[_]++-1:++n}for(;n>=0&&x;--n){var j=i[n].s;d[j]==t&&(--d[j],++x)}y=t}return{t:new Pn(d),l:y}},i2=function(e,t,r){return e.s==-1?Math.max(i2(e.l,t,r+1),i2(e.r,t,r+1)):t[e.s]=r},ey=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ka(++t),n=0,a=e[0],i=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},ju=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},ab=function(e,t,r){var n=r.length,a=qg(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},ty=function(e,t,r,n,a,i,s,o,l,c,u){as(t,u++,r),++a[256];for(var h=Ip(a,15),p=h.t,d=h.l,y=Ip(i,15),x=y.t,S=y.l,v=ey(p),k=v.c,_=v.n,j=ey(x),D=j.c,z=j.n,I=new ka(19),T=0;T<k.length;++T)++I[k[T]&31];for(var T=0;T<D.length;++T)++I[D[T]&31];for(var L=Ip(I,7),O=L.t,F=L.l,N=19;N>4&&!O[r2[N-1]];--N);var M=c+5<<3,K=ju(a,yo)+ju(i,U0)+s,he=ju(a,p)+ju(i,x)+s+14+3*N+ju(I,O)+2*I[16]+3*I[17]+7*I[18];if(l>=0&&M<=K&&M<=he)return ab(t,u,e.subarray(l,l+c));var le,fe,ie,q;if(as(t,u,1+(he<K)),u+=2,he<K){le=zi(p,d,0),fe=p,ie=zi(x,S,0),q=x;var Z=zi(O,F,0);as(t,u,_-257),as(t,u+5,z-1),as(t,u+10,N-4),u+=14;for(var T=0;T<N;++T)as(t,u+3*T,O[r2[T]]);u+=3*N;for(var oe=[k,D],b=0;b<2;++b)for(var A=oe[b],T=0;T<A.length;++T){var C=A[T]&31;as(t,u,Z[C]),u+=O[C],C>15&&(as(t,u,A[T]>>5&127),u+=A[T]>>12)}}else le=uR,fe=yo,ie=hR,q=U0;for(var T=0;T<o;++T){var R=n[T];if(R>255){var C=R>>18&31;Iu(t,u,le[C+257]),u+=fe[C+257],C>7&&(as(t,u,R>>23&31),u+=n1[C]);var H=R&31;Iu(t,u,ie[H]),u+=q[H],H>3&&(Iu(t,u,R>>5&8191),u+=a1[H])}else Iu(t,u,le[R]),u+=fe[R]}return Iu(t,u,le[256]),u+fe[256]},gR=new $g([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ib=new Pn(0),xR=function(e,t,r,n,a,i){var s=i.z||e.length,o=new Pn(n+s+5*(1+Math.ceil(s/7e3))+a),l=o.subarray(n,o.length-a),c=i.l,u=(i.r||0)&7;if(t){u&&(l[0]=i.r>>3);for(var h=gR[t-1],p=h>>13,d=h&8191,y=(1<<r)-1,x=i.p||new ka(32768),S=i.h||new ka(y+1),v=Math.ceil(r/3),k=2*v,_=function(Se){return(e[Se]^e[Se+1]<<v^e[Se+2]<<k)&y},j=new $g(25e3),D=new ka(288),z=new ka(32),I=0,T=0,L=i.i||0,O=0,F=i.w||0,N=0;L+2<s;++L){var M=_(L),K=L&32767,he=S[M];if(x[K]=he,S[M]=K,F<=L){var le=s-L;if((I>7e3||O>24576)&&(le>423||!c)){u=ty(e,l,0,j,D,z,T,O,N,L-N,u),O=I=T=0,N=L;for(var fe=0;fe<286;++fe)D[fe]=0;for(var fe=0;fe<30;++fe)z[fe]=0}var ie=2,q=0,Z=d,oe=K-he&32767;if(le>2&&M==_(L-oe))for(var b=Math.min(p,le)-1,A=Math.min(32767,L),C=Math.min(258,le);oe<=A&&--Z&&K!=he;){if(e[L+ie]==e[L+ie-oe]){for(var R=0;R<C&&e[L+R]==e[L+R-oe];++R);if(R>ie){if(ie=R,q=oe,R>b)break;for(var H=Math.min(oe,R-2),re=0,fe=0;fe<H;++fe){var ae=L-oe+fe&32767,ne=x[ae],me=ae-ne&32767;me>re&&(re=me,he=ae)}}}K=he,he=x[K],oe+=K-he&32767}if(q){j[O++]=268435456|n2[ie]<<18|Z5[q];var we=n2[ie]&31,X=Z5[q]&31;T+=n1[we]+a1[X],++D[257+we],++z[X],F=L+ie,++I}else j[O++]=e[L],++D[e[L]]}}for(L=Math.max(L,F);L<s;++L)j[O++]=e[L],++D[e[L]];u=ty(e,l,c,j,D,z,T,O,N,L-N,u),c||(i.r=u&7|l[u/8|0]<<3,u-=7,i.h=S,i.p=x,i.i=L,i.w=F)}else{for(var L=i.w||0;L<s+c;L+=65535){var Ie=L+65535;Ie>=s&&(l[u/8|0]=c,Ie=s),u=ab(l,u+1,e.subarray(L,Ie))}i.i=s}return nb(o,0,n+qg(u)+a)},sb=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},vR=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new Pn(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return xR(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},ob=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},yR=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=sb();a.p(t.dictionary),ob(e,2,a.d())}},wR=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&fi(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&fi(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function s2(e,t){t||(t={});var r=sb();r.p(e);var n=vR(e,t,t.dictionary?6:2,4);return yR(n,t),ob(n,n.length-4,r.d()),n}function _R(e,t){return mR(e.subarray(wR(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var bR=typeof TextDecoder<"u"&&new TextDecoder,kR=0;try{bR.decode(ib,{stream:!0}),kR=1}catch{}var _t=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function jp(){_t.console&&typeof _t.console.log=="function"&&_t.console.log.apply(_t.console,arguments)}var ar={log:jp,warn:function(e){_t.console&&(typeof _t.console.warn=="function"?_t.console.warn.apply(_t.console,arguments):jp.call(null,arguments))},error:function(e){_t.console&&(typeof _t.console.error=="function"?_t.console.error.apply(_t.console,arguments):jp(e))}};function Rp(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Uo(n.response,t,r)},n.onerror=function(){ar.error("could not download file")},n.send()}function ry(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function vh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var f0,o2,Uo=_t.saveAs||((typeof window>"u"?"undefined":Qt(window))!=="object"||window!==_t?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=_t.URL||_t.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?ry(a.href)?Rp(e,t,r):vh(a,a.target="_blank"):vh(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){vh(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(ry(e))Rp(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){vh(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:Qt(i)!=="object"&&(ar.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Rp(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(_t.HTMLElement)||_t.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":Qt(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var l=_t.URL||_t.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function lb(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Op(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=En(r,n,a,i,t[0],7,-680876936),i=En(i,r,n,a,t[1],12,-389564586),a=En(a,i,r,n,t[2],17,606105819),n=En(n,a,i,r,t[3],22,-1044525330),r=En(r,n,a,i,t[4],7,-176418897),i=En(i,r,n,a,t[5],12,1200080426),a=En(a,i,r,n,t[6],17,-1473231341),n=En(n,a,i,r,t[7],22,-45705983),r=En(r,n,a,i,t[8],7,1770035416),i=En(i,r,n,a,t[9],12,-1958414417),a=En(a,i,r,n,t[10],17,-42063),n=En(n,a,i,r,t[11],22,-1990404162),r=En(r,n,a,i,t[12],7,1804603682),i=En(i,r,n,a,t[13],12,-40341101),a=En(a,i,r,n,t[14],17,-1502002290),r=An(r,n=En(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=An(i,r,n,a,t[6],9,-1069501632),a=An(a,i,r,n,t[11],14,643717713),n=An(n,a,i,r,t[0],20,-373897302),r=An(r,n,a,i,t[5],5,-701558691),i=An(i,r,n,a,t[10],9,38016083),a=An(a,i,r,n,t[15],14,-660478335),n=An(n,a,i,r,t[4],20,-405537848),r=An(r,n,a,i,t[9],5,568446438),i=An(i,r,n,a,t[14],9,-1019803690),a=An(a,i,r,n,t[3],14,-187363961),n=An(n,a,i,r,t[8],20,1163531501),r=An(r,n,a,i,t[13],5,-1444681467),i=An(i,r,n,a,t[2],9,-51403784),a=An(a,i,r,n,t[7],14,1735328473),r=Nn(r,n=An(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Nn(i,r,n,a,t[8],11,-2022574463),a=Nn(a,i,r,n,t[11],16,1839030562),n=Nn(n,a,i,r,t[14],23,-35309556),r=Nn(r,n,a,i,t[1],4,-1530992060),i=Nn(i,r,n,a,t[4],11,1272893353),a=Nn(a,i,r,n,t[7],16,-155497632),n=Nn(n,a,i,r,t[10],23,-1094730640),r=Nn(r,n,a,i,t[13],4,681279174),i=Nn(i,r,n,a,t[0],11,-358537222),a=Nn(a,i,r,n,t[3],16,-722521979),n=Nn(n,a,i,r,t[6],23,76029189),r=Nn(r,n,a,i,t[9],4,-640364487),i=Nn(i,r,n,a,t[12],11,-421815835),a=Nn(a,i,r,n,t[15],16,530742520),r=Tn(r,n=Nn(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Tn(i,r,n,a,t[7],10,1126891415),a=Tn(a,i,r,n,t[14],15,-1416354905),n=Tn(n,a,i,r,t[5],21,-57434055),r=Tn(r,n,a,i,t[12],6,1700485571),i=Tn(i,r,n,a,t[3],10,-1894986606),a=Tn(a,i,r,n,t[10],15,-1051523),n=Tn(n,a,i,r,t[1],21,-2054922799),r=Tn(r,n,a,i,t[8],6,1873313359),i=Tn(i,r,n,a,t[15],10,-30611744),a=Tn(a,i,r,n,t[6],15,-1560198380),n=Tn(n,a,i,r,t[13],21,1309151649),r=Tn(r,n,a,i,t[4],6,-145523070),i=Tn(i,r,n,a,t[11],10,-1120210379),a=Tn(a,i,r,n,t[2],15,718787259),n=Tn(n,a,i,r,t[9],21,-343485551),e[0]=no(r,e[0]),e[1]=no(n,e[1]),e[2]=no(a,e[2]),e[3]=no(i,e[3])}function i1(e,t,r,n,a,i){return t=no(no(t,e),no(n,i)),no(t<<a|t>>>32-a,r)}function En(e,t,r,n,a,i,s){return i1(t&r|~t&n,e,t,a,i,s)}function An(e,t,r,n,a,i,s){return i1(t&n|r&~n,e,t,a,i,s)}function Nn(e,t,r,n,a,i,s){return i1(t^r^n,e,t,a,i,s)}function Tn(e,t,r,n,a,i,s){return i1(r^(t|~n),e,t,a,i,s)}function cb(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Op(n,SR(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(Op(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,Op(n,a),n}function SR(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}f0=_t.atob.bind(_t),o2=_t.btoa.bind(_t);var ny="0123456789abcdef".split("");function ER(e){for(var t="",r=0;r<4;r++)t+=ny[e>>8*r+4&15]+ny[e>>8*r&15];return t}function AR(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function l2(e){return cb(e).map(AR).join("")}var NR=function(e){for(var t=0;t<e.length;t++)e[t]=ER(e[t]);return e.join("")}(cb("hello"))!="5d41402abc4b2a76b9719d911017c592";function no(e,t){if(NR){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function c2(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length>>0),new Array(i+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}r=e,n=o}else o=n;var h=t.length,p=0,d=0,y="";for(l=0;l<h;l++)d=(d+(u=o[p=(p+1)%256]))%256,o[p]=o[d],o[d]=u,s=o[(o[p]+o[d])%256],y+=String.fromCharCode(t.charCodeAt(l)^s);return y}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var ay={print:4,modify:8,copy:16,"annot-forms":32};function Jl(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(o){if(ay.perm!==void 0)throw new Error("Invalid permission: "+o);a+=ay[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=l2(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=c2(this.encryptionKey,this.padding)}function Ql(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[n]}return t}function iy(e){if(Qt(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){_t.console&&ar.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Sd(e){if(!(this instanceof Sd))return new Sd(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function ub(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function qo(e,t,r,n,a){if(!(this instanceof qo))return new qo(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,ub.call(this,n,a)}function hc(e,t,r,n,a){if(!(this instanceof hc))return new hc(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,ub.call(this,n,a)}function wt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,l=16,c="S",u=null;Qt(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},d={internal:{},__private__:{}};d.__private__.PubSub=iy;var y="1.3",x=d.__private__.getPdfVersion=function(){return y};d.__private__.setPdfVersion=function(w){y=w};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return S};var v=d.__private__.getPageFormat=function(w){return S[w]};a=a||"a4";var k={COMPAT:"compat",ADVANCED:"advanced"},_=k.COMPAT;function j(){this.saveGraphicsState(),Q(new vt(He,0,0,-He,0,Es()*He).toString()+" cm"),this.setFontSize(this.getFontSize()/He),c="n",_=k.ADVANCED}function D(){this.restoreGraphicsState(),c="S",_=k.COMPAT}var z=d.__private__.combineFontStyleAndFontWeight=function(w,U){if(w=="bold"&&U=="normal"||w=="bold"&&U==400||w=="normal"&&U=="italic"||w=="bold"&&U=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(w=U==400||U==="normal"?w==="italic"?"italic":"normal":U!=700&&U!=="bold"||w!=="normal"?(U==700?"bold":U)+""+w:"bold"),w};d.advancedAPI=function(w){var U=_===k.COMPAT;return U&&j.call(this),typeof w!="function"||(w(this),U&&D.call(this)),this},d.compatAPI=function(w){var U=_===k.ADVANCED;return U&&D.call(this),typeof w!="function"||(w(this),U&&j.call(this)),this},d.isAdvancedAPI=function(){return _===k.ADVANCED};var I,T=function(w){if(_!==k.ADVANCED)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},L=d.roundToPrecision=d.__private__.roundToPrecision=function(w,U){var pe=t||U;if(isNaN(w)||isNaN(pe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(pe).replace(/0+$/,"")};I=d.hpf=d.__private__.hpf=typeof l=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return L(w,l)}:l==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return L(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return L(w,16)};var O=d.f2=d.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return L(w,2)},F=d.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return L(w,3)},N=d.scale=d.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return _===k.COMPAT?w*He:_===k.ADVANCED?w:void 0},M=function(w){return _===k.COMPAT?Es()-w:_===k.ADVANCED?w:void 0},K=function(w){return N(M(w))};d.__private__.setPrecision=d.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(t=parseInt(w,10))};var he,le="00000000000000000000000000000000",fe=d.__private__.getFileId=function(){return le},ie=d.__private__.setFileId=function(w){return le=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():le.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(wn=new Jl(u.userPermissions,u.userPassword,u.ownerPassword,le)),le};d.setFileId=function(w){return ie(w),this},d.getFileId=function(){return fe()};var q=d.__private__.convertDateToPDFDate=function(w){var U=w.getTimezoneOffset(),pe=U<0?"+":"-",xe=Math.floor(Math.abs(U/60)),Ee=Math.abs(U%60),Me=[pe,C(xe),"'",C(Ee),"'"].join("");return["D:",w.getFullYear(),C(w.getMonth()+1),C(w.getDate()),C(w.getHours()),C(w.getMinutes()),C(w.getSeconds()),Me].join("")},Z=d.__private__.convertPDFDateToDate=function(w){var U=parseInt(w.substr(2,4),10),pe=parseInt(w.substr(6,2),10)-1,xe=parseInt(w.substr(8,2),10),Ee=parseInt(w.substr(10,2),10),Me=parseInt(w.substr(12,2),10),Ve=parseInt(w.substr(14,2),10);return new Date(U,pe,xe,Ee,Me,Ve,0)},oe=d.__private__.setCreationDate=function(w){var U;if(w===void 0&&(w=new Date),w instanceof Date)U=q(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=w}return he=U},b=d.__private__.getCreationDate=function(w){var U=he;return w==="jsDate"&&(U=Z(he)),U};d.setCreationDate=function(w){return oe(w),this},d.getCreationDate=function(w){return b(w)};var A,C=d.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},R=d.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},H=0,re=[],ae=[],ne=0,me=[],we=[],X=!1,Ie=ae,Se=function(){H=0,ne=0,ae=[],re=[],me=[],ee=kr(),te=kr()};d.__private__.setCustomOutputDestination=function(w){X=!0,Ie=w};var _e=function(w){X||(Ie=w)};d.__private__.resetCustomOutputDestination=function(){X=!1,Ie=ae};var Q=d.__private__.out=function(w){return w=w.toString(),ne+=w.length+1,Ie.push(w),Ie},Oe=d.__private__.write=function(w){return Q(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},Pe=d.__private__.getArrayBuffer=function(w){for(var U=w.length,pe=new ArrayBuffer(U),xe=new Uint8Array(pe);U--;)xe[U]=w.charCodeAt(U);return pe},De=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return De};var qe=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(w){return qe=_===k.ADVANCED?w/He:w,this};var Ke,Ge=d.__private__.getFontSize=d.getFontSize=function(){return _===k.COMPAT?qe:qe*He},st=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(w){return st=w,this},d.__private__.getR2L=d.getR2L=function(){return st};var rt,ft=d.__private__.setZoomMode=function(w){var U=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))Ke=w;else if(isNaN(w)){if(U.indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');Ke=w}else Ke=parseInt(w,10)};d.__private__.getZoomMode=function(){return Ke};var lt,gt=d.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');rt=w};d.__private__.getPageMode=function(){return rt};var xt=d.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');lt=w};d.__private__.getLayoutMode=function(){return lt},d.__private__.setDisplayMode=d.setDisplayMode=function(w,U,pe){return ft(w),xt(U),gt(pe),this};var ht={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(w){if(Object.keys(ht).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ht[w]},d.__private__.getDocumentProperties=function(){return ht},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(w){for(var U in ht)ht.hasOwnProperty(U)&&w[U]&&(ht[U]=w[U]);return this},d.__private__.setDocumentProperty=function(w,U){if(Object.keys(ht).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ht[w]=U};var Ze,He,It,pt,br,Kt={},ir={},La=[],$t={},Si={},fr={},fa={},Ja=null,rr=0,St=[],Wt=new iy(d),Gi=e.hotfixes||[],Gr={},Fa={},Pa=[],vt=function w(U,pe,xe,Ee,Me,Ve){if(!(this instanceof w))return new w(U,pe,xe,Ee,Me,Ve);isNaN(U)&&(U=1),isNaN(pe)&&(pe=0),isNaN(xe)&&(xe=0),isNaN(Ee)&&(Ee=1),isNaN(Me)&&(Me=0),isNaN(Ve)&&(Ve=0),this._matrix=[U,pe,xe,Ee,Me,Ve]};Object.defineProperty(vt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(vt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(vt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(vt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(vt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(vt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(vt.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(vt.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(vt.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(vt.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(vt.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(vt.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(vt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(vt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(vt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(vt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),vt.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(w)},vt.prototype.multiply=function(w){var U=w.sx*this.sx+w.shy*this.shx,pe=w.sx*this.shy+w.shy*this.sy,xe=w.shx*this.sx+w.sy*this.shx,Ee=w.shx*this.shy+w.sy*this.sy,Me=w.tx*this.sx+w.ty*this.shx+this.tx,Ve=w.tx*this.shy+w.ty*this.sy+this.ty;return new vt(U,pe,xe,Ee,Me,Ve)},vt.prototype.decompose=function(){var w=this.sx,U=this.shy,pe=this.shx,xe=this.sy,Ee=this.tx,Me=this.ty,Ve=Math.sqrt(w*w+U*U),it=(w/=Ve)*pe+(U/=Ve)*xe;pe-=w*it,xe-=U*it;var mt=Math.sqrt(pe*pe+xe*xe);return it/=mt,w*(xe/=mt)<U*(pe/=mt)&&(w=-w,U=-U,it=-it,Ve=-Ve),{scale:new vt(Ve,0,0,mt,0,0),translate:new vt(1,0,0,1,Ee,Me),rotate:new vt(w,U,-U,w,0,0),skew:new vt(1,0,it,1,0,0)}},vt.prototype.toString=function(w){return this.join(" ")},vt.prototype.inversed=function(){var w=this.sx,U=this.shy,pe=this.shx,xe=this.sy,Ee=this.tx,Me=this.ty,Ve=1/(w*xe-U*pe),it=xe*Ve,mt=-U*Ve,Ct=-pe*Ve,At=w*Ve;return new vt(it,mt,Ct,At,-it*Ee-Ct*Me,-mt*Ee-At*Me)},vt.prototype.applyToPoint=function(w){var U=w.x*this.sx+w.y*this.shx+this.tx,pe=w.x*this.shy+w.y*this.sy+this.ty;return new Sl(U,pe)},vt.prototype.applyToRectangle=function(w){var U=this.applyToPoint(w),pe=this.applyToPoint(new Sl(w.x+w.w,w.y+w.h));return new au(U.x,U.y,pe.x-U.x,pe.y-U.y)},vt.prototype.clone=function(){var w=this.sx,U=this.shy,pe=this.shx,xe=this.sy,Ee=this.tx,Me=this.ty;return new vt(w,U,pe,xe,Ee,Me)},d.Matrix=vt;var ha=d.matrixMult=function(w,U){return U.multiply(w)},Yn=new vt(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=Yn;var yn=function(w,U){if(!Si[w]){var pe=(U instanceof qo?"Sh":"P")+(Object.keys($t).length+1).toString(10);U.id=pe,Si[w]=pe,$t[pe]=U,Wt.publish("addPattern",U)}};d.ShadingPattern=qo,d.TilingPattern=hc,d.addShadingPattern=function(w,U){return T("addShadingPattern()"),yn(w,U),this},d.beginTilingPattern=function(w){T("beginTilingPattern()"),gf(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},d.endTilingPattern=function(w,U){T("endTilingPattern()"),U.stream=we[A].join(`
`),yn(w,U),Wt.publish("endTilingPattern",U),Pa.pop().restore()};var Lr=d.__private__.newObject=function(){var w=kr();return W(w,!0),w},kr=d.__private__.newObjectDeferred=function(){return H++,re[H]=function(){return ne},H},W=function(w,U){return U=typeof U=="boolean"&&U,re[w]=ne,U&&Q(w+" 0 obj"),w},ue=d.__private__.newAdditionalObject=function(){var w={objId:kr(),content:""};return me.push(w),w},ee=kr(),te=kr(),ce=d.__private__.decodeColorString=function(w){var U=w.split(" ");if(U.length!==2||U[1]!=="g"&&U[1]!=="G")U.length===5&&(U[4]==="k"||U[4]==="K")&&(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var pe=parseFloat(U[0]);U=[pe,pe,pe,"r"]}for(var xe="#",Ee=0;Ee<3;Ee++)xe+=("0"+Math.floor(255*parseFloat(U[Ee])).toString(16)).slice(-2);return xe},de=d.__private__.encodeColorString=function(w){var U;typeof w=="string"&&(w={ch1:w});var pe=w.ch1,xe=w.ch2,Ee=w.ch3,Me=w.ch4,Ve=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof pe=="string"&&pe.charAt(0)!=="#"){var it=new lb(pe);if(it.ok)pe=it.toHex();else if(!/^\d*\.?\d*$/.test(pe))throw new Error('Invalid color "'+pe+'" passed to jsPDF.encodeColorString.')}if(typeof pe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(pe)&&(pe="#"+pe[1]+pe[1]+pe[2]+pe[2]+pe[3]+pe[3]),typeof pe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(pe)){var mt=parseInt(pe.substr(1),16);pe=mt>>16&255,xe=mt>>8&255,Ee=255&mt}if(xe===void 0||Me===void 0&&pe===xe&&xe===Ee)if(typeof pe=="string")U=pe+" "+Ve[0];else switch(w.precision){case 2:U=O(pe/255)+" "+Ve[0];break;case 3:default:U=F(pe/255)+" "+Ve[0]}else if(Me===void 0||Qt(Me)==="object"){if(Me&&!isNaN(Me.a)&&Me.a===0)return U=["1.","1.","1.",Ve[1]].join(" ");if(typeof pe=="string")U=[pe,xe,Ee,Ve[1]].join(" ");else switch(w.precision){case 2:U=[O(pe/255),O(xe/255),O(Ee/255),Ve[1]].join(" ");break;default:case 3:U=[F(pe/255),F(xe/255),F(Ee/255),Ve[1]].join(" ")}}else if(typeof pe=="string")U=[pe,xe,Ee,Me,Ve[2]].join(" ");else switch(w.precision){case 2:U=[O(pe),O(xe),O(Ee),O(Me),Ve[2]].join(" ");break;case 3:default:U=[F(pe),F(xe),F(Ee),F(Me),Ve[2]].join(" ")}return U},Ne=d.__private__.getFilters=function(){return s},je=d.__private__.putStream=function(w){var U=(w=w||{}).data||"",pe=w.filters||Ne(),xe=w.alreadyAppliedFilters||[],Ee=w.addLength1||!1,Me=U.length,Ve=w.objectId,it=function(_n){return _n};if(u!==null&&Ve===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(it=wn.encryptor(Ve,0));var mt={};pe===!0&&(pe=["FlateEncode"]);var Ct=w.additionalKeyValues||[],At=(mt=wt.API.processDataByFilters!==void 0?wt.API.processDataByFilters(U,pe):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(xe)?xe.join(" "):xe.toString());if(mt.data.length!==0&&(Ct.push({key:"Length",value:mt.data.length}),Ee===!0&&Ct.push({key:"Length1",value:Me})),At.length!=0)if(At.split("/").length-1==1)Ct.push({key:"Filter",value:At});else{Ct.push({key:"Filter",value:"["+At+"]"});for(var Bt=0;Bt<Ct.length;Bt+=1)if(Ct[Bt].key==="DecodeParms"){for(var xr=[],Sr=0;Sr<mt.reverseChain.split("/").length-1;Sr+=1)xr.push("null");xr.push(Ct[Bt].value),Ct[Bt].value="["+xr.join(" ")+"]"}}Q("<<");for(var Ur=0;Ur<Ct.length;Ur++)Q("/"+Ct[Ur].key+" "+Ct[Ur].value);Q(">>"),mt.data.length!==0&&(Q("stream"),Q(it(mt.data)),Q("endstream"))},Ae=d.__private__.putPage=function(w){var U=w.number,pe=w.data,xe=w.objId,Ee=w.contentsObjId;W(xe,!0),Q("<</Type /Page"),Q("/Parent "+w.rootDictionaryObjId+" 0 R"),Q("/Resources "+w.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(I(w.mediaBox.bottomLeftX))+" "+parseFloat(I(w.mediaBox.bottomLeftY))+" "+I(w.mediaBox.topRightX)+" "+I(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&Q("/CropBox ["+I(w.cropBox.bottomLeftX)+" "+I(w.cropBox.bottomLeftY)+" "+I(w.cropBox.topRightX)+" "+I(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&Q("/BleedBox ["+I(w.bleedBox.bottomLeftX)+" "+I(w.bleedBox.bottomLeftY)+" "+I(w.bleedBox.topRightX)+" "+I(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&Q("/TrimBox ["+I(w.trimBox.bottomLeftX)+" "+I(w.trimBox.bottomLeftY)+" "+I(w.trimBox.topRightX)+" "+I(w.trimBox.topRightY)+"]"),w.artBox!==null&&Q("/ArtBox ["+I(w.artBox.bottomLeftX)+" "+I(w.artBox.bottomLeftY)+" "+I(w.artBox.topRightX)+" "+I(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&Q("/UserUnit "+w.userUnit),Wt.publish("putPage",{objId:xe,pageContext:St[U],pageNumber:U,page:pe}),Q("/Contents "+Ee+" 0 R"),Q(">>"),Q("endobj");var Me=pe.join(`
`);return _===k.ADVANCED&&(Me+=`
Q`),W(Ee,!0),je({data:Me,filters:Ne(),objectId:Ee}),Q("endobj"),xe},Le=d.__private__.putPages=function(){var w,U,pe=[];for(w=1;w<=rr;w++)St[w].objId=kr(),St[w].contentsObjId=kr();for(w=1;w<=rr;w++)pe.push(Ae({number:w,data:we[w],objId:St[w].objId,contentsObjId:St[w].contentsObjId,mediaBox:St[w].mediaBox,cropBox:St[w].cropBox,bleedBox:St[w].bleedBox,trimBox:St[w].trimBox,artBox:St[w].artBox,userUnit:St[w].userUnit,rootDictionaryObjId:ee,resourceDictionaryObjId:te}));W(ee,!0),Q("<</Type /Pages");var xe="/Kids [";for(U=0;U<rr;U++)xe+=pe[U]+" 0 R ";Q(xe+"]"),Q("/Count "+rr),Q(">>"),Q("endobj"),Wt.publish("postPutPages")},Fe=function(w){Wt.publish("putFont",{font:w,out:Q,newObject:Lr,putStream:je}),w.isAlreadyPutted!==!0&&(w.objectNumber=Lr(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+Ql(w.postScriptName)),Q("/Subtype /Type1"),typeof w.encoding=="string"&&Q("/Encoding /"+w.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},We=function(){for(var w in Kt)Kt.hasOwnProperty(w)&&(h===!1||h===!0&&p.hasOwnProperty(w))&&Fe(Kt[w])},Qe=function(w){w.objectNumber=Lr();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[I(w.x),I(w.y),I(w.x+w.width),I(w.y+w.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var pe=w.pages[1].join(`
`);je({data:pe,additionalKeyValues:U,objectId:w.objectNumber}),Q("endobj")},at=function(){for(var w in Gr)Gr.hasOwnProperty(w)&&Qe(Gr[w])},Ye=function(w,U){var pe,xe=[],Ee=1/(U-1);for(pe=0;pe<1;pe+=Ee)xe.push(pe);if(xe.push(1),w[0].offset!=0){var Me={offset:0,color:w[0].color};w.unshift(Me)}if(w[w.length-1].offset!=1){var Ve={offset:1,color:w[w.length-1].color};w.push(Ve)}for(var it="",mt=0,Ct=0;Ct<xe.length;Ct++){for(pe=xe[Ct];pe>w[mt+1].offset;)mt++;var At=w[mt].offset,Bt=(pe-At)/(w[mt+1].offset-At),xr=w[mt].color,Sr=w[mt+1].color;it+=R(Math.round((1-Bt)*xr[0]+Bt*Sr[0]).toString(16))+R(Math.round((1-Bt)*xr[1]+Bt*Sr[1]).toString(16))+R(Math.round((1-Bt)*xr[2]+Bt*Sr[2]).toString(16))}return it.trim()},nt=function(w,U){U||(U=21);var pe=Lr(),xe=Ye(w.colors,U),Ee=[];Ee.push({key:"FunctionType",value:"0"}),Ee.push({key:"Domain",value:"[0.0 1.0]"}),Ee.push({key:"Size",value:"["+U+"]"}),Ee.push({key:"BitsPerSample",value:"8"}),Ee.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ee.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),je({data:xe,additionalKeyValues:Ee,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:pe}),Q("endobj"),w.objectNumber=Lr(),Q("<< /ShadingType "+w.type),Q("/ColorSpace /DeviceRGB");var Me="/Coords ["+I(parseFloat(w.coords[0]))+" "+I(parseFloat(w.coords[1]))+" ";w.type===2?Me+=I(parseFloat(w.coords[2]))+" "+I(parseFloat(w.coords[3])):Me+=I(parseFloat(w.coords[2]))+" "+I(parseFloat(w.coords[3]))+" "+I(parseFloat(w.coords[4]))+" "+I(parseFloat(w.coords[5])),Q(Me+="]"),w.matrix&&Q("/Matrix ["+w.matrix.toString()+"]"),Q("/Function "+pe+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},kt=function(w,U){var pe=kr(),xe=Lr();U.push({resourcesOid:pe,objectOid:xe}),w.objectNumber=xe;var Ee=[];Ee.push({key:"Type",value:"/Pattern"}),Ee.push({key:"PatternType",value:"1"}),Ee.push({key:"PaintType",value:"1"}),Ee.push({key:"TilingType",value:"1"}),Ee.push({key:"BBox",value:"["+w.boundingBox.map(I).join(" ")+"]"}),Ee.push({key:"XStep",value:I(w.xStep)}),Ee.push({key:"YStep",value:I(w.yStep)}),Ee.push({key:"Resources",value:pe+" 0 R"}),w.matrix&&Ee.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),je({data:w.stream,additionalKeyValues:Ee,objectId:w.objectNumber}),Q("endobj")},Xt=function(w){var U;for(U in $t)$t.hasOwnProperty(U)&&($t[U]instanceof qo?nt($t[U]):$t[U]instanceof hc&&kt($t[U],w))},er=function(w){for(var U in w.objectNumber=Lr(),Q("<<"),w)switch(U){case"opacity":Q("/ca "+O(w[U]));break;case"stroke-opacity":Q("/CA "+O(w[U]))}Q(">>"),Q("endobj")},Br=function(){var w;for(w in fr)fr.hasOwnProperty(w)&&er(fr[w])},Qa=function(){for(var w in Q("/XObject <<"),Gr)Gr.hasOwnProperty(w)&&Gr[w].objectNumber>=0&&Q("/"+w+" "+Gr[w].objectNumber+" 0 R");Wt.publish("putXobjectDict"),Q(">>")},Ki=function(){wn.oid=Lr(),Q("<<"),Q("/Filter /Standard"),Q("/V "+wn.v),Q("/R "+wn.r),Q("/U <"+wn.toHexString(wn.U)+">"),Q("/O <"+wn.toHexString(wn.O)+">"),Q("/P "+wn.P),Q(">>"),Q("endobj")},Ei=function(){for(var w in Q("/Font <<"),Kt)Kt.hasOwnProperty(w)&&(h===!1||h===!0&&p.hasOwnProperty(w))&&Q("/"+w+" "+Kt[w].objectNumber+" 0 R");Q(">>")},Za=function(){if(Object.keys($t).length>0){for(var w in Q("/Shading <<"),$t)$t.hasOwnProperty(w)&&$t[w]instanceof qo&&$t[w].objectNumber>=0&&Q("/"+w+" "+$t[w].objectNumber+" 0 R");Wt.publish("putShadingPatternDict"),Q(">>")}},Ai=function(w){if(Object.keys($t).length>0){for(var U in Q("/Pattern <<"),$t)$t.hasOwnProperty(U)&&$t[U]instanceof d.TilingPattern&&$t[U].objectNumber>=0&&$t[U].objectNumber<w&&Q("/"+U+" "+$t[U].objectNumber+" 0 R");Wt.publish("putTilingPatternDict"),Q(">>")}},da=function(){if(Object.keys(fr).length>0){var w;for(w in Q("/ExtGState <<"),fr)fr.hasOwnProperty(w)&&fr[w].objectNumber>=0&&Q("/"+w+" "+fr[w].objectNumber+" 0 R");Wt.publish("putGStateDict"),Q(">>")}},Fr=function(w){W(w.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ei(),Za(),Ai(w.objectOid),da(),Qa(),Q(">>"),Q("endobj")},ef=function(){var w=[];We(),Br(),at(),Xt(w),Wt.publish("putResources"),w.forEach(Fr),Fr({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),Wt.publish("postPutResources")},tf=function(){Wt.publish("putAdditionalObjects");for(var w=0;w<me.length;w++){var U=me[w];W(U.objId,!0),Q(U.content),Q("endobj")}Wt.publish("postPutAdditionalObjects")},rf=function(w){ir[w.fontName]=ir[w.fontName]||{},ir[w.fontName][w.fontStyle]=w.id},Xc=function(w,U,pe,xe,Ee){var Me={id:"F"+(Object.keys(Kt).length+1).toString(10),postScriptName:w,fontName:U,fontStyle:pe,encoding:xe,isStandardFont:Ee||!1,metadata:{}};return Wt.publish("addFont",{font:Me,instance:this}),Kt[Me.id]=Me,rf(Me),Me.id},s1=function(w){for(var U=0,pe=De.length;U<pe;U++){var xe=Xc.call(this,w[U][0],w[U][1],w[U][2],De[U][3],!0);h===!1&&(p[xe]=!0);var Ee=w[U][0].split("-");rf({id:xe,fontName:Ee[0],fontStyle:Ee[1]||""})}Wt.publish("addFonts",{fonts:Kt,dictionary:ir})},ei=function(w){return w.foo=function(){try{return w.apply(this,arguments)}catch(xe){var U=xe.stack||"";~U.indexOf(" at ")&&(U=U.split(" at ")[1]);var pe="Error in function "+U.split(`
`)[0].split("<")[0]+": "+xe.message;if(!_t.console)throw new Error(pe);_t.console.error(pe,xe),_t.alert&&alert(pe)}},w.foo.bar=w,w.foo},vl=function(w,U){var pe,xe,Ee,Me,Ve,it,mt,Ct,At;if(Ee=(U=U||{}).sourceEncoding||"Unicode",Ve=U.outputEncoding,(U.autoencode||Ve)&&Kt[Ze].metadata&&Kt[Ze].metadata[Ee]&&Kt[Ze].metadata[Ee].encoding&&(Me=Kt[Ze].metadata[Ee].encoding,!Ve&&Kt[Ze].encoding&&(Ve=Kt[Ze].encoding),!Ve&&Me.codePages&&(Ve=Me.codePages[0]),typeof Ve=="string"&&(Ve=Me[Ve]),Ve)){for(mt=!1,it=[],pe=0,xe=w.length;pe<xe;pe++)(Ct=Ve[w.charCodeAt(pe)])?it.push(String.fromCharCode(Ct)):it.push(w[pe]),it[pe].charCodeAt(0)>>8&&(mt=!0);w=it.join("")}for(pe=w.length;mt===void 0&&pe!==0;)w.charCodeAt(pe-1)>>8&&(mt=!0),pe--;if(!mt)return w;for(it=U.noBOM?[]:[254,255],pe=0,xe=w.length;pe<xe;pe++){if((At=(Ct=w.charCodeAt(pe))>>8)>>8)throw new Error("Character at position "+pe+" of string '"+w+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");it.push(At),it.push(Ct-(At<<8))}return String.fromCharCode.apply(void 0,it)},Jn=d.__private__.pdfEscape=d.pdfEscape=function(w,U){return vl(w,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Yc=d.__private__.beginPage=function(w){we[++rr]=[],St[rr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},af(rr),_e(we[A])},nf=function(w,U){var pe,xe,Ee;switch(r=U||r,typeof w=="string"&&(pe=v(w.toLowerCase()),Array.isArray(pe)&&(xe=pe[0],Ee=pe[1])),Array.isArray(w)&&(xe=w[0]*He,Ee=w[1]*He),isNaN(xe)&&(xe=a[0],Ee=a[1]),(xe>14400||Ee>14400)&&(ar.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),xe=Math.min(14400,xe),Ee=Math.min(14400,Ee)),a=[xe,Ee],r.substr(0,1)){case"l":Ee>xe&&(a=[Ee,xe]);break;case"p":xe>Ee&&(a=[Ee,xe])}Yc(a),ff(eu),Q(ti),ru!==0&&Q(ru+" J"),nu!==0&&Q(nu+" j"),Wt.publish("addPage",{pageNumber:rr})},o1=function(w){w>0&&w<=rr&&(we.splice(w,1),St.splice(w,1),rr--,A>rr&&(A=rr),this.setPage(A))},af=function(w){w>0&&w<=rr&&(A=w)},l1=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return we.length-1},sf=function(w,U,pe){var xe,Ee=void 0;return pe=pe||{},w=w!==void 0?w:Kt[Ze].fontName,U=U!==void 0?U:Kt[Ze].fontStyle,xe=w.toLowerCase(),ir[xe]!==void 0&&ir[xe][U]!==void 0?Ee=ir[xe][U]:ir[w]!==void 0&&ir[w][U]!==void 0?Ee=ir[w][U]:pe.disableWarning===!1&&ar.warn("Unable to look up font label for font '"+w+"', '"+U+"'. Refer to getFontList() for available fonts."),Ee||pe.noFallback||(Ee=ir.times[U])==null&&(Ee=ir.times.normal),Ee},c1=d.__private__.putInfo=function(){var w=Lr(),U=function(xe){return xe};for(var pe in u!==null&&(U=wn.encryptor(w,0)),Q("<<"),Q("/Producer ("+Jn(U("jsPDF "+wt.version))+")"),ht)ht.hasOwnProperty(pe)&&ht[pe]&&Q("/"+pe.substr(0,1).toUpperCase()+pe.substr(1)+" ("+Jn(U(ht[pe]))+")");Q("/CreationDate ("+Jn(U(he))+")"),Q(">>"),Q("endobj")},Jc=d.__private__.putCatalog=function(w){var U=(w=w||{}).rootDictionaryObjId||ee;switch(Lr(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+U+" 0 R"),Ke||(Ke="fullwidth"),Ke){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var pe=""+Ke;pe.substr(pe.length-1)==="%"&&(Ke=parseInt(Ke)/100),typeof Ke=="number"&&Q("/OpenAction [3 0 R /XYZ null null "+O(Ke)+"]")}switch(lt||(lt="continuous"),lt){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}rt&&Q("/PageMode /"+rt),Wt.publish("putCatalog"),Q(">>"),Q("endobj")},u1=d.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(H+1)),Q("/Root "+H+" 0 R"),Q("/Info "+(H-1)+" 0 R"),u!==null&&Q("/Encrypt "+wn.oid+" 0 R"),Q("/ID [ <"+le+"> <"+le+"> ]"),Q(">>")},f1=d.__private__.putHeader=function(){Q("%PDF-"+y),Q("%")},h1=d.__private__.putXRef=function(){var w="0000000000";Q("xref"),Q("0 "+(H+1)),Q("0000000000 65535 f ");for(var U=1;U<=H;U++)typeof re[U]=="function"?Q((w+re[U]()).slice(-10)+" 00000 n "):re[U]!==void 0?Q((w+re[U]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},Xi=d.__private__.buildDocument=function(){Se(),_e(ae),Wt.publish("buildDocument"),f1(),Le(),tf(),ef(),u!==null&&Ki(),c1(),Jc();var w=ne;return h1(),u1(),Q("startxref"),Q(""+w),Q("%%EOF"),_e(we[A]),ae.join(`
`)},yl=d.__private__.getBlob=function(w){return new Blob([Pe(w)],{type:"application/pdf"})},wl=d.output=d.__private__.output=ei(function(w,U){switch(typeof(U=U||{})=="string"?U={filename:U}:U.filename=U.filename||"generated.pdf",w){case void 0:return Xi();case"save":d.save(U.filename);break;case"arraybuffer":return Pe(Xi());case"blob":return yl(Xi());case"bloburi":case"bloburl":if(_t.URL!==void 0&&typeof _t.URL.createObjectURL=="function")return _t.URL&&_t.URL.createObjectURL(yl(Xi()))||void 0;ar.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var pe="",xe=Xi();try{pe=o2(xe)}catch{pe=o2(unescape(encodeURIComponent(xe)))}return"data:application/pdf;filename="+U.filename+";base64,"+pe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(_t)==="[object Window]"){var Ee="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Me=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(Ee=U.pdfObjectUrl,Me="");var Ve='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ee+'"'+Me+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",it=_t.open();return it!==null&&it.document.write(Ve),it}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(_t)==="[object Window]"){var mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',Ct=_t.open();if(Ct!==null){Ct.document.write(mt);var At=this;Ct.document.documentElement.querySelector("#pdfViewer").onload=function(){Ct.document.title=U.filename,Ct.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(At.output("bloburl"))}}return Ct}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(_t)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Bt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',xr=_t.open();if(xr!==null&&(xr.document.write(Bt),xr.document.title=U.filename),xr||typeof safari>"u")return xr;break;case"datauri":case"dataurl":return _t.document.location.href=this.output("datauristring",U);default:return null}}),of=function(w){return Array.isArray(Gi)===!0&&Gi.indexOf(w)>-1};switch(n){case"pt":He=1;break;case"mm":He=72/25.4;break;case"cm":He=72/2.54;break;case"in":He=72;break;case"px":He=of("px_scaling")==1?.75:96/72;break;case"pc":case"em":He=12;break;case"ex":He=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);He=n}var wn=null;oe(),ie();var d1=function(w){return u!==null?wn.encryptor(w,0):function(U){return U}},lf=d.__private__.getPageInfo=d.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[w].objId,pageNumber:w,pageContext:St[w]}},Et=d.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in St)if(St[U].objId===w)break;return lf(U)},p1=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:St[A].objId,pageNumber:A,pageContext:St[A]}};d.addPage=function(){return nf.apply(this,arguments),this},d.setPage=function(){return af.apply(this,arguments),_e.call(this,we[A]),this},d.insertPage=function(w){return this.addPage(),this.movePage(A,w),this},d.movePage=function(w,U){var pe,xe;if(w>U){pe=we[w],xe=St[w];for(var Ee=w;Ee>U;Ee--)we[Ee]=we[Ee-1],St[Ee]=St[Ee-1];we[U]=pe,St[U]=xe,this.setPage(U)}else if(w<U){pe=we[w],xe=St[w];for(var Me=w;Me<U;Me++)we[Me]=we[Me+1],St[Me]=St[Me+1];we[U]=pe,St[U]=xe,this.setPage(U)}return this},d.deletePage=function(){return o1.apply(this,arguments),this},d.__private__.text=d.text=function(w,U,pe,xe,Ee){var Me,Ve,it,mt,Ct,At,Bt,xr,Sr,Ur=(xe=xe||{}).scope||this;if(typeof w=="number"&&typeof U=="number"&&(typeof pe=="string"||Array.isArray(pe))){var _n=pe;pe=U,U=w,w=_n}if(arguments[3]instanceof vt?(T("The transform parameter of text() with a Matrix value"),Sr=Ee):(it=arguments[4],mt=arguments[5],Qt(Bt=arguments[3])==="object"&&Bt!==null||(typeof it=="string"&&(mt=it,it=null),typeof Bt=="string"&&(mt=Bt,Bt=null),typeof Bt=="number"&&(it=Bt,Bt=null),xe={flags:Bt,angle:it,align:mt})),isNaN(U)||isNaN(pe)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return Ur;var tn="",ri=!1,pa=typeof xe.lineHeightFactor=="number"?xe.lineHeightFactor:No,Ci=Ur.internal.scaleFactor;function xf(sr){return sr=sr.split("	").join(Array(xe.TabLen||9).join(" ")),Jn(sr,Bt)}function lu(sr){for(var or,Ir=sr.concat(),Kr=[],es=Ir.length;es--;)typeof(or=Ir.shift())=="string"?Kr.push(or):Array.isArray(sr)&&(or.length===1||or[1]===void 0&&or[2]===void 0)?Kr.push(or[0]):Kr.push([or[0],or[1],or[2]]);return Kr}function cu(sr,or){var Ir;if(typeof sr=="string")Ir=or(sr)[0];else if(Array.isArray(sr)){for(var Kr,es,xu=sr.concat(),Rl=[],bf=xu.length;bf--;)typeof(Kr=xu.shift())=="string"?Rl.push(or(Kr)[0]):Array.isArray(Kr)&&typeof Kr[0]=="string"&&(es=or(Kr[0],Kr[1],Kr[2]),Rl.push([es[0],es[1],es[2]]));Ir=Rl}return Ir}var Al=!1,uu=!0;if(typeof w=="string")Al=!0;else if(Array.isArray(w)){var fu=w.concat();Ve=[];for(var Nl,fn=fu.length;fn--;)(typeof(Nl=fu.shift())!="string"||Array.isArray(Nl)&&typeof Nl[0]!="string")&&(uu=!1);Al=uu}if(Al===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var Tl=qe/Ur.internal.scaleFactor,Cl=Tl*(pa-1);switch(xe.baseline){case"bottom":pe-=Cl;break;case"top":pe+=Tl-Cl;break;case"hanging":pe+=Tl-2*Cl;break;case"middle":pe+=Tl/2-Cl}if((At=xe.maxWidth||0)>0&&(typeof w=="string"?w=Ur.splitTextToSize(w,At):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(sr,or){return sr.concat(Ur.splitTextToSize(or,At))},[]))),Me={text:w,x:U,y:pe,options:xe,mutex:{pdfEscape:Jn,activeFontKey:Ze,fonts:Kt,activeFontSize:qe}},Wt.publish("preProcessText",Me),w=Me.text,it=(xe=Me.options).angle,!(Sr instanceof vt)&&it&&typeof it=="number"){it*=Math.PI/180,xe.rotationDirection===0&&(it=-it),_===k.ADVANCED&&(it=-it);var Ll=Math.cos(it),hu=Math.sin(it);Sr=new vt(Ll,hu,-hu,Ll,0,0)}else it&&it instanceof vt&&(Sr=it);_!==k.ADVANCED||Sr||(Sr=Yn),(Ct=xe.charSpace||kl)!==void 0&&(tn+=I(N(Ct))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(xr=xe.horizontalScale)!==void 0&&(tn+=I(100*xr)+` Tz
`),xe.lang;var Qn=-1,S1=xe.renderingMode!==void 0?xe.renderingMode:xe.stroke,du=Ur.internal.getCurrentPageInfo().pageContext;switch(S1){case 0:case!1:case"fill":Qn=0;break;case 1:case!0:case"stroke":Qn=1;break;case 2:case"fillThenStroke":Qn=2;break;case 3:case"invisible":Qn=3;break;case 4:case"fillAndAddForClipping":Qn=4;break;case 5:case"strokeAndAddPathForClipping":Qn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Qn=6;break;case 7:case"addToPathForClipping":Qn=7}var vf=du.usedRenderingMode!==void 0?du.usedRenderingMode:-1;Qn!==-1?tn+=Qn+` Tr
`:vf!==-1&&(tn+=`0 Tr
`),Qn!==-1&&(du.usedRenderingMode=Qn),mt=xe.align||"left";var Ia,Fl=qe*pa,yf=Ur.internal.pageSize.getWidth(),wf=Kt[Ze];Ct=xe.charSpace||kl,At=xe.maxWidth||0,Bt=Object.assign({autoencode:!0,noBOM:!0},xe.flags);var As=[],Lo=function(sr){return Ur.getStringUnitWidth(sr,{font:wf,charSpace:Ct,fontSize:qe,doKerning:!1})*qe/Ci};if(Object.prototype.toString.call(w)==="[object Array]"){var Zn;Ve=lu(w),mt!=="left"&&(Ia=Ve.map(Lo));var Mn,Ns=0;if(mt==="right"){U-=Ia[0],w=[],fn=Ve.length;for(var Ji=0;Ji<fn;Ji++)Ji===0?(Mn=Ti(U),Zn=Yi(pe)):(Mn=N(Ns-Ia[Ji]),Zn=-Fl),w.push([Ve[Ji],Mn,Zn]),Ns=Ia[Ji]}else if(mt==="center"){U-=Ia[0]/2,w=[],fn=Ve.length;for(var Qi=0;Qi<fn;Qi++)Qi===0?(Mn=Ti(U),Zn=Yi(pe)):(Mn=N((Ns-Ia[Qi])/2),Zn=-Fl),w.push([Ve[Qi],Mn,Zn]),Ns=Ia[Qi]}else if(mt==="left"){w=[],fn=Ve.length;for(var Pl=0;Pl<fn;Pl++)w.push(Ve[Pl])}else if(mt==="justify"&&wf.encoding==="Identity-H"){w=[],fn=Ve.length,At=At!==0?At:yf;for(var Zi=0,Pr=0;Pr<fn;Pr++)if(Zn=Pr===0?Yi(pe):-Fl,Mn=Pr===0?Ti(U):Zi,Pr<fn-1){var pu=N((At-Ia[Pr])/(Ve[Pr].split(" ").length-1)),Bn=Ve[Pr].split(" ");w.push([Bn[0]+" ",Mn,Zn]),Zi=0;for(var ja=1;ja<Bn.length;ja++){var Il=(Lo(Bn[ja-1]+" "+Bn[ja])-Lo(Bn[ja]))*Ci+pu;ja==Bn.length-1?w.push([Bn[ja],Il,0]):w.push([Bn[ja]+" ",Il,0]),Zi-=Il}}else w.push([Ve[Pr],Mn,Zn]);w.push(["",Zi,0])}else{if(mt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],fn=Ve.length,At=At!==0?At:yf,Pr=0;Pr<fn;Pr++)Zn=Pr===0?Yi(pe):-Fl,Mn=Pr===0?Ti(U):0,Pr<fn-1?As.push(I(N((At-Ia[Pr])/(Ve[Pr].split(" ").length-1)))):As.push(0),w.push([Ve[Pr],Mn,Zn])}}var _f=typeof xe.R2L=="boolean"?xe.R2L:st;_f===!0&&(w=cu(w,function(sr,or,Ir){return[sr.split("").reverse().join(""),or,Ir]})),Me={text:w,x:U,y:pe,options:xe,mutex:{pdfEscape:Jn,activeFontKey:Ze,fonts:Kt,activeFontSize:qe}},Wt.publish("postProcessText",Me),w=Me.text,ri=Me.mutex.isHex||!1;var mu=Kt[Ze].encoding;mu!=="WinAnsiEncoding"&&mu!=="StandardEncoding"||(w=cu(w,function(sr,or,Ir){return[xf(sr),or,Ir]})),Ve=lu(w),w=[];for(var Fo,Po,Ts,Io=0,jl=1,jo=Array.isArray(Ve[0])?jl:Io,Cs="",gu=function(sr,or,Ir){var Kr="";return Ir instanceof vt?(Ir=typeof xe.angle=="number"?ha(Ir,new vt(1,0,0,1,sr,or)):ha(new vt(1,0,0,1,sr,or),Ir),_===k.ADVANCED&&(Ir=ha(new vt(1,0,0,-1,0,0),Ir)),Kr=Ir.join(" ")+` Tm
`):Kr=I(sr)+" "+I(or)+` Td
`,Kr},Ra=0;Ra<Ve.length;Ra++){switch(Cs="",jo){case jl:Ts=(ri?"<":"(")+Ve[Ra][0]+(ri?">":")"),Fo=parseFloat(Ve[Ra][1]),Po=parseFloat(Ve[Ra][2]);break;case Io:Ts=(ri?"<":"(")+Ve[Ra]+(ri?">":")"),Fo=Ti(U),Po=Yi(pe)}As!==void 0&&As[Ra]!==void 0&&(Cs=As[Ra]+` Tw
`),Ra===0?w.push(Cs+gu(Fo,Po,Sr)+Ts):jo===Io?w.push(Cs+Ts):jo===jl&&w.push(Cs+gu(Fo,Po,Sr)+Ts)}w=jo===Io?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var Oa=`BT
/`;return Oa+=Ze+" "+qe+` Tf
`,Oa+=I(qe*pa)+` TL
`,Oa+=To+`
`,Oa+=tn,Oa+=w,Q(Oa+="ET"),p[Ze]=!0,Ur};var m1=d.__private__.clip=d.clip=function(w){return Q(w==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return m1("evenodd")},d.__private__.discardPath=d.discardPath=function(){return Q("n"),this};var Ni=d.__private__.isValidStyle=function(w){var U=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(U=!0),U};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(w){return Ni(w)&&(c=w),this};var cf=d.__private__.getStyle=d.getStyle=function(w){var U=c;switch(w){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=w}return U},uf=d.close=function(){return Q("h"),this};d.stroke=function(){return Q("S"),this},d.fill=function(w){return _l("f",w),this},d.fillEvenOdd=function(w){return _l("f*",w),this},d.fillStroke=function(w){return _l("B",w),this},d.fillStrokeEvenOdd=function(w){return _l("B*",w),this};var _l=function(w,U){Qt(U)==="object"?x1(U,w):Q(w)},Qc=function(w){w===null||_===k.ADVANCED&&w===void 0||(w=cf(w),Q(w))};function g1(w,U,pe,xe,Ee){var Me=new hc(U||this.boundingBox,pe||this.xStep,xe||this.yStep,this.gState,Ee||this.matrix);Me.stream=this.stream;var Ve=w+"$$"+this.cloneIndex+++"$$";return yn(Ve,Me),Me}var x1=function(w,U){var pe=Si[w.key],xe=$t[pe];if(xe instanceof qo)Q("q"),Q(v1(U)),xe.gState&&d.setGState(xe.gState),Q(w.matrix.toString()+" cm"),Q("/"+pe+" sh"),Q("Q");else if(xe instanceof hc){var Ee=new vt(1,0,0,-1,0,Es());w.matrix&&(Ee=Ee.multiply(w.matrix||Yn),pe=g1.call(xe,w.key,w.boundingBox,w.xStep,w.yStep,Ee).id),Q("q"),Q("/Pattern cs"),Q("/"+pe+" scn"),xe.gState&&d.setGState(xe.gState),Q(U),Q("Q")}},v1=function(w){switch(w){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Zc=d.moveTo=function(w,U){return Q(I(N(w))+" "+I(K(U))+" m"),this},Ao=d.lineTo=function(w,U){return Q(I(N(w))+" "+I(K(U))+" l"),this},ks=d.curveTo=function(w,U,pe,xe,Ee,Me){return Q([I(N(w)),I(K(U)),I(N(pe)),I(K(xe)),I(N(Ee)),I(K(Me)),"c"].join(" ")),this};d.__private__.line=d.line=function(w,U,pe,xe,Ee){if(isNaN(w)||isNaN(U)||isNaN(pe)||isNaN(xe)||!Ni(Ee))throw new Error("Invalid arguments passed to jsPDF.line");return _===k.COMPAT?this.lines([[pe-w,xe-U]],w,U,[1,1],Ee||"S"):this.lines([[pe-w,xe-U]],w,U,[1,1]).stroke()},d.__private__.lines=d.lines=function(w,U,pe,xe,Ee,Me){var Ve,it,mt,Ct,At,Bt,xr,Sr,Ur,_n,tn,ri;if(typeof w=="number"&&(ri=pe,pe=U,U=w,w=ri),xe=xe||[1,1],Me=Me||!1,isNaN(U)||isNaN(pe)||!Array.isArray(w)||!Array.isArray(xe)||!Ni(Ee)||typeof Me!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Zc(U,pe),Ve=xe[0],it=xe[1],Ct=w.length,_n=U,tn=pe,mt=0;mt<Ct;mt++)(At=w[mt]).length===2?(_n=At[0]*Ve+_n,tn=At[1]*it+tn,Ao(_n,tn)):(Bt=At[0]*Ve+_n,xr=At[1]*it+tn,Sr=At[2]*Ve+_n,Ur=At[3]*it+tn,_n=At[4]*Ve+_n,tn=At[5]*it+tn,ks(Bt,xr,Sr,Ur,_n,tn));return Me&&uf(),Qc(Ee),this},d.path=function(w){for(var U=0;U<w.length;U++){var pe=w[U],xe=pe.c;switch(pe.op){case"m":Zc(xe[0],xe[1]);break;case"l":Ao(xe[0],xe[1]);break;case"c":ks.apply(this,xe);break;case"h":uf()}}return this},d.__private__.rect=d.rect=function(w,U,pe,xe,Ee){if(isNaN(w)||isNaN(U)||isNaN(pe)||isNaN(xe)||!Ni(Ee))throw new Error("Invalid arguments passed to jsPDF.rect");return _===k.COMPAT&&(xe=-xe),Q([I(N(w)),I(K(U)),I(N(pe)),I(N(xe)),"re"].join(" ")),Qc(Ee),this},d.__private__.triangle=d.triangle=function(w,U,pe,xe,Ee,Me,Ve){if(isNaN(w)||isNaN(U)||isNaN(pe)||isNaN(xe)||isNaN(Ee)||isNaN(Me)||!Ni(Ve))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[pe-w,xe-U],[Ee-pe,Me-xe],[w-Ee,U-Me]],w,U,[1,1],Ve,!0),this},d.__private__.roundedRect=d.roundedRect=function(w,U,pe,xe,Ee,Me,Ve){if(isNaN(w)||isNaN(U)||isNaN(pe)||isNaN(xe)||isNaN(Ee)||isNaN(Me)||!Ni(Ve))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var it=4/3*(Math.SQRT2-1);return Ee=Math.min(Ee,.5*pe),Me=Math.min(Me,.5*xe),this.lines([[pe-2*Ee,0],[Ee*it,0,Ee,Me-Me*it,Ee,Me],[0,xe-2*Me],[0,Me*it,-Ee*it,Me,-Ee,Me],[2*Ee-pe,0],[-Ee*it,0,-Ee,-Me*it,-Ee,-Me],[0,2*Me-xe],[0,-Me*it,Ee*it,-Me,Ee,-Me]],w+Ee,U,[1,1],Ve,!0),this},d.__private__.ellipse=d.ellipse=function(w,U,pe,xe,Ee){if(isNaN(w)||isNaN(U)||isNaN(pe)||isNaN(xe)||!Ni(Ee))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Me=4/3*(Math.SQRT2-1)*pe,Ve=4/3*(Math.SQRT2-1)*xe;return Zc(w+pe,U),ks(w+pe,U-Ve,w+Me,U-xe,w,U-xe),ks(w-Me,U-xe,w-pe,U-Ve,w-pe,U),ks(w-pe,U+Ve,w-Me,U+xe,w,U+xe),ks(w+Me,U+xe,w+pe,U+Ve,w+pe,U),Qc(Ee),this},d.__private__.circle=d.circle=function(w,U,pe,xe){if(isNaN(w)||isNaN(U)||isNaN(pe)||!Ni(xe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,U,pe,pe,xe)},d.setFont=function(w,U,pe){return pe&&(U=z(U,pe)),Ze=sf(w,U,{disableWarning:!1}),this};var y1=d.__private__.getFont=d.getFont=function(){return Kt[sf.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var w,U,pe={};for(w in ir)if(ir.hasOwnProperty(w))for(U in pe[w]=[],ir[w])ir[w].hasOwnProperty(U)&&pe[w].push(U);return pe},d.addFont=function(w,U,pe,xe,Ee){var Me=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Me.indexOf(arguments[3])!==-1?Ee=arguments[3]:arguments[3]&&Me.indexOf(arguments[3])==-1&&(pe=z(pe,xe)),Ee=Ee||"Identity-H",Xc.call(this,w,U,pe,Ee)};var No,eu=e.lineWidth||.200025,bl=d.__private__.getLineWidth=d.getLineWidth=function(){return eu},ff=d.__private__.setLineWidth=d.setLineWidth=function(w){return eu=w,Q(I(N(w))+" w"),this};d.__private__.setLineDash=wt.API.setLineDash=wt.API.setLineDashPattern=function(w,U){if(w=w||[],U=U||0,isNaN(U)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(pe){return I(N(pe))}).join(" "),U=I(N(U)),Q("["+w+"] "+U+" d"),this};var hf=d.__private__.getLineHeight=d.getLineHeight=function(){return qe*No};d.__private__.getLineHeight=d.getLineHeight=function(){return qe*No};var df=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(No=w),this},pf=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return No};df(e.lineHeight);var Ti=d.__private__.getHorizontalCoordinate=function(w){return N(w)},Yi=d.__private__.getVerticalCoordinate=function(w){return _===k.ADVANCED?w:St[A].mediaBox.topRightY-St[A].mediaBox.bottomLeftY-N(w)},w1=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(w){return I(Ti(w))},Ss=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(w){return I(Yi(w))},ti=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return ce(ti)},d.__private__.setStrokeColor=d.setDrawColor=function(w,U,pe,xe){return ti=de({ch1:w,ch2:U,ch3:pe,ch4:xe,pdfColorType:"draw",precision:2}),Q(ti),this};var tu=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return ce(tu)},d.__private__.setFillColor=d.setFillColor=function(w,U,pe,xe){return tu=de({ch1:w,ch2:U,ch3:pe,ch4:xe,pdfColorType:"fill",precision:2}),Q(tu),this};var To=e.textColor||"0 g",_1=d.__private__.getTextColor=d.getTextColor=function(){return ce(To)};d.__private__.setTextColor=d.setTextColor=function(w,U,pe,xe){return To=de({ch1:w,ch2:U,ch3:pe,ch4:xe,pdfColorType:"text",precision:3}),this};var kl=e.charSpace,b1=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(kl||0)};d.__private__.setCharSpace=d.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return kl=w,this};var ru=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(w){var U=d.CapJoinStyles[w];if(U===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ru=U,Q(U+" J"),this};var nu=0;d.__private__.setLineJoin=d.setLineJoin=function(w){var U=d.CapJoinStyles[w];if(U===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return nu=U,Q(U+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(I(N(w))+" M"),this},d.GState=Sd,d.setGState=function(w){(w=typeof w=="string"?fr[fa[w]]:mf(null,w)).equals(Ja)||(Q("/"+w.id+" gs"),Ja=w)};var mf=function(w,U){if(!w||!fa[w]){var pe=!1;for(var xe in fr)if(fr.hasOwnProperty(xe)&&fr[xe].equals(U)){pe=!0;break}if(pe)U=fr[xe];else{var Ee="GS"+(Object.keys(fr).length+1).toString(10);fr[Ee]=U,U.id=Ee}return w&&(fa[w]=U.id),Wt.publish("addGState",U),U}};d.addGState=function(w,U){return mf(w,U),this},d.saveGraphicsState=function(){return Q("q"),La.push({key:Ze,size:qe,color:To}),this},d.restoreGraphicsState=function(){Q("Q");var w=La.pop();return Ze=w.key,qe=w.size,To=w.color,Ja=null,this},d.setCurrentTransformationMatrix=function(w){return Q(w.toString()+" cm"),this},d.comment=function(w){return Q("#"+w),this};var Sl=function(w,U){var pe=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return pe},set:function(Me){isNaN(Me)||(pe=parseFloat(Me))}});var xe=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return xe},set:function(Me){isNaN(Me)||(xe=parseFloat(Me))}});var Ee="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ee},set:function(Me){Ee=Me.toString()}}),this},au=function(w,U,pe,xe){Sl.call(this,w,U),this.type="rect";var Ee=pe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ee},set:function(Ve){isNaN(Ve)||(Ee=parseFloat(Ve))}});var Me=xe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Me},set:function(Ve){isNaN(Ve)||(Me=parseFloat(Ve))}}),this},iu=function(){this.page=rr,this.currentPage=A,this.pages=we.slice(0),this.pagesContext=St.slice(0),this.x=It,this.y=pt,this.matrix=br,this.width=Co(A),this.height=Es(A),this.outputDestination=Ie,this.id="",this.objectNumber=-1};iu.prototype.restore=function(){rr=this.page,A=this.currentPage,St=this.pagesContext,we=this.pages,It=this.x,pt=this.y,br=this.matrix,su(A,this.width),ou(A,this.height),Ie=this.outputDestination};var gf=function(w,U,pe,xe,Ee){Pa.push(new iu),rr=A=0,we=[],It=w,pt=U,br=Ee,Yc([pe,xe])},k1=function(w){if(Fa[w])Pa.pop().restore();else{var U=new iu,pe="Xo"+(Object.keys(Gr).length+1).toString(10);U.id=pe,Fa[w]=pe,Gr[pe]=U,Wt.publish("addFormObject",U),Pa.pop().restore()}};for(var El in d.beginFormObject=function(w,U,pe,xe,Ee){return gf(w,U,pe,xe,Ee),this},d.endFormObject=function(w){return k1(w),this},d.doFormObject=function(w,U){var pe=Gr[Fa[w]];return Q("q"),Q(U.toString()+" cm"),Q("/"+pe.id+" Do"),Q("Q"),this},d.getFormObject=function(w){var U=Gr[Fa[w]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},d.save=function(w,U){return w=w||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,U.returnPromise===!1?(Uo(yl(Xi()),w),typeof Uo.unload=="function"&&_t.setTimeout&&setTimeout(Uo.unload,911),this):new Promise(function(pe,xe){try{var Ee=Uo(yl(Xi()),w);typeof Uo.unload=="function"&&_t.setTimeout&&setTimeout(Uo.unload,911),pe(Ee)}catch(Me){xe(Me.message)}})},wt.API)wt.API.hasOwnProperty(El)&&(El==="events"&&wt.API.events.length?function(w,U){var pe,xe,Ee;for(Ee=U.length-1;Ee!==-1;Ee--)pe=U[Ee][0],xe=U[Ee][1],w.subscribe.apply(w,[pe].concat(typeof xe=="function"?[xe]:xe))}(Wt,wt.API.events):d[El]=wt.API[El]);var Co=d.getPageWidth=function(w){return(St[w=w||A].mediaBox.topRightX-St[w].mediaBox.bottomLeftX)/He},su=d.setPageWidth=function(w,U){St[w].mediaBox.topRightX=U*He+St[w].mediaBox.bottomLeftX},Es=d.getPageHeight=function(w){return(St[w=w||A].mediaBox.topRightY-St[w].mediaBox.bottomLeftY)/He},ou=d.setPageHeight=function(w,U){St[w].mediaBox.topRightY=U*He+St[w].mediaBox.bottomLeftY};return d.internal={pdfEscape:Jn,getStyle:cf,getFont:y1,getFontSize:Ge,getCharSpace:b1,getTextColor:_1,getLineHeight:hf,getLineHeightFactor:pf,getLineWidth:bl,write:Oe,getHorizontalCoordinate:Ti,getVerticalCoordinate:Yi,getCoordinateString:w1,getVerticalCoordinateString:Ss,collections:{},newObject:Lr,newAdditionalObject:ue,newObjectDeferred:kr,newObjectDeferredBegin:W,getFilters:Ne,putStream:je,events:Wt,scaleFactor:He,pageSize:{getWidth:function(){return Co(A)},setWidth:function(w){su(A,w)},getHeight:function(){return Es(A)},setHeight:function(w){ou(A,w)}},encryptionOptions:u,encryption:wn,getEncryptor:d1,output:wl,getNumberOfPages:l1,pages:we,out:Q,f2:O,f3:F,getPageInfo:lf,getPageInfoByObjId:Et,getCurrentPageInfo:p1,getPDFVersion:x,Point:Sl,Rectangle:au,Matrix:vt,hasHotfix:of},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Co(A)},set:function(w){su(A,w)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Es(A)},set:function(w){ou(A,w)},enumerable:!0,configurable:!0}),s1.call(d,De),Ze="F1",nf(a,r),Wt.publish("initialized"),d}Jl.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Jl.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Jl.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Jl.prototype.processOwnerPassword=function(e,t){return c2(l2(t).substr(0,5),e)},Jl.prototype.encryptor=function(e,t){var r=l2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return c2(r,n)}},Sd.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Qt(e)!==Qt(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},wt.API={events:[]},wt.version="2.5.2";var Ar=wt.API,Hg=1,xl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Vl=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Nt=function(e){return e.toFixed(2)},Us=function(e){return e.toFixed(5)};Ar.__acroform__={};var ua=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},sy=function(e){return e*Hg},Ri=function(e){var t=new hb,r=ut.internal.getHeight(e)||0,n=ut.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Nt(n)),Number(Nt(r))],t},TR=Ar.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},CR=Ar.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},LR=Ar.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Or=Ar.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return LR(e,t-1)},Dr=Ar.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return TR(e,t-1)},Mr=Ar.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return CR(e,t-1)},FR=Ar.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=r(a+s)||0,l.upperRight_Y=n(i)||0,[Number(Nt(l.lowerLeft_X)),Number(Nt(l.lowerLeft_Y)),Number(Nt(l.upperRight_X)),Number(Nt(l.upperRight_Y))]},PR=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=u2(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Nt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Ri(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},u2=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(F){return F.split(`
`)}):a.map(function(F){return[F]});var i=r,s=ut.internal.getHeight(e)||0;s=s<0?-s:s;var o=ut.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(F,N,M){if(F+1<a.length){var K=N+" "+a[F+1][0];return yh(K,e,M).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,u,h=yh("3",e,i).height,p=e.multiline?s-i:(s-h)/2,d=p+=2,y=0,x=0,S=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+yh(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var v="",k=0,_=0;_<a.length;_++)if(a.hasOwnProperty(_)){var j=!1;if(a[_].length!==1&&S!==a[_].length-1){if((h+2)*(k+2)+2>s)continue e;v+=a[_][S],j=!0,x=_,_--}else{v=(v+=a[_][S]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var D=parseInt(_),z=l(D,v,i),I=_>=a.length-1;if(z&&!I){v+=" ",S=0;continue}if(z||I){if(I)x=D;else if(e.multiline&&(h+2)*(k+2)+2>s)continue e}else{if(!e.multiline||(h+2)*(k+2)+2>s)continue e;x=D}}for(var T="",L=y;L<=x;L++){var O=a[L];if(e.multiline){if(L===x){T+=O[S]+" ",S=(S+1)%O.length;continue}if(L===y){T+=O[O.length-1]+" ";continue}}T+=O[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,u=yh(T,e,i).width,e.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;case"left":default:c=2}t+=Nt(c)+" "+Nt(d)+` Td
`,t+="("+xl(T)+`) Tj
`,t+=-Nt(c)+` 0 Td
`,d=-(i+2),u=0,y=j?x:x+1,k++,v=""}break}return n.text=t,n.fontSize=i,n},yh=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},IR={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},jR=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},RR=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),Qt(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},OR=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(bi.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(IR)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Hg=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new db,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&jR(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=FR(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ut.createDefaultAppearanceStream(o),Qt(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=PR(o);l.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var h="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var d=o.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var s in d)if(d.hasOwnProperty(s)){var y=d[s];typeof y=="function"&&(y=y.call(a,o)),h+="/"+s+" "+y+" ",a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y)}}else typeof(y=d)=="function"&&(y=y.call(a,o)),h+="/"+s+" "+y,a.internal.acroformPlugin.xForms.indexOf(y)>=0||a.internal.acroformPlugin.xForms.push(y);h+=">>"}l.push({key:"AP",value:`<<
`+h+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:o.objId}),a.internal.out("endobj")}i&&RR(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},fb=Ar.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),Qt(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+xl(n(e[i].toString()))+")"):a+=e[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Dp=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+xl(n(e))+")"},Mi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Mi.prototype.toString=function(){return this.objId+" 0 R"},Mi.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Mi.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:fb(a,this.objId,this.scope)}):a instanceof Mi?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var hb=function(){Mi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ua(hb,Mi);var db=function(){Mi.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+xl(r(e))+")"}},set:function(r){e=r}})};ua(db,Mi);var bi=function e(){Mi.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');t=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Or(t,3)},set:function(v){v?this.F=Dr(t,3):this.F=Mr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Ed)return;i="FieldObject"+e.FieldNum++}var v=function(k){return k};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+xl(v(i))+")"},set:function(v){i=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(v){i=v}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(v){s=v}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(v){l=v}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/Hg:c},set:function(v){c=v}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Ed||this instanceof Qo))return Dp(h,this.objId,this.scope)},set:function(v){v=v.toString(),h=v}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ln?p:Dp(p,this.objId,this.scope)},set:function(v){v=v.toString(),p=this instanceof ln?v:v.substr(0,1)==="("?Vl(v.substr(1,v.length-2)):Vl(v)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ln?Vl(p.substr(1,p.length-1)):p},set:function(v){v=v.toString(),p=this instanceof ln?"/"+v:v}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof ln?d:Dp(d,this.objId,this.scope)},set:function(v){v=v.toString(),d=this instanceof ln?v:v.substr(0,1)==="("?Vl(v.substr(1,v.length-2)):Vl(v)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ln?Vl(d.substr(1,d.length-1)):d},set:function(v){v=v.toString(),d=this instanceof ln?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var y,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(v){v=!!v,x=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(y)return y},set:function(v){y=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,1)},set:function(v){v?this.Ff=Dr(this.Ff,1):this.Ff=Mr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,2)},set:function(v){v?this.Ff=Dr(this.Ff,2):this.Ff=Mr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,3)},set:function(v){v?this.Ff=Dr(this.Ff,3):this.Ff=Mr(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');S=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(S){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:S=2;break;case"center":case 1:S=1;break;case"left":case 0:default:S=0}}})};ua(bi,Mi);var kc=function(){bi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return fb(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,o){o||(o=1);for(var l,c=[];l=s.exec(i);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,18)},set:function(r){r?this.Ff=Dr(this.Ff,18):this.Ff=Mr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Dr(this.Ff,19):this.Ff=Mr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,20)},set:function(r){r?(this.Ff=Dr(this.Ff,20),t.sort()):this.Ff=Mr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,22)},set:function(r){r?this.Ff=Dr(this.Ff,22):this.Ff=Mr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,23)},set:function(r){r?this.Ff=Dr(this.Ff,23):this.Ff=Mr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,27)},set:function(r){r?this.Ff=Dr(this.Ff,27):this.Ff=Mr(this.Ff,27)}}),this.hasAppearanceStream=!1};ua(kc,bi);var Sc=function(){kc.call(this),this.fontName="helvetica",this.combo=!1};ua(Sc,kc);var Ec=function(){Sc.call(this),this.combo=!0};ua(Ec,Sc);var jh=function(){Ec.call(this),this.edit=!0};ua(jh,Ec);var ln=function(){bi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,15)},set:function(r){r?this.Ff=Dr(this.Ff,15):this.Ff=Mr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,16)},set:function(r){r?this.Ff=Dr(this.Ff,16):this.Ff=Mr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,17)},set:function(r){r?this.Ff=Dr(this.Ff,17):this.Ff=Mr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,26)},set:function(r){r?this.Ff=Dr(this.Ff,26):this.Ff=Mr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+xl(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Qt(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ua(ln,bi);var Rh=function(){ln.call(this),this.pushButton=!0};ua(Rh,ln);var Ac=function(){ln.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ua(Ac,ln);var Ed=function(){var e,t;bi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+xl(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){Qt(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ut.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ua(Ed,bi),Ac.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Ac.prototype.createOption=function(e){var t=new Ed;return t.Parent=this,t.optionName=e,this.Kids.push(t),DR.call(this.scope,t),t};var Oh=function(){ln.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ut.CheckBox.createAppearanceStream()};ua(Oh,ln);var Qo=function(){bi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,13)},set:function(t){t?this.Ff=Dr(this.Ff,13):this.Ff=Mr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,21)},set:function(t){t?this.Ff=Dr(this.Ff,21):this.Ff=Mr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,23)},set:function(t){t?this.Ff=Dr(this.Ff,23):this.Ff=Mr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,24)},set:function(t){t?this.Ff=Dr(this.Ff,24):this.Ff=Mr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,25)},set:function(t){t?this.Ff=Dr(this.Ff,25):this.Ff=Mr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,26)},set:function(t){t?this.Ff=Dr(this.Ff,26):this.Ff=Mr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ua(Qo,bi);var Dh=function(){Qo.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Or(this.Ff,14)},set:function(e){e?this.Ff=Dr(this.Ff,14):this.Ff=Mr(this.Ff,14)}}),this.password=!0};ua(Dh,Qo);var ut={CheckBox:{createAppearanceStream:function(){return{N:{On:ut.CheckBox.YesNormal},D:{On:ut.CheckBox.YesPushDown,Off:ut.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ri(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=u2(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Nt(ut.internal.getWidth(e))+" "+Nt(ut.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Nt(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ri(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=ut.internal.getHeight(e),s=ut.internal.getWidth(e),o=u2(e,e.caption);return a.push("1 g"),a.push("0 0 "+Nt(s)+" "+Nt(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Nt(s-1)+" "+Nt(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Nt(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=Ri(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Nt(ut.internal.getWidth(e))+" "+Nt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Circle.YesNormal,t.D[e]=ut.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ri(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=ut.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Us(ut.internal.getWidth(e)/2)+" "+Us(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ri(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ut.internal.Bezier_C).toFixed(5)),s=Number((n*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Us(ut.internal.getWidth(e)/2)+" "+Us(ut.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Us(ut.internal.getWidth(e)/2)+" "+Us(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ri(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Us(ut.internal.getWidth(e)/2)+" "+Us(ut.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Cross.YesNormal,t.D[e]=ut.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ri(e);t.scope=e.scope;var r=[],n=ut.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Nt(ut.internal.getWidth(e)-2)+" "+Nt(ut.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Nt(n.x1.x)+" "+Nt(n.x1.y)+" m"),r.push(Nt(n.x2.x)+" "+Nt(n.x2.y)+" l"),r.push(Nt(n.x4.x)+" "+Nt(n.x4.y)+" m"),r.push(Nt(n.x3.x)+" "+Nt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ri(e);t.scope=e.scope;var r=ut.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Nt(ut.internal.getWidth(e))+" "+Nt(ut.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Nt(ut.internal.getWidth(e)-2)+" "+Nt(ut.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Nt(r.x1.x)+" "+Nt(r.x1.y)+" m"),n.push(Nt(r.x2.x)+" "+Nt(r.x2.y)+" l"),n.push(Nt(r.x4.x)+" "+Nt(r.x4.y)+" m"),n.push(Nt(r.x3.x)+" "+Nt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ri(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Nt(ut.internal.getWidth(e))+" "+Nt(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ut.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ut.internal.getWidth(e),r=ut.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ut.internal.getWidth=function(e){var t=0;return Qt(e)==="object"&&(t=sy(e.Rect[2])),t},ut.internal.getHeight=function(e){var t=0;return Qt(e)==="object"&&(t=sy(e.Rect[3])),t};var DR=Ar.addField=function(e){if(OR(this,e),!(e instanceof bi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Ar.AcroFormChoiceField=kc,Ar.AcroFormListBox=Sc,Ar.AcroFormComboBox=Ec,Ar.AcroFormEditBox=jh,Ar.AcroFormButton=ln,Ar.AcroFormPushButton=Rh,Ar.AcroFormRadioButton=Ac,Ar.AcroFormCheckBox=Oh,Ar.AcroFormTextField=Qo,Ar.AcroFormPasswordField=Dh,Ar.AcroFormAppearance=ut,Ar.AcroForm={ChoiceField:kc,ListBox:Sc,ComboBox:Ec,EditBox:jh,Button:ln,PushButton:Rh,RadioButton:Ac,CheckBox:Oh,TextField:Qo,PasswordField:Dh,Appearance:ut},wt.AcroForm={ChoiceField:kc,ListBox:Sc,ComboBox:Ec,EditBox:jh,Button:ln,PushButton:Rh,RadioButton:Ac,CheckBox:Oh,TextField:Qo,PasswordField:Dh,Appearance:ut};function pb(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(F,N){var M,K,he,le,fe,ie=t;if((N=N||t)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(z(F))for(fe in r)for(he=r[fe],M=0;M<he.length;M+=1){for(le=!0,K=0;K<he[M].length;K+=1)if(he[M][K]!==void 0&&he[M][K]!==F[K]){le=!1;break}if(le===!0){ie=fe;break}}else for(fe in r)for(he=r[fe],M=0;M<he.length;M+=1){for(le=!0,K=0;K<he[M].length;K+=1)if(he[M][K]!==void 0&&he[M][K]!==F.charCodeAt(K)){le=!1;break}if(le===!0){ie=fe;break}}return ie===t&&N!==t&&(ie=N),ie},a=function F(N){for(var M=this.internal.write,K=this.internal.putStream,he=(0,this.internal.getFilters)();he.indexOf("FlateEncode")!==-1;)he.splice(he.indexOf("FlateEncode"),1);N.objectId=this.internal.newObject();var le=[];if(le.push({key:"Type",value:"/XObject"}),le.push({key:"Subtype",value:"/Image"}),le.push({key:"Width",value:N.width}),le.push({key:"Height",value:N.height}),N.colorSpace===S.INDEXED?le.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(N.palette.length/3-1)+" "+("sMask"in N&&N.sMask!==void 0?N.objectId+2:N.objectId+1)+" 0 R]"}):(le.push({key:"ColorSpace",value:"/"+N.colorSpace}),N.colorSpace===S.DEVICE_CMYK&&le.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),le.push({key:"BitsPerComponent",value:N.bitsPerComponent}),"decodeParameters"in N&&N.decodeParameters!==void 0&&le.push({key:"DecodeParms",value:"<<"+N.decodeParameters+">>"}),"transparency"in N&&Array.isArray(N.transparency)){for(var fe="",ie=0,q=N.transparency.length;ie<q;ie++)fe+=N.transparency[ie]+" "+N.transparency[ie]+" ";le.push({key:"Mask",value:"["+fe+"]"})}N.sMask!==void 0&&le.push({key:"SMask",value:N.objectId+1+" 0 R"});var Z=N.filter!==void 0?["/"+N.filter]:void 0;if(K({data:N.data,additionalKeyValues:le,alreadyAppliedFilters:Z,objectId:N.objectId}),M("endobj"),"sMask"in N&&N.sMask!==void 0){var oe="/Predictor "+N.predictor+" /Colors 1 /BitsPerComponent "+N.bitsPerComponent+" /Columns "+N.width,b={width:N.width,height:N.height,colorSpace:"DeviceGray",bitsPerComponent:N.bitsPerComponent,decodeParameters:oe,data:N.sMask};"filter"in N&&(b.filter=N.filter),F.call(this,b)}if(N.colorSpace===S.INDEXED){var A=this.internal.newObject();K({data:T(new Uint8Array(N.palette)),objectId:A}),M("endobj")}},i=function(){var F=this.internal.collections.addImage_images;for(var N in F)a.call(this,F[N])},s=function(){var F,N=this.internal.collections.addImage_images,M=this.internal.write;for(var K in N)M("/I"+(F=N[K]).index,F.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},l=function(){var F=this.internal.collections.addImage_images;return o.call(this),F},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(F){return typeof e["process"+F.toUpperCase()]=="function"},h=function(F){return Qt(F)==="object"&&F.nodeType===1},p=function(F,N){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var M=""+F.getAttribute("src");if(M.indexOf("data:image/")===0)return f0(unescape(M).split("base64,").pop());var K=e.loadFile(M,!0);if(K!==void 0)return K}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var he;switch(N){case"PNG":he="image/png";break;case"WEBP":he="image/webp";break;case"JPEG":case"JPG":default:he="image/jpeg"}return f0(F.toDataURL(he,1).split("base64,").pop())}},d=function(F){var N=this.internal.collections.addImage_images;if(N){for(var M in N)if(F===N[M].alias)return N[M]}},y=function(F,N,M){return F||N||(F=-96,N=-96),F<0&&(F=-1*M.width*72/F/this.internal.scaleFactor),N<0&&(N=-1*M.height*72/N/this.internal.scaleFactor),F===0&&(F=N*M.width/M.height),N===0&&(N=F*M.height/M.width),[F,N]},x=function(F,N,M,K,he,le){var fe=y.call(this,M,K,he),ie=this.internal.getCoordinateString,q=this.internal.getVerticalCoordinateString,Z=l.call(this);if(M=fe[0],K=fe[1],Z[he.index]=he,le){le*=Math.PI/180;var oe=Math.cos(le),b=Math.sin(le),A=function(R){return R.toFixed(4)},C=[A(oe),A(b),A(-1*b),A(oe),0,0,"cm"]}this.internal.write("q"),le?(this.internal.write([1,"0","0",1,ie(F),q(N+K),"cm"].join(" ")),this.internal.write(C.join(" ")),this.internal.write([ie(M),"0","0",ie(K),"0","0","cm"].join(" "))):this.internal.write([ie(M),"0","0",ie(K),ie(F),q(N+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+he.index+" Do"),this.internal.write("Q")},S=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},k=e.__addimage__.sHashCode=function(F){var N,M,K=0;if(typeof F=="string")for(M=F.length,N=0;N<M;N++)K=(K<<5)-K+F.charCodeAt(N),K|=0;else if(z(F))for(M=F.byteLength/2,N=0;N<M;N++)K=(K<<5)-K+F[N],K|=0;return K},_=e.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var N=!0;return F.length===0&&(N=!1),F.length%4!=0&&(N=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(N=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(N=!1),N},j=e.__addimage__.extractImageFromDataUrl=function(F){var N=(F=F||"").split("base64,"),M=null;if(N.length===2){var K=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(N[0]);Array.isArray(K)&&(M={mimeType:K[1],charset:K[2],data:N[1]})}return M},D=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(F){return D()&&F instanceof ArrayBuffer};var z=e.__addimage__.isArrayBufferView=function(F){return D()&&typeof Uint32Array<"u"&&(F instanceof Int8Array||F instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array)},I=e.__addimage__.binaryStringToUint8Array=function(F){for(var N=F.length,M=new Uint8Array(N),K=0;K<N;K++)M[K]=F.charCodeAt(K);return M},T=e.__addimage__.arrayBufferToBinaryString=function(F){for(var N="",M=z(F)?F:new Uint8Array(F),K=0;K<M.length;K+=8192)N+=String.fromCharCode.apply(null,M.subarray(K,K+8192));return N};e.addImage=function(){var F,N,M,K,he,le,fe,ie,q;if(typeof arguments[1]=="number"?(N=t,M=arguments[1],K=arguments[2],he=arguments[3],le=arguments[4],fe=arguments[5],ie=arguments[6],q=arguments[7]):(N=arguments[1],M=arguments[2],K=arguments[3],he=arguments[4],le=arguments[5],fe=arguments[6],ie=arguments[7],q=arguments[8]),Qt(F=arguments[0])==="object"&&!h(F)&&"imageData"in F){var Z=F;F=Z.imageData,N=Z.format||N||t,M=Z.x||M||0,K=Z.y||K||0,he=Z.w||Z.width||he,le=Z.h||Z.height||le,fe=Z.alias||fe,ie=Z.compression||ie,q=Z.rotation||Z.angle||q}var oe=this.internal.getFilters();if(ie===void 0&&oe.indexOf("FlateEncode")!==-1&&(ie="SLOW"),isNaN(M)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var b=L.call(this,F,N,fe,ie);return x.call(this,M,K,he,le,b,q),this};var L=function(F,N,M,K){var he,le,fe;if(typeof F=="string"&&n(F)===t){F=unescape(F);var ie=O(F,!1);(ie!==""||(ie=e.loadFile(F,!0))!==void 0)&&(F=ie)}if(h(F)&&(F=p(F,N)),N=n(F,N),!u(N))throw new Error("addImage does not support files of type '"+N+"', please ensure that a plugin for '"+N+"' support is added.");if(((fe=M)==null||fe.length===0)&&(M=function(q){return typeof q=="string"||z(q)?k(q):z(q.data)?k(q.data):null}(F)),(he=d.call(this,M))||(D()&&(F instanceof Uint8Array||N==="RGBA"||(le=F,F=I(F))),he=this["process"+N.toUpperCase()](F,c.call(this),M,function(q){return q&&typeof q=="string"&&(q=q.toUpperCase()),q in e.image_compression?q:v.NONE}(K),le)),!he)throw new Error("An unknown error occurred whilst processing the image.");return he},O=e.__addimage__.convertBase64ToBinaryString=function(F,N){var M;N=typeof N!="boolean"||N;var K,he="";if(typeof F=="string"){K=(M=j(F))!==null?M.data:F;try{he=f0(K)}catch(le){if(N)throw _(K)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+le.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return he};e.getImageProperties=function(F){var N,M,K="";if(h(F)&&(F=p(F)),typeof F=="string"&&n(F)===t&&((K=O(F,!1))===""&&(K=e.loadFile(F)||""),F=K),M=n(F),!u(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(!D()||F instanceof Uint8Array||(F=I(F)),!(N=this["process"+M.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return N.fileType=M,N}})(wt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};wt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,u=!1,h=0;h<c.length&&!u;h++)switch((n=c[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){n=c[p];var d=this.internal.pdfEscape,y=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(x.objId),k=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(v(n.contents))+")",i+=" /Popup "+S.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+d(v(k))+") >>",x.content=i;var _=x.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+_,n.open&&(i+=" /Open true"),i+=" >>",S.content=i,this.internal.write(x.objId,"0 R",S.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+d(y(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var D=this.annotations._nameMap[n.options.name];n.options.pageNumber=D.page,n.options.top=D.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+d(y(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var z=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+z+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(n),w:l(r+a),h:c(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var u=this.splitTextToSize(r,o).length;s=Math.ceil(c*u)}else o=l,s=c;return this.text(r,n,a,i),a+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,a-c,o,s,i),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(wt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(x){return t[x.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},o=e.__arabicParser__.isArabicEndLetter=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(x){return s(x)&&a.indexOf(x.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(x){return s(x)&&i(x)&&t[x.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(x){var S=0,v=r,k="",_=0;for(S=0;S<x.length;S+=1)v[x.charCodeAt(S)]!==void 0?(_++,typeof(v=v[x.charCodeAt(S)])=="number"&&(k+=String.fromCharCode(v),v=r,_=0),S===x.length-1&&(v=r,k+=x.charAt(S-(_-1)),S-=_-1,_=0)):(v=r,k+=x.charAt(S-_),S-=_,_=0);return k};e.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(x,S,v){return s(x)?i(x)===!1?-1:!c(x)||!s(S)&&!s(v)||!s(v)&&o(S)||o(x)&&!s(S)||o(x)&&l(S)||o(x)&&o(S)?0:u(x)&&s(S)&&!o(S)&&s(v)&&c(v)?3:o(x)||!s(v)?1:2:-1},d=function(x){var S=0,v=0,k=0,_="",j="",D="",z=(x=x||"").split("\\s+"),I=[];for(S=0;S<z.length;S+=1){for(I.push(""),v=0;v<z[S].length;v+=1)_=z[S][v],j=z[S][v-1],D=z[S][v+1],s(_)?(k=p(_,j,D),I[S]+=k!==-1?String.fromCharCode(t[_.charCodeAt(0)][k]):_):I[S]+=_;I[S]=h(I[S])}return I.join(" ")},y=e.__arabicParser__.processArabic=e.processArabic=function(){var x,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(S)){var k=0;for(v=[],k=0;k<S.length;k+=1)Array.isArray(S[k])?v.push([d(S[k][0]),S[k][1],S[k][2]]):v.push([d(S[k])]);x=v}else x=d(S);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};e.events.push(["preProcessText",y])}(wt.API),wt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(wt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(x){l=x}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(x){c=x}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(x){p=x}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(x){d=x}});var y=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return y},set:function(x){y=x}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,d=0,y=0,x=0,S=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var v=c.maxWidth;v>0?typeof l=="string"?l=this.splitTextToSize(l,v):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(_,j){return _.concat(S.splitTextToSize(j,v))},[])):l=Array.isArray(l)?l:[l];for(var k=0;k<l.length;k++)d<(x=this.getStringUnitWidth(l[k],{font:h})*u)&&(d=x);return d!==0&&(y=l.length),{w:d/=p,h:Math.max((y*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=h.top,d&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};e.table=function(l,c,u,h,p){if(n.call(this),!u)throw new Error("No data for PDF table.");var d,y,x,S,v=[],k=[],_=[],j={},D={},z=[],I=[],T=(p=p||{}).autoSize||!1,L=p.printHeaders!==!1,O=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,F=p.margins||Object.assign({width:this.getPageWidth()},t),N=typeof p.padding=="number"?p.padding:3,M=p.headerBackgroundColor||"#c8c8c8",K=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=L,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=O,this.internal.__cell__.padding=N,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=K,this.setFontSize(O),h==null)k=v=Object.keys(u[0]),_=v.map(function(){return"left"});else if(Array.isArray(h)&&Qt(h[0])==="object")for(v=h.map(function(Z){return Z.name}),k=h.map(function(Z){return Z.prompt||Z.name||""}),_=h.map(function(Z){return Z.align||"left"}),d=0;d<h.length;d+=1)D[h[d].name]=h[d].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(k=v=h,_=v.map(function(){return"left"}));if(T||Array.isArray(h)&&typeof h[0]=="string")for(d=0;d<v.length;d+=1){for(j[S=v[d]]=u.map(function(Z){return Z[S]}),this.setFont(void 0,"bold"),z.push(this.getTextDimensions(k[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),y=j[S],this.setFont(void 0,"normal"),x=0;x<y.length;x+=1)z.push(this.getTextDimensions(y[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[S]=Math.max.apply(null,z)+N+N,z=[]}if(L){var he={};for(d=0;d<v.length;d+=1)he[v[d]]={},he[v[d]].text=k[d],he[v[d]].align=_[d];var le=o.call(this,he,D);I=v.map(function(Z){return new i(l,c,D[Z],le,he[Z].text,void 0,he[Z].align)}),this.setTableHeaderRow(I),this.printHeaderRow(1,!1)}var fe=h.reduce(function(Z,oe){return Z[oe.name]=oe.align,Z},{});for(d=0;d<u.length;d+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:d,data:u[d]},this);var ie=o.call(this,u[d],D);for(x=0;x<v.length;x+=1){var q=u[d][v[x]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:d,col:x,data:q},this),s.call(this,new i(l,c,D[v[x]],ie,q,d+2,fe[v[x]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(d){var y=l[d];return this.splitTextToSize(y.hasOwnProperty("text")?y.text:y,c[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*h/p+u+u},this).reduce(function(d,y){return Math.max(d,y)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,p.push(u)),u.lineNumber=l;var y=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(y)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(wt.API);var mb={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},gb=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],f2=pb(gb),xb=[100,200,300,400,500,600,700,800,900],MR=pb(xb);function h2(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return mb[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),a=function(i){return typeof f2[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function oy(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var BR={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},ly={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function cy(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function UR(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},BR,r.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(a[(i=h2(t[o])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){s=e[i.family];break}if(!(s=s||e[n]))throw new Error("Could not find a font-family for the rule '"+cy(i)+"' and default family '"+n+"'.");if(s=function(l,c){if(c[l])return c[l];var u=f2[l],h=u<=f2.normal?-1:1,p=oy(c,gb,u,h);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(i.stretch,s),s=function(l,c){if(c[l])return c[l];for(var u=mb[l],h=0;h<u.length;++h)if(c[u[h]])return c[u[h]];throw new Error("Could not find a matching font-style for "+l)}(i.style,s),!(s=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var u=MR[l],h=oy(c,xb,u,l<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+l);return h}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+cy(i)+"'.");return s}function uy(e){return e.trimLeft()}function zR(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function $R(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var wh,fy,hy,Mp=["times"];(function(e){var t,r,n,a,i,s,o,l,c,u=function(b){return b=b||{},this.isStrokeTransparent=b.isStrokeTransparent||!1,this.strokeOpacity=b.strokeOpacity||1,this.strokeStyle=b.strokeStyle||"#000000",this.fillStyle=b.fillStyle||"#000000",this.isFillTransparent=b.isFillTransparent||!1,this.fillOpacity=b.fillOpacity||1,this.font=b.font||"10px sans-serif",this.textBaseline=b.textBaseline||"alphabetic",this.textAlign=b.textAlign||"left",this.lineWidth=b.lineWidth||1,this.lineJoin=b.lineJoin||"miter",this.lineCap=b.lineCap||"butt",this.path=b.path||[],this.transform=b.transform!==void 0?b.transform.clone():new l,this.globalCompositeOperation=b.globalCompositeOperation||"normal",this.globalAlpha=b.globalAlpha||1,this.clip_path=b.clip_path||[],this.currentPoint=b.currentPoint||new s,this.miterLimit=b.miterLimit||10,this.lastPoint=b.lastPoint||new s,this.lineDashOffset=b.lineDashOffset||0,this.lineDash=b.lineDash||[],this.margin=b.margin||[0,0,0,0],this.prevPageLastElemOffset=b.prevPageLastElemOffset||0,this.ignoreClearRect=typeof b.ignoreClearRect!="boolean"||b.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var h=function(b){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var A=b;Object.defineProperty(this,"pdf",{get:function(){return A}});var C=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return C},set:function(_e){C=!!_e}});var R=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return R},set:function(_e){R=!!_e}});var H=0;Object.defineProperty(this,"posX",{get:function(){return H},set:function(_e){isNaN(_e)||(H=_e)}});var re=0;Object.defineProperty(this,"posY",{get:function(){return re},set:function(_e){isNaN(_e)||(re=_e)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(_e){var Q;typeof _e=="number"?Q=[_e,_e,_e,_e]:((Q=new Array(4))[0]=_e[0],Q[1]=_e.length>=2?_e[1]:Q[0],Q[2]=_e.length>=3?_e[2]:Q[0],Q[3]=_e.length>=4?_e[3]:Q[1]),c.margin=Q}});var ae=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ae},set:function(_e){ae=_e}});var ne=0;Object.defineProperty(this,"lastBreak",{get:function(){return ne},set:function(_e){ne=_e}});var me=[];Object.defineProperty(this,"pageBreaks",{get:function(){return me},set:function(_e){me=_e}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(_e){_e instanceof u&&(c=_e)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(_e){c.path=_e}});var we=[];Object.defineProperty(this,"ctxStack",{get:function(){return we},set:function(_e){we=_e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(_e){var Q;Q=p(_e),this.ctx.fillStyle=Q.style,this.ctx.isFillTransparent=Q.a===0,this.ctx.fillOpacity=Q.a,this.pdf.setFillColor(Q.r,Q.g,Q.b,{a:Q.a}),this.pdf.setTextColor(Q.r,Q.g,Q.b,{a:Q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(_e){var Q=p(_e);this.ctx.strokeStyle=Q.style,this.ctx.isStrokeTransparent=Q.a===0,this.ctx.strokeOpacity=Q.a,Q.a===0?this.pdf.setDrawColor(255,255,255):(Q.a,this.pdf.setDrawColor(Q.r,Q.g,Q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(_e){["butt","round","square"].indexOf(_e)!==-1&&(this.ctx.lineCap=_e,this.pdf.setLineCap(_e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(_e){isNaN(_e)||(this.ctx.lineWidth=_e,this.pdf.setLineWidth(_e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(_e){["bevel","round","miter"].indexOf(_e)!==-1&&(this.ctx.lineJoin=_e,this.pdf.setLineJoin(_e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(_e){isNaN(_e)||(this.ctx.miterLimit=_e,this.pdf.setMiterLimit(_e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(_e){this.ctx.textBaseline=_e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(_e){["right","end","center","left","start"].indexOf(_e)!==-1&&(this.ctx.textAlign=_e)}});var X=null;function Ie(_e,Q){if(X===null){var Oe=function(Pe){var De=[];return Object.keys(Pe).forEach(function(qe){Pe[qe].forEach(function(Ke){var Ge=null;switch(Ke){case"bold":Ge={family:qe,weight:"bold"};break;case"italic":Ge={family:qe,style:"italic"};break;case"bolditalic":Ge={family:qe,weight:"bold",style:"italic"};break;case"":case"normal":Ge={family:qe}}Ge!==null&&(Ge.ref={name:qe,style:Ke},De.push(Ge))})}),De}(_e.getFontList());X=function(Pe){for(var De={},qe=0;qe<Pe.length;++qe){var Ke=h2(Pe[qe]),Ge=Ke.family,st=Ke.stretch,rt=Ke.style,ft=Ke.weight;De[Ge]=De[Ge]||{},De[Ge][st]=De[Ge][st]||{},De[Ge][st][rt]=De[Ge][st][rt]||{},De[Ge][st][rt][ft]=Ke}return De}(Oe.concat(Q))}return X}var Se=null;Object.defineProperty(this,"fontFaces",{get:function(){return Se},set:function(_e){X=null,Se=_e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(_e){var Q;if(this.ctx.font=_e,(Q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(_e))!==null){var Oe=Q[1],Pe=(Q[2],Q[3]),De=Q[4],qe=(Q[5],Q[6]),Ke=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(De)[2];De=Math.floor(Ke==="px"?parseFloat(De)*this.pdf.internal.scaleFactor:Ke==="em"?parseFloat(De)*this.pdf.getFontSize():parseFloat(De)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(De);var Ge=function(ht){var Ze,He,It=[],pt=ht.trim();if(pt==="")return Mp;if(pt in ly)return[ly[pt]];for(;pt!=="";){switch(He=null,Ze=(pt=uy(pt)).charAt(0)){case'"':case"'":He=zR(pt.substring(1),Ze);break;default:He=$R(pt)}if(He===null||(It.push(He[0]),(pt=uy(He[1]))!==""&&pt.charAt(0)!==","))return Mp;pt=pt.replace(/^,/,"")}return It}(qe);if(this.fontFaces){var st=UR(Ie(this.pdf,this.fontFaces),Ge.map(function(ht){return{family:ht,stretch:"normal",weight:Pe,style:Oe}}));this.pdf.setFont(st.ref.name,st.ref.style)}else{var rt="";(Pe==="bold"||parseInt(Pe,10)>=700||Oe==="bold")&&(rt="bold"),Oe==="italic"&&(rt+="italic"),rt.length===0&&(rt="normal");for(var ft="",lt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},gt=0;gt<Ge.length;gt++){if(this.pdf.internal.getFont(Ge[gt],rt,{noFallback:!0,disableWarning:!0})!==void 0){ft=Ge[gt];break}if(rt==="bolditalic"&&this.pdf.internal.getFont(Ge[gt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ft=Ge[gt],rt="bold";else if(this.pdf.internal.getFont(Ge[gt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ft=Ge[gt],rt="normal";break}}if(ft===""){for(var xt=0;xt<Ge.length;xt++)if(lt[Ge[xt]]){ft=lt[Ge[xt]];break}}ft=ft===""?"Times":ft,this.pdf.setFont(ft,rt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(_e){this.ctx.globalCompositeOperation=_e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(_e){this.ctx.globalAlpha=_e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(_e){this.ctx.lineDashOffset=_e,oe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(_e){this.ctx.lineDash=_e,oe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(_e){this.ctx.ignoreClearRect=!!_e}})};h.prototype.setLineDash=function(b){this.lineDash=b},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){j.call(this,"fill",!1)},h.prototype.stroke=function(){j.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(b,A){if(isNaN(b)||isNaN(A))throw ar.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var C=this.ctx.transform.applyToPoint(new s(b,A));this.path.push({type:"mt",x:C.x,y:C.y}),this.ctx.lastPoint=new s(b,A)},h.prototype.closePath=function(){var b=new s(0,0),A=0;for(A=this.path.length-1;A!==-1;A--)if(this.path[A].type==="begin"&&Qt(this.path[A+1])==="object"&&typeof this.path[A+1].x=="number"){b=new s(this.path[A+1].x,this.path[A+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(b.x,b.y)},h.prototype.lineTo=function(b,A){if(isNaN(b)||isNaN(A))throw ar.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var C=this.ctx.transform.applyToPoint(new s(b,A));this.path.push({type:"lt",x:C.x,y:C.y}),this.ctx.lastPoint=new s(C.x,C.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},h.prototype.quadraticCurveTo=function(b,A,C,R){if(isNaN(C)||isNaN(R)||isNaN(b)||isNaN(A))throw ar.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var H=this.ctx.transform.applyToPoint(new s(C,R)),re=this.ctx.transform.applyToPoint(new s(b,A));this.path.push({type:"qct",x1:re.x,y1:re.y,x:H.x,y:H.y}),this.ctx.lastPoint=new s(H.x,H.y)},h.prototype.bezierCurveTo=function(b,A,C,R,H,re){if(isNaN(H)||isNaN(re)||isNaN(b)||isNaN(A)||isNaN(C)||isNaN(R))throw ar.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ae=this.ctx.transform.applyToPoint(new s(H,re)),ne=this.ctx.transform.applyToPoint(new s(b,A)),me=this.ctx.transform.applyToPoint(new s(C,R));this.path.push({type:"bct",x1:ne.x,y1:ne.y,x2:me.x,y2:me.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new s(ae.x,ae.y)},h.prototype.arc=function(b,A,C,R,H,re){if(isNaN(b)||isNaN(A)||isNaN(C)||isNaN(R)||isNaN(H))throw ar.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(re=!!re,!this.ctx.transform.isIdentity){var ae=this.ctx.transform.applyToPoint(new s(b,A));b=ae.x,A=ae.y;var ne=this.ctx.transform.applyToPoint(new s(0,C)),me=this.ctx.transform.applyToPoint(new s(0,0));C=Math.sqrt(Math.pow(ne.x-me.x,2)+Math.pow(ne.y-me.y,2))}Math.abs(H-R)>=2*Math.PI&&(R=0,H=2*Math.PI),this.path.push({type:"arc",x:b,y:A,radius:C,startAngle:R,endAngle:H,counterclockwise:re})},h.prototype.arcTo=function(b,A,C,R,H){throw new Error("arcTo not implemented.")},h.prototype.rect=function(b,A,C,R){if(isNaN(b)||isNaN(A)||isNaN(C)||isNaN(R))throw ar.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(b,A),this.lineTo(b+C,A),this.lineTo(b+C,A+R),this.lineTo(b,A+R),this.lineTo(b,A),this.lineTo(b+C,A),this.lineTo(b,A)},h.prototype.fillRect=function(b,A,C,R){if(isNaN(b)||isNaN(A)||isNaN(C)||isNaN(R))throw ar.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var H={};this.lineCap!=="butt"&&(H.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(H.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(b,A,C,R),this.fill(),H.hasOwnProperty("lineCap")&&(this.lineCap=H.lineCap),H.hasOwnProperty("lineJoin")&&(this.lineJoin=H.lineJoin)}},h.prototype.strokeRect=function(b,A,C,R){if(isNaN(b)||isNaN(A)||isNaN(C)||isNaN(R))throw ar.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");y.call(this)||(this.beginPath(),this.rect(b,A,C,R),this.stroke())},h.prototype.clearRect=function(b,A,C,R){if(isNaN(b)||isNaN(A)||isNaN(C)||isNaN(R))throw ar.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(b,A,C,R))},h.prototype.save=function(b){b=typeof b!="boolean"||b;for(var A=this.pdf.internal.getCurrentPageInfo().pageNumber,C=0;C<this.pdf.internal.getNumberOfPages();C++)this.pdf.setPage(C+1),this.pdf.internal.out("q");if(this.pdf.setPage(A),b){this.ctx.fontSize=this.pdf.internal.getFontSize();var R=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=R}},h.prototype.restore=function(b){b=typeof b!="boolean"||b;for(var A=this.pdf.internal.getCurrentPageInfo().pageNumber,C=0;C<this.pdf.internal.getNumberOfPages();C++)this.pdf.setPage(C+1),this.pdf.internal.out("Q");this.pdf.setPage(A),b&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(b){var A,C,R,H;if(b.isCanvasGradient===!0&&(b=b.getColor()),!b)return{r:0,g:0,b:0,a:0,style:b};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(b))A=0,C=0,R=0,H=0;else{var re=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(b);if(re!==null)A=parseInt(re[1]),C=parseInt(re[2]),R=parseInt(re[3]),H=1;else if((re=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(b))!==null)A=parseInt(re[1]),C=parseInt(re[2]),R=parseInt(re[3]),H=parseFloat(re[4]);else{if(H=1,typeof b=="string"&&b.charAt(0)!=="#"){var ae=new lb(b);b=ae.ok?ae.toHex():"#000000"}b.length===4?(A=b.substring(1,2),A+=A,C=b.substring(2,3),C+=C,R=b.substring(3,4),R+=R):(A=b.substring(1,3),C=b.substring(3,5),R=b.substring(5,7)),A=parseInt(A,16),C=parseInt(C,16),R=parseInt(R,16)}}return{r:A,g:C,b:R,a:H,style:b}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},y=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(b,A,C,R){if(isNaN(A)||isNaN(C)||typeof b!="string")throw ar.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(R=isNaN(R)?void 0:R,!d.call(this)){var H=ie(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;N.call(this,{text:b,x:A,y:C,scale:re,angle:H,align:this.textAlign,maxWidth:R})}},h.prototype.strokeText=function(b,A,C,R){if(isNaN(A)||isNaN(C)||typeof b!="string")throw ar.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!y.call(this)){R=isNaN(R)?void 0:R;var H=ie(this.ctx.transform.rotation),re=this.ctx.transform.scaleX;N.call(this,{text:b,x:A,y:C,scale:re,renderingMode:"stroke",angle:H,align:this.textAlign,maxWidth:R})}},h.prototype.measureText=function(b){if(typeof b!="string")throw ar.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var A=this.pdf,C=this.pdf.internal.scaleFactor,R=A.internal.getFontSize(),H=A.getStringUnitWidth(b)*R/A.internal.scaleFactor,re=function(ae){var ne=(ae=ae||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ne}}),this};return new re({width:H*=Math.round(96*C/72*1e4)/1e4})},h.prototype.scale=function(b,A){if(isNaN(b)||isNaN(A))throw ar.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var C=new l(b,0,0,A,0,0);this.ctx.transform=this.ctx.transform.multiply(C)},h.prototype.rotate=function(b){if(isNaN(b))throw ar.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var A=new l(Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0);this.ctx.transform=this.ctx.transform.multiply(A)},h.prototype.translate=function(b,A){if(isNaN(b)||isNaN(A))throw ar.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var C=new l(1,0,0,1,b,A);this.ctx.transform=this.ctx.transform.multiply(C)},h.prototype.transform=function(b,A,C,R,H,re){if(isNaN(b)||isNaN(A)||isNaN(C)||isNaN(R)||isNaN(H)||isNaN(re))throw ar.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ae=new l(b,A,C,R,H,re);this.ctx.transform=this.ctx.transform.multiply(ae)},h.prototype.setTransform=function(b,A,C,R,H,re){b=isNaN(b)?1:b,A=isNaN(A)?0:A,C=isNaN(C)?0:C,R=isNaN(R)?1:R,H=isNaN(H)?0:H,re=isNaN(re)?0:re,this.ctx.transform=new l(b,A,C,R,H,re)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(b,A,C,R,H,re,ae,ne,me){var we=this.pdf.getImageProperties(b),X=1,Ie=1,Se=1,_e=1;R!==void 0&&ne!==void 0&&(Se=ne/R,_e=me/H,X=we.width/R*ne/R,Ie=we.height/H*me/H),re===void 0&&(re=A,ae=C,A=0,C=0),R!==void 0&&ne===void 0&&(ne=R,me=H),R===void 0&&ne===void 0&&(ne=we.width,me=we.height);for(var Q,Oe=this.ctx.transform.decompose(),Pe=ie(Oe.rotate.shx),De=new l,qe=(De=(De=(De=De.multiply(Oe.translate)).multiply(Oe.skew)).multiply(Oe.scale)).applyToRectangle(new o(re-A*Se,ae-C*_e,R*X,H*Ie)),Ke=S.call(this,qe),Ge=[],st=0;st<Ke.length;st+=1)Ge.indexOf(Ke[st])===-1&&Ge.push(Ke[st]);if(_(Ge),this.autoPaging)for(var rt=Ge[0],ft=Ge[Ge.length-1],lt=rt;lt<ft+1;lt++){this.pdf.setPage(lt);var gt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=lt===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],He=lt===1?0:ht+(lt-2)*Ze;if(this.ctx.clip_path.length!==0){var It=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(Q,this.posX+this.margin[3],-He+xt+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=It}var pt=JSON.parse(JSON.stringify(qe));pt=k([pt],this.posX+this.margin[3],-He+xt+this.ctx.prevPageLastElemOffset)[0];var br=(lt>rt||lt<ft)&&x.call(this);br&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],gt,Ze,null).clip().discardPath()),this.pdf.addImage(b,"JPEG",pt.x,pt.y,pt.w,pt.h,null,null,Pe),br&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(b,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,Pe)};var S=function(b,A,C){var R=[];A=A||this.pdf.internal.pageSize.width,C=C||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var H=this.posY+this.ctx.prevPageLastElemOffset;switch(b.type){default:case"mt":case"lt":R.push(Math.floor((b.y+H)/C)+1);break;case"arc":R.push(Math.floor((b.y+H-b.radius)/C)+1),R.push(Math.floor((b.y+H+b.radius)/C)+1);break;case"qct":var re=q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,b.x1,b.y1,b.x,b.y);R.push(Math.floor((re.y+H)/C)+1),R.push(Math.floor((re.y+re.h+H)/C)+1);break;case"bct":var ae=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,b.x1,b.y1,b.x2,b.y2,b.x,b.y);R.push(Math.floor((ae.y+H)/C)+1),R.push(Math.floor((ae.y+ae.h+H)/C)+1);break;case"rect":R.push(Math.floor((b.y+H)/C)+1),R.push(Math.floor((b.y+b.h+H)/C)+1)}for(var ne=0;ne<R.length;ne+=1)for(;this.pdf.internal.getNumberOfPages()<R[ne];)v.call(this);return R},v=function(){var b=this.fillStyle,A=this.strokeStyle,C=this.font,R=this.lineCap,H=this.lineWidth,re=this.lineJoin;this.pdf.addPage(),this.fillStyle=b,this.strokeStyle=A,this.font=C,this.lineCap=R,this.lineWidth=H,this.lineJoin=re},k=function(b,A,C){for(var R=0;R<b.length;R++)switch(b[R].type){case"bct":b[R].x2+=A,b[R].y2+=C;case"qct":b[R].x1+=A,b[R].y1+=C;case"mt":case"lt":case"arc":default:b[R].x+=A,b[R].y+=C}return b},_=function(b){return b.sort(function(A,C){return A-C})},j=function(b,A){for(var C,R,H=this.fillStyle,re=this.strokeStyle,ae=this.lineCap,ne=this.lineWidth,me=Math.abs(ne*this.ctx.transform.scaleX),we=this.lineJoin,X=JSON.parse(JSON.stringify(this.path)),Ie=JSON.parse(JSON.stringify(this.path)),Se=[],_e=0;_e<Ie.length;_e++)if(Ie[_e].x!==void 0)for(var Q=S.call(this,Ie[_e]),Oe=0;Oe<Q.length;Oe+=1)Se.indexOf(Q[Oe])===-1&&Se.push(Q[Oe]);for(var Pe=0;Pe<Se.length;Pe++)for(;this.pdf.internal.getNumberOfPages()<Se[Pe];)v.call(this);if(_(Se),this.autoPaging)for(var De=Se[0],qe=Se[Se.length-1],Ke=De;Ke<qe+1;Ke++){this.pdf.setPage(Ke),this.fillStyle=H,this.strokeStyle=re,this.lineCap=ae,this.lineWidth=me,this.lineJoin=we;var Ge=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],st=Ke===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],lt=Ke===1?0:rt+(Ke-2)*ft;if(this.ctx.clip_path.length!==0){var gt=this.path;C=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(C,this.posX+this.margin[3],-lt+st+this.ctx.prevPageLastElemOffset),D.call(this,b,!0),this.path=gt}if(R=JSON.parse(JSON.stringify(X)),this.path=k(R,this.posX+this.margin[3],-lt+st+this.ctx.prevPageLastElemOffset),A===!1||Ke===0){var xt=(Ke>De||Ke<qe)&&x.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ge,ft,null).clip().discardPath()),D.call(this,b,A),xt&&this.pdf.restoreGraphicsState()}this.lineWidth=ne}else this.lineWidth=me,D.call(this,b,A),this.lineWidth=ne;this.path=X},D=function(b,A){if((b!=="stroke"||A||!y.call(this))&&(b==="stroke"||A||!d.call(this))){for(var C,R,H=[],re=this.path,ae=0;ae<re.length;ae++){var ne=re[ae];switch(ne.type){case"begin":H.push({begin:!0});break;case"close":H.push({close:!0});break;case"mt":H.push({start:ne,deltas:[],abs:[]});break;case"lt":var me=H.length;if(re[ae-1]&&!isNaN(re[ae-1].x)&&(C=[ne.x-re[ae-1].x,ne.y-re[ae-1].y],me>0)){for(;me>=0;me--)if(H[me-1].close!==!0&&H[me-1].begin!==!0){H[me-1].deltas.push(C),H[me-1].abs.push(ne);break}}break;case"bct":C=[ne.x1-re[ae-1].x,ne.y1-re[ae-1].y,ne.x2-re[ae-1].x,ne.y2-re[ae-1].y,ne.x-re[ae-1].x,ne.y-re[ae-1].y],H[H.length-1].deltas.push(C);break;case"qct":var we=re[ae-1].x+2/3*(ne.x1-re[ae-1].x),X=re[ae-1].y+2/3*(ne.y1-re[ae-1].y),Ie=ne.x+2/3*(ne.x1-ne.x),Se=ne.y+2/3*(ne.y1-ne.y),_e=ne.x,Q=ne.y;C=[we-re[ae-1].x,X-re[ae-1].y,Ie-re[ae-1].x,Se-re[ae-1].y,_e-re[ae-1].x,Q-re[ae-1].y],H[H.length-1].deltas.push(C);break;case"arc":H.push({deltas:[],abs:[],arc:!0}),Array.isArray(H[H.length-1].abs)&&H[H.length-1].abs.push(ne)}}R=A?null:b==="stroke"?"stroke":"fill";for(var Oe=!1,Pe=0;Pe<H.length;Pe++)if(H[Pe].arc)for(var De=H[Pe].abs,qe=0;qe<De.length;qe++){var Ke=De[qe];Ke.type==="arc"?T.call(this,Ke.x,Ke.y,Ke.radius,Ke.startAngle,Ke.endAngle,Ke.counterclockwise,void 0,A,!Oe):M.call(this,Ke.x,Ke.y),Oe=!0}else if(H[Pe].close===!0)this.pdf.internal.out("h"),Oe=!1;else if(H[Pe].begin!==!0){var Ge=H[Pe].start.x,st=H[Pe].start.y;K.call(this,H[Pe].deltas,Ge,st),Oe=!0}R&&L.call(this,R),A&&O.call(this)}},z=function(b){var A=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,C=A*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return b-C;case"top":return b+A-C;case"hanging":return b+A-2*C;case"middle":return b+A/2-C;case"ideographic":return b;case"alphabetic":default:return b}},I=function(b){return b+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var b=function(){};return b.colorStops=[],b.addColorStop=function(A,C){this.colorStops.push([A,C])},b.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},b.isCanvasGradient=!0,b},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(b,A,C,R,H,re,ae,ne,me){for(var we=le.call(this,C,R,H,re),X=0;X<we.length;X++){var Ie=we[X];X===0&&(me?F.call(this,Ie.x1+b,Ie.y1+A):M.call(this,Ie.x1+b,Ie.y1+A)),he.call(this,b,A,Ie.x2,Ie.y2,Ie.x3,Ie.y3,Ie.x4,Ie.y4)}ne?O.call(this):L.call(this,ae)},L=function(b){switch(b){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},O=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(b,A){this.pdf.internal.out(r(b)+" "+n(A)+" m")},N=function(b){var A;switch(b.align){case"right":case"end":A="right";break;case"center":A="center";break;case"left":case"start":default:A="left"}var C=this.pdf.getTextDimensions(b.text),R=z.call(this,b.y),H=I.call(this,R)-C.h,re=this.ctx.transform.applyToPoint(new s(b.x,R)),ae=this.ctx.transform.decompose(),ne=new l;ne=(ne=(ne=ne.multiply(ae.translate)).multiply(ae.skew)).multiply(ae.scale);for(var me,we,X,Ie=this.ctx.transform.applyToRectangle(new o(b.x,R,C.w,C.h)),Se=ne.applyToRectangle(new o(b.x,H,C.w,C.h)),_e=S.call(this,Se),Q=[],Oe=0;Oe<_e.length;Oe+=1)Q.indexOf(_e[Oe])===-1&&Q.push(_e[Oe]);if(_(Q),this.autoPaging)for(var Pe=Q[0],De=Q[Q.length-1],qe=Pe;qe<De+1;qe++){this.pdf.setPage(qe);var Ke=qe===1?this.posY+this.margin[0]:this.margin[0],Ge=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],st=this.pdf.internal.pageSize.height-this.margin[2],rt=st-this.margin[0],ft=this.pdf.internal.pageSize.width-this.margin[1],lt=ft-this.margin[3],gt=qe===1?0:Ge+(qe-2)*rt;if(this.ctx.clip_path.length!==0){var xt=this.path;me=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=k(me,this.posX+this.margin[3],-1*gt+Ke),D.call(this,"fill",!0),this.path=xt}var ht=k([JSON.parse(JSON.stringify(Se))],this.posX+this.margin[3],-gt+Ke+this.ctx.prevPageLastElemOffset)[0];b.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*b.scale),X=this.lineWidth,this.lineWidth=X*b.scale);var Ze=this.autoPaging!=="text";if(Ze||ht.y+ht.h<=st){if(Ze||ht.y>=Ke&&ht.x<=ft){var He=Ze?b.text:this.pdf.splitTextToSize(b.text,b.maxWidth||ft-ht.x)[0],It=k([JSON.parse(JSON.stringify(Ie))],this.posX+this.margin[3],-gt+Ke+this.ctx.prevPageLastElemOffset)[0],pt=Ze&&(qe>Pe||qe<De)&&x.call(this);pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,rt,null).clip().discardPath()),this.pdf.text(He,It.x,It.y,{angle:b.angle,align:A,renderingMode:b.renderingMode}),pt&&this.pdf.restoreGraphicsState()}}else ht.y<st&&(this.ctx.prevPageLastElemOffset+=st-ht.y);b.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=X)}else b.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*b.scale),X=this.lineWidth,this.lineWidth=X*b.scale),this.pdf.text(b.text,re.x+this.posX,re.y+this.posY,{angle:b.angle,align:A,renderingMode:b.renderingMode,maxWidth:b.maxWidth}),b.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=X)},M=function(b,A,C,R){C=C||0,R=R||0,this.pdf.internal.out(r(b+C)+" "+n(A+R)+" l")},K=function(b,A,C){return this.pdf.lines(b,A,C,null,null)},he=function(b,A,C,R,H,re,ae,ne){this.pdf.internal.out([t(a(C+b)),t(i(R+A)),t(a(H+b)),t(i(re+A)),t(a(ae+b)),t(i(ne+A)),"c"].join(" "))},le=function(b,A,C,R){for(var H=2*Math.PI,re=Math.PI/2;A>C;)A-=H;var ae=Math.abs(C-A);ae<H&&R&&(ae=H-ae);for(var ne=[],me=R?-1:1,we=A;ae>1e-5;){var X=we+me*Math.min(ae,re);ne.push(fe.call(this,b,we,X)),ae-=Math.abs(X-we),we=X}return ne},fe=function(b,A,C){var R=(C-A)/2,H=b*Math.cos(R),re=b*Math.sin(R),ae=H,ne=-re,me=ae*ae+ne*ne,we=me+ae*H+ne*re,X=4/3*(Math.sqrt(2*me*we)-we)/(ae*re-ne*H),Ie=ae-X*ne,Se=ne+X*ae,_e=Ie,Q=-Se,Oe=R+A,Pe=Math.cos(Oe),De=Math.sin(Oe);return{x1:b*Math.cos(A),y1:b*Math.sin(A),x2:Ie*Pe-Se*De,y2:Ie*De+Se*Pe,x3:_e*Pe-Q*De,y3:_e*De+Q*Pe,x4:b*Math.cos(C),y4:b*Math.sin(C)}},ie=function(b){return 180*b/Math.PI},q=function(b,A,C,R,H,re){var ae=b+.5*(C-b),ne=A+.5*(R-A),me=H+.5*(C-H),we=re+.5*(R-re),X=Math.min(b,H,ae,me),Ie=Math.max(b,H,ae,me),Se=Math.min(A,re,ne,we),_e=Math.max(A,re,ne,we);return new o(X,Se,Ie-X,_e-Se)},Z=function(b,A,C,R,H,re,ae,ne){var me,we,X,Ie,Se,_e,Q,Oe,Pe,De,qe,Ke,Ge,st,rt=C-b,ft=R-A,lt=H-C,gt=re-R,xt=ae-H,ht=ne-re;for(we=0;we<41;we++)Pe=(Q=(X=b+(me=we/40)*rt)+me*((Se=C+me*lt)-X))+me*(Se+me*(H+me*xt-Se)-Q),De=(Oe=(Ie=A+me*ft)+me*((_e=R+me*gt)-Ie))+me*(_e+me*(re+me*ht-_e)-Oe),we==0?(qe=Pe,Ke=De,Ge=Pe,st=De):(qe=Math.min(qe,Pe),Ke=Math.min(Ke,De),Ge=Math.max(Ge,Pe),st=Math.max(st,De));return new o(Math.round(qe),Math.round(Ke),Math.round(Ge-qe),Math.round(st-Ke))},oe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var b,A,C=(b=this.ctx.lineDash,A=this.ctx.lineDashOffset,JSON.stringify({lineDash:b,lineDashOffset:A}));this.prevLineDash!==C&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=C)}}})(wt.API),function(e){var t=function(i){var s,o,l,c,u,h,p,d,y,x;for(o=[],l=0,c=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;c>l;l+=4)(u=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(h=(u=((u=((u=((u=(u-(x=u%85))/85)-(y=u%85))/85)-(d=u%85))/85)-(p=u%85))/85)%85,o.push(h+33,p+33,d+33,y+33,x+33)):o.push(122);return function(S,v){for(var k=v;k>0;k--)S.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},r=function(i){var s,o,l,c,u,h=String,p="length",d=255,y="charCodeAt",x="slice",S="replace";for(i[x](-2),i=i[x](0,-2)[S](/\s/g,"")[S]("z","!!!!!"),l=[],c=0,u=(i+=s="uuuuu"[x](i[p]%5||5))[p];u>c;c+=5)o=52200625*(i[y](c)-33)+614125*(i[y](c+1)-33)+7225*(i[y](c+2)-33)+85*(i[y](c+3)-33)+(i[y](c+4)-33),l.push(d&o>>24,d&o>>16,d&o>>8,d&o);return function(v,k){for(var _=k;_>0;_--)v.pop()}(l,s[p]),h.fromCharCode.apply(h,l)},n=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",l=0;l<i.length;l+=2)o+=String.fromCharCode("0x"+(i[l]+i[l+1]));return o},a=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=s2(s)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};e.processDataByFilters=function(i,s){var o=0,l=i||"",c=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=a(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(wt.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,c,u){var h=new XMLHttpRequest,p=0,d=function(y){var x=y.length,S=[],v=String.fromCharCode;for(p=0;p<x;p+=1)S.push(v(255&y.charCodeAt(p)));return S.join("")};if(h.open("GET",l,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?u(d(this.responseText)):u(void 0)}),h.send(null),c&&h.status===200)return d(h.responseText)}(a,i,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(wt.API),function(e){function t(){return(_t.html2canvas?Promise.resolve(_t.html2canvas):vs(()=>import("./html2canvas.esm-e0a7d97b.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(_t.DOMPurify?Promise.resolve(_t.DOMPurify):vs(()=>import("./purify.es-2de9db7f.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=Qt(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(s,o){var l=document.createElement(s);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},i=function s(o){var l=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),c=s.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(l){return this.set({src:a("div",{innerHTML:s,dompurify:l})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,u){for(var h=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||h.appendChild(l(p,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(h.width=c.width,h.height=c.height,h.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(h.value=c.value),h.addEventListener("load",function(){h.scrollTop=c.scrollTop,h.scrollLeft=c.scrollLeft},!0)),h}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var d=c[p],y=d.src.find(function(x){return x.format==="truetype"});y&&l.addFont(y.url,d.ref.name,d.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,l.context2d.save(!0),o(this.prop.container,h)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=s[l]};switch(l){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[l]=s[l]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var l=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(l):l})},i.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(s=s||wt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,l,c){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,l,c){return this.setProgress(s?this.progress.val+s:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(s,o){var l=this;return this.thenCore(s,o,function(c,u){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(h){return l.updateProgress(null,c),h}).then(c,u).then(function(h){return l.updateProgress(1),h})})},i.prototype.thenCore=function(s,o,l){l=l||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=l.call(c,s,o);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(l){o=o.thenCore(l)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,wt.getPageSize=function(s,o,l){if(Qt(s)==="object"){var c=s;s=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",s=(""+(s||"P")).toLowerCase();var u,h=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var d,y=0,x=0;if(p.hasOwnProperty(h))y=p[h][1]/u,x=p[h][0]/u;else try{y=l[1],x=l[0]}catch{throw new Error("Invalid format: "+l)}if(s==="p"||s==="portrait")s="p",x>y&&(d=x,x=y,y=d);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",y>x&&(d=x,x=y,y=d)}return{width:x,height:y,unit:o,k:u,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(h2):null;var l=new i(o);return o.worker?l:l.from(s).doCallback()}}(wt.API),wt.API.addJS=function(e){return hy=e,this.internal.events.subscribe("postPutResources",function(){wh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(wh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),fy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+hy+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){wh!==void 0&&fy!==void 0&&this.internal.out("/Names <</JavaScript "+wh+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(i=0;i<c;i++){var h=r.internal.newObject();u.push(h);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(wt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(h){for(var p,d=256*h.charCodeAt(4)+h.charCodeAt(5),y=h.length,x={width:0,height:0,numcomponents:1},S=4;S<y;S+=2){if(S+=d,t.indexOf(h.charCodeAt(S+1))!==-1){p=256*h.charCodeAt(S+5)+h.charCodeAt(S+6),x={width:256*h.charCodeAt(S+7)+h.charCodeAt(S+8),height:p,numcomponents:h.charCodeAt(S+9)};break}d=256*h.charCodeAt(S+2)+h.charCodeAt(S+3)}return x}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:a}}return u}}(wt.API);var Wl,_h,dy,py,my,qR=function(){var e,t,r;function n(i){var s,o,l,c,u,h,p,d,y,x,S,v,k,_;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(s=this.readUInt32(),y=(function(){var j,D;for(D=[],j=0;j<4;++j)D.push(String.fromCharCode(this.data[this.pos++]));return D}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),c=this.readUInt16()||100,h.delay=1e3*u/c,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(y==="fdAT"&&(this.pos+=4,s-=4),i=(h!=null?h.data:void 0)||this.imgData,v=0;0<=s?v<s:v>s;0<=s?++v:--v)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((x=l-this.transparency.indexed.length)>0)for(k=0;0<=x?k<x:k>x;0<=x?++k:--k)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(S=this.read(s)).indexOf(0),d=String.fromCharCode.apply(String,S.slice(0,p)),this.text[d]=String.fromCharCode.apply(String,S.slice(p+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(_=this.colorType)===4||_===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),l=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(h,p,d,y){var x,S,v,k,_,j,D,z,I,T,L,O,F,N,M,K,he,le,fe,ie,q,Z=Math.ceil((c.width-h)/d),oe=Math.ceil((c.height-p)/y),b=c.width==Z&&c.height==oe;for(N=s*Z,O=b?o:new Uint8Array(N*oe),j=i.length,F=0,S=0;F<oe&&l<j;){switch(i[l++]){case 0:for(k=he=0;he<N;k=he+=1)O[S++]=i[l++];break;case 1:for(k=le=0;le<N;k=le+=1)x=i[l++],_=k<s?0:O[S-s],O[S++]=(x+_)%256;break;case 2:for(k=fe=0;fe<N;k=fe+=1)x=i[l++],v=(k-k%s)/s,M=F&&O[(F-1)*N+v*s+k%s],O[S++]=(M+x)%256;break;case 3:for(k=ie=0;ie<N;k=ie+=1)x=i[l++],v=(k-k%s)/s,_=k<s?0:O[S-s],M=F&&O[(F-1)*N+v*s+k%s],O[S++]=(x+Math.floor((_+M)/2))%256;break;case 4:for(k=q=0;q<N;k=q+=1)x=i[l++],v=(k-k%s)/s,_=k<s?0:O[S-s],F===0?M=K=0:(M=O[(F-1)*N+v*s+k%s],K=v&&O[(F-1)*N+(v-1)*s+k%s]),D=_+M-K,z=Math.abs(D-_),T=Math.abs(D-M),L=Math.abs(D-K),I=z<=T&&z<=L?_:T<=L?M:K,O[S++]=(x+I)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!b){var A=((p+F*y)*c.width+h)*s,C=F*N;for(k=0;k<Z;k+=1){for(var R=0;R<s;R+=1)o[A++]=O[C++];A+=(d-1)*s}}F++}}return i=_R(i),c.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var i,s,o,l,c,u,h,p,d;for(o=this.palette,u=this.transparency.indexed||[],c=new Uint8Array((u.length||0)+o.length),l=0,i=0,s=h=0,p=o.length;h<p;s=h+=3)c[l++]=o[s],c[l++]=o[s+1],c[l++]=o[s+2],c[l++]=(d=u[i++])!=null?d:255;return c},n.prototype.copyToImageData=function(i,s){var o,l,c,u,h,p,d,y,x,S,v;if(l=this.colors,x=null,o=this.hasAlphaChannel,this.palette.length&&(x=(v=this._decodedPalette)!=null?v:this._decodedPalette=this.decodePalette(),l=4,o=!0),y=(c=i.data||i).length,h=x||s,u=p=0,l===1)for(;u<y;)d=x?4*s[u/4]:p,S=h[d++],c[u++]=S,c[u++]=S,c[u++]=S,c[u++]=o?h[d++]:255,p=d;else for(;u<y;)d=x?4*s[u/4]:p,c[u++]=h[d++],c[u++]=h[d++],c[u++]=h[d++],c[u++]=o?h[d++]:255,p=d},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(_t)==="[object Window]"){try{t=_t.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(i){var s;if(a()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var s,o,l,c,u,h,p,d;if(this.animation){for(d=[],o=u=0,h=(p=this.animation.frames).length;u<h;o=++u)s=p[o],l=i.createImageData(s.width,s.height),c=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(l,c),s.imageData=l,d.push(s.image=e(l));return d}},n.prototype.renderFrame=function(i,s){var o,l,c;return o=(l=this.animation.frames)[s],c=l[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var s,o,l,c,u,h,p=this;return o=0,h=this.animation,c=h.numFrames,l=h.frames,u=h.numPlays,(s=function(){var d,y;if(d=o++%c,y=l[d],p.renderFrame(i,d),c>1&&o/c<u)return p.animation._timeout=setTimeout(s,y.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function HR(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<(7&a)+1;e[t++],e[t++];var o=null,l=null;i&&(o=t,l=s,t+=3*s);var c=!0,u=[],h=0,p=null,d=0,y=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,y=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var x=e[t++];h=e[t++]|e[t++]<<8,p=e[t++],!(1&x)&&(p=null),d=x>>2&7,t++;break;case 254:for(;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var S=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,k=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,j=e[t++],D=j>>6&1,z=1<<(7&j)+1,I=o,T=l,L=!1;j>>7&&(L=!0,I=t,T=z,t+=3*z);var O=t;for(t++;;){var F;if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}u.push({x:S,y:v,width:k,height:_,has_local_palette:L,palette_offset:I,palette_size:T,data_offset:O,data_length:t-O,transparent_index:p,interlaced:!!D,delay:h,disposal:d});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return y},this.frameInfo=function(N){if(N<0||N>=u.length)throw new Error("Frame index out of range.");return u[N]},this.decodeAndBlitFrameBGRA=function(N,M){var K=this.frameInfo(N),he=K.width*K.height,le=new Uint8Array(he);gy(e,K.data_offset,le,he);var fe=K.palette_offset,ie=K.transparent_index;ie===null&&(ie=256);var q=K.width,Z=r-q,oe=q,b=4*(K.y*r+K.x),A=4*((K.y+K.height)*r+K.x),C=b,R=4*Z;K.interlaced===!0&&(R+=4*r*7);for(var H=8,re=0,ae=le.length;re<ae;++re){var ne=le[re];if(oe===0&&(oe=q,(C+=R)>=A&&(R=4*Z+4*r*(H-1),C=b+(q+Z)*(H<<1),H>>=1)),ne===ie)C+=4;else{var me=e[fe+3*ne],we=e[fe+3*ne+1],X=e[fe+3*ne+2];M[C++]=X,M[C++]=we,M[C++]=me,M[C++]=255}--oe}},this.decodeAndBlitFrameRGBA=function(N,M){var K=this.frameInfo(N),he=K.width*K.height,le=new Uint8Array(he);gy(e,K.data_offset,le,he);var fe=K.palette_offset,ie=K.transparent_index;ie===null&&(ie=256);var q=K.width,Z=r-q,oe=q,b=4*(K.y*r+K.x),A=4*((K.y+K.height)*r+K.x),C=b,R=4*Z;K.interlaced===!0&&(R+=4*r*7);for(var H=8,re=0,ae=le.length;re<ae;++re){var ne=le[re];if(oe===0&&(oe=q,(C+=R)>=A&&(R=4*Z+4*r*(H-1),C=b+(q+Z)*(H<<1),H>>=1)),ne===ie)C+=4;else{var me=e[fe+3*ne],we=e[fe+3*ne+1],X=e[fe+3*ne+2];M[C++]=me,M[C++]=we,M[C++]=X,M[C++]=255}--oe}}}function gy(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,l=a+1,c=(1<<l)-1,u=0,h=0,p=0,d=e[t++],y=new Int32Array(4096),x=null;;){for(;u<16&&d!==0;)h|=e[t++]<<u,u+=8,d===1?d=e[t++]:--d;if(u<l)break;var S=h&c;if(h>>=l,u-=l,S!==i){if(S===s)break;for(var v=S<o?S:x,k=0,_=v;_>i;)_=y[_]>>8,++k;var j=_;if(p+k+(v!==S?1:0)>n)return void ar.log("Warning, gif stream longer than expected.");r[p++]=j;var D=p+=k;for(v!==S&&(r[p++]=j),_=v;k--;)_=y[_],r[--D]=255&_,_>>=8;x!==null&&o<4096&&(y[o++]=x<<8|j,o>=c+1&&l<12&&(++l,c=c<<1|1)),x=S}else o=s+1,c=(1<<(l=a+1))-1,x=null}return p!==n&&ar.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Bp(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(65535),p=new Array(65535),d=new Array(64),y=new Array(64),x=[],S=0,v=7,k=new Array(64),_=new Array(64),j=new Array(64),D=new Array(256),z=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],N=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],he=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function le(b,A){for(var C=0,R=0,H=new Array,re=1;re<=16;re++){for(var ae=1;ae<=b[re];ae++)H[A[R]]=[],H[A[R]][0]=C,H[A[R]][1]=re,R++,C++;C*=2}return H}function fe(b){for(var A=b[0],C=b[1]-1;C>=0;)A&1<<C&&(S|=1<<v),C--,--v<0&&(S==255?(ie(255),ie(0)):ie(S),v=7,S=0)}function ie(b){x.push(b)}function q(b){ie(b>>8&255),ie(255&b)}function Z(b,A,C,R,H){for(var re,ae=H[0],ne=H[240],me=function(De,qe){var Ke,Ge,st,rt,ft,lt,gt,xt,ht,Ze,He=0;for(ht=0;ht<8;++ht){Ke=De[He],Ge=De[He+1],st=De[He+2],rt=De[He+3],ft=De[He+4],lt=De[He+5],gt=De[He+6];var It=Ke+(xt=De[He+7]),pt=Ke-xt,br=Ge+gt,Kt=Ge-gt,ir=st+lt,La=st-lt,$t=rt+ft,Si=rt-ft,fr=It+$t,fa=It-$t,Ja=br+ir,rr=br-ir;De[He]=fr+Ja,De[He+4]=fr-Ja;var St=.707106781*(rr+fa);De[He+2]=fa+St,De[He+6]=fa-St;var Wt=.382683433*((fr=Si+La)-(rr=Kt+pt)),Gi=.5411961*fr+Wt,Gr=1.306562965*rr+Wt,Fa=.707106781*(Ja=La+Kt),Pa=pt+Fa,vt=pt-Fa;De[He+5]=vt+Gi,De[He+3]=vt-Gi,De[He+1]=Pa+Gr,De[He+7]=Pa-Gr,He+=8}for(He=0,ht=0;ht<8;++ht){Ke=De[He],Ge=De[He+8],st=De[He+16],rt=De[He+24],ft=De[He+32],lt=De[He+40],gt=De[He+48];var ha=Ke+(xt=De[He+56]),Yn=Ke-xt,yn=Ge+gt,Lr=Ge-gt,kr=st+lt,W=st-lt,ue=rt+ft,ee=rt-ft,te=ha+ue,ce=ha-ue,de=yn+kr,Ne=yn-kr;De[He]=te+de,De[He+32]=te-de;var je=.707106781*(Ne+ce);De[He+16]=ce+je,De[He+48]=ce-je;var Ae=.382683433*((te=ee+W)-(Ne=Lr+Yn)),Le=.5411961*te+Ae,Fe=1.306562965*Ne+Ae,We=.707106781*(de=W+Lr),Qe=Yn+We,at=Yn-We;De[He+40]=at+Le,De[He+24]=at-Le,De[He+8]=Qe+Fe,De[He+56]=Qe-Fe,He++}for(ht=0;ht<64;++ht)Ze=De[ht]*qe[ht],d[ht]=Ze>0?Ze+.5|0:Ze-.5|0;return d}(b,A),we=0;we<64;++we)y[I[we]]=me[we];var X=y[0]-C;C=y[0],X==0?fe(R[0]):(fe(R[p[re=32767+X]]),fe(h[re]));for(var Ie=63;Ie>0&&y[Ie]==0;)Ie--;if(Ie==0)return fe(ae),C;for(var Se,_e=1;_e<=Ie;){for(var Q=_e;y[_e]==0&&_e<=Ie;)++_e;var Oe=_e-Q;if(Oe>=16){Se=Oe>>4;for(var Pe=1;Pe<=Se;++Pe)fe(ne);Oe&=15}re=32767+y[_e],fe(H[(Oe<<4)+p[re]]),fe(h[re]),_e++}return Ie!=63&&fe(ae),C}function oe(b){b=Math.min(Math.max(b,1),100),i!=b&&(function(A){for(var C=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],R=0;R<64;R++){var H=s((C[R]*A+50)/100);H=Math.min(Math.max(H,1),255),o[I[R]]=H}for(var re=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ae=0;ae<64;ae++){var ne=s((re[ae]*A+50)/100);ne=Math.min(Math.max(ne,1),255),l[I[ae]]=ne}for(var me=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],we=0,X=0;X<8;X++)for(var Ie=0;Ie<8;Ie++)c[we]=1/(o[I[we]]*me[X]*me[Ie]*8),u[we]=1/(l[I[we]]*me[X]*me[Ie]*8),we++}(b<50?Math.floor(5e3/b):Math.floor(200-2*b)),i=b)}this.encode=function(b,A){A&&oe(A),x=new Array,S=0,v=7,q(65496),q(65504),q(16),ie(74),ie(70),ie(73),ie(70),ie(0),ie(1),ie(1),ie(0),q(1),q(1),ie(0),ie(0),function(){q(65499),q(132),ie(0);for(var Ge=0;Ge<64;Ge++)ie(o[Ge]);ie(1);for(var st=0;st<64;st++)ie(l[st])}(),function(Ge,st){q(65472),q(17),ie(8),q(st),q(Ge),ie(3),ie(1),ie(17),ie(0),ie(2),ie(17),ie(1),ie(3),ie(17),ie(1)}(b.width,b.height),function(){q(65476),q(418),ie(0);for(var Ge=0;Ge<16;Ge++)ie(T[Ge+1]);for(var st=0;st<=11;st++)ie(L[st]);ie(16);for(var rt=0;rt<16;rt++)ie(O[rt+1]);for(var ft=0;ft<=161;ft++)ie(F[ft]);ie(1);for(var lt=0;lt<16;lt++)ie(N[lt+1]);for(var gt=0;gt<=11;gt++)ie(M[gt]);ie(17);for(var xt=0;xt<16;xt++)ie(K[xt+1]);for(var ht=0;ht<=161;ht++)ie(he[ht])}(),q(65498),q(12),ie(3),ie(1),ie(0),ie(2),ie(17),ie(3),ie(17),ie(0),ie(63),ie(0);var C=0,R=0,H=0;S=0,v=7,this.encode.displayName="_encode_";for(var re,ae,ne,me,we,X,Ie,Se,_e,Q=b.data,Oe=b.width,Pe=b.height,De=4*Oe,qe=0;qe<Pe;){for(re=0;re<De;){for(we=De*qe+re,Ie=-1,Se=0,_e=0;_e<64;_e++)X=we+(Se=_e>>3)*De+(Ie=4*(7&_e)),qe+Se>=Pe&&(X-=De*(qe+1+Se-Pe)),re+Ie>=De&&(X-=re+Ie-De+4),ae=Q[X++],ne=Q[X++],me=Q[X++],k[_e]=(z[ae]+z[ne+256>>0]+z[me+512>>0]>>16)-128,_[_e]=(z[ae+768>>0]+z[ne+1024>>0]+z[me+1280>>0]>>16)-128,j[_e]=(z[ae+1280>>0]+z[ne+1536>>0]+z[me+1792>>0]>>16)-128;C=Z(k,c,C,t,n),R=Z(_,u,R,r,a),H=Z(j,u,H,r,a),re+=32}qe+=8}if(v>=0){var Ke=[];Ke[1]=v+1,Ke[0]=(1<<v+1)-1,fe(Ke)}return q(65497),new Uint8Array(x)},e=e||50,function(){for(var b=String.fromCharCode,A=0;A<256;A++)D[A]=b(A)}(),t=le(T,L),r=le(N,M),n=le(O,F),a=le(K,he),function(){for(var b=1,A=2,C=1;C<=15;C++){for(var R=b;R<A;R++)p[32767+R]=C,h[32767+R]=[],h[32767+R][1]=C,h[32767+R][0]=R;for(var H=-(A-1);H<=-b;H++)p[32767+H]=C,h[32767+H]=[],h[32767+H][1]=C,h[32767+H][0]=A-1+H;b<<=1,A<<=1}}(),function(){for(var b=0;b<256;b++)z[b]=19595*b,z[b+256>>0]=38470*b,z[b+512>>0]=7471*b+32768,z[b+768>>0]=-11059*b,z[b+1024>>0]=-21709*b,z[b+1280>>0]=32768*b+8421375,z[b+1536>>0]=-27439*b,z[b+1792>>0]=-5329*b}(),oe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ci(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function xy(e){function t(T){if(!T)throw Error("assert :P")}function r(T,L,O){for(var F=0;4>F;F++)if(T[L+F]!=O.charCodeAt(F))return!0;return!1}function n(T,L,O,F,N){for(var M=0;M<N;M++)T[L+M]=O[F+M]}function a(T,L,O,F){for(var N=0;N<F;N++)T[L+N]=O}function i(T){return new Int32Array(T)}function s(T,L){for(var O=[],F=0;F<T;F++)O.push(new L);return O}function o(T,L){var O=[];return function F(N,M,K){for(var he=K[M],le=0;le<he&&(N.push(K.length>M+1?[]:new L),!(K.length<M+1));le++)F(N[le],M+1,K)}(O,0,T),O}var l=function(){var T=this;function L(f,g){for(var E=1<<g-1>>>0;f&E;)E>>>=1;return E?(f&E-1)+E:f}function O(f,g,E,P,B){t(!(P%E));do f[g+(P-=E)]=B;while(0<P)}function F(f,g,E,P,B){if(t(2328>=B),512>=B)var V=i(512);else if((V=i(B))==null)return 0;return function(G,Y,J,se,ve,Te){var Ce,ke,ze=Y,Re=1<<J,ye=i(16),be=i(16);for(t(ve!=0),t(se!=null),t(G!=null),t(0<J),ke=0;ke<ve;++ke){if(15<se[ke])return 0;++ye[se[ke]]}if(ye[0]==ve)return 0;for(be[1]=0,Ce=1;15>Ce;++Ce){if(ye[Ce]>1<<Ce)return 0;be[Ce+1]=be[Ce]+ye[Ce]}for(ke=0;ke<ve;++ke)Ce=se[ke],0<se[ke]&&(Te[be[Ce]++]=ke);if(be[15]==1)return(se=new N).g=0,se.value=Te[0],O(G,ze,1,Re,se),Re;var Be,$e=-1,Ue=Re-1,ot=0,et=1,yt=1,tt=1<<J;for(ke=0,Ce=1,ve=2;Ce<=J;++Ce,ve<<=1){if(et+=yt<<=1,0>(yt-=ye[Ce]))return 0;for(;0<ye[Ce];--ye[Ce])(se=new N).g=Ce,se.value=Te[ke++],O(G,ze+ot,ve,tt,se),ot=L(ot,Ce)}for(Ce=J+1,ve=2;15>=Ce;++Ce,ve<<=1){if(et+=yt<<=1,0>(yt-=ye[Ce]))return 0;for(;0<ye[Ce];--ye[Ce]){if(se=new N,(ot&Ue)!=$e){for(ze+=tt,Be=1<<($e=Ce)-J;15>$e&&!(0>=(Be-=ye[$e]));)++$e,Be<<=1;Re+=tt=1<<(Be=$e-J),G[Y+($e=ot&Ue)].g=Be+J,G[Y+$e].value=ze-Y-$e}se.g=Ce-J,se.value=Te[ke++],O(G,ze+(ot>>J),ve,tt,se),ot=L(ot,Ce)}}return et!=2*be[15]-1?0:Re}(f,g,E,P,B,V)}function N(){this.value=this.g=0}function M(){this.value=this.g=0}function K(){this.G=s(5,N),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(fn,M)}function he(f,g,E,P){t(f!=null),t(g!=null),t(2147483648>P),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=g,f.pa=E,f.Jd=g,f.Yc=E+P,f.Zc=4<=P?E+P-4+1:E,re(f)}function le(f,g){for(var E=0;0<g--;)E|=ne(f,128)<<g;return E}function fe(f,g){var E=le(f,g);return ae(f)?-E:E}function ie(f,g,E,P){var B,V=0;for(t(f!=null),t(g!=null),t(4294967288>P),f.Sb=P,f.Ra=0,f.u=0,f.h=0,4<P&&(P=4),B=0;B<P;++B)V+=g[E+B]<<8*B;f.Ra=V,f.bb=P,f.oa=g,f.pa=E}function q(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Ll-8>>>0,++f.bb,f.u-=8;C(f)&&(f.h=1,f.u=0)}function Z(f,g){if(t(0<=g),!f.h&&g<=Cl){var E=A(f)&Tl[g];return f.u+=g,q(f),E}return f.h=1,f.u=0}function oe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function b(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function A(f){return f.Ra>>>(f.u&Ll-1)>>>0}function C(f){return t(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Ll}function R(f,g){f.u=g,f.h=C(f)}function H(f){f.u>=hu&&(t(f.u>=hu),q(f))}function re(f){t(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(t(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function ae(f){return le(f,1)}function ne(f,g){var E=f.Ca;0>f.b&&re(f);var P=f.b,B=E*g>>>8,V=(f.I>>>P>B)+0;for(V?(E-=B,f.I-=B+1<<P>>>0):E=B+1,P=E,B=0;256<=P;)B+=8,P>>=8;return P=7^B+Qn[P],f.b-=P,f.Ca=(E<<P)-1,V}function me(f,g,E){f[g+0]=E>>24&255,f[g+1]=E>>16&255,f[g+2]=E>>8&255,f[g+3]=E>>0&255}function we(f,g){return f[g+0]<<0|f[g+1]<<8}function X(f,g){return we(f,g)|f[g+2]<<16}function Ie(f,g){return we(f,g)|we(f,g+2)<<16}function Se(f,g){var E=1<<g;return t(f!=null),t(0<g),f.X=i(E),f.X==null?0:(f.Mb=32-g,f.Xa=g,1)}function _e(f,g){t(f!=null),t(g!=null),t(f.Xa==g.Xa),n(g.X,0,f.X,0,1<<g.Xa)}function Q(){this.X=[],this.Xa=this.Mb=0}function Oe(f,g,E,P){t(E!=null),t(P!=null);var B=E[0],V=P[0];return B==0&&(B=(f*V+g/2)/g),V==0&&(V=(g*B+f/2)/f),0>=B||0>=V?0:(E[0]=B,P[0]=V,1)}function Pe(f,g){return f+(1<<g)-1>>>g}function De(f,g){return((4278255360&f)+(4278255360&g)>>>0&4278255360)+((16711935&f)+(16711935&g)>>>0&16711935)>>>0}function qe(f,g){T[g]=function(E,P,B,V,G,Y,J){var se;for(se=0;se<G;++se){var ve=T[f](Y[J+se-1],B,V+se);Y[J+se]=De(E[P+se],ve)}}}function Ke(){this.ud=this.hd=this.jd=0}function Ge(f,g){return((4278124286&(f^g))>>>1)+(f&g)>>>0}function st(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function rt(f,g){return st(f+(f-g+.5>>1))}function ft(f,g,E){return Math.abs(g-E)-Math.abs(f-E)}function lt(f,g,E,P,B,V,G){for(P=V[G-1],E=0;E<B;++E)V[G+E]=P=De(f[g+E],P)}function gt(f,g,E,P,B){var V;for(V=0;V<E;++V){var G=f[g+V],Y=G>>8&255,J=16711935&(J=(J=16711935&G)+((Y<<16)+Y));P[B+V]=(4278255360&G)+J>>>0}}function xt(f,g){g.jd=f>>0&255,g.hd=f>>8&255,g.ud=f>>16&255}function ht(f,g,E,P,B,V){var G;for(G=0;G<P;++G){var Y=g[E+G],J=Y>>>8,se=Y,ve=255&(ve=(ve=Y>>>16)+((f.jd<<24>>24)*(J<<24>>24)>>>5));se=255&(se=(se=se+((f.hd<<24>>24)*(J<<24>>24)>>>5))+((f.ud<<24>>24)*(ve<<24>>24)>>>5)),B[V+G]=(4278255360&Y)+(ve<<16)+se}}function Ze(f,g,E,P,B){T[g]=function(V,G,Y,J,se,ve,Te,Ce,ke){for(J=Te;J<Ce;++J)for(Te=0;Te<ke;++Te)se[ve++]=B(Y[P(V[G++])])},T[f]=function(V,G,Y,J,se,ve,Te){var Ce=8>>V.b,ke=V.Ea,ze=V.K[0],Re=V.w;if(8>Ce)for(V=(1<<V.b)-1,Re=(1<<Ce)-1;G<Y;++G){var ye,be=0;for(ye=0;ye<ke;++ye)ye&V||(be=P(J[se++])),ve[Te++]=B(ze[be&Re]),be>>=Ce}else T["VP8LMapColor"+E](J,se,ze,Re,ve,Te,G,Y,ke)}}function He(f,g,E,P,B){for(E=g+E;g<E;){var V=f[g++];P[B++]=V>>16&255,P[B++]=V>>8&255,P[B++]=V>>0&255}}function It(f,g,E,P,B){for(E=g+E;g<E;){var V=f[g++];P[B++]=V>>16&255,P[B++]=V>>8&255,P[B++]=V>>0&255,P[B++]=V>>24&255}}function pt(f,g,E,P,B){for(E=g+E;g<E;){var V=(G=f[g++])>>16&240|G>>12&15,G=G>>0&240|G>>28&15;P[B++]=V,P[B++]=G}}function br(f,g,E,P,B){for(E=g+E;g<E;){var V=(G=f[g++])>>16&248|G>>13&7,G=G>>5&224|G>>3&31;P[B++]=V,P[B++]=G}}function Kt(f,g,E,P,B){for(E=g+E;g<E;){var V=f[g++];P[B++]=V>>0&255,P[B++]=V>>8&255,P[B++]=V>>16&255}}function ir(f,g,E,P,B,V){if(V==0)for(E=g+E;g<E;)me(P,((V=f[g++])[0]>>24|V[1]>>8&65280|V[2]<<8&16711680|V[3]<<24)>>>0),B+=32;else n(P,B,f,g,E)}function La(f,g){T[g][0]=T[f+"0"],T[g][1]=T[f+"1"],T[g][2]=T[f+"2"],T[g][3]=T[f+"3"],T[g][4]=T[f+"4"],T[g][5]=T[f+"5"],T[g][6]=T[f+"6"],T[g][7]=T[f+"7"],T[g][8]=T[f+"8"],T[g][9]=T[f+"9"],T[g][10]=T[f+"10"],T[g][11]=T[f+"11"],T[g][12]=T[f+"12"],T[g][13]=T[f+"13"],T[g][14]=T[f+"0"],T[g][15]=T[f+"0"]}function $t(f){return f==N1||f==T1||f==Tf||f==C1}function Si(){this.eb=[],this.size=this.A=this.fb=0}function fr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function fa(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Si,this.f.kb=new fr,this.sd=null}function Ja(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function rr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function St(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function Wt(f,g){var E=f.T,P=g.ba.f.RGBA,B=P.eb,V=P.fb+f.ka*P.A,G=Ma[g.ba.S],Y=f.y,J=f.O,se=f.f,ve=f.N,Te=f.ea,Ce=f.W,ke=g.cc,ze=g.dc,Re=g.Mc,ye=g.Nc,be=f.ka,Be=f.ka+f.T,$e=f.U,Ue=$e+1>>1;for(be==0?G(Y,J,null,null,se,ve,Te,Ce,se,ve,Te,Ce,B,V,null,null,$e):(G(g.ec,g.fc,Y,J,ke,ze,Re,ye,se,ve,Te,Ce,B,V-P.A,B,V,$e),++E);be+2<Be;be+=2)ke=se,ze=ve,Re=Te,ye=Ce,ve+=f.Rc,Ce+=f.Rc,V+=2*P.A,G(Y,(J+=2*f.fa)-f.fa,Y,J,ke,ze,Re,ye,se,ve,Te,Ce,B,V-P.A,B,V,$e);return J+=f.fa,f.j+Be<f.o?(n(g.ec,g.fc,Y,J,$e),n(g.cc,g.dc,se,ve,Ue),n(g.Mc,g.Nc,Te,Ce,Ue),E--):1&Be||G(Y,J,null,null,se,ve,Te,Ce,se,ve,Te,Ce,B,V+P.A,null,null,$e),E}function Gi(f,g,E){var P=f.F,B=[f.J];if(P!=null){var V=f.U,G=g.ba.S,Y=G==Nf||G==Tf;g=g.ba.f.RGBA;var J=[0],se=f.ka;J[0]=f.T,f.Kb&&(se==0?--J[0]:(--se,B[0]-=f.width),f.j+f.ka+f.T==f.o&&(J[0]=f.o-f.j-se));var ve=g.eb;se=g.fb+se*g.A,f=or(P,B[0],f.width,V,J,ve,se+(Y?0:3),g.A),t(E==J),f&&$t(G)&&Oa(ve,se,Y,V,J,g.A)}return 0}function Gr(f){var g=f.ma,E=g.ba.S,P=11>E,B=E==Ef||E==Af||E==Nf||E==A1||E==12||$t(E);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!uu(g.Oa,f,B?11:12))return 0;if(B&&$t(E)&&Ve(),f.da)alert("todo:use_scaling");else{if(P){if(g.Ib=St,f.Kb){if(E=f.U+1>>1,g.memory=i(f.U+2*E),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+f.U,g.Mc=g.cc,g.Nc=g.dc+E,g.Ib=Wt,Ve()}}else alert("todo:EmitYUV");B&&(g.Jb=Gi,P&&Ee())}if(P&&!tx){for(f=0;256>f;++f)Ub[f]=89858*(f-128)+Lf>>Cf,qb[f]=-22014*(f-128)+Lf,$b[f]=-45773*(f-128),zb[f]=113618*(f-128)+Lf>>Cf;for(f=yu;f<P1;++f)g=76283*(f-16)+Lf>>Cf,Hb[f-yu]=pa(g,255),Vb[f-yu]=pa(g+8>>4,15);tx=1}return 1}function Fa(f){var g=f.ma,E=f.U,P=f.T;return t(!(1&f.ka)),0>=E||0>=P?0:(E=g.Ib(f,g),g.Jb!=null&&g.Jb(f,g,E),g.Dc+=E,1)}function Pa(f){f.ma.memory=null}function vt(f,g,E,P){return Z(f,8)!=47?0:(g[0]=Z(f,14)+1,E[0]=Z(f,14)+1,P[0]=Z(f,1),Z(f,3)!=0?0:!f.h)}function ha(f,g){if(4>f)return f+1;var E=f-2>>1;return(2+(1&f)<<E)+Z(g,E)+1}function Yn(f,g){return 120<g?g-120:1<=(E=((E=Ab[g-1])>>4)*f+(8-(15&E)))?E:1;var E}function yn(f,g,E){var P=A(E),B=f[g+=255&P].g-8;return 0<B&&(R(E,E.u+8),P=A(E),g+=f[g].value,g+=P&(1<<B)-1),R(E,E.u+f[g].g),f[g].value}function Lr(f,g,E){return E.g+=f.g,E.value+=f.value<<g>>>0,t(8>=E.g),f.g}function kr(f,g,E){var P=f.xc;return t((g=P==0?0:f.vc[f.md*(E>>P)+(g>>P)])<f.Wb),f.Ya[g]}function W(f,g,E,P){var B=f.ab,V=f.c*g,G=f.C;g=G+g;var Y=E,J=P;for(P=f.Ta,E=f.Ua;0<B--;){var se=f.gc[B],ve=G,Te=g,Ce=Y,ke=J,ze=(J=P,Y=E,se.Ea);switch(t(ve<Te),t(Te<=se.nc),se.hc){case 2:vf(Ce,ke,(Te-ve)*ze,J,Y);break;case 0:var Re=ve,ye=Te,be=J,Be=Y,$e=(tt=se).Ea;Re==0&&(S1(Ce,ke,null,null,1,be,Be),lt(Ce,ke+1,0,0,$e-1,be,Be+1),ke+=$e,Be+=$e,++Re);for(var Ue=1<<tt.b,ot=Ue-1,et=Pe($e,tt.b),yt=tt.K,tt=tt.w+(Re>>tt.b)*et;Re<ye;){var Gt=yt,Yt=tt,qt=1;for(du(Ce,ke,be,Be-$e,1,be,Be);qt<$e;){var Ot=(qt&~ot)+Ue;Ot>$e&&(Ot=$e),(0,As[Gt[Yt++]>>8&15])(Ce,ke+ +qt,be,Be+qt-$e,Ot-qt,be,Be+qt),qt=Ot}ke+=$e,Be+=$e,++Re&ot||(tt+=et)}Te!=se.nc&&n(J,Y-ze,J,Y+(Te-ve-1)*ze,ze);break;case 1:for(ze=Ce,ye=ke,$e=(Ce=se.Ea)-(Be=Ce&~(be=(ke=1<<se.b)-1)),Re=Pe(Ce,se.b),Ue=se.K,se=se.w+(ve>>se.b)*Re;ve<Te;){for(ot=Ue,et=se,yt=new Ke,tt=ye+Be,Gt=ye+Ce;ye<tt;)xt(ot[et++],yt),Lo(yt,ze,ye,ke,J,Y),ye+=ke,Y+=ke;ye<Gt&&(xt(ot[et++],yt),Lo(yt,ze,ye,$e,J,Y),ye+=$e,Y+=$e),++ve&be||(se+=Re)}break;case 3:if(Ce==J&&ke==Y&&0<se.b){for(ye=J,Ce=ze=Y+(Te-ve)*ze-(Be=(Te-ve)*Pe(se.Ea,se.b)),ke=J,be=Y,Re=[],Be=($e=Be)-1;0<=Be;--Be)Re[Be]=ke[be+Be];for(Be=$e-1;0<=Be;--Be)ye[Ce+Be]=Re[Be];Ia(se,ve,Te,J,ze,J,Y)}else Ia(se,ve,Te,Ce,ke,J,Y)}Y=P,J=E}J!=E&&n(P,E,Y,J,V)}function ue(f,g){var E=f.V,P=f.Ba+f.c*f.C,B=g-f.C;if(t(g<=f.l.o),t(16>=B),0<B){var V=f.l,G=f.Ta,Y=f.Ua,J=V.width;if(W(f,B,E,P),B=Y=[Y],t((E=f.C)<(P=g)),t(V.v<V.va),P>V.o&&(P=V.o),E<V.j){var se=V.j-E;E=V.j,B[0]+=se*J}if(E>=P?E=0:(B[0]+=4*V.v,V.ka=E-V.j,V.U=V.va-V.v,V.T=P-E,E=1),E){if(Y=Y[0],11>(E=f.ca).S){var ve=E.f.RGBA,Te=(P=E.S,B=V.U,V=V.T,se=ve.eb,ve.A),Ce=V;for(ve=ve.fb+f.Ma*ve.A;0<Ce--;){var ke=G,ze=Y,Re=B,ye=se,be=ve;switch(P){case Sf:Zn(ke,ze,Re,ye,be);break;case Ef:Mn(ke,ze,Re,ye,be);break;case N1:Mn(ke,ze,Re,ye,be),Oa(ye,be,0,Re,1,0);break;case Vg:Qi(ke,ze,Re,ye,be);break;case Af:ir(ke,ze,Re,ye,be,1);break;case T1:ir(ke,ze,Re,ye,be,1),Oa(ye,be,0,Re,1,0);break;case Nf:ir(ke,ze,Re,ye,be,0);break;case Tf:ir(ke,ze,Re,ye,be,0),Oa(ye,be,1,Re,1,0);break;case A1:Ns(ke,ze,Re,ye,be);break;case C1:Ns(ke,ze,Re,ye,be),sr(ye,be,Re,1,0);break;case Wg:Ji(ke,ze,Re,ye,be);break;default:t(0)}Y+=J,ve+=Te}f.Ma+=V}else alert("todo:EmitRescaledRowsYUVA");t(f.Ma<=E.height)}}f.C=g,t(f.C<=f.i)}function ee(f){var g;if(0<f.ua)return 0;for(g=0;g<f.Wb;++g){var E=f.Ya[g].G,P=f.Ya[g].H;if(0<E[1][P[1]+0].g||0<E[2][P[2]+0].g||0<E[3][P[3]+0].g)return 0}return 1}function te(f,g,E,P,B,V){if(f.Z!=0){var G=f.qd,Y=f.rd;for(t(Fs[f.Z]!=null);g<E;++g)Fs[f.Z](G,Y,P,B,P,B,V),G=P,Y=B,B+=V;f.qd=G,f.rd=Y}}function ce(f,g){var E=f.l.ma,P=E.Z==0||E.Z==1?f.l.j:f.C;if(P=f.C<P?P:f.C,t(g<=f.l.o),g>P){var B=f.l.width,V=E.ca,G=E.tb+B*P,Y=f.V,J=f.Ba+f.c*P,se=f.gc;t(f.ab==1),t(se[0].hc==3),yf(se[0],P,g,Y,J,V,G),te(E,P,g,V,G,B)}f.C=f.Ma=g}function de(f,g,E,P,B,V,G){var Y=f.$/P,J=f.$%P,se=f.m,ve=f.s,Te=E+f.$,Ce=Te;B=E+P*B;var ke=E+P*V,ze=280+ve.ua,Re=f.Pb?Y:16777216,ye=0<ve.ua?ve.Wa:null,be=ve.wc,Be=Te<ke?kr(ve,J,Y):null;t(f.C<V),t(ke<=B);var $e=!1;e:for(;;){for(;$e||Te<ke;){var Ue=0;if(Y>=Re){var ot=Te-E;t((Re=f).Pb),Re.wd=Re.m,Re.xd=ot,0<Re.s.ua&&_e(Re.s.Wa,Re.s.vb),Re=Y+Tb}if(J&be||(Be=kr(ve,J,Y)),t(Be!=null),Be.Qb&&(g[Te]=Be.qb,$e=!0),!$e)if(H(se),Be.jc){Ue=se,ot=g;var et=Te,yt=Be.pd[A(Ue)&fn-1];t(Be.jc),256>yt.g?(R(Ue,Ue.u+yt.g),ot[et]=yt.value,Ue=0):(R(Ue,Ue.u+yt.g-256),t(256<=yt.value),Ue=yt.value),Ue==0&&($e=!0)}else Ue=yn(Be.G[0],Be.H[0],se);if(se.h)break;if($e||256>Ue){if(!$e)if(Be.nd)g[Te]=(Be.qb|Ue<<8)>>>0;else{if(H(se),$e=yn(Be.G[1],Be.H[1],se),H(se),ot=yn(Be.G[2],Be.H[2],se),et=yn(Be.G[3],Be.H[3],se),se.h)break;g[Te]=(et<<24|$e<<16|Ue<<8|ot)>>>0}if($e=!1,++Te,++J>=P&&(J=0,++Y,G!=null&&Y<=V&&!(Y%16)&&G(f,Y),ye!=null))for(;Ce<Te;)Ue=g[Ce++],ye.X[(506832829*Ue&4294967295)>>>ye.Mb]=Ue}else if(280>Ue){if(Ue=ha(Ue-256,se),ot=yn(Be.G[4],Be.H[4],se),H(se),ot=Yn(P,ot=ha(ot,se)),se.h)break;if(Te-E<ot||B-Te<Ue)break e;for(et=0;et<Ue;++et)g[Te+et]=g[Te+et-ot];for(Te+=Ue,J+=Ue;J>=P;)J-=P,++Y,G!=null&&Y<=V&&!(Y%16)&&G(f,Y);if(t(Te<=B),J&be&&(Be=kr(ve,J,Y)),ye!=null)for(;Ce<Te;)Ue=g[Ce++],ye.X[(506832829*Ue&4294967295)>>>ye.Mb]=Ue}else{if(!(Ue<ze))break e;for($e=Ue-280,t(ye!=null);Ce<Te;)Ue=g[Ce++],ye.X[(506832829*Ue&4294967295)>>>ye.Mb]=Ue;Ue=Te,t(!($e>>>(ot=ye).Xa)),g[Ue]=ot.X[$e],$e=!0}$e||t(se.h==C(se))}if(f.Pb&&se.h&&Te<B)t(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&_e(f.s.vb,f.s.Wa);else{if(se.h)break e;G!=null&&G(f,Y>V?V:Y),f.a=0,f.$=Te-E}return 1}return f.a=3,0}function Ne(f){t(f!=null),f.vc=null,f.yc=null,f.Ya=null;var g=f.Wa;g!=null&&(g.X=null),f.vb=null,t(f!=null)}function je(){var f=new k1;return f==null?null:(f.a=0,f.xb=Xg,La("Predictor","VP8LPredictors"),La("Predictor","VP8LPredictors_C"),La("PredictorAdd","VP8LPredictorsAdd"),La("PredictorAdd","VP8LPredictorsAdd_C"),vf=gt,Lo=ht,Zn=He,Mn=It,Ns=pt,Ji=br,Qi=Kt,T.VP8LMapColor32b=Fl,T.VP8LMapColor8b=wf,f)}function Ae(f,g,E,P,B){var V=1,G=[f],Y=[g],J=P.m,se=P.s,ve=null,Te=0;e:for(;;){if(E)for(;V&&Z(J,1);){var Ce=G,ke=Y,ze=P,Re=1,ye=ze.m,be=ze.gc[ze.ab],Be=Z(ye,2);if(ze.Oc&1<<Be)V=0;else{switch(ze.Oc|=1<<Be,be.hc=Be,be.Ea=Ce[0],be.nc=ke[0],be.K=[null],++ze.ab,t(4>=ze.ab),Be){case 0:case 1:be.b=Z(ye,3)+2,Re=Ae(Pe(be.Ea,be.b),Pe(be.nc,be.b),0,ze,be.K),be.K=be.K[0];break;case 3:var $e,Ue=Z(ye,8)+1,ot=16<Ue?0:4<Ue?1:2<Ue?2:3;if(Ce[0]=Pe(be.Ea,ot),be.b=ot,$e=Re=Ae(Ue,1,0,ze,be.K)){var et,yt=Ue,tt=be,Gt=1<<(8>>tt.b),Yt=i(Gt);if(Yt==null)$e=0;else{var qt=tt.K[0],Ot=tt.w;for(Yt[0]=tt.K[0][0],et=1;et<1*yt;++et)Yt[et]=De(qt[Ot+et],Yt[et-1]);for(;et<4*Gt;++et)Yt[et]=0;tt.K[0]=null,tt.K[0]=Yt,$e=1}}Re=$e;break;case 2:break;default:t(0)}V=Re}}if(G=G[0],Y=Y[0],V&&Z(J,1)&&!(V=1<=(Te=Z(J,4))&&11>=Te)){P.a=3;break e}var nr;if(nr=V)t:{var tr,Lt,zr,ea=P,$r=G,ta=Y,Jt=Te,ga=E,xa=ea.m,rn=ea.s,hn=[null],Un=1,Ba=0,Li=Nb[Jt];r:for(;;){if(ga&&Z(xa,1)){var nn=Z(xa,3)+2,rs=Pe($r,nn),Ro=Pe(ta,nn),Ol=rs*Ro;if(!Ae(rs,Ro,0,ea,hn))break r;for(hn=hn[0],rn.xc=nn,tr=0;tr<Ol;++tr){var Ps=hn[tr]>>8&65535;hn[tr]=Ps,Ps>=Un&&(Un=Ps+1)}}if(xa.h)break r;for(Lt=0;5>Lt;++Lt){var Er=Gg[Lt];!Lt&&0<Jt&&(Er+=1<<Jt),Ba<Er&&(Ba=Er)}var I1=s(Un*Li,N),ax=Un,ix=s(ax,K);if(ix==null)var Pf=null;else t(65536>=ax),Pf=ix;var wu=i(Ba);if(Pf==null||wu==null||I1==null){ea.a=1;break r}var If=I1;for(tr=zr=0;tr<Un;++tr){var ai=Pf[tr],Dl=ai.G,Ml=ai.H,sx=0,jf=1,ox=0;for(Lt=0;5>Lt;++Lt){Er=Gg[Lt],Dl[Lt]=If,Ml[Lt]=zr,!Lt&&0<Jt&&(Er+=1<<Jt);a:{var Rf,j1=Er,Of=ea,_u=wu,Kb=If,Xb=zr,R1=0,Is=Of.m,Yb=Z(Is,1);if(a(_u,0,0,j1),Yb){var Jb=Z(Is,1)+1,Qb=Z(Is,1),lx=Z(Is,Qb==0?1:8);_u[lx]=1,Jb==2&&(_u[lx=Z(Is,8)]=1);var Df=1}else{var cx=i(19),ux=Z(Is,4)+4;if(19<ux){Of.a=3;var Mf=0;break a}for(Rf=0;Rf<ux;++Rf)cx[Eb[Rf]]=Z(Is,3);var O1=void 0,bu=void 0,fx=Of,Zb=cx,Bf=j1,hx=_u,D1=0,js=fx.m,dx=8,px=s(128,N);n:for(;F(px,0,7,Zb,19);){if(Z(js,1)){var ek=2+2*Z(js,3);if((O1=2+Z(js,ek))>Bf)break n}else O1=Bf;for(bu=0;bu<Bf&&O1--;){H(js);var mx=px[0+(127&A(js))];R(js,js.u+mx.g);var Bl=mx.value;if(16>Bl)hx[bu++]=Bl,Bl!=0&&(dx=Bl);else{var tk=Bl==16,gx=Bl-16,rk=kb[gx],xx=Z(js,bb[gx])+rk;if(bu+xx>Bf)break n;for(var nk=tk?dx:0;0<xx--;)hx[bu++]=nk}}D1=1;break n}D1||(fx.a=3),Df=D1}(Df=Df&&!Is.h)&&(R1=F(Kb,Xb,8,_u,j1)),Df&&R1!=0?Mf=R1:(Of.a=3,Mf=0)}if(Mf==0)break r;if(jf&&Sb[Lt]==1&&(jf=If[zr].g==0),sx+=If[zr].g,zr+=Mf,3>=Lt){var ku,M1=wu[0];for(ku=1;ku<Er;++ku)wu[ku]>M1&&(M1=wu[ku]);ox+=M1}}if(ai.nd=jf,ai.Qb=0,jf&&(ai.qb=(Dl[3][Ml[3]+0].value<<24|Dl[1][Ml[1]+0].value<<16|Dl[2][Ml[2]+0].value)>>>0,sx==0&&256>Dl[0][Ml[0]+0].value&&(ai.Qb=1,ai.qb+=Dl[0][Ml[0]+0].value<<8)),ai.jc=!ai.Qb&&6>ox,ai.jc){var Uf,ns=ai;for(Uf=0;Uf<fn;++Uf){var Rs=Uf,Os=ns.pd[Rs],zf=ns.G[0][ns.H[0]+Rs];256<=zf.value?(Os.g=zf.g+256,Os.value=zf.value):(Os.g=0,Os.value=0,Rs>>=Lr(zf,8,Os),Rs>>=Lr(ns.G[1][ns.H[1]+Rs],16,Os),Rs>>=Lr(ns.G[2][ns.H[2]+Rs],0,Os),Lr(ns.G[3][ns.H[3]+Rs],24,Os))}}}rn.vc=hn,rn.Wb=Un,rn.Ya=Pf,rn.yc=I1,nr=1;break t}nr=0}if(!(V=nr)){P.a=3;break e}if(0<Te){if(se.ua=1<<Te,!Se(se.Wa,Te)){P.a=1,V=0;break e}}else se.ua=0;var B1=P,vx=G,ak=Y,U1=B1.s,z1=U1.xc;if(B1.c=vx,B1.i=ak,U1.md=Pe(vx,z1),U1.wc=z1==0?-1:(1<<z1)-1,E){P.xb=Rb;break e}if((ve=i(G*Y))==null){P.a=1,V=0;break e}V=(V=de(P,ve,0,G,Y,Y,null))&&!J.h;break e}return V?(B!=null?B[0]=ve:(t(ve==null),t(E)),P.$=0,E||Ne(se)):Ne(se),V}function Le(f,g){var E=f.c*f.i,P=E+g+16*g;return t(f.c<=g),f.V=i(P),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+E+g,1)}function Fe(f,g){var E=f.C,P=g-E,B=f.V,V=f.Ba+f.c*E;for(t(g<=f.l.o);0<P;){var G=16<P?16:P,Y=f.l.ma,J=f.l.width,se=J*G,ve=Y.ca,Te=Y.tb+J*E,Ce=f.Ta,ke=f.Ua;W(f,G,B,V),Ir(Ce,ke,ve,Te,se),te(Y,E,E+G,ve,Te,J),P-=G,B+=G*f.c,E+=G}t(E==g),f.C=f.Ma=g}function We(){this.ub=this.yd=this.td=this.Rb=0}function Qe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function at(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Ye(){this.Yb=function(){var f=[];return function g(E,P,B){for(var V=B[P],G=0;G<V&&(E.push(B.length>P+1?[]:0),!(B.length<P+1));G++)g(E[G],P+1,B)}(f,0,[3,11]),f}()}function nt(){this.jb=i(3),this.Wc=o([4,8],Ye),this.Xc=o([4,17],Ye)}function kt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Xt(){this.ld=this.La=this.dd=this.tc=0}function er(){this.Na=this.la=0}function Br(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Qa(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ki(){this.uc=this.M=this.Nb=0,this.wa=Array(new Xt),this.Y=0,this.ya=Array(new Qa),this.aa=0,this.l=new Ai}function Ei(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Za(){this.cb=this.a=0,this.sc="",this.m=new oe,this.Od=new We,this.Kc=new Qe,this.ed=new kt,this.Qa=new at,this.Ic=this.$c=this.Aa=0,this.D=new Ki,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,oe),this.ia=0,this.pb=s(4,Br),this.Pa=new nt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ei),this.Hd=0,this.rb=Array(new er),this.sb=0,this.wa=Array(new Xt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Qa),this.L=this.aa=0,this.gd=o([4,2],Xt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ai(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function da(){var f=new Za;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,vu||(vu=rf)),f}function Fr(f,g,E){return f.a==0&&(f.a=g,f.sc=E,f.cb=0),0}function ef(f,g,E){return 3<=E&&f[g+0]==157&&f[g+1]==1&&f[g+2]==42}function tf(f,g){if(f==null)return 0;if(f.a=0,f.sc="OK",g==null)return Fr(f,2,"null VP8Io passed to VP8GetHeaders()");var E=g.data,P=g.w,B=g.ha;if(4>B)return Fr(f,7,"Truncated header.");var V=E[P+0]|E[P+1]<<8|E[P+2]<<16,G=f.Od;if(G.Rb=!(1&V),G.td=V>>1&7,G.yd=V>>4&1,G.ub=V>>5,3<G.td)return Fr(f,3,"Incorrect keyframe parameters.");if(!G.yd)return Fr(f,4,"Frame not displayable.");P+=3,B-=3;var Y=f.Kc;if(G.Rb){if(7>B)return Fr(f,7,"cannot parse picture header");if(!ef(E,P,B))return Fr(f,3,"Bad code word");Y.c=16383&(E[P+4]<<8|E[P+3]),Y.Td=E[P+4]>>6,Y.i=16383&(E[P+6]<<8|E[P+5]),Y.Ud=E[P+6]>>6,P+=7,B-=7,f.za=Y.c+15>>4,f.Ub=Y.i+15>>4,g.width=Y.c,g.height=Y.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,a((V=f.Pa).jb,0,255,V.jb.length),t((V=f.Qa)!=null),V.Cb=0,V.Bb=0,V.Fb=1,a(V.Zb,0,0,V.Zb.length),a(V.Lb,0,0,V.Lb)}if(G.ub>B)return Fr(f,7,"bad partition length");he(V=f.m,E,P,G.ub),P+=G.ub,B-=G.ub,G.Rb&&(Y.Ld=ae(V),Y.Kd=ae(V)),Y=f.Qa;var J,se=f.Pa;if(t(V!=null),t(Y!=null),Y.Cb=ae(V),Y.Cb){if(Y.Bb=ae(V),ae(V)){for(Y.Fb=ae(V),J=0;4>J;++J)Y.Zb[J]=ae(V)?fe(V,7):0;for(J=0;4>J;++J)Y.Lb[J]=ae(V)?fe(V,6):0}if(Y.Bb)for(J=0;3>J;++J)se.jb[J]=ae(V)?le(V,8):255}else Y.Bb=0;if(V.Ka)return Fr(f,3,"cannot parse segment header");if((Y=f.ed).zd=ae(V),Y.Tb=le(V,6),Y.wb=le(V,3),Y.Pc=ae(V),Y.Pc&&ae(V)){for(se=0;4>se;++se)ae(V)&&(Y.vd[se]=fe(V,6));for(se=0;4>se;++se)ae(V)&&(Y.od[se]=fe(V,6))}if(f.L=Y.Tb==0?0:Y.zd?1:2,V.Ka)return Fr(f,3,"cannot parse filter header");var ve=B;if(B=J=P,P=J+ve,Y=ve,f.Xb=(1<<le(f.m,2))-1,ve<3*(se=f.Xb))E=7;else{for(J+=3*se,Y-=3*se,ve=0;ve<se;++ve){var Te=E[B+0]|E[B+1]<<8|E[B+2]<<16;Te>Y&&(Te=Y),he(f.Jc[+ve],E,J,Te),J+=Te,Y-=Te,B+=3}he(f.Jc[+se],E,J,Y),E=J<P?0:5}if(E!=0)return Fr(f,E,"cannot parse partitions");for(E=le(J=f.m,7),B=ae(J)?fe(J,4):0,P=ae(J)?fe(J,4):0,Y=ae(J)?fe(J,4):0,se=ae(J)?fe(J,4):0,J=ae(J)?fe(J,4):0,ve=f.Qa,Te=0;4>Te;++Te){if(ve.Cb){var Ce=ve.Zb[Te];ve.Fb||(Ce+=E)}else{if(0<Te){f.pb[Te]=f.pb[0];continue}Ce=E}var ke=f.pb[Te];ke.Sc[0]=L1[pa(Ce+B,127)],ke.Sc[1]=F1[pa(Ce+0,127)],ke.Eb[0]=2*L1[pa(Ce+P,127)],ke.Eb[1]=101581*F1[pa(Ce+Y,127)]>>16,8>ke.Eb[1]&&(ke.Eb[1]=8),ke.Qc[0]=L1[pa(Ce+se,117)],ke.Qc[1]=F1[pa(Ce+J,127)],ke.lc=Ce+J}if(!G.Rb)return Fr(f,4,"Not a key frame.");for(ae(V),G=f.Pa,E=0;4>E;++E){for(B=0;8>B;++B)for(P=0;3>P;++P)for(Y=0;11>Y;++Y)se=ne(V,Ib[E][B][P][Y])?le(V,8):Fb[E][B][P][Y],G.Wc[E][B].Yb[P][Y]=se;for(B=0;17>B;++B)G.Xc[E][B]=G.Wc[E][jb[B]]}return f.kc=ae(V),f.kc&&(f.Bd=le(V,8)),f.cb=1}function rf(f,g,E,P,B,V,G){var Y=g[B].Yb[E];for(E=0;16>B;++B){if(!ne(f,Y[E+0]))return B;for(;!ne(f,Y[E+1]);)if(Y=g[++B].Yb[0],E=0,B==16)return 16;var J=g[B+1].Yb;if(ne(f,Y[E+2])){var se=f,ve=0;if(ne(se,(Ce=Y)[(Te=E)+3]))if(ne(se,Ce[Te+6])){for(Y=0,Te=2*(ve=ne(se,Ce[Te+8]))+(Ce=ne(se,Ce[Te+9+ve])),ve=0,Ce=Cb[Te];Ce[Y];++Y)ve+=ve+ne(se,Ce[Y]);ve+=3+(8<<Te)}else ne(se,Ce[Te+7])?(ve=7+2*ne(se,165),ve+=ne(se,145)):ve=5+ne(se,159);else ve=ne(se,Ce[Te+4])?3+ne(se,Ce[Te+5]):2;Y=J[2]}else ve=1,Y=J[1];J=G+Lb[B],0>(se=f).b&&re(se);var Te,Ce=se.b,ke=(Te=se.Ca>>1)-(se.I>>Ce)>>31;--se.b,se.Ca+=ke,se.Ca|=1,se.I-=(Te+1&ke)<<Ce,V[J]=((ve^ke)-ke)*P[(0<B)+0]}return 16}function Xc(f){var g=f.rb[f.sb-1];g.la=0,g.Na=0,a(f.zc,0,0,f.zc.length),f.ja=0}function s1(f,g){if(f==null)return 0;if(g==null)return Fr(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!tf(f,g))return 0;if(t(f.cb),g.ac==null||g.ac(g)){g.ob&&(f.L=0);var E=Ff[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=g.v-E>>4,f.zb=g.j-E>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=g.o+15+E>>4,f.Hb=g.va+15+E>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var P=f.ed;for(E=0;4>E;++E){var B;if(f.Qa.Cb){var V=f.Qa.Lb[E];f.Qa.Fb||(V+=P.Tb)}else V=P.Tb;for(B=0;1>=B;++B){var G=f.gd[E][B],Y=V;if(P.Pc&&(Y+=P.vd[0],B&&(Y+=P.od[0])),0<(Y=0>Y?0:63<Y?63:Y)){var J=Y;0<P.wb&&(J=4<P.wb?J>>2:J>>1)>9-P.wb&&(J=9-P.wb),1>J&&(J=1),G.dd=J,G.tc=2*Y+J,G.ld=40<=Y?2:15<=Y?1:0}else G.tc=0;G.La=B}}}E=0}else Fr(f,6,"Frame setup failed"),E=f.a;if(E=E==0){if(E){f.$c=0,0<f.Aa||(f.Ic=Gb);e:{E=f.Ic,P=4*(J=f.za);var se=32*J,ve=J+1,Te=0<f.L?J*(0<f.Aa?2:1):0,Ce=(f.Aa==2?2:1)*J;if((G=P+832+(B=3*(16*E+Ff[f.L])/2*se)+(V=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=G)E=0;else{if(G>f.Vb){if(f.Vb=0,f.Ec=i(G),f.Fc=0,f.Ec==null){E=Fr(f,1,"no memory during frame initialization.");break e}f.Vb=G}G=f.Ec,Y=f.Fc,f.Ac=G,f.Bc=Y,Y+=P,f.Gd=s(se,Ei),f.Hd=0,f.rb=s(ve+1,er),f.sb=1,f.wa=Te?s(Te,Xt):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=J),t(!0),f.oc=G,f.pc=Y,Y+=832,f.ya=s(Ce,Qa),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=J),f.R=16*J,f.B=8*J,J=(se=Ff[f.L])*f.R,se=se/2*f.B,f.sa=G,f.ta=Y+J,f.qa=f.sa,f.ra=f.ta+16*E*f.R+se,f.Ha=f.qa,f.Ia=f.ra+8*E*f.B+se,f.$c=0,Y+=B,f.mb=V?G:null,f.nb=V?Y:null,t(Y+V<=f.Fc+f.Vb),Xc(f),a(f.Ac,f.Bc,0,P),E=1}}if(E){if(g.ka=0,g.y=f.sa,g.O=f.ta,g.f=f.qa,g.N=f.ra,g.ea=f.Ha,g.Vd=f.Ia,g.fa=f.R,g.Rc=f.B,g.F=null,g.J=0,!bf){for(E=-255;255>=E;++E)Kr[255+E]=0>E?-E:E;for(E=-1020;1020>=E;++E)es[1020+E]=-128>E?-128:127<E?127:E;for(E=-112;112>=E;++E)xu[112+E]=-16>E?-16:15<E?15:E;for(E=-255;510>=E;++E)Rl[255+E]=0>E?0:255<E?255:E;bf=1}Pl=c1,Zi=o1,pu=af,Bn=l1,ja=sf,Pr=nf,Il=tu,_f=To,mu=b1,Fo=ru,Po=_1,Ts=kl,Io=nu,jl=mf,jo=pf,Cs=Ti,gu=Yi,Ra=w1,ni[0]=Ni,ni[1]=u1,ni[2]=p1,ni[3]=m1,ni[4]=cf,ni[5]=_l,ni[6]=uf,ni[7]=Qc,ni[8]=x1,ni[9]=g1,Ls[0]=of,Ls[1]=h1,Ls[2]=Xi,Ls[3]=yl,Ls[4]=wn,Ls[5]=d1,Ls[6]=lf,ts[0]=ks,ts[1]=f1,ts[2]=v1,ts[3]=Zc,ts[4]=No,ts[5]=y1,ts[6]=eu,E=1}else E=0}E&&(E=function(ke,ze){for(ke.M=0;ke.M<ke.Va;++ke.M){var Re,ye=ke.Jc[ke.M&ke.Xb],be=ke.m,Be=ke;for(Re=0;Re<Be.za;++Re){var $e=be,Ue=Be,ot=Ue.Ac,et=Ue.Bc+4*Re,yt=Ue.zc,tt=Ue.ya[Ue.aa+Re];if(Ue.Qa.Bb?tt.$b=ne($e,Ue.Pa.jb[0])?2+ne($e,Ue.Pa.jb[2]):ne($e,Ue.Pa.jb[1]):tt.$b=0,Ue.kc&&(tt.Ad=ne($e,Ue.Bd)),tt.Za=!ne($e,145)+0,tt.Za){var Gt=tt.Ob,Yt=0;for(Ue=0;4>Ue;++Ue){var qt,Ot=yt[0+Ue];for(qt=0;4>qt;++qt){Ot=Pb[ot[et+qt]][Ot];for(var nr=Kg[ne($e,Ot[0])];0<nr;)nr=Kg[2*nr+ne($e,Ot[nr])];Ot=-nr,ot[et+qt]=Ot}n(Gt,Yt,ot,et,4),Yt+=4,yt[0+Ue]=Ot}}else Ot=ne($e,156)?ne($e,128)?1:3:ne($e,163)?2:0,tt.Ob[0]=Ot,a(ot,et,Ot,4),a(yt,0,Ot,4);tt.Dd=ne($e,142)?ne($e,114)?ne($e,183)?1:3:2:0}if(Be.m.Ka)return Fr(ke,7,"Premature end-of-partition0 encountered.");for(;ke.ja<ke.za;++ke.ja){if(Be=ye,$e=(be=ke).rb[be.sb-1],ot=be.rb[be.sb+be.ja],Re=be.ya[be.aa+be.ja],et=be.kc?Re.Ad:0)$e.la=ot.la=0,Re.Za||($e.Na=ot.Na=0),Re.Hc=0,Re.Gc=0,Re.ia=0;else{var tr,Lt;if($e=ot,ot=Be,et=be.Pa.Xc,yt=be.ya[be.aa+be.ja],tt=be.pb[yt.$b],Ue=yt.ad,Gt=0,Yt=be.rb[be.sb-1],Ot=qt=0,a(Ue,Gt,0,384),yt.Za)var zr=0,ea=et[3];else{nr=i(16);var $r=$e.Na+Yt.Na;if($r=vu(ot,et[1],$r,tt.Eb,0,nr,0),$e.Na=Yt.Na=(0<$r)+0,1<$r)Pl(nr,0,Ue,Gt);else{var ta=nr[0]+3>>3;for(nr=0;256>nr;nr+=16)Ue[Gt+nr]=ta}zr=1,ea=et[0]}var Jt=15&$e.la,ga=15&Yt.la;for(nr=0;4>nr;++nr){var xa=1&ga;for(ta=Lt=0;4>ta;++ta)Jt=Jt>>1|(xa=($r=vu(ot,ea,$r=xa+(1&Jt),tt.Sc,zr,Ue,Gt))>zr)<<7,Lt=Lt<<2|(3<$r?3:1<$r?2:Ue[Gt+0]!=0),Gt+=16;Jt>>=4,ga=ga>>1|xa<<7,qt=(qt<<8|Lt)>>>0}for(ea=Jt,zr=ga>>4,tr=0;4>tr;tr+=2){for(Lt=0,Jt=$e.la>>4+tr,ga=Yt.la>>4+tr,nr=0;2>nr;++nr){for(xa=1&ga,ta=0;2>ta;++ta)$r=xa+(1&Jt),Jt=Jt>>1|(xa=0<($r=vu(ot,et[2],$r,tt.Qc,0,Ue,Gt)))<<3,Lt=Lt<<2|(3<$r?3:1<$r?2:Ue[Gt+0]!=0),Gt+=16;Jt>>=2,ga=ga>>1|xa<<5}Ot|=Lt<<4*tr,ea|=Jt<<4<<tr,zr|=(240&ga)<<tr}$e.la=ea,Yt.la=zr,yt.Hc=qt,yt.Gc=Ot,yt.ia=43690&Ot?0:tt.ia,et=!(qt|Ot)}if(0<be.L&&(be.wa[be.Y+be.ja]=be.gd[Re.$b][Re.Za],be.wa[be.Y+be.ja].La|=!et),Be.Ka)return Fr(ke,7,"Premature end-of-file encountered.")}if(Xc(ke),be=ze,Be=1,Re=(ye=ke).D,$e=0<ye.L&&ye.M>=ye.zb&&ye.M<=ye.Va,ye.Aa==0)e:{if(Re.M=ye.M,Re.uc=$e,cu(ye,Re),Be=1,Re=(Lt=ye.D).Nb,$e=(Ot=Ff[ye.L])*ye.R,ot=Ot/2*ye.B,nr=16*Re*ye.R,ta=8*Re*ye.B,et=ye.sa,yt=ye.ta-$e+nr,tt=ye.qa,Ue=ye.ra-ot+ta,Gt=ye.Ha,Yt=ye.Ia-ot+ta,ga=(Jt=Lt.M)==0,qt=Jt>=ye.Va-1,ye.Aa==2&&cu(ye,Lt),Lt.uc)for(xa=($r=ye).D.M,t($r.D.uc),Lt=$r.yb;Lt<$r.Hb;++Lt){zr=Lt,ea=xa;var rn=(hn=(Er=$r).D).Nb;tr=Er.R;var hn=hn.wa[hn.Y+zr],Un=Er.sa,Ba=Er.ta+16*rn*tr+16*zr,Li=hn.dd,nn=hn.tc;if(nn!=0)if(t(3<=nn),Er.L==1)0<zr&&Cs(Un,Ba,tr,nn+4),hn.La&&Ra(Un,Ba,tr,nn),0<ea&&jo(Un,Ba,tr,nn+4),hn.La&&gu(Un,Ba,tr,nn);else{var rs=Er.B,Ro=Er.qa,Ol=Er.ra+8*rn*rs+8*zr,Ps=Er.Ha,Er=Er.Ia+8*rn*rs+8*zr;rn=hn.ld,0<zr&&(_f(Un,Ba,tr,nn+4,Li,rn),Fo(Ro,Ol,Ps,Er,rs,nn+4,Li,rn)),hn.La&&(Ts(Un,Ba,tr,nn,Li,rn),jl(Ro,Ol,Ps,Er,rs,nn,Li,rn)),0<ea&&(Il(Un,Ba,tr,nn+4,Li,rn),mu(Ro,Ol,Ps,Er,rs,nn+4,Li,rn)),hn.La&&(Po(Un,Ba,tr,nn,Li,rn),Io(Ro,Ol,Ps,Er,rs,nn,Li,rn))}}if(ye.ia&&alert("todo:DitherRow"),be.put!=null){if(Lt=16*Jt,Jt=16*(Jt+1),ga?(be.y=ye.sa,be.O=ye.ta+nr,be.f=ye.qa,be.N=ye.ra+ta,be.ea=ye.Ha,be.W=ye.Ia+ta):(Lt-=Ot,be.y=et,be.O=yt,be.f=tt,be.N=Ue,be.ea=Gt,be.W=Yt),qt||(Jt-=Ot),Jt>be.o&&(Jt=be.o),be.F=null,be.J=null,ye.Fa!=null&&0<ye.Fa.length&&Lt<Jt&&(be.J=ou(ye,be,Lt,Jt-Lt),be.F=ye.mb,be.F==null&&be.F.length==0)){Be=Fr(ye,3,"Could not decode alpha data.");break e}Lt<be.j&&(Ot=be.j-Lt,Lt=be.j,t(!(1&Ot)),be.O+=ye.R*Ot,be.N+=ye.B*(Ot>>1),be.W+=ye.B*(Ot>>1),be.F!=null&&(be.J+=be.width*Ot)),Lt<Jt&&(be.O+=be.v,be.N+=be.v>>1,be.W+=be.v>>1,be.F!=null&&(be.J+=be.v),be.ka=Lt-be.j,be.U=be.va-be.v,be.T=Jt-Lt,Be=be.put(be))}Re+1!=ye.Ic||qt||(n(ye.sa,ye.ta-$e,et,yt+16*ye.R,$e),n(ye.qa,ye.ra-ot,tt,Ue+8*ye.B,ot),n(ye.Ha,ye.Ia-ot,Gt,Yt+8*ye.B,ot))}if(!Be)return Fr(ke,6,"Output aborted.")}return 1}(f,g)),g.bc!=null&&g.bc(g),E&=1}return E?(f.cb=0,E):0}function ei(f,g,E,P,B){B=f[g+E+32*P]+(B>>3),f[g+E+32*P]=-256&B?0>B?0:255:B}function vl(f,g,E,P,B,V){ei(f,g,0,E,P+B),ei(f,g,1,E,P+V),ei(f,g,2,E,P-V),ei(f,g,3,E,P-B)}function Jn(f){return(20091*f>>16)+f}function Yc(f,g,E,P){var B,V=0,G=i(16);for(B=0;4>B;++B){var Y=f[g+0]+f[g+8],J=f[g+0]-f[g+8],se=(35468*f[g+4]>>16)-Jn(f[g+12]),ve=Jn(f[g+4])+(35468*f[g+12]>>16);G[V+0]=Y+ve,G[V+1]=J+se,G[V+2]=J-se,G[V+3]=Y-ve,V+=4,g++}for(B=V=0;4>B;++B)Y=(f=G[V+0]+4)+G[V+8],J=f-G[V+8],se=(35468*G[V+4]>>16)-Jn(G[V+12]),ei(E,P,0,0,Y+(ve=Jn(G[V+4])+(35468*G[V+12]>>16))),ei(E,P,1,0,J+se),ei(E,P,2,0,J-se),ei(E,P,3,0,Y-ve),V++,P+=32}function nf(f,g,E,P){var B=f[g+0]+4,V=35468*f[g+4]>>16,G=Jn(f[g+4]),Y=35468*f[g+1]>>16;vl(E,P,0,B+G,f=Jn(f[g+1]),Y),vl(E,P,1,B+V,f,Y),vl(E,P,2,B-V,f,Y),vl(E,P,3,B-G,f,Y)}function o1(f,g,E,P,B){Yc(f,g,E,P),B&&Yc(f,g+16,E,P+4)}function af(f,g,E,P){Zi(f,g+0,E,P,1),Zi(f,g+32,E,P+128,1)}function l1(f,g,E,P){var B;for(f=f[g+0]+4,B=0;4>B;++B)for(g=0;4>g;++g)ei(E,P,g,B,f)}function sf(f,g,E,P){f[g+0]&&Bn(f,g+0,E,P),f[g+16]&&Bn(f,g+16,E,P+4),f[g+32]&&Bn(f,g+32,E,P+128),f[g+48]&&Bn(f,g+48,E,P+128+4)}function c1(f,g,E,P){var B,V=i(16);for(B=0;4>B;++B){var G=f[g+0+B]+f[g+12+B],Y=f[g+4+B]+f[g+8+B],J=f[g+4+B]-f[g+8+B],se=f[g+0+B]-f[g+12+B];V[0+B]=G+Y,V[8+B]=G-Y,V[4+B]=se+J,V[12+B]=se-J}for(B=0;4>B;++B)G=(f=V[0+4*B]+3)+V[3+4*B],Y=V[1+4*B]+V[2+4*B],J=V[1+4*B]-V[2+4*B],se=f-V[3+4*B],E[P+0]=G+Y>>3,E[P+16]=se+J>>3,E[P+32]=G-Y>>3,E[P+48]=se-J>>3,P+=64}function Jc(f,g,E){var P,B=g-32,V=ma,G=255-f[B-1];for(P=0;P<E;++P){var Y,J=V,se=G+f[g-1];for(Y=0;Y<E;++Y)f[g+Y]=J[se+f[B+Y]];g+=32}}function u1(f,g){Jc(f,g,4)}function f1(f,g){Jc(f,g,8)}function h1(f,g){Jc(f,g,16)}function Xi(f,g){var E;for(E=0;16>E;++E)n(f,g+32*E,f,g-32,16)}function yl(f,g){var E;for(E=16;0<E;--E)a(f,g,f[g-1],16),g+=32}function wl(f,g,E){var P;for(P=0;16>P;++P)a(g,E+32*P,f,16)}function of(f,g){var E,P=16;for(E=0;16>E;++E)P+=f[g-1+32*E]+f[g+E-32];wl(P>>5,f,g)}function wn(f,g){var E,P=8;for(E=0;16>E;++E)P+=f[g-1+32*E];wl(P>>4,f,g)}function d1(f,g){var E,P=8;for(E=0;16>E;++E)P+=f[g+E-32];wl(P>>4,f,g)}function lf(f,g){wl(128,f,g)}function Et(f,g,E){return f+2*g+E+2>>2}function p1(f,g){var E,P=g-32;for(P=new Uint8Array([Et(f[P-1],f[P+0],f[P+1]),Et(f[P+0],f[P+1],f[P+2]),Et(f[P+1],f[P+2],f[P+3]),Et(f[P+2],f[P+3],f[P+4])]),E=0;4>E;++E)n(f,g+32*E,P,0,P.length)}function m1(f,g){var E=f[g-1],P=f[g-1+32],B=f[g-1+64],V=f[g-1+96];me(f,g+0,16843009*Et(f[g-1-32],E,P)),me(f,g+32,16843009*Et(E,P,B)),me(f,g+64,16843009*Et(P,B,V)),me(f,g+96,16843009*Et(B,V,V))}function Ni(f,g){var E,P=4;for(E=0;4>E;++E)P+=f[g+E-32]+f[g-1+32*E];for(P>>=3,E=0;4>E;++E)a(f,g+32*E,P,4)}function cf(f,g){var E=f[g-1+0],P=f[g-1+32],B=f[g-1+64],V=f[g-1-32],G=f[g+0-32],Y=f[g+1-32],J=f[g+2-32],se=f[g+3-32];f[g+0+96]=Et(P,B,f[g-1+96]),f[g+1+96]=f[g+0+64]=Et(E,P,B),f[g+2+96]=f[g+1+64]=f[g+0+32]=Et(V,E,P),f[g+3+96]=f[g+2+64]=f[g+1+32]=f[g+0+0]=Et(G,V,E),f[g+3+64]=f[g+2+32]=f[g+1+0]=Et(Y,G,V),f[g+3+32]=f[g+2+0]=Et(J,Y,G),f[g+3+0]=Et(se,J,Y)}function uf(f,g){var E=f[g+1-32],P=f[g+2-32],B=f[g+3-32],V=f[g+4-32],G=f[g+5-32],Y=f[g+6-32],J=f[g+7-32];f[g+0+0]=Et(f[g+0-32],E,P),f[g+1+0]=f[g+0+32]=Et(E,P,B),f[g+2+0]=f[g+1+32]=f[g+0+64]=Et(P,B,V),f[g+3+0]=f[g+2+32]=f[g+1+64]=f[g+0+96]=Et(B,V,G),f[g+3+32]=f[g+2+64]=f[g+1+96]=Et(V,G,Y),f[g+3+64]=f[g+2+96]=Et(G,Y,J),f[g+3+96]=Et(Y,J,J)}function _l(f,g){var E=f[g-1+0],P=f[g-1+32],B=f[g-1+64],V=f[g-1-32],G=f[g+0-32],Y=f[g+1-32],J=f[g+2-32],se=f[g+3-32];f[g+0+0]=f[g+1+64]=V+G+1>>1,f[g+1+0]=f[g+2+64]=G+Y+1>>1,f[g+2+0]=f[g+3+64]=Y+J+1>>1,f[g+3+0]=J+se+1>>1,f[g+0+96]=Et(B,P,E),f[g+0+64]=Et(P,E,V),f[g+0+32]=f[g+1+96]=Et(E,V,G),f[g+1+32]=f[g+2+96]=Et(V,G,Y),f[g+2+32]=f[g+3+96]=Et(G,Y,J),f[g+3+32]=Et(Y,J,se)}function Qc(f,g){var E=f[g+0-32],P=f[g+1-32],B=f[g+2-32],V=f[g+3-32],G=f[g+4-32],Y=f[g+5-32],J=f[g+6-32],se=f[g+7-32];f[g+0+0]=E+P+1>>1,f[g+1+0]=f[g+0+64]=P+B+1>>1,f[g+2+0]=f[g+1+64]=B+V+1>>1,f[g+3+0]=f[g+2+64]=V+G+1>>1,f[g+0+32]=Et(E,P,B),f[g+1+32]=f[g+0+96]=Et(P,B,V),f[g+2+32]=f[g+1+96]=Et(B,V,G),f[g+3+32]=f[g+2+96]=Et(V,G,Y),f[g+3+64]=Et(G,Y,J),f[g+3+96]=Et(Y,J,se)}function g1(f,g){var E=f[g-1+0],P=f[g-1+32],B=f[g-1+64],V=f[g-1+96];f[g+0+0]=E+P+1>>1,f[g+2+0]=f[g+0+32]=P+B+1>>1,f[g+2+32]=f[g+0+64]=B+V+1>>1,f[g+1+0]=Et(E,P,B),f[g+3+0]=f[g+1+32]=Et(P,B,V),f[g+3+32]=f[g+1+64]=Et(B,V,V),f[g+3+64]=f[g+2+64]=f[g+0+96]=f[g+1+96]=f[g+2+96]=f[g+3+96]=V}function x1(f,g){var E=f[g-1+0],P=f[g-1+32],B=f[g-1+64],V=f[g-1+96],G=f[g-1-32],Y=f[g+0-32],J=f[g+1-32],se=f[g+2-32];f[g+0+0]=f[g+2+32]=E+G+1>>1,f[g+0+32]=f[g+2+64]=P+E+1>>1,f[g+0+64]=f[g+2+96]=B+P+1>>1,f[g+0+96]=V+B+1>>1,f[g+3+0]=Et(Y,J,se),f[g+2+0]=Et(G,Y,J),f[g+1+0]=f[g+3+32]=Et(E,G,Y),f[g+1+32]=f[g+3+64]=Et(P,E,G),f[g+1+64]=f[g+3+96]=Et(B,P,E),f[g+1+96]=Et(V,B,P)}function v1(f,g){var E;for(E=0;8>E;++E)n(f,g+32*E,f,g-32,8)}function Zc(f,g){var E;for(E=0;8>E;++E)a(f,g,f[g-1],8),g+=32}function Ao(f,g,E){var P;for(P=0;8>P;++P)a(g,E+32*P,f,8)}function ks(f,g){var E,P=8;for(E=0;8>E;++E)P+=f[g+E-32]+f[g-1+32*E];Ao(P>>4,f,g)}function y1(f,g){var E,P=4;for(E=0;8>E;++E)P+=f[g+E-32];Ao(P>>3,f,g)}function No(f,g){var E,P=4;for(E=0;8>E;++E)P+=f[g-1+32*E];Ao(P>>3,f,g)}function eu(f,g){Ao(128,f,g)}function bl(f,g,E){var P=f[g-E],B=f[g+0],V=3*(B-P)+E1[1020+f[g-2*E]-f[g+E]],G=kf[112+(V+4>>3)];f[g-E]=ma[255+P+kf[112+(V+3>>3)]],f[g+0]=ma[255+B-G]}function ff(f,g,E,P){var B=f[g+0],V=f[g+E];return Da[255+f[g-2*E]-f[g-E]]>P||Da[255+V-B]>P}function hf(f,g,E,P){return 4*Da[255+f[g-E]-f[g+0]]+Da[255+f[g-2*E]-f[g+E]]<=P}function df(f,g,E,P,B){var V=f[g-3*E],G=f[g-2*E],Y=f[g-E],J=f[g+0],se=f[g+E],ve=f[g+2*E],Te=f[g+3*E];return 4*Da[255+Y-J]+Da[255+G-se]>P?0:Da[255+f[g-4*E]-V]<=B&&Da[255+V-G]<=B&&Da[255+G-Y]<=B&&Da[255+Te-ve]<=B&&Da[255+ve-se]<=B&&Da[255+se-J]<=B}function pf(f,g,E,P){var B=2*P+1;for(P=0;16>P;++P)hf(f,g+P,E,B)&&bl(f,g+P,E)}function Ti(f,g,E,P){var B=2*P+1;for(P=0;16>P;++P)hf(f,g+P*E,1,B)&&bl(f,g+P*E,1)}function Yi(f,g,E,P){var B;for(B=3;0<B;--B)pf(f,g+=4*E,E,P)}function w1(f,g,E,P){var B;for(B=3;0<B;--B)Ti(f,g+=4,E,P)}function Ss(f,g,E,P,B,V,G,Y){for(V=2*V+1;0<B--;){if(df(f,g,E,V,G))if(ff(f,g,E,Y))bl(f,g,E);else{var J=f,se=g,ve=E,Te=J[se-2*ve],Ce=J[se-ve],ke=J[se+0],ze=J[se+ve],Re=J[se+2*ve],ye=27*(Be=E1[1020+3*(ke-Ce)+E1[1020+Te-ze]])+63>>7,be=18*Be+63>>7,Be=9*Be+63>>7;J[se-3*ve]=ma[255+J[se-3*ve]+Be],J[se-2*ve]=ma[255+Te+be],J[se-ve]=ma[255+Ce+ye],J[se+0]=ma[255+ke-ye],J[se+ve]=ma[255+ze-be],J[se+2*ve]=ma[255+Re-Be]}g+=P}}function ti(f,g,E,P,B,V,G,Y){for(V=2*V+1;0<B--;){if(df(f,g,E,V,G))if(ff(f,g,E,Y))bl(f,g,E);else{var J=f,se=g,ve=E,Te=J[se-ve],Ce=J[se+0],ke=J[se+ve],ze=kf[112+((Re=3*(Ce-Te))+4>>3)],Re=kf[112+(Re+3>>3)],ye=ze+1>>1;J[se-2*ve]=ma[255+J[se-2*ve]+ye],J[se-ve]=ma[255+Te+Re],J[se+0]=ma[255+Ce-ze],J[se+ve]=ma[255+ke-ye]}g+=P}}function tu(f,g,E,P,B,V){Ss(f,g,E,1,16,P,B,V)}function To(f,g,E,P,B,V){Ss(f,g,1,E,16,P,B,V)}function _1(f,g,E,P,B,V){var G;for(G=3;0<G;--G)ti(f,g+=4*E,E,1,16,P,B,V)}function kl(f,g,E,P,B,V){var G;for(G=3;0<G;--G)ti(f,g+=4,1,E,16,P,B,V)}function b1(f,g,E,P,B,V,G,Y){Ss(f,g,B,1,8,V,G,Y),Ss(E,P,B,1,8,V,G,Y)}function ru(f,g,E,P,B,V,G,Y){Ss(f,g,1,B,8,V,G,Y),Ss(E,P,1,B,8,V,G,Y)}function nu(f,g,E,P,B,V,G,Y){ti(f,g+4*B,B,1,8,V,G,Y),ti(E,P+4*B,B,1,8,V,G,Y)}function mf(f,g,E,P,B,V,G,Y){ti(f,g+4,1,B,8,V,G,Y),ti(E,P+4,1,B,8,V,G,Y)}function Sl(){this.ba=new fa,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new rr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function au(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function iu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function gf(){this.ua=0,this.Wa=new Q,this.vb=new Q,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new K,this.yc=new N}function k1(){this.xb=this.a=0,this.l=new Ai,this.ca=new fa,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new b,this.Pb=0,this.wd=new b,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new gf,this.ab=0,this.gc=s(4,iu),this.Oc=0}function El(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ai,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Co(f,g,E,P,B,V,G){for(f=f==null?0:f[g+0],g=0;g<G;++g)B[V+g]=f+E[P+g]&255,f=B[V+g]}function su(f,g,E,P,B,V,G){var Y;if(f==null)Co(null,null,E,P,B,V,G);else for(Y=0;Y<G;++Y)B[V+Y]=f[g+Y]+E[P+Y]&255}function Es(f,g,E,P,B,V,G){if(f==null)Co(null,null,E,P,B,V,G);else{var Y,J=f[g+0],se=J,ve=J;for(Y=0;Y<G;++Y)se=ve+(J=f[g+Y])-se,ve=E[P+Y]+(-256&se?0>se?0:255:se)&255,se=J,B[V+Y]=ve}}function ou(f,g,E,P){var B=g.width,V=g.o;if(t(f!=null&&g!=null),0>E||0>=P||E+P>V)return null;if(!f.Cc){if(f.ga==null){var G;if(f.ga=new El,(G=f.ga==null)||(G=g.width*g.o,t(f.Gb.length==0),f.Gb=i(G),f.Uc=0,f.Gb==null?G=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,G=1),G=!G),!G){G=f.ga;var Y=f.Fa,J=f.P,se=f.qc,ve=f.mb,Te=f.nb,Ce=J+1,ke=se-1,ze=G.l;if(t(Y!=null&&ve!=null&&g!=null),Fs[0]=null,Fs[1]=Co,Fs[2]=su,Fs[3]=Es,G.ca=ve,G.tb=Te,G.c=g.width,G.i=g.height,t(0<G.c&&0<G.i),1>=se)g=0;else if(G.$a=Y[J+0]>>0&3,G.Z=Y[J+0]>>2&3,G.Lc=Y[J+0]>>4&3,J=Y[J+0]>>6&3,0>G.$a||1<G.$a||4<=G.Z||1<G.Lc||J)g=0;else if(ze.put=Fa,ze.ac=Gr,ze.bc=Pa,ze.ma=G,ze.width=g.width,ze.height=g.height,ze.Da=g.Da,ze.v=g.v,ze.va=g.va,ze.j=g.j,ze.o=g.o,G.$a)e:{t(G.$a==1),g=je();t:for(;;){if(g==null){g=0;break e}if(t(G!=null),G.mc=g,g.c=G.c,g.i=G.i,g.l=G.l,g.l.ma=G,g.l.width=G.c,g.l.height=G.i,g.a=0,ie(g.m,Y,Ce,ke),!Ae(G.c,G.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&ee(g.s)?(G.ic=1,Y=g.c*g.i,g.Ta=null,g.Ua=0,g.V=i(Y),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(G.ic=0,g=Le(g,G.c)),!g))break t;g=1;break e}G.mc=null,g=0}else g=ke>=G.c*G.i;G=!g}if(G)return null;f.ga.Lc!=1?f.Ga=0:P=V-E}t(f.ga!=null),t(E+P<=V);e:{if(g=(Y=f.ga).c,V=Y.l.o,Y.$a==0){if(Ce=f.rc,ke=f.Vc,ze=f.Fa,J=f.P+1+E*g,se=f.mb,ve=f.nb+E*g,t(J<=f.P+f.qc),Y.Z!=0)for(t(Fs[Y.Z]!=null),G=0;G<P;++G)Fs[Y.Z](Ce,ke,ze,J,se,ve,g),Ce=se,ke=ve,ve+=g,J+=g;else for(G=0;G<P;++G)n(se,ve,ze,J,g),Ce=se,ke=ve,ve+=g,J+=g;f.rc=Ce,f.Vc=ke}else{if(t(Y.mc!=null),g=E+P,t((G=Y.mc)!=null),t(g<=G.i),G.C>=g)g=1;else if(Y.ic||Ee(),Y.ic){Y=G.V,Ce=G.Ba,ke=G.c;var Re=G.i,ye=(ze=1,J=G.$/ke,se=G.$%ke,ve=G.m,Te=G.s,G.$),be=ke*Re,Be=ke*g,$e=Te.wc,Ue=ye<Be?kr(Te,se,J):null;t(ye<=be),t(g<=Re),t(ee(Te));t:for(;;){for(;!ve.h&&ye<Be;){if(se&$e||(Ue=kr(Te,se,J)),t(Ue!=null),H(ve),256>(Re=yn(Ue.G[0],Ue.H[0],ve)))Y[Ce+ye]=Re,++ye,++se>=ke&&(se=0,++J<=g&&!(J%16)&&ce(G,J));else{if(!(280>Re)){ze=0;break t}Re=ha(Re-256,ve);var ot,et=yn(Ue.G[4],Ue.H[4],ve);if(H(ve),!(ye>=(et=Yn(ke,et=ha(et,ve)))&&be-ye>=Re)){ze=0;break t}for(ot=0;ot<Re;++ot)Y[Ce+ye+ot]=Y[Ce+ye+ot-et];for(ye+=Re,se+=Re;se>=ke;)se-=ke,++J<=g&&!(J%16)&&ce(G,J);ye<Be&&se&$e&&(Ue=kr(Te,se,J))}t(ve.h==C(ve))}ce(G,J>g?g:J);break t}!ze||ve.h&&ye<be?(ze=0,G.a=ve.h?5:3):G.$=ye,g=ze}else g=de(G,G.V,G.Ba,G.c,G.i,g,Fe);if(!g){P=0;break e}}E+P>=V&&(f.Cc=1),P=1}if(!P)return null;if(f.Cc&&((P=f.ga)!=null&&(P.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+E*B}function w(f,g,E,P,B,V){for(;0<B--;){var G,Y=f,J=g+(E?1:0),se=f,ve=g+(E?0:3);for(G=0;G<P;++G){var Te=se[ve+4*G];Te!=255&&(Te*=32897,Y[J+4*G+0]=Y[J+4*G+0]*Te>>23,Y[J+4*G+1]=Y[J+4*G+1]*Te>>23,Y[J+4*G+2]=Y[J+4*G+2]*Te>>23)}g+=V}}function U(f,g,E,P,B){for(;0<P--;){var V;for(V=0;V<E;++V){var G=f[g+2*V+0],Y=15&(se=f[g+2*V+1]),J=4369*Y,se=(240&se|se>>4)*J>>16;f[g+2*V+0]=(240&G|G>>4)*J>>16&240|(15&G|G<<4)*J>>16>>4&15,f[g+2*V+1]=240&se|Y}g+=B}}function pe(f,g,E,P,B,V,G,Y){var J,se,ve=255;for(se=0;se<B;++se){for(J=0;J<P;++J){var Te=f[g+J];V[G+4*J]=Te,ve&=Te}g+=E,G+=Y}return ve!=255}function xe(f,g,E,P,B){var V;for(V=0;V<B;++V)E[P+V]=f[g+V]>>8}function Ee(){Oa=w,sr=U,or=pe,Ir=xe}function Me(f,g,E){T[f]=function(P,B,V,G,Y,J,se,ve,Te,Ce,ke,ze,Re,ye,be,Be,$e){var Ue,ot=$e-1>>1,et=Y[J+0]|se[ve+0]<<16,yt=Te[Ce+0]|ke[ze+0]<<16;t(P!=null);var tt=3*et+yt+131074>>2;for(g(P[B+0],255&tt,tt>>16,Re,ye),V!=null&&(tt=3*yt+et+131074>>2,g(V[G+0],255&tt,tt>>16,be,Be)),Ue=1;Ue<=ot;++Ue){var Gt=Y[J+Ue]|se[ve+Ue]<<16,Yt=Te[Ce+Ue]|ke[ze+Ue]<<16,qt=et+Gt+yt+Yt+524296,Ot=qt+2*(Gt+yt)>>3;tt=Ot+et>>1,et=(qt=qt+2*(et+Yt)>>3)+Gt>>1,g(P[B+2*Ue-1],255&tt,tt>>16,Re,ye+(2*Ue-1)*E),g(P[B+2*Ue-0],255&et,et>>16,Re,ye+(2*Ue-0)*E),V!=null&&(tt=qt+yt>>1,et=Ot+Yt>>1,g(V[G+2*Ue-1],255&tt,tt>>16,be,Be+(2*Ue-1)*E),g(V[G+2*Ue+0],255&et,et>>16,be,Be+(2*Ue+0)*E)),et=Gt,yt=Yt}1&$e||(tt=3*et+yt+131074>>2,g(P[B+$e-1],255&tt,tt>>16,Re,ye+($e-1)*E),V!=null&&(tt=3*yt+et+131074>>2,g(V[G+$e-1],255&tt,tt>>16,be,Be+($e-1)*E)))}}function Ve(){Ma[Sf]=Ob,Ma[Ef]=Yg,Ma[Vg]=Db,Ma[Af]=Jg,Ma[Nf]=Qg,Ma[A1]=Zg,Ma[Wg]=Mb,Ma[N1]=Yg,Ma[T1]=Jg,Ma[Tf]=Qg,Ma[C1]=Zg}function it(f){return f&~Bb?0>f?0:255:f>>ex}function mt(f,g){return it((19077*f>>8)+(26149*g>>8)-14234)}function Ct(f,g,E){return it((19077*f>>8)-(6419*g>>8)-(13320*E>>8)+8708)}function At(f,g){return it((19077*f>>8)+(33050*g>>8)-17685)}function Bt(f,g,E,P,B){P[B+0]=mt(f,E),P[B+1]=Ct(f,g,E),P[B+2]=At(f,g)}function xr(f,g,E,P,B){P[B+0]=At(f,g),P[B+1]=Ct(f,g,E),P[B+2]=mt(f,E)}function Sr(f,g,E,P,B){var V=Ct(f,g,E);g=V<<3&224|At(f,g)>>3,P[B+0]=248&mt(f,E)|V>>5,P[B+1]=g}function Ur(f,g,E,P,B){var V=240&At(f,g)|15;P[B+0]=240&mt(f,E)|Ct(f,g,E)>>4,P[B+1]=V}function _n(f,g,E,P,B){P[B+0]=255,Bt(f,g,E,P,B+1)}function tn(f,g,E,P,B){xr(f,g,E,P,B),P[B+3]=255}function ri(f,g,E,P,B){Bt(f,g,E,P,B),P[B+3]=255}function pa(f,g){return 0>f?0:f>g?g:f}function Ci(f,g,E){T[f]=function(P,B,V,G,Y,J,se,ve,Te){for(var Ce=ve+(-2&Te)*E;ve!=Ce;)g(P[B+0],V[G+0],Y[J+0],se,ve),g(P[B+1],V[G+0],Y[J+0],se,ve+E),B+=2,++G,++J,ve+=2*E;1&Te&&g(P[B+0],V[G+0],Y[J+0],se,ve)}}function xf(f,g,E){return E==0?f==0?g==0?6:5:g==0?4:0:E}function lu(f,g,E,P,B){switch(f>>>30){case 3:Zi(g,E,P,B,0);break;case 2:Pr(g,E,P,B);break;case 1:Bn(g,E,P,B)}}function cu(f,g){var E,P,B=g.M,V=g.Nb,G=f.oc,Y=f.pc+40,J=f.oc,se=f.pc+584,ve=f.oc,Te=f.pc+600;for(E=0;16>E;++E)G[Y+32*E-1]=129;for(E=0;8>E;++E)J[se+32*E-1]=129,ve[Te+32*E-1]=129;for(0<B?G[Y-1-32]=J[se-1-32]=ve[Te-1-32]=129:(a(G,Y-32-1,127,21),a(J,se-32-1,127,9),a(ve,Te-32-1,127,9)),P=0;P<f.za;++P){var Ce=g.ya[g.aa+P];if(0<P){for(E=-1;16>E;++E)n(G,Y+32*E-4,G,Y+32*E+12,4);for(E=-1;8>E;++E)n(J,se+32*E-4,J,se+32*E+4,4),n(ve,Te+32*E-4,ve,Te+32*E+4,4)}var ke=f.Gd,ze=f.Hd+P,Re=Ce.ad,ye=Ce.Hc;if(0<B&&(n(G,Y-32,ke[ze].y,0,16),n(J,se-32,ke[ze].f,0,8),n(ve,Te-32,ke[ze].ea,0,8)),Ce.Za){var be=G,Be=Y-32+16;for(0<B&&(P>=f.za-1?a(be,Be,ke[ze].y[15],4):n(be,Be,ke[ze+1].y,0,4)),E=0;4>E;E++)be[Be+128+E]=be[Be+256+E]=be[Be+384+E]=be[Be+0+E];for(E=0;16>E;++E,ye<<=2)be=G,Be=Y+rx[E],ni[Ce.Ob[E]](be,Be),lu(ye,Re,16*+E,be,Be)}else if(be=xf(P,B,Ce.Ob[0]),Ls[be](G,Y),ye!=0)for(E=0;16>E;++E,ye<<=2)lu(ye,Re,16*+E,G,Y+rx[E]);for(E=Ce.Gc,be=xf(P,B,Ce.Dd),ts[be](J,se),ts[be](ve,Te),ye=Re,be=J,Be=se,255&(Ce=E>>0)&&(170&Ce?pu(ye,256,be,Be):ja(ye,256,be,Be)),Ce=ve,ye=Te,255&(E>>=8)&&(170&E?pu(Re,320,Ce,ye):ja(Re,320,Ce,ye)),B<f.Ub-1&&(n(ke[ze].y,0,G,Y+480,16),n(ke[ze].f,0,J,se+224,8),n(ke[ze].ea,0,ve,Te+224,8)),E=8*V*f.B,ke=f.sa,ze=f.ta+16*P+16*V*f.R,Re=f.qa,Ce=f.ra+8*P+E,ye=f.Ha,be=f.Ia+8*P+E,E=0;16>E;++E)n(ke,ze+E*f.R,G,Y+32*E,16);for(E=0;8>E;++E)n(Re,Ce+E*f.B,J,se+32*E,8),n(ye,be+E*f.B,ve,Te+32*E,8)}}function Al(f,g,E,P,B,V,G,Y,J){var se=[0],ve=[0],Te=0,Ce=J!=null?J.kd:0,ke=J??new au;if(f==null||12>E)return 7;ke.data=f,ke.w=g,ke.ha=E,g=[g],E=[E],ke.gb=[ke.gb];e:{var ze=g,Re=E,ye=ke.gb;if(t(f!=null),t(Re!=null),t(ye!=null),ye[0]=0,12<=Re[0]&&!r(f,ze[0],"RIFF")){if(r(f,ze[0]+8,"WEBP")){ye=3;break e}var be=Ie(f,ze[0]+4);if(12>be||4294967286<be){ye=3;break e}if(Ce&&be>Re[0]-8){ye=7;break e}ye[0]=be,ze[0]+=12,Re[0]-=12}ye=0}if(ye!=0)return ye;for(be=0<ke.gb[0],E=E[0];;){e:{var Be=f;Re=g,ye=E;var $e=se,Ue=ve,ot=ze=[0];if((tt=Te=[Te])[0]=0,8>ye[0])ye=7;else{if(!r(Be,Re[0],"VP8X")){if(Ie(Be,Re[0]+4)!=10){ye=3;break e}if(18>ye[0]){ye=7;break e}var et=Ie(Be,Re[0]+8),yt=1+X(Be,Re[0]+12);if(2147483648<=yt*(Be=1+X(Be,Re[0]+15))){ye=3;break e}ot!=null&&(ot[0]=et),$e!=null&&($e[0]=yt),Ue!=null&&(Ue[0]=Be),Re[0]+=18,ye[0]-=18,tt[0]=1}ye=0}}if(Te=Te[0],ze=ze[0],ye!=0)return ye;if(Re=!!(2&ze),!be&&Te)return 3;if(V!=null&&(V[0]=!!(16&ze)),G!=null&&(G[0]=Re),Y!=null&&(Y[0]=0),G=se[0],ze=ve[0],Te&&Re&&J==null){ye=0;break}if(4>E){ye=7;break}if(be&&Te||!be&&!Te&&!r(f,g[0],"ALPH")){E=[E],ke.na=[ke.na],ke.P=[ke.P],ke.Sa=[ke.Sa];e:{et=f,ye=g,be=E;var tt=ke.gb;$e=ke.na,Ue=ke.P,ot=ke.Sa,yt=22,t(et!=null),t(be!=null),Be=ye[0];var Gt=be[0];for(t($e!=null),t(ot!=null),$e[0]=null,Ue[0]=null,ot[0]=0;;){if(ye[0]=Be,be[0]=Gt,8>Gt){ye=7;break e}var Yt=Ie(et,Be+4);if(4294967286<Yt){ye=3;break e}var qt=8+Yt+1&-2;if(yt+=qt,0<tt&&yt>tt){ye=3;break e}if(!r(et,Be,"VP8 ")||!r(et,Be,"VP8L")){ye=0;break e}if(Gt[0]<qt){ye=7;break e}r(et,Be,"ALPH")||($e[0]=et,Ue[0]=Be+8,ot[0]=Yt),Be+=qt,Gt-=qt}}if(E=E[0],ke.na=ke.na[0],ke.P=ke.P[0],ke.Sa=ke.Sa[0],ye!=0)break}E=[E],ke.Ja=[ke.Ja],ke.xa=[ke.xa];e:if(tt=f,ye=g,be=E,$e=ke.gb[0],Ue=ke.Ja,ot=ke.xa,et=ye[0],Be=!r(tt,et,"VP8 "),yt=!r(tt,et,"VP8L"),t(tt!=null),t(be!=null),t(Ue!=null),t(ot!=null),8>be[0])ye=7;else{if(Be||yt){if(tt=Ie(tt,et+4),12<=$e&&tt>$e-12){ye=3;break e}if(Ce&&tt>be[0]-8){ye=7;break e}Ue[0]=tt,ye[0]+=8,be[0]-=8,ot[0]=yt}else ot[0]=5<=be[0]&&tt[et+0]==47&&!(tt[et+4]>>5),Ue[0]=be[0];ye=0}if(E=E[0],ke.Ja=ke.Ja[0],ke.xa=ke.xa[0],g=g[0],ye!=0)break;if(4294967286<ke.Ja)return 3;if(Y==null||Re||(Y[0]=ke.xa?2:1),G=[G],ze=[ze],ke.xa){if(5>E){ye=7;break}Y=G,Ce=ze,Re=V,f==null||5>E?f=0:5<=E&&f[g+0]==47&&!(f[g+4]>>5)?(be=[0],tt=[0],$e=[0],ie(Ue=new b,f,g,E),vt(Ue,be,tt,$e)?(Y!=null&&(Y[0]=be[0]),Ce!=null&&(Ce[0]=tt[0]),Re!=null&&(Re[0]=$e[0]),f=1):f=0):f=0}else{if(10>E){ye=7;break}Y=ze,f==null||10>E||!ef(f,g+3,E-3)?f=0:(Ce=f[g+0]|f[g+1]<<8|f[g+2]<<16,Re=16383&(f[g+7]<<8|f[g+6]),f=16383&(f[g+9]<<8|f[g+8]),1&Ce||3<(Ce>>1&7)||!(Ce>>4&1)||Ce>>5>=ke.Ja||!Re||!f?f=0:(G&&(G[0]=Re),Y&&(Y[0]=f),f=1))}if(!f||(G=G[0],ze=ze[0],Te&&(se[0]!=G||ve[0]!=ze)))return 3;J!=null&&(J[0]=ke,J.offset=g-J.w,t(4294967286>g-J.w),t(J.offset==J.ha-E));break}return ye==0||ye==7&&Te&&J==null?(V!=null&&(V[0]|=ke.na!=null&&0<ke.na.length),P!=null&&(P[0]=G),B!=null&&(B[0]=ze),0):ye}function uu(f,g,E){var P=g.width,B=g.height,V=0,G=0,Y=P,J=B;if(g.Da=f!=null&&0<f.Da,g.Da&&(Y=f.cd,J=f.bd,V=f.v,G=f.j,11>E||(V&=-2,G&=-2),0>V||0>G||0>=Y||0>=J||V+Y>P||G+J>B))return 0;if(g.v=V,g.j=G,g.va=V+Y,g.o=G+J,g.U=Y,g.T=J,g.da=f!=null&&0<f.da,g.da){if(!Oe(Y,J,E=[f.ib],V=[f.hb]))return 0;g.ib=E[0],g.hb=V[0]}return g.ob=f!=null&&f.ob,g.Kb=f==null||!f.Sd,g.da&&(g.ob=g.ib<3*P/4&&g.hb<3*B/4,g.Kb=0),1}function fu(f){if(f==null)return 2;if(11>f.S){var g=f.f.RGBA;g.fb+=(f.height-1)*g.A,g.A=-g.A}else g=f.f.kb,f=f.height,g.O+=(f-1)*g.fa,g.fa=-g.fa,g.N+=(f-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(f-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(f-1)*g.lb,g.lb=-g.lb);return 0}function Nl(f,g,E,P){if(P==null||0>=f||0>=g)return 2;if(E!=null){if(E.Da){var B=E.cd,V=E.bd,G=-2&E.v,Y=-2&E.j;if(0>G||0>Y||0>=B||0>=V||G+B>f||Y+V>g)return 2;f=B,g=V}if(E.da){if(!Oe(f,g,B=[E.ib],V=[E.hb]))return 2;f=B[0],g=V[0]}}P.width=f,P.height=g;e:{var J=P.width,se=P.height;if(f=P.S,0>=J||0>=se||!(f>=Sf&&13>f))f=2;else{if(0>=P.Rd&&P.sd==null){G=V=B=g=0;var ve=(Y=J*nx[f])*se;if(11>f||(V=(se+1)/2*(g=(J+1)/2),f==12&&(G=(B=J)*se)),(se=i(ve+2*V+G))==null){f=1;break e}P.sd=se,11>f?((J=P.f.RGBA).eb=se,J.fb=0,J.A=Y,J.size=ve):((J=P.f.kb).y=se,J.O=0,J.fa=Y,J.Fd=ve,J.f=se,J.N=0+ve,J.Ab=g,J.Cd=V,J.ea=se,J.W=0+ve+V,J.Db=g,J.Ed=V,f==12&&(J.F=se,J.J=0+ve+2*V),J.Tc=G,J.lb=B)}if(g=1,B=P.S,V=P.width,G=P.height,B>=Sf&&13>B)if(11>B)f=P.f.RGBA,g&=(Y=Math.abs(f.A))*(G-1)+V<=f.size,g&=Y>=V*nx[B],g&=f.eb!=null;else{f=P.f.kb,Y=(V+1)/2,ve=(G+1)/2,J=Math.abs(f.fa),se=Math.abs(f.Ab);var Te=Math.abs(f.Db),Ce=Math.abs(f.lb),ke=Ce*(G-1)+V;g&=J*(G-1)+V<=f.Fd,g&=se*(ve-1)+Y<=f.Cd,g=(g&=Te*(ve-1)+Y<=f.Ed)&J>=V&se>=Y&Te>=Y,g&=f.y!=null,g&=f.f!=null,g&=f.ea!=null,B==12&&(g&=Ce>=V,g&=ke<=f.Tc,g&=f.F!=null)}else g=0;f=g?0:2}}return f!=0||E!=null&&E.fd&&(f=fu(P)),f}var fn=64,Tl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Cl=24,Ll=32,hu=8,Qn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];qe("Predictor0","PredictorAdd0"),T.Predictor0=function(){return 4278190080},T.Predictor1=function(f){return f},T.Predictor2=function(f,g,E){return g[E+0]},T.Predictor3=function(f,g,E){return g[E+1]},T.Predictor4=function(f,g,E){return g[E-1]},T.Predictor5=function(f,g,E){return Ge(Ge(f,g[E+1]),g[E+0])},T.Predictor6=function(f,g,E){return Ge(f,g[E-1])},T.Predictor7=function(f,g,E){return Ge(f,g[E+0])},T.Predictor8=function(f,g,E){return Ge(g[E-1],g[E+0])},T.Predictor9=function(f,g,E){return Ge(g[E+0],g[E+1])},T.Predictor10=function(f,g,E){return Ge(Ge(f,g[E-1]),Ge(g[E+0],g[E+1]))},T.Predictor11=function(f,g,E){var P=g[E+0];return 0>=ft(P>>24&255,f>>24&255,(g=g[E-1])>>24&255)+ft(P>>16&255,f>>16&255,g>>16&255)+ft(P>>8&255,f>>8&255,g>>8&255)+ft(255&P,255&f,255&g)?P:f},T.Predictor12=function(f,g,E){var P=g[E+0];return(st((f>>24&255)+(P>>24&255)-((g=g[E-1])>>24&255))<<24|st((f>>16&255)+(P>>16&255)-(g>>16&255))<<16|st((f>>8&255)+(P>>8&255)-(g>>8&255))<<8|st((255&f)+(255&P)-(255&g)))>>>0},T.Predictor13=function(f,g,E){var P=g[E-1];return(rt((f=Ge(f,g[E+0]))>>24&255,P>>24&255)<<24|rt(f>>16&255,P>>16&255)<<16|rt(f>>8&255,P>>8&255)<<8|rt(f>>0&255,P>>0&255))>>>0};var S1=T.PredictorAdd0;T.PredictorAdd1=lt,qe("Predictor2","PredictorAdd2"),qe("Predictor3","PredictorAdd3"),qe("Predictor4","PredictorAdd4"),qe("Predictor5","PredictorAdd5"),qe("Predictor6","PredictorAdd6"),qe("Predictor7","PredictorAdd7"),qe("Predictor8","PredictorAdd8"),qe("Predictor9","PredictorAdd9"),qe("Predictor10","PredictorAdd10"),qe("Predictor11","PredictorAdd11"),qe("Predictor12","PredictorAdd12"),qe("Predictor13","PredictorAdd13");var du=T.PredictorAdd2;Ze("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),Ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var vf,Ia=T.ColorIndexInverseTransform,Fl=T.MapARGB,yf=T.VP8LColorIndexInverseTransformAlpha,wf=T.MapAlpha,As=T.VP8LPredictorsAdd=[];As.length=16,(T.VP8LPredictors=[]).length=16,(T.VP8LPredictorsAdd_C=[]).length=16,(T.VP8LPredictors_C=[]).length=16;var Lo,Zn,Mn,Ns,Ji,Qi,Pl,Zi,Pr,pu,Bn,ja,Il,_f,mu,Fo,Po,Ts,Io,jl,jo,Cs,gu,Ra,Oa,sr,or,Ir,Kr=i(511),es=i(2041),xu=i(225),Rl=i(767),bf=0,E1=es,kf=xu,ma=Rl,Da=Kr,Sf=0,Ef=1,Vg=2,Af=3,Nf=4,A1=5,Wg=6,N1=7,T1=8,Tf=9,C1=10,bb=[2,3,7],kb=[3,3,11],Gg=[280,256,256,256,40],Sb=[0,1,1,1,0],Eb=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ab=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Nb=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Tb=8,L1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],F1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],vu=null,Cb=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Lb=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Kg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Fb=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Pb=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ib=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],jb=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ls=[],ni=[],ts=[],Rb=1,Xg=2,Fs=[],Ma=[];Me("UpsampleRgbLinePair",Bt,3),Me("UpsampleBgrLinePair",xr,3),Me("UpsampleRgbaLinePair",ri,4),Me("UpsampleBgraLinePair",tn,4),Me("UpsampleArgbLinePair",_n,4),Me("UpsampleRgba4444LinePair",Ur,2),Me("UpsampleRgb565LinePair",Sr,2);var Ob=T.UpsampleRgbLinePair,Db=T.UpsampleBgrLinePair,Yg=T.UpsampleRgbaLinePair,Jg=T.UpsampleBgraLinePair,Qg=T.UpsampleArgbLinePair,Zg=T.UpsampleRgba4444LinePair,Mb=T.UpsampleRgb565LinePair,Cf=16,Lf=1<<Cf-1,yu=-227,P1=482,ex=6,Bb=(256<<ex)-1,tx=0,Ub=i(256),zb=i(256),$b=i(256),qb=i(256),Hb=i(P1-yu),Vb=i(P1-yu);Ci("YuvToRgbRow",Bt,3),Ci("YuvToBgrRow",xr,3),Ci("YuvToRgbaRow",ri,4),Ci("YuvToBgraRow",tn,4),Ci("YuvToArgbRow",_n,4),Ci("YuvToRgba4444Row",Ur,2),Ci("YuvToRgb565Row",Sr,2);var rx=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ff=[0,2,8],Wb=[8,7,6,4,4,2,2,2,1,1,1,1],Gb=1;this.WebPDecodeRGBA=function(f,g,E,P,B){var V=Ef,G=new Sl,Y=new fa;G.ba=Y,Y.S=V,Y.width=[Y.width],Y.height=[Y.height];var J=Y.width,se=Y.height,ve=new Ja;if(ve==null||f==null)var Te=2;else t(ve!=null),Te=Al(f,g,E,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(Te!=0?J=0:(J!=null&&(J[0]=ve.width[0]),se!=null&&(se[0]=ve.height[0]),J=1),J){Y.width=Y.width[0],Y.height=Y.height[0],P!=null&&(P[0]=Y.width),B!=null&&(B[0]=Y.height);e:{if(P=new Ai,(B=new au).data=f,B.w=g,B.ha=E,B.kd=1,g=[0],t(B!=null),((f=Al(B.data,B.w,B.ha,null,null,null,g,null,B))==0||f==7)&&g[0]&&(f=4),(g=f)==0){if(t(G!=null),P.data=B.data,P.w=B.w+B.offset,P.ha=B.ha-B.offset,P.put=Fa,P.ac=Gr,P.bc=Pa,P.ma=G,B.xa){if((f=je())==null){G=1;break e}if(function(Ce,ke){var ze=[0],Re=[0],ye=[0];t:for(;;){if(Ce==null)return 0;if(ke==null)return Ce.a=2,0;if(Ce.l=ke,Ce.a=0,ie(Ce.m,ke.data,ke.w,ke.ha),!vt(Ce.m,ze,Re,ye)){Ce.a=3;break t}if(Ce.xb=Xg,ke.width=ze[0],ke.height=Re[0],!Ae(ze[0],Re[0],1,Ce,null))break t;return 1}return t(Ce.a!=0),0}(f,P)){if(P=(g=Nl(P.width,P.height,G.Oa,G.ba))==0){t:{P=f;r:for(;;){if(P==null){P=0;break t}if(t(P.s.yc!=null),t(P.s.Ya!=null),t(0<P.s.Wb),t((E=P.l)!=null),t((B=E.ma)!=null),P.xb!=0){if(P.ca=B.ba,P.tb=B.tb,t(P.ca!=null),!uu(B.Oa,E,Af)){P.a=2;break r}if(!Le(P,E.width)||E.da)break r;if((E.da||$t(P.ca.S))&&Ee(),11>P.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),P.ca.f.kb.F!=null&&Ee()),P.Pb&&0<P.s.ua&&P.s.vb.X==null&&!Se(P.s.vb,P.s.Wa.Xa)){P.a=1;break r}P.xb=0}if(!de(P,P.V,P.Ba,P.c,P.i,E.o,ue))break r;B.Dc=P.Ma,P=1;break t}t(P.a!=0),P=0}P=!P}P&&(g=f.a)}else g=f.a}else{if((f=new da)==null){G=1;break e}if(f.Fa=B.na,f.P=B.P,f.qc=B.Sa,tf(f,P)){if((g=Nl(P.width,P.height,G.Oa,G.ba))==0){if(f.Aa=0,E=G.Oa,t((B=f)!=null),E!=null){if(0<(J=0>(J=E.Md)?0:100<J?255:255*J/100)){for(se=ve=0;4>se;++se)12>(Te=B.pb[se]).lc&&(Te.ia=J*Wb[0>Te.lc?0:Te.lc]>>3),ve|=Te.ia;ve&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=E.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}s1(f,P)||(g=f.a)}}else g=f.a}g==0&&G.Oa!=null&&G.Oa.fd&&(g=fu(G.ba))}G=g}V=G!=0?null:11>V?Y.f.RGBA.eb:Y.f.kb.y}else V=null;return V};var nx=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(T,L){for(var O="",F=0;F<4;F++)O+=String.fromCharCode(T[L++]);return O}function u(T,L){return(T[L+0]<<0|T[L+1]<<8|T[L+2]<<16)>>>0}function h(T,L){return(T[L+0]<<0|T[L+1]<<8|T[L+2]<<16|T[L+3]<<24)>>>0}new l;var p=[0],d=[0],y=[],x=new l,S=e,v=function(T,L){var O={},F=0,N=!1,M=0,K=0;if(O.frames=[],!function(A,C,R,H){for(var re=0;re<H;re++)if(A[C+re]!=R.charCodeAt(re))return!0;return!1}(T,L,"RIFF",4)){var he,le;for(h(T,L+=4),L+=8;L<T.length;){var fe=c(T,L),ie=h(T,L+=4);L+=4;var q=ie+(1&ie);switch(fe){case"VP8 ":case"VP8L":O.frames[F]===void 0&&(O.frames[F]={}),(b=O.frames[F]).src_off=N?K:L-8,b.src_size=M+ie+8,F++,N&&(N=!1,M=0,K=0);break;case"VP8X":(b=O.header={}).feature_flags=T[L];var Z=L+4;b.canvas_width=1+u(T,Z),Z+=3,b.canvas_height=1+u(T,Z),Z+=3;break;case"ALPH":N=!0,M=q+8,K=L-8;break;case"ANIM":(b=O.header).bgcolor=h(T,L),Z=L+4,b.loop_count=(he=T)[(le=Z)+0]<<0|he[le+1]<<8,Z+=2;break;case"ANMF":var oe,b;(b=O.frames[F]={}).offset_x=2*u(T,L),L+=3,b.offset_y=2*u(T,L),L+=3,b.width=1+u(T,L),L+=3,b.height=1+u(T,L),L+=3,b.duration=u(T,L),L+=3,oe=T[L++],b.dispose=1&oe,b.blend=oe>>1&1}fe!="ANMF"&&(L+=q)}return O}}(S,0);v.response=S,v.rgbaoutput=!0,v.dataurl=!1;var k=v.header?v.header:null,_=v.frames?v.frames:null;if(k){k.loop_counter=k.loop_count,p=[k.canvas_height],d=[k.canvas_width];for(var j=0;j<_.length&&_[j].blend!=0;j++);}var D=_[0],z=x.WebPDecodeRGBA(S,D.src_off,D.src_size,d,p);D.rgba=z,D.imgwidth=d[0],D.imgheight=p[0];for(var I=0;I<d[0]*p[0]*4;I++)y[I]=z[I];return this.width=d,this.height=p,this.data=y,this}(function(e){var t=function(){return typeof s2=="function"},r=function(p,d,y,x){var S=4,v=s;switch(x){case e.image_compression.FAST:S=1,v=i;break;case e.image_compression.MEDIUM:S=6,v=o;break;case e.image_compression.SLOW:S=9,v=l}p=n(p,d,y,v);var k=s2(p,{level:S});return e.__addimage__.arrayBufferToBinaryString(k)},n=function(p,d,y,x){for(var S,v,k,_=p.length/d,j=new Uint8Array(p.length+_),D=u(),z=0;z<_;z+=1){if(k=z*d,S=p.subarray(k,k+d),x)j.set(x(S,y,v),k+z);else{for(var I,T=D.length,L=[];I<T;I+=1)L[I]=D[I](S,y,v);var O=h(L.concat());j.set(L[O],k+z)}v=S}return j},a=function(p){var d=Array.apply([],p);return d.unshift(0),d},i=function(p,d){var y,x=[],S=p.length;x[0]=1;for(var v=0;v<S;v+=1)y=p[v-d]||0,x[v+1]=p[v]-y+256&255;return x},s=function(p,d,y){var x,S=[],v=p.length;S[0]=2;for(var k=0;k<v;k+=1)x=y&&y[k]||0,S[k+1]=p[k]-x+256&255;return S},o=function(p,d,y){var x,S,v=[],k=p.length;v[0]=3;for(var _=0;_<k;_+=1)x=p[_-d]||0,S=y&&y[_]||0,v[_+1]=p[_]+256-(x+S>>>1)&255;return v},l=function(p,d,y){var x,S,v,k,_=[],j=p.length;_[0]=4;for(var D=0;D<j;D+=1)x=p[D-d]||0,S=y&&y[D]||0,v=y&&y[D-d]||0,k=c(x,S,v),_[D+1]=p[D]-k+256&255;return _},c=function(p,d,y){if(p===d&&d===y)return p;var x=Math.abs(d-y),S=Math.abs(p-y),v=Math.abs(p+d-y-y);return x<=S&&x<=v?p:S<=v?d:y},u=function(){return[a,i,s,o,l]},h=function(p){var d=p.map(function(y){return y.reduce(function(x,S){return x+Math.abs(S)},0)});return d.indexOf(Math.min.apply(null,d))};e.processPNG=function(p,d,y,x){var S,v,k,_,j,D,z,I,T,L,O,F,N,M,K,he=this.decode.FLATE_DECODE,le="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(k=new qR(p)).imgData,v=k.bits,S=k.colorSpace,j=k.colors,[4,6].indexOf(k.colorType)!==-1){if(k.bits===8){T=(I=k.pixelBitlength==32?new Uint32Array(k.decodePixels().buffer):k.pixelBitlength==16?new Uint16Array(k.decodePixels().buffer):new Uint8Array(k.decodePixels().buffer)).length,O=new Uint8Array(T*k.colors),L=new Uint8Array(T);var fe,ie=k.pixelBitlength-k.bits;for(M=0,K=0;M<T;M++){for(N=I[M],fe=0;fe<ie;)O[K++]=N>>>fe&255,fe+=k.bits;L[M]=N>>>fe&255}}if(k.bits===16){T=(I=new Uint32Array(k.decodePixels().buffer)).length,O=new Uint8Array(T*(32/k.pixelBitlength)*k.colors),L=new Uint8Array(T*(32/k.pixelBitlength)),F=k.colors>1,M=0,K=0;for(var q=0;M<T;)N=I[M++],O[K++]=N>>>0&255,F&&(O[K++]=N>>>16&255,N=I[M++],O[K++]=N>>>0&255),L[q++]=N>>>16&255;v=8}x!==e.image_compression.NONE&&t()?(p=r(O,k.width*k.colors,k.colors,x),z=r(L,k.width,1,x)):(p=O,z=L,he=void 0)}if(k.colorType===3&&(S=this.color_spaces.INDEXED,D=k.palette,k.transparency.indexed)){var Z=k.transparency.indexed,oe=0;for(M=0,T=Z.length;M<T;++M)oe+=Z[M];if((oe/=255)===T-1&&Z.indexOf(0)!==-1)_=[Z.indexOf(0)];else if(oe!==T){for(I=k.decodePixels(),L=new Uint8Array(I.length),M=0,T=I.length;M<T;M++)L[M]=Z[I[M]];z=r(L,k.width,1)}}var b=function(A){var C;switch(A){case e.image_compression.FAST:C=11;break;case e.image_compression.MEDIUM:C=13;break;case e.image_compression.SLOW:C=14;break;default:C=12}return C}(x);return he===this.decode.FLATE_DECODE&&(le="/Predictor "+b+" "),le+="/Colors "+j+" /BitsPerComponent "+v+" /Columns "+k.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(z&&this.__addimage__.isArrayBuffer(z)||this.__addimage__.isArrayBufferView(z))&&(z=this.__addimage__.arrayBufferToBinaryString(z)),{alias:y,data:p,index:d,filter:he,decodeParameters:le,transparency:_,palette:D,sMask:z,predictor:b,width:k.width,height:k.height,bitsPerComponent:v,colorSpace:S}}}})(wt.API),function(e){e.processGIF89A=function(t,r,n,a){var i=new HR(t),s=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new Bp(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(wt.API),ci.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ci.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){ar.log("bit decode error:"+r)}},ci.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},ci.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},ci.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},ci.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,l=(i>>10&t)/t*255|0,c=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=e}},ci.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,c=(s>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},ci.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},ci.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},ci.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new ci(t,!1),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new Bp(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(wt.API),xy.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new xy(t),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new Bp(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(wt.API),wt.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var u=n[c],h=n[c+1],p=n[c+2],d=n[c+3];i[o++]=u,i[o++]=h,i[o++]=p,s[l++]=d}var y=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:y,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},wt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Wl=wt.API,_h=Wl.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=c.fof?c.fof:1,h=t.doKerning!==!1,p=0,d=e.length,y=0,x=o[0]||l,S=[];for(r=0;r<d;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?S.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(p=h&&Qt(c[n])==="object"&&!isNaN(parseInt(c[n][y],10))?c[n][y]/u:0,S.push((o[n]||x)/l+p)),y=n;return S},dy=Wl.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Wl.processArabic&&(e=Wl.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:_h.apply(this,arguments).reduce(function(i,s){return i+s},0)},py=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var l=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(l,i)),o=0,l=i),o+=t[i],i++;return l!==i&&a.push(e.slice(l,i)),a},my=function(e,t,r){r||(r={});var n,a,i,s,o,l,c,u=[],h=[u],p=r.textIndent||0,d=0,y=0,x=e.split(" "),S=_h.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?x[0].length+2:r.lineIndent||0){var v=Array(l).join(" "),k=[];x.map(function(j){(j=j.split(/\s*\n/)).length>1?k=k.concat(j.map(function(D,z){return(z&&D.length?`
`:"")+D})):k.push(j[0])}),x=k,l=dy.apply(this,[v,r])}for(i=0,s=x.length;i<s;i++){var _=0;if(n=x[i],l&&n[0]==`
`&&(n=n.substr(1),_=1),p+d+(y=(a=_h.apply(this,[n,r])).reduce(function(j,D){return j+D},0))>t||_){if(y>t){for(o=py.apply(this,[n,a,t-(p+d),t]),u.push(o.shift()),u=[o.pop()];o.length;)h.push([o.shift()]);y=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(j,D){return j+D},0)}else u=[n];h.push(u),p=y+l,d=S}else u.push(n),p+=d+y,d=S}return c=l?function(j,D){return(D?v:"")+j.join(" ")}:function(j){return j.join(" ")},h.map(c)},Wl.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(my.apply(this,[n[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},a=0;a<t.length;a++)r[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var i=function(h){return"0x"+parseInt(h,10).toString(16)},s=e.__fontmetrics__.compress=function(h){var p,d,y,x,S=["{"];for(var v in h){if(p=h[v],isNaN(parseInt(v,10))?d="'"+v+"'":(v=parseInt(v,10),d=(d=i(v).slice(2)).slice(0,-1)+n[d.slice(-1)]),typeof p=="number")p<0?(y=i(p).slice(3),x="-"):(y=i(p).slice(2),x=""),y=x+y.slice(0,-1)+n[y.slice(-1)];else{if(Qt(p)!=="object")throw new Error("Don't know what to do with value type "+Qt(p)+".");y=s(p)}S.push(d+y)}return S.push("}"),S.join("")},o=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,d,y,x,S={},v=1,k=S,_=[],j="",D="",z=h.length-1,I=1;I<z;I+=1)(x=h[I])=="'"?p?(y=p.join(""),p=void 0):p=[]:p?p.push(x):x=="{"?(_.push([k,y]),k={},y=void 0):x=="}"?((d=_.pop())[0][d[1]]=k,y=void 0,k=d[0]):x=="-"?v=-1:y===void 0?r.hasOwnProperty(x)?(j+=r[x],y=parseInt(j,16)*v,v=1,j=""):j+=x:r.hasOwnProperty(x)?(D+=r[x],k[y]=parseInt(D,16)*v,v=1,y=void 0,D=""):D+=x;return S},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var p=h.font,d=u.Unicode[p.postScriptName];d&&(p.metadata.Unicode={},p.metadata.Unicode.widths=d.widths,p.metadata.Unicode.kerning=d.kerning);var y=c.Unicode[p.postScriptName];y&&(p.metadata.Unicode.encoding=y,p.encoding=y.codePages[0])}])}(wt.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(f0(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(wt),function(e){function t(){return(_t.canvg?Promise.resolve(_t.canvg):vs(()=>import("./index.es-ece8c28f.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}wt.API.addSvgAsImage=function(r,n,a,i,s,o,l,c){if(isNaN(n)||isNaN(a))throw ar.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw ar.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=s;var h=u.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,u.width,u.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return t().then(function(y){return y.fromString(h,r,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(y){return y.render(p)}).then(function(){d.addImage(u.toDataURL("image/jpeg",1),n,a,i,s,l,c)})}}(),wt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},wt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,h=0;function p(y,x){var S,v=!1;for(S=0;S<y.length;S+=1)y[S]===x&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=o.length;for(h=0;h<d;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(Qt(e)==="object"){for(a in e)if(i=e[a],p(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&p(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(u=0;u<i[c].length;u+=1)typeof i[c][u]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}r[a].value="["+l.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var y,x=[];for(y in r)r[y].explicitSet===!0&&(r[y].type==="name"?x.push("/"+y+" /"+r[y].value):x.push("/"+y+" "+r[y].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(wt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],h=0,p=i.length;h<p;++h){if(o=s.metadata.characterToGlyph(i.charCodeAt(h)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(h),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(i){var s,o,l,c,u,h,p;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],h=0,p=(o=Object.keys(i).sort(function(d,y){return d-y})).length;h<p;h++)s=o[h],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",y=0;y<p.length;y++)d+=String.fromCharCode(p[y]);var x=c();u({data:d,addLength1:!0,objectId:x}),l("endobj");var S=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:S}),l("endobj");var v=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Ql(o.fontName)),l("/FontFile2 "+x+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var k=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Ql(o.fontName)),l("/FontDescriptor "+v+" 0 R"),l("/W "+e.API.PDFObject.convert(h)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+S+" 0 R"),l("/BaseFont /"+Ql(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+k+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,p="",d=0;d<h.length;d++)p+=String.fromCharCode(h[d]);var y=c();u({data:p,addLength1:!0,objectId:y}),l("endobj");var x=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:x}),l("endobj");var S=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+y+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Ql(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var v=0;v<o.metadata.hmtx.widths.length;v++)o.metadata.hmtx.widths[v]=parseInt(o.metadata.hmtx.widths[v]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+Ql(o.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",l=i.x,c=i.y,u=i.options||{},h=i.mutex||{},p=h.pdfEscape,d=h.activeFontKey,y=h.fonts,x=d,S="",v=0,k="",_=y[x].encoding;if(y[x].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:h};for(k=o,x=d,Array.isArray(o)&&(k=o[0]),v=0;v<k.length;v+=1)y[x].metadata.hasOwnProperty("cmap")&&(s=y[x].metadata.cmap.unicode.codeMap[k[v].charCodeAt(0)]),s||k[v].charCodeAt(0)<256&&y[x].metadata.hasOwnProperty("Unicode")?S+=k[v]:S+="";var j="";return parseInt(x.slice(1))<14||_==="WinAnsiEncoding"?j=p(S,x).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):_==="Identity-H"&&(j=r(S,y[x])),h.isHex=!0,{text:j,x:l,y:c,options:u,mutex:h}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],l={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([a(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(a(Object.assign({},l,{text:s[c]})).text);i.text=o}else i.text=a(Object.assign({},l,{text:s})).text}])}(wt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(wt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,l,c,u,h=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),k=!1,_=0;this.__bidiEngine__={};var j=function(F){var N=F.charCodeAt(),M=N>>8,K=x[M];return K!==void 0?h[256*K+(255&N)]:M===252||M===253?"AL":v.test(M)?"L":M===8?"R":"N"},D=function(F){for(var N,M=0;M<F.length;M++){if((N=j(F.charAt(M)))==="L")return!1;if(N==="R")return!0}return!1},z=function(F,N,M,K){var he,le,fe,ie,q=N[K];switch(q){case"L":case"R":k=!1;break;case"N":case"AN":break;case"EN":k&&(q="AN");break;case"AL":k=!0,q="R";break;case"WS":q="N";break;case"CS":K<1||K+1>=N.length||(he=M[K-1])!=="EN"&&he!=="AN"||(le=N[K+1])!=="EN"&&le!=="AN"?q="N":k&&(le="AN"),q=le===he?le:"N";break;case"ES":q=(he=K>0?M[K-1]:"B")==="EN"&&K+1<N.length&&N[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&M[K-1]==="EN"){q="EN";break}if(k){q="N";break}for(fe=K+1,ie=N.length;fe<ie&&N[fe]==="ET";)fe++;q=fe<ie&&N[fe]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(ie=N.length,fe=K+1;fe<ie&&N[fe]==="NSM";)fe++;if(fe<ie){var Z=F[K],oe=Z>=1425&&Z<=2303||Z===64286;if(he=N[fe],oe&&(he==="R"||he==="AL")){q="R";break}}}q=K<1||(he=N[K-1])==="B"?"N":M[K-1];break;case"B":k=!1,a=!0,q=_;break;case"S":i=!0,q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":k=!1;break;case"BN":q="N"}return q},I=function(F,N,M){var K=F.split("");return M&&T(K,M,{hiLevel:_}),K.reverse(),N&&N.reverse(),K.join("")},T=function(F,N,M){var K,he,le,fe,ie,q=-1,Z=F.length,oe=0,b=[],A=_?d:p,C=[];for(k=!1,a=!1,i=!1,he=0;he<Z;he++)C[he]=j(F[he]);for(le=0;le<Z;le++){if(ie=oe,b[le]=z(F,C,b,le),K=240&(oe=A[ie][y[b[le]]]),oe&=15,N[le]=fe=A[oe][5],K>0)if(K===16){for(he=q;he<le;he++)N[he]=1;q=-1}else q=-1;if(A[oe][6])q===-1&&(q=le);else if(q>-1){for(he=q;he<le;he++)N[he]=fe;q=-1}C[le]==="B"&&(N[le]=0),M.hiLevel|=fe}i&&function(R,H,re){for(var ae=0;ae<re;ae++)if(R[ae]==="S"){H[ae]=_;for(var ne=ae-1;ne>=0&&R[ne]==="WS";ne--)H[ne]=_}}(C,N,Z)},L=function(F,N,M,K,he){if(!(he.hiLevel<F)){if(F===1&&_===1&&!a)return N.reverse(),void(M&&M.reverse());for(var le,fe,ie,q,Z=N.length,oe=0;oe<Z;){if(K[oe]>=F){for(ie=oe+1;ie<Z&&K[ie]>=F;)ie++;for(q=oe,fe=ie-1;q<fe;q++,fe--)le=N[q],N[q]=N[fe],N[fe]=le,M&&(le=M[q],M[q]=M[fe],M[fe]=le);oe=ie}oe++}}},O=function(F,N,M){var K=F.split(""),he={hiLevel:_};return M||(M=[]),T(K,M,he),function(le,fe,ie){if(ie.hiLevel!==0&&u)for(var q,Z=0;Z<le.length;Z++)fe[Z]===1&&(q=S.indexOf(le[Z]))>=0&&(le[Z]=S[q+1])}(K,M,he),L(2,K,N,M,he),L(1,K,N,M,he),K.join("")};return this.__bidiEngine__.doBidiReorder=function(F,N,M){if(function(he,le){if(le)for(var fe=0;fe<he.length;fe++)le[fe]=fe;o===void 0&&(o=D(he)),c===void 0&&(c=D(he))}(F,N),s||!l||c)if(s&&l&&o^c)_=o?1:0,F=I(F,N,M);else if(!s&&l&&c)_=o?1:0,F=O(F,N,M),F=I(F,N);else if(!s||o||l||c){if(s&&!l&&o^c)F=I(F,N),o?(_=0,F=O(F,N,M)):(_=1,F=O(F,N,M),F=I(F,N));else if(s&&o&&!l&&c)_=1,F=O(F,N,M),F=I(F,N);else if(!s&&!l&&o^c){var K=u;o?(_=1,F=O(F,N,M),_=0,u=!1,F=O(F,N,M),u=K):(_=0,F=O(F,N,M),F=I(F,N),_=1,u=!1,F=O(F,N,M),u=K,F=I(F,N))}}else _=0,F=O(F,N,M);else _=o?1:0,F=O(F,N,M);return F},this.__bidiEngine__.setOptions=function(F){F&&(s=F.isInputVisual,l=F.isOutputVisual,o=F.isInputRtl,c=F.isOutputRtl,u=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text,i=(n.x,n.y,n.options||{}),s=(n.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(wt),wt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new wo(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new iO(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new VR(this.contents),this.head=new GR(this),this.name=new QR(this),this.cmap=new vb(this),this.toUnicode={},this.hhea=new KR(this),this.maxp=new ZR(this),this.hmtx=new eO(this),this.post=new YR(this),this.os2=new XR(this),this.loca=new aO(this),this.glyf=new tO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var ki,wo=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),VR=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,l,c,u,h,p,d,y,x;for(x in d=Object.keys(r).length,l=Math.log(2),h=16*Math.floor(Math.log(d)/l),s=Math.floor(h/l),u=16*d-h,(a=new wo).writeInt(this.scalarType),a.writeShort(d),a.writeShort(h),a.writeShort(s),a.writeShort(u),i=16*d,c=a.pos+i,o=null,y=[],r)for(p=r[x],a.writeString(x),a.writeInt(e(p)),a.writeInt(c),a.writeInt(p.length),y=y.concat(p),x==="head"&&(o=c),c+=p.length;c%4;)y.push(0),c++;return a.write(y),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=yb.call(r);r.length%4;)r.push(0);for(i=new wo(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),WR={}.hasOwnProperty,Wi=function(e,t){for(var r in t)WR.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ki=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var GR=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new wo).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),vy=function(){function e(t,r){var n,a,i,s,o,l,c,u,h,p,d,y,x,S,v,k,_;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),p=d/2,t.pos+=6,i=function(){var j,D;for(D=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)D.push(t.readUInt16());return D}(),t.pos+=2,x=function(){var j,D;for(D=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)D.push(t.readUInt16());return D}(),c=function(){var j,D;for(D=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)D.push(t.readUInt16());return D}(),u=function(){var j,D;for(D=[],l=j=0;0<=p?j<p:j>p;l=0<=p?++j:--j)D.push(t.readUInt16());return D}(),a=(this.length-t.pos+this.offset)/2,o=function(){var j,D;for(D=[],l=j=0;0<=a?j<a:j>a;l=0<=a?++j:--j)D.push(t.readUInt16());return D}(),l=v=0,_=i.length;v<_;l=++v)for(S=i[l],n=k=y=x[l];y<=S?k<=S:k>=S;n=y<=S?++k:--k)u[l]===0?s=n+c[l]:(s=o[u[l]/2+(n-y)-(p-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=h}return e.encode=function(t,r){var n,a,i,s,o,l,c,u,h,p,d,y,x,S,v,k,_,j,D,z,I,T,L,O,F,N,M,K,he,le,fe,ie,q,Z,oe,b,A,C,R,H,re,ae,ne,me,we,X;switch(K=new wo,s=Object.keys(t).sort(function(Ie,Se){return Ie-Se}),r){case"macroman":for(x=0,S=function(){var Ie=[];for(y=0;y<256;++y)Ie.push(0);return Ie}(),k={0:0},i={},he=0,q=s.length;he<q;he++)k[ne=t[a=s[he]]]==null&&(k[ne]=++x),i[a]={old:t[a],new:k[t[a]]},S[a]=k[t[a]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(S),{charMap:i,subtable:K.data,maxGlyphID:x+1};case"unicode":for(N=[],h=[],_=0,k={},n={},v=c=null,le=0,Z=s.length;le<Z;le++)k[D=t[a=s[le]]]==null&&(k[D]=++_),n[a]={old:D,new:k[D]},o=k[D]-a,v!=null&&o===c||(v&&h.push(v),N.push(a),c=o),v=a;for(v&&h.push(v),h.push(65535),N.push(65535),O=2*(L=N.length),T=2*Math.pow(Math.log(L)/Math.LN2,2),p=Math.log(T/2)/Math.LN2,I=2*L-T,l=[],z=[],d=[],y=fe=0,oe=N.length;fe<oe;y=++fe){if(F=N[y],u=h[y],F===65535){l.push(0),z.push(0);break}if(F-(M=n[F].new)>=32768)for(l.push(0),z.push(2*(d.length+L-y)),a=ie=F;F<=u?ie<=u:ie>=u;a=F<=u?++ie:--ie)d.push(n[a].new);else l.push(M-F),z.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*L+2*d.length),K.writeUInt16(0),K.writeUInt16(O),K.writeUInt16(T),K.writeUInt16(p),K.writeUInt16(I),re=0,b=h.length;re<b;re++)a=h[re],K.writeUInt16(a);for(K.writeUInt16(0),ae=0,A=N.length;ae<A;ae++)a=N[ae],K.writeUInt16(a);for(me=0,C=l.length;me<C;me++)o=l[me],K.writeUInt16(o);for(we=0,R=z.length;we<R;we++)j=z[we],K.writeUInt16(j);for(X=0,H=d.length;X<H;X++)x=d[X],K.writeUInt16(x);return{charMap:n,subtable:K.data,maxGlyphID:_+1}}},e}(),vb=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,a,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new vy(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var a,i;return n==null&&(n="macroman"),a=vy.encode(r,n),(i=new wo).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},t}(),KR=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),XR=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(r.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(r.readInt());return a}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(r.readInt());return a}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),YR=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="post",t.prototype.parse=function(r){var n,a,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(a=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(r.readUInt32());return c}).call(this)}},t}(),JR=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},QR=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="name",t.prototype.parse=function(r){var n,a,i,s,o,l,c,u,h,p,d;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),a=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(c={},s=h=0,p=a.length;h<p;s=++h)i=a[s],r.pos=i.offset,u=r.readString(i.length),o=new JR(u,i),c[d=i.nameID]==null&&(c[d]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),ZR=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),eO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,a,i,s,o,l,c;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,h;for(h=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)h.push(r.readInt16());return h}(),this.widths=(function(){var u,h,p,d;for(d=[],u=0,h=(p=this.metrics).length;u<h;u++)s=p[u],d.push(s.advance);return d}).call(this),a=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(a));return c},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),yb=[].slice,tO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,a,i,s,o,l,c,u,h,p;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,a=s.indexOf(r),(i=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+a,o=(l=new wo(n.read(i))).readShort(),u=l.readShort(),p=l.readShort(),c=l.readShort(),h=l.readShort(),this.cache[r]=o===-1?new nO(l,u,p,c,h):new rO(l,o,u,p,c,h),this.cache[r]))},t.prototype.encode=function(r,n,a){var i,s,o,l,c;for(o=[],s=[],l=0,c=n.length;l<c;l++)i=r[n[l]],s.push(o.length),i&&(o=o.concat(i.encode(a)));return s.push(o.length),{table:o,offsets:s}},t}(),rO=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),nO=function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new wo(yb.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),aO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Wi(t,ki),t.prototype.tag="loca",t.prototype.parse=function(r){var n,a;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var a=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<a.length;++o)if(a[o]=i,s<n.length&&n[s]==o){++s,a[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*a.length),h=0;h<a.length;++h)u[4*h+3]=255&a[h],u[4*h+2]=(65280&a[h])>>8,u[4*h+1]=(16711680&a[h])>>16,u[4*h]=(4278190080&a[h])>>24;return u},t}(),iO=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,l;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in l=this.glyphsFor(r))n=l[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,l,c,u,h,p,d,y,x,S,v;for(a in n=vb.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),d={0:0},v=n.charMap)d[(l=v[a]).old]=l.new;for(y in p=n.maxGlyphID,s)y in d||(d[y]=p++);return u=function(k){var _,j;for(_ in j={},k)j[k[_]]=_;return j}(d),h=Object.keys(u).sort(function(k,_){return k-_}),x=function(){var k,_,j;for(j=[],k=0,_=h.length;k<_;k++)o=h[k],j.push(u[o]);return j}(),i=this.font.glyf.encode(s,x,d),c=this.font.loca.encode(i.offsets,x),S={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},e}();wt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();const sO=(e,t,r)=>{const n=new wt,a=n.internal.pageSize.width;n.setFontSize(20),n.text("INVOICE",a/2,20,{align:"center"}),n.setFontSize(10),n.text("Gas Cylinder Rental Company",20,40),n.text("123 Business Street",20,45),n.text("City, State 12345",20,50),n.text("Phone: (555) 123-4567",20,55),n.setFontSize(12),n.text(`Invoice Number: ${e.id}`,a-60,40),n.text(`Date: ${new Date(e.invoice_date).toLocaleDateString()}`,a-60,45),n.setFontSize(12),n.text("Bill To:",20,70),n.setFontSize(10),n.text(t.name,20,75),n.text(`Customer #: ${t.customer_number}`,20,80),n.text(t.contact_details||"",20,85);const i=100;n.setFillColor(240,240,240),n.rect(20,i-5,a-40,10,"F"),n.setFontSize(10),n.text("Cylinder",25,i),n.text("Gas Type",65,i),n.text("Rental Type",105,i),n.text("Period",145,i),n.text("Amount",a-35,i,{align:"right"});let s=i+10,o=0;r.forEach((c,u)=>{s>250&&(n.addPage(),s=20),n.text(c.cylinder.serial_number,25,s),n.text(c.cylinder.gas_type,65,s),n.text(c.rental_type,105,s),n.text(`${c.rental_start_date} - ${c.rental_end_date||"Current"}`,145,s),n.text(`$${c.amount.toFixed(2)}`,a-35,s,{align:"right"}),o+=c.amount,s+=10}),s+=10,n.setFillColor(240,240,240),n.rect(a-80,s-5,60,10,"F"),n.setFontSize(12),n.text(`Total: $${o.toFixed(2)}`,a-35,s,{align:"right"}),n.setFontSize(10);const l="Thank you for your business!";return n.text(l,a/2,n.internal.pageSize.height-20,{align:"center"}),n},oO=e=>{const t=new Date(e.rental_start_date),r=e.rental_end_date?new Date(e.rental_end_date):new Date,n=(r.getFullYear()-t.getFullYear())*12+r.getMonth()-t.getMonth(),a=50,i=500;return e.rental_type==="monthly"?a*(n||1):i*(Math.ceil(n/12)||1)};function lO({profile:e}){const[t,r]=ge.useState([]),[n,a]=ge.useState([]),[i,s]=ge.useState(!0),[o,l]=ge.useState(null),[c,u]=ge.useState(!1),[h,p]=ge.useState(""),[d,y]=ge.useState(!1),x=Rt(),S=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager";ge.useEffect(()=>{(async()=>{s(!0),l(null);try{const{data:j,error:D}=await Je.from("invoices").select(`
            *,
            customer:customer_id (
              CustomerListID,
              name,
              customer_number
            ),
            generated_by_user:generated_by (
              full_name
            )
          `).order("invoice_date",{ascending:!1});if(D)throw D;const{data:z,error:I}=await Je.from("customers").select("*").order("name");if(I)throw I;r(j),a(z)}catch(j){l(j.message)}s(!1)})()},[]);const v=async _=>{y(!0),l(null);try{const{data:j}=await Je.from("customers").select("*").eq("CustomerListID",_).single(),{data:D}=await Je.from("rentals").select(`
          *,
          cylinder:cylinder_id (
            serial_number,
            gas_type
          )
        `).eq("customer_id",_).eq("status","active");if(!(D!=null&&D.length))throw new Error("No active rentals found for this customer");const z=D.map(he=>({...he,amount:oO(he)})),{data:I,error:T}=await Je.from("invoices").insert([{customer_id:_,amount:z.reduce((he,le)=>he+le.amount,0),invoice_date:new Date().toISOString().split("T")[0],generated_by:e.id,rental_type:D[0].rental_type}]).select().single();if(T)throw T;const O=sO(I,j,z).output("blob"),F=`invoice_${I.id}_${j.customer_number}.pdf`,{error:N}=await Je.storage.from("invoices").upload(F,O);if(N)throw N;const M=`${Je.storage.from("invoices").getPublicUrl(F).data.publicUrl}`;await Je.from("invoices").update({file_url:M}).eq("id",I.id);const{data:K}=await Je.from("invoices").select(`
          *,
          customer:customer_id (
            CustomerListID,
            name,
            customer_number
          ),
          generated_by_user:generated_by (
            full_name
          )
        `).order("invoice_date",{ascending:!1});r(K),u(!1),window.open(M,"_blank")}catch(j){l(j.message)}y(!1)},k=async()=>{y(!0),l(null);try{const{data:_}=await Je.from("rentals").select("customer_id").eq("status","active").distinct(),j=_.map(D=>D.customer_id);for(const D of j)await v(D)}catch(_){l(_.message)}y(!1)};return i?m.jsx("div",{children:"Loading invoices..."}):o?m.jsxs("div",{className:"text-red-600",children:["Error: ",o]}):m.jsxs("div",{className:"max-w-5xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h2",{className:"text-3xl font-extrabold text-blue-900 tracking-tight",children:"Invoices"}),m.jsx("button",{onClick:()=>x("/"),className:"bg-gradient-to-r from-gray-400 to-gray-300 text-white px-6 py-2 rounded-lg shadow-md hover:from-gray-500 hover:to-gray-400 font-semibold transition",children:"Back to Dashboard"}),S&&m.jsxs("div",{className:"flex gap-2",children:[m.jsxs("button",{onClick:()=>u(!0),className:"bg-gradient-to-r from-blue-600 to-blue-400 text-white px-5 py-2 rounded-lg shadow-md hover:from-blue-700 hover:to-blue-500 font-semibold transition flex items-center gap-2",disabled:d,children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Generate Invoice"]}),m.jsxs("button",{onClick:k,className:"bg-gradient-to-r from-green-600 to-green-400 text-white px-5 py-2 rounded-lg shadow-md hover:from-green-700 hover:to-green-500 font-semibold transition flex items-center gap-2",disabled:d,children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7h18M3 12h18M3 17h18"})}),"Bulk Generate"]})]})]}),m.jsx("div",{className:"overflow-x-auto rounded-2xl border border-blue-100 bg-white/70",children:m.jsxs("table",{className:"min-w-full border-separate border-spacing-0 rounded-2xl text-sm",children:[m.jsx("thead",{className:"bg-gradient-to-r from-blue-200 to-blue-100 sticky top-0 z-10 shadow-sm",children:m.jsxs("tr",{children:[m.jsx("th",{className:"border-b px-3 py-2 font-semibold text-blue-900 text-xs tracking-wider uppercase bg-blue-50 rounded-tl-2xl",children:"Invoice #"}),m.jsx("th",{className:"border-b px-3 py-2 font-semibold text-blue-900 text-xs tracking-wider uppercase",children:"Customer"}),m.jsx("th",{className:"border-b px-3 py-2 font-semibold text-blue-900 text-xs tracking-wider uppercase",children:"Amount"}),m.jsx("th",{className:"border-b px-3 py-2 font-semibold text-blue-900 text-xs tracking-wider uppercase",children:"Date"}),m.jsx("th",{className:"border-b px-3 py-2 font-semibold text-blue-900 text-xs tracking-wider uppercase",children:"Generated By"}),m.jsx("th",{className:"border-b px-3 py-2 font-semibold text-blue-900 text-xs tracking-wider uppercase rounded-tr-2xl",children:"Actions"})]})}),m.jsx("tbody",{children:t.map((_,j)=>{var D,z,I;return m.jsxs("tr",{className:j%2===0?"bg-white/80 hover:bg-blue-50":"bg-blue-50/60 hover:bg-blue-100",children:[m.jsx("td",{className:"px-3 py-2 font-mono text-xs text-blue-800 whitespace-nowrap rounded-l-xl",children:_.id}),m.jsx("td",{className:"px-3 py-2 text-blue-900 whitespace-nowrap",children:((D=_.customer)==null?void 0:D.name)||_.customer_id}),m.jsxs("td",{className:"px-3 py-2 text-blue-900 whitespace-nowrap",children:["$",(z=_.amount)==null?void 0:z.toLocaleString(void 0,{minimumFractionDigits:2})]}),m.jsx("td",{className:"px-3 py-2 text-blue-900 whitespace-nowrap",children:_.invoice_date}),m.jsx("td",{className:"px-3 py-2 text-blue-900 whitespace-nowrap",children:((I=_.generated_by_user)==null?void 0:I.full_name)||"-"}),m.jsx("td",{className:"px-3 py-2 space-x-2 rounded-r-xl flex items-center",children:_.file_url&&m.jsxs("a",{href:_.file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 bg-gradient-to-r from-blue-500 to-blue-300 text-white px-3 py-1 rounded-lg shadow hover:from-blue-600 hover:to-blue-400 transition font-semibold text-xs",children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V4a2 2 0 10-4 0v1.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),"PDF"]})})]},_.id)})})]})}),c&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:m.jsxs("div",{className:"bg-white p-6 rounded-lg w-96",children:[m.jsx("h3",{className:"text-lg font-bold mb-4",children:"Generate Invoice"}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2",children:"Customer"}),m.jsxs("select",{value:h,onChange:_=>p(_.target.value),className:"w-full border p-2 rounded",children:[m.jsx("option",{value:"",children:"Select Customer"}),n.map(_=>m.jsxs("option",{value:_.CustomerListID,children:[_.name," (",_.customer_number,")"]},_.CustomerListID))]})]}),m.jsxs("div",{className:"flex justify-end gap-2",children:[m.jsx("button",{type:"button",onClick:()=>u(!1),className:"bg-gray-400 text-white px-4 py-2 rounded",disabled:d,children:"Cancel"}),m.jsx("button",{onClick:()=>v(h),className:"bg-blue-600 text-white px-4 py-2 rounded",disabled:!h||d,children:d?"Generating...":"Generate"})]})]})]})})]})}function cO(){const e=Rt(),t=async()=>{await Je.auth.signOut(),e("/login")};return m.jsxs("nav",{className:"text-white p-4 flex gap-4 items-center",style:{background:"var(--accent)"},children:[m.jsx(Vs,{to:"/dashboard",className:({isActive:r})=>r?"underline":"",children:"Dashboard"}),m.jsx(Vs,{to:"/customers",className:({isActive:r})=>r?"underline":"",children:"Customers"}),m.jsx(Vs,{to:"/cylinders",className:({isActive:r})=>r?"underline":"",children:"Cylinders"}),m.jsx(Vs,{to:"/rentals",className:({isActive:r})=>r?"underline":"",children:"Rentals"}),m.jsx(Vs,{to:"/invoices",className:({isActive:r})=>r?"underline":"",children:"Invoices"}),m.jsx(Vs,{to:"/settings",className:({isActive:r})=>r?"underline":"",children:"Settings"}),m.jsx("button",{onClick:t,className:"ml-auto bg-red-600 px-3 py-1 rounded text-white hover:bg-red-700",children:"Logout"})]})}function uO(){const e={success:!0,missing:[],message:""};return e.success?e.message="All environment variables are properly configured!":e.message=`Missing environment variables: ${e.missing.join(", ")}`,e}function fO(){const[e,t]=ge.useState(null);return ge.useEffect(()=>{const r=uO();t(r)},[]),e?m.jsx("div",{className:"p-4 rounded-lg shadow-sm max-w-md mx-auto mt-8",children:m.jsxs("div",{className:`p-4 rounded-lg ${e.success?"bg-green-100":"bg-red-100"}`,children:[m.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Environment Variables Status"}),m.jsx("p",{className:`${e.success?"text-green-700":"text-red-700"}`,children:e.message}),!e.success&&m.jsxs("div",{className:"mt-4",children:[m.jsx("p",{className:"text-sm text-gray-700",children:"Please add the missing variables to your .env file:"}),m.jsx("ul",{className:"list-disc list-inside mt-2",children:e.missing.map(r=>m.jsx("li",{className:"text-sm text-red-600",children:r},r))})]})]})}):null}const hO=()=>{const[e,t]=ge.useState(""),[r,n]=ge.useState([]),[a,i]=ge.useState(!1),s=Rt(),o=cl();ge.useEffect(()=>{if(!e){n([]);return}(async()=>{const[h,p,d]=await Promise.all([Je.from("cylinders").select("id, barcode_number, serial_number, product_code, description").or(`barcode_number.ilike.%${e}%,serial_number.ilike.%${e}%,product_code.ilike.%${e}%`).limit(5),Je.from("customers").select("CustomerListID, name, phone").or(`CustomerListID.ilike.%${e}%,name.ilike.%${e}%,phone.ilike.%${e}%`).limit(5),Je.from("sales_orders").select("id, sales_order_number, customer_name").or(`sales_order_number.ilike.%${e}%,customer_name.ilike.%${e}%`).limit(5)]),y=(h.data||[]).map(v=>({type:"asset",id:v.barcode_number||v.serial_number||v.product_code,label:v.description||v.product_code||v.barcode_number||v.serial_number,sub:v.barcode_number||v.serial_number})),x=(p.data||[]).map(v=>({type:"customer",id:v.CustomerListID,label:v.name,sub:v.phone})),S=(d.data||[]).map(v=>({type:"order",id:v.id,label:v.sales_order_number,sub:v.customer_name}));n([...y,...x,...S])})()},[e]);const l=u=>{i(!1),t(""),u.type==="asset"?s(`/assets/${u.id}/history`):u.type==="customer"?s(`/customers/${u.id}`):u.type==="order"?s("/integration"):alert("Unknown type")},c=async u=>{u.preventDefault(),r.length>0?l(r[0]):alert("No matching asset, customer, or order found.")};return m.jsxs("div",{className:"bg-gray-800 text-white w-64 min-h-screen p-4 flex flex-col",children:[m.jsxs("div",{className:"mb-6",children:[m.jsx("div",{className:"mb-2 text-xs text-gray-400",children:"Search:"}),m.jsx("form",{onSubmit:c,autoComplete:"off",children:m.jsx("input",{className:"w-full mb-2 p-2 rounded text-black",placeholder:"Asset, Customer, Order...",value:e,onChange:u=>{t(u.target.value),i(!0)},onFocus:()=>i(!0),onBlur:()=>setTimeout(()=>i(!1),150)})}),a&&r.length>0&&m.jsx("div",{className:"absolute z-20 bg-white text-black w-56 rounded shadow border max-h-60 overflow-y-auto",children:r.map((u,h)=>m.jsxs("div",{className:"px-4 py-2 cursor-pointer hover:bg-blue-100",onMouseDown:()=>l(u),children:[m.jsx("span",{className:"font-semibold",children:u.label}),m.jsx("span",{className:"text-xs text-gray-500 ml-2",children:u.sub}),m.jsx("span",{className:"text-xs ml-2 rounded px-2 py-1 bg-gray-200 text-gray-700",children:u.type})]},h))})]}),m.jsx("nav",{className:"flex-1",children:m.jsx("ul",{className:"space-y-1",children:[{to:"/home",label:"Home"},{to:"/custom-reports",label:"Custom Reports"},{to:"/customers",label:"Customers"},{to:"/locations",label:"Locations"},{to:"/assets/history-lookup",label:"Asset History Lookup"},{to:"/all-asset-movements",label:"All Asset Movements"},{to:"/import",label:"Import"},{to:"/import-customer-info",label:"Import Customers"},{to:"/import-history",label:"Import History"}].map(({to:u,label:h})=>m.jsx("li",{children:m.jsx(W4,{to:u,className:"block px-4 py-2 rounded font-medium transition-colors duration-200",style:o.pathname===u?{background:"var(--accent)",color:"white"}:{background:"transparent",color:"white"},onMouseOver:p=>{o.pathname!==u&&(p.currentTarget.style.background="var(--accent)")},onMouseOut:p=>{o.pathname!==u&&(p.currentTarget.style.background="transparent")},children:h})},u))})})]})};function dO({profile:e}){return Rt(),ge.useState(""),m.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-white via-blue-50 to-blue-100 flex",children:[m.jsx(hO,{}),m.jsxs("div",{className:"flex-1",children:[m.jsx(cO,{}),m.jsx("div",{className:"p-8 max-w-3xl mx-auto",children:m.jsxs("div",{className:"bg-white/80 shadow-2xl rounded-2xl p-8 border border-blue-100 mb-8",children:[m.jsxs("h1",{className:"text-4xl font-extrabold mb-4 text-blue-900 tracking-tight flex items-center gap-3",children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v4a1 1 0 001 1h3m10-5h3a1 1 0 011 1v4a1 1 0 01-1 1h-3m-10 4h10m-10 4h10"})}),"Dashboard"]}),m.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mb-6",children:[m.jsxs("div",{className:"flex-1 bg-gradient-to-r from-blue-100 to-blue-50 rounded-xl p-6 shadow flex items-center gap-4",children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 15c2.5 0 4.847.655 6.879 1.804M15 11a3 3 0 11-6 0 3 3 0 016 0z"})}),m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-blue-900",children:(e==null?void 0:e.full_name)||"User"}),m.jsx("div",{className:"text-xs text-blue-700",children:"Logged in"})]})]}),m.jsxs("div",{className:"flex-1 bg-gradient-to-r from-blue-100 to-blue-50 rounded-xl p-6 shadow flex items-center gap-4",children:[m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 01-8 0m8 0a4 4 0 00-8 0m8 0V5a4 4 0 00-8 0v2m8 0a4 4 0 01-8 0"})}),m.jsxs("div",{children:[m.jsx("div",{className:"text-lg font-bold text-blue-900 capitalize",children:e==null?void 0:e.role}),m.jsx("div",{className:"text-xs text-blue-700",children:"Role"})]})]})]}),(e==null?void 0:e.role)==="admin"&&m.jsx("p",{className:"text-green-700 font-semibold mb-2",children:"You have full access to all features."}),(e==null?void 0:e.role)==="manager"&&m.jsx("p",{className:"text-blue-700 font-semibold mb-2",children:"You can view, assign cylinders, and generate invoices."}),(e==null?void 0:e.role)==="user"&&m.jsx("p",{className:"text-gray-700 font-semibold mb-2",children:"You have view-only access to customers and assigned cylinders."}),m.jsx("p",{className:"mt-6 text-blue-900",children:"Use the navigation bar to manage customers, cylinders, rentals, and invoices."}),(e==null?void 0:e.role)==="admin"&&m.jsx("div",{className:"mt-8",children:m.jsx(fO,{})})]})})]})]})}function pO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("div",{className:"text-2xl",children:"Favorites Page"})]})}function mO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("div",{className:"text-2xl",children:"Custom Reports Page"})]})}const gO=[{to:"/management-reports/all-assets",label:"All Assets"},{to:"/management-reports/asset-type-changes",label:"Asset Type Changes"},{to:"/management-reports/assets-by-customer",label:"Assets By Customer"},{to:"/management-reports/audits-to-delivery-records",label:"Audits to Delivery Records"},{to:"/management-reports/balance-changes-summary",label:"Balance Changes Summary"},{to:"/management-reports/customer-deliveries",label:"Customer Deliveries"},{to:"/management-reports/deliveries-by-location",label:"Deliveries By Location"},{to:"/management-reports/delivery-totals-by-user",label:"Delivery Totals By User"},{to:"/management-reports/lost-assets",label:"Lost Assets"},{to:"/management-reports/movement-between-locations",label:"Movement Between Locations"},{to:"/management-reports/negative-balance-report",label:"Negative Balance Report"},{to:"/management-reports/new-assets-added",label:"New Assets Added"},{to:"/management-reports/not-scanned-source",label:"Not-Scanned: Source"},{to:"/management-reports/overdue-asset-search",label:"Overdue Asset Search"},{to:"/management-reports/print-days-records",label:"Print Day's Records"},{to:"/management-reports/quick-map",label:"Quick Map"}];function xO(){return m.jsxs("div",{className:"bg-gray-200 w-64 min-h-screen p-0 border-r",children:[m.jsx("div",{className:"bg-gray-600 text-white font-bold px-4 py-3",children:"Management Reports"}),m.jsx("nav",{children:gO.map(e=>m.jsx(Vs,{to:e.to,className:({isActive:t})=>`block px-4 py-2 border-b text-gray-800 hover:bg-gray-300 ${t?"bg-gray-300 font-semibold":""}`,children:e.label},e.to))})]})}function vO(){return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[m.jsx(xO,{}),m.jsx("div",{className:"flex-1 p-8",children:m.jsx(SE,{})})]})}function yO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"All Assets"}),m.jsx("p",{children:"This page will display all assets in the system."})]})}function wO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Asset Type Changes"}),m.jsx("p",{children:"This page will display asset type changes."})]})}function _O(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Assets By Customer"}),m.jsx("p",{children:"This page will display assets grouped by customer."})]})}function bO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Audits to Delivery Records"}),m.jsx("p",{children:"This page will display audits to delivery records."})]})}function kO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Balance Changes Summary"}),m.jsx("p",{children:"This page will display a summary of balance changes."})]})}function SO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Customer Deliveries"}),m.jsx("p",{children:"This page will display customer deliveries."})]})}function EO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Deliveries By Location"}),m.jsx("p",{children:"This page will display deliveries by location."})]})}function AO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Delivery Totals By User"}),m.jsx("p",{children:"This will show delivery totals grouped by user."})]})}function NO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Lost Assets"}),m.jsx("p",{children:"This will show lost assets in the system."})]})}function TO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Movement Between Locations"}),m.jsx("p",{children:"This will show asset movements between locations."})]})}function CO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Negative Balance Report"}),m.jsx("p",{children:"This will show assets or customers with negative balances."})]})}function LO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"New Assets Added"}),m.jsx("p",{children:"This will show assets that were recently added to the system."})]})}function FO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Not-Scanned: Source"}),m.jsx("p",{children:"This will show assets that have not been scanned at the source."})]})}function PO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Overdue Asset Search"}),m.jsx("p",{children:"This will show assets that are overdue for return or maintenance."})]})}function IO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Print Day's Records"}),m.jsx("p",{children:"This will allow printing of all records for a selected day."})]})}function jO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Quick Map"}),m.jsx("p",{children:"This will show a quick map visualization of assets or deliveries."})]})}function RO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("div",{className:"text-2xl",children:"Quick Add Page"})]})}function OO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Lot Reports"}),m.jsx("p",{children:"View and manage lot reports here."})]})}function DO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Regular Maintenance"}),m.jsx("p",{children:"View and manage regular maintenance here."})]})}function MO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Locations"}),m.jsx("p",{children:"Manage and view all locations here."})]})}function BO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Search"}),m.jsx("p",{children:"Search the system here."})]})}function UO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create Records"}),m.jsx("p",{children:"Create new records here."})]})}function zO(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Alerts"}),m.jsx("p",{children:"View and manage alerts here."})]})}function $O(){return m.jsxs("div",{children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Mobile Units"}),m.jsx("p",{children:"Manage and view mobile units here."})]})}const qO=[{to:"/rental/class-groups",label:"Rental Class Groups"},{to:"/rental/classes",label:"Rental Classes"},{to:"/rental/bill-formats",label:"Rental Bill Formats"},{to:"/rental/flat-fees",label:"Flat Fees"},{to:"/rental/expiring-asset-agreements",label:"Expiring Asset Agreements"},{to:"/rental/bill-configuration",label:"Rental Bill Configuration"},{to:"/rental/billing-periods",label:"Show Rental Billing Periods"},{to:"/rental/legacy-code-mappings",label:"Rental Legacy Code Mappings"},{to:"/rental/tax-regions",label:"Rental Tax Regions"},{to:"/rental/tax-categories",label:"Rental Tax Categories"},{to:"/rental/invoice-search",label:"Rental Invoice Search"},{to:"/rental/accounting-products",label:"Accounting Asset Agreement Products"},{to:"/rental/assign-asset-types",label:"Assign Asset Types To Rental Classes"}];function HO(){return m.jsxs("div",{className:"bg-gray-200 w-64 min-h-screen p-0 border-r",children:[m.jsx("div",{className:"bg-gray-600 text-white font-bold px-4 py-3",children:"Rental"}),m.jsx("nav",{children:qO.map(e=>m.jsx(Vs,{to:e.to,className:({isActive:t})=>`block px-4 py-2 border-b text-gray-800 hover:bg-gray-300 ${t?"bg-gray-300 font-semibold":""}`,children:e.label},e.to))})]})}function VO(){const[e,t]=ge.useState([{id:1,name:"Industrial",description:"Industrial rental class group"},{id:2,name:"Medical",description:"Medical rental class group"}]),[r,n]=ge.useState({name:"",description:""}),[a,i]=ge.useState(null),s=Rt(),o=h=>n({...r,[h.target.name]:h.target.value}),l=h=>{h.preventDefault(),a?(t(e.map(p=>p.id===a?{...p,...r}:p)),i(null)):t([...e,{id:Date.now(),...r}]),n({name:"",description:""})},c=h=>{i(h.id),n({name:h.name,description:h.description})},u=h=>t(e.filter(p=>p.id!==h));return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>s("/dashboard"),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Class Groups"}),m.jsxs("form",{onSubmit:l,className:"mb-6 flex gap-2 items-end",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm",children:"Name"}),m.jsx("input",{name:"name",value:r.name,onChange:o,className:"border p-2 rounded w-48",required:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm",children:"Description"}),m.jsx("input",{name:"description",value:r.description,onChange:o,className:"border p-2 rounded w-64"})]}),m.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded",children:a?"Update":"Add"}),a&&m.jsx("button",{type:"button",onClick:()=>{i(null),n({name:"",description:""})},className:"bg-gray-400 text-white px-4 py-2 rounded",children:"Cancel"})]}),m.jsxs("table",{className:"min-w-full bg-white border",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{className:"border px-4 py-2",children:"Name"}),m.jsx("th",{className:"border px-4 py-2",children:"Description"}),m.jsx("th",{className:"border px-4 py-2",children:"Actions"})]})}),m.jsx("tbody",{children:e.map(h=>m.jsxs("tr",{children:[m.jsx("td",{className:"border px-4 py-2",children:h.name}),m.jsx("td",{className:"border px-4 py-2",children:h.description}),m.jsxs("td",{className:"border px-4 py-2",children:[m.jsx("button",{onClick:()=>c(h),className:"bg-yellow-400 text-white px-2 py-1 rounded mr-2",children:"Edit"}),m.jsx("button",{onClick:()=>u(h.id),className:"bg-red-600 text-white px-2 py-1 rounded",children:"Delete"})]})]},h.id))})]})]})}function WO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Classes"}),m.jsx("div",{children:"Rental Classes content goes here."})]})}function GO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Bill Formats"}),m.jsx("div",{children:"Rental Bill Formats content goes here."})]})}function KO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Flat Fees"}),m.jsx("div",{children:"Flat Fees content goes here."})]})}function XO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Expiring Asset Agreements"}),m.jsx("div",{children:"Expiring Asset Agreements content goes here."})]})}function YO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Bill Configuration"}),m.jsx("div",{children:"Rental Bill Configuration content goes here."})]})}function JO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Show Rental Billing Periods"}),m.jsx("div",{children:"Show Rental Billing Periods content goes here."})]})}function QO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Legacy Code Mappings"}),m.jsx("div",{children:"Rental Legacy Code Mappings content goes here."})]})}function ZO(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Tax Regions"}),m.jsx("div",{children:"Rental Tax Regions content goes here."})]})}function eD(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Tax Categories"}),m.jsx("div",{children:"Rental Tax Categories content goes here."})]})}function tD(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Rental Invoice Search"}),m.jsx("div",{children:"Rental Invoice Search content goes here."})]})}function rD(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Accounting Asset Agreement Products"}),m.jsx("div",{children:"Accounting Asset Agreement Products content goes here."})]})}function nD(){const e=Rt();return m.jsxs("div",{className:"p-8",children:[m.jsx("button",{onClick:()=>e(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Assign Asset Types To Rental Classes"}),m.jsx("div",{children:"Assign Asset Types To Rental Classes content goes here."})]})}function aD(){return m.jsxs("div",{className:"flex min-h-screen",children:[m.jsx(HO,{}),m.jsx("div",{className:"flex-1",children:m.jsxs(H4,{children:[m.jsx(dt,{path:"/class-groups",element:m.jsx(VO,{})}),m.jsx(dt,{path:"/classes",element:m.jsx(WO,{})}),m.jsx(dt,{path:"/bill-formats",element:m.jsx(GO,{})}),m.jsx(dt,{path:"/flat-fees",element:m.jsx(KO,{})}),m.jsx(dt,{path:"/expiring-asset-agreements",element:m.jsx(XO,{})}),m.jsx(dt,{path:"/bill-configuration",element:m.jsx(YO,{})}),m.jsx(dt,{path:"/billing-periods",element:m.jsx(JO,{})}),m.jsx(dt,{path:"/legacy-code-mappings",element:m.jsx(QO,{})}),m.jsx(dt,{path:"/tax-regions",element:m.jsx(ZO,{})}),m.jsx(dt,{path:"/tax-categories",element:m.jsx(eD,{})}),m.jsx(dt,{path:"/invoice-search",element:m.jsx(tD,{})}),m.jsx(dt,{path:"/accounting-products",element:m.jsx(rD,{})}),m.jsx(dt,{path:"/assign-asset-types",element:m.jsx(nD,{})}),m.jsx(dt,{path:"*",element:m.jsx(Xr,{to:"/rental/class-groups"})})]})})]})}function iD(){const{id:e}=z4(),t=Rt(),[r,n]=ge.useState(null),[a,i]=ge.useState([]),[s,o]=ge.useState(!0),[l,c]=ge.useState(null);return ge.useEffect(()=>{(async()=>{o(!0),c(null);try{const{data:h,error:p}=await Je.from("customers").select("*").eq("CustomerListID",e).single();if(p)throw p;n(h);const{data:d,error:y}=await Je.from("cylinders").select("*").eq("assigned_customer",e);if(y)throw y;i(d)}catch(h){c(h.message)}o(!1)})()},[e]),s?m.jsx("div",{children:"Loading..."}):l?m.jsxs("div",{className:"text-red-600",children:["Error: ",l]}):r?m.jsxs("div",{className:"max-w-5xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100 w-full",children:[m.jsx("button",{onClick:()=>t(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Customer Details"}),m.jsxs("div",{className:"mb-6 p-4 bg-white/80 rounded-xl shadow border border-blue-100",children:[m.jsx("div",{className:"font-bold text-blue-900 text-lg mb-2",children:r.name}),m.jsxs("div",{className:"text-sm text-gray-700",children:["CustomerListID: ",m.jsx("span",{className:"font-mono",children:r.CustomerListID})]}),m.jsxs("div",{className:"text-sm text-gray-700",children:["Address: ",r.contact_details]}),m.jsxs("div",{className:"text-sm text-gray-700",children:["Phone: ",r.phone]})]}),m.jsx("h3",{className:"font-bold mb-2 text-blue-800",children:"Assets Assigned to Customer"}),a.length===0?m.jsx("div",{className:"text-gray-500",children:"No assets assigned to this customer."}):m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"min-w-full bg-white border text-xs",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"Serial Number"}),m.jsx("th",{children:"Product Code"}),m.jsx("th",{children:"Description"}),m.jsx("th",{children:"Gas Type"}),m.jsx("th",{children:"Rental Start"}),m.jsx("th",{children:"Category"}),m.jsx("th",{children:"Group"}),m.jsx("th",{children:"Type"}),m.jsx("th",{children:"In-House Total"}),m.jsx("th",{children:"With Customer Total"}),m.jsx("th",{children:"Lost Total"}),m.jsx("th",{children:"Total"}),m.jsx("th",{children:"Dock Stock"})]})}),m.jsx("tbody",{children:a.map(u=>m.jsxs("tr",{children:[m.jsx("td",{children:u.serial_number}),m.jsx("td",{children:u.product_code}),m.jsx("td",{children:u.description}),m.jsx("td",{children:u.gas_type}),m.jsx("td",{children:u.rental_start_date||"-"}),m.jsx("td",{children:u.category}),m.jsx("td",{children:u.group_name}),m.jsx("td",{children:u.type}),m.jsx("td",{children:u.in_house_total}),m.jsx("td",{children:u.with_customer_total}),m.jsx("td",{children:u.lost_total}),m.jsx("td",{children:u.total}),m.jsx("td",{children:u.dock_stock})]},u.id))})]})})]}):m.jsx("div",{children:"Customer not found."})}function sD(){const{id:e}=z4(),t=Rt(),[r,n]=ge.useState(null),[a,i]=ge.useState([]),[s,o]=ge.useState(!0),[l,c]=ge.useState(null),[u,h]=ge.useState(""),[p,d]=ge.useState(!1),[y,x]=ge.useState({}),[S,v]=ge.useState(null),[k,_]=ge.useState({});ge.useEffect(()=>{(async()=>{o(!0),c(null);try{const{data:F,error:N}=await Je.from("cylinders").select("*").or(`barcode_number.eq.${e},serial_number.eq.${e}`).single();if(N||!F)throw new Error("Asset not found.");n(F),x(F);const{data:M,error:K}=await Je.from("asset_records").select("*").eq("asset_id",F.id).order("created_at",{ascending:!1});i(M||[])}catch(F){c(F.message)}o(!1)})()},[e]);const j=()=>d(!0),D=O=>x({...y,[O.target.name]:O.target.value}),z=async()=>{o(!0),c(null);const{error:O}=await Je.from("cylinders").update(y).eq("id",r.id);O?c(O.message):(n(y),d(!1)),o(!1)},I=O=>{v(O.id),_(O)},T=O=>_({...k,[O.target.name]:O.target.value}),L=async()=>{o(!0),c(null);const{error:O}=await Je.from("asset_records").update(k).eq("id",S);O?c(O.message):(i(a.map(F=>F.id===S?k:F)),v(null)),o(!1)};return s?m.jsx("div",{children:"Loading..."}):l?m.jsxs("div",{className:"text-red-600",children:["Error: ",l]}):r?m.jsxs("div",{className:"max-w-5xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100 w-full",children:[m.jsx("button",{onClick:()=>t(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Asset History"}),m.jsxs("div",{className:"mb-6 p-4 bg-white/80 rounded-xl shadow border border-blue-100",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2",children:[m.jsx("div",{className:"font-bold text-blue-900 text-lg",children:r.description||"Asset"}),!p&&m.jsx("button",{onClick:j,className:"bg-yellow-400 text-yellow-900 px-4 py-2 rounded shadow hover:bg-yellow-500",children:"Edit Asset"})]}),p?m.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[m.jsx("input",{name:"barcode_number",value:y.barcode_number||"",onChange:D,placeholder:"Barcode",className:"border p-2 rounded"}),m.jsx("input",{name:"serial_number",value:y.serial_number||"",onChange:D,placeholder:"Serial Number",className:"border p-2 rounded"}),m.jsx("input",{name:"category",value:y.category||"",onChange:D,placeholder:"Category",className:"border p-2 rounded"}),m.jsx("input",{name:"group_name",value:y.group_name||"",onChange:D,placeholder:"Group",className:"border p-2 rounded"}),m.jsx("input",{name:"type",value:y.type||"",onChange:D,placeholder:"Type",className:"border p-2 rounded"}),m.jsx("input",{name:"description",value:y.description||"",onChange:D,placeholder:"Description",className:"border p-2 rounded"}),m.jsx("input",{name:"gas_type",value:y.gas_type||"",onChange:D,placeholder:"Gas Type",className:"border p-2 rounded"}),m.jsx("input",{name:"dock_stock",value:y.dock_stock||"",onChange:D,placeholder:"Dock Stock",className:"border p-2 rounded"})]}):m.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[m.jsxs("div",{children:[m.jsx("b",{children:"Barcode:"})," ",r.barcode_number]}),m.jsxs("div",{children:[m.jsx("b",{children:"Serial Number:"})," ",r.serial_number]}),m.jsxs("div",{children:[m.jsx("b",{children:"Category:"})," ",r.category]}),m.jsxs("div",{children:[m.jsx("b",{children:"Group:"})," ",r.group_name]}),m.jsxs("div",{children:[m.jsx("b",{children:"Type:"})," ",r.type]}),m.jsxs("div",{children:[m.jsx("b",{children:"Description:"})," ",r.description]}),m.jsxs("div",{children:[m.jsx("b",{children:"Gas Type:"})," ",r.gas_type]}),m.jsxs("div",{children:[m.jsx("b",{children:"Dock Stock:"})," ",r.dock_stock]}),m.jsxs("div",{children:[m.jsx("b",{children:"Status:"})," ",r.status||"-"]}),m.jsxs("div",{children:[m.jsx("b",{children:"Use State:"})," ",r.use_state||"-"]})]}),p&&m.jsxs("div",{className:"flex gap-2 mt-2",children:[m.jsx("button",{onClick:z,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Save"}),m.jsx("button",{onClick:()=>{d(!1),x(r)},className:"bg-gray-400 text-white px-4 py-2 rounded",children:"Cancel"})]})]}),m.jsx("h3",{className:"font-bold mb-2 text-blue-800",children:"Asset Record Log"}),m.jsx("div",{className:"mb-4 flex gap-2",children:m.jsx("input",{type:"text",value:u,onChange:O=>h(O.target.value),placeholder:"Search records by type, user, location, notes...",className:"border p-2 rounded w-80"})}),m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"min-w-full bg-white border text-xs",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"Type"}),m.jsx("th",{children:"Created"}),m.jsx("th",{children:"Submitted"}),m.jsx("th",{children:"User"}),m.jsx("th",{children:"Device"}),m.jsx("th",{children:"Location"}),m.jsx("th",{children:"Data"}),m.jsx("th",{children:"Associated Assets"}),m.jsx("th",{children:"Notes"}),m.jsx("th",{children:"Actions"})]})}),m.jsx("tbody",{children:a.filter(O=>{var F,N,M,K;return!u||((F=O.type)==null?void 0:F.toLowerCase().includes(u.toLowerCase()))||((N=O.user)==null?void 0:N.toLowerCase().includes(u.toLowerCase()))||((M=O.location)==null?void 0:M.toLowerCase().includes(u.toLowerCase()))||((K=O.notes)==null?void 0:K.toLowerCase().includes(u.toLowerCase()))}).map(O=>m.jsx("tr",{className:S===O.id?"bg-yellow-100":"",children:S===O.id?m.jsxs(m.Fragment,{children:[m.jsx("td",{children:m.jsx("input",{name:"type",value:k.type||"",onChange:T,className:"border p-1 rounded w-24"})}),m.jsx("td",{children:k.created_at}),m.jsx("td",{children:k.submitted_at}),m.jsx("td",{children:m.jsx("input",{name:"user",value:k.user||"",onChange:T,className:"border p-1 rounded w-24"})}),m.jsx("td",{children:m.jsx("input",{name:"device",value:k.device||"",onChange:T,className:"border p-1 rounded w-24"})}),m.jsx("td",{children:m.jsx("input",{name:"location",value:k.location||"",onChange:T,className:"border p-1 rounded w-24"})}),m.jsx("td",{children:m.jsx("input",{name:"data",value:k.data||"",onChange:T,className:"border p-1 rounded w-24"})}),m.jsx("td",{children:m.jsx("input",{name:"associated_assets",value:k.associated_assets||"",onChange:T,className:"border p-1 rounded w-24"})}),m.jsx("td",{children:m.jsx("input",{name:"notes",value:k.notes||"",onChange:T,className:"border p-1 rounded w-24"})}),m.jsxs("td",{children:[m.jsx("button",{onClick:L,className:"bg-blue-600 text-white px-2 py-1 rounded mr-1",children:"Save"}),m.jsx("button",{onClick:()=>v(null),className:"bg-gray-400 text-white px-2 py-1 rounded",children:"Cancel"})]})]}):m.jsxs(m.Fragment,{children:[m.jsx("td",{children:O.type}),m.jsx("td",{children:O.created_at}),m.jsx("td",{children:O.submitted_at}),m.jsx("td",{children:O.user}),m.jsx("td",{children:O.device}),m.jsx("td",{children:O.location}),m.jsx("td",{children:O.data}),m.jsx("td",{children:O.associated_assets}),m.jsx("td",{children:O.notes}),m.jsx("td",{children:m.jsx("button",{onClick:()=>I(O),className:"bg-yellow-400 text-yellow-900 px-2 py-1 rounded",children:"Edit"})})]})},O.id))})]})})]}):m.jsx("div",{children:"Asset not found."})}function oD(){const[e,t]=ge.useState(""),r=Rt();return m.jsxs("div",{className:"max-w-xl mx-auto mt-20 bg-white/80 shadow-2xl rounded-2xl p-8 border border-blue-100",children:[m.jsx("h2",{className:"text-2xl font-bold mb-4 text-blue-900",children:"Asset History Lookup"}),m.jsxs("div",{className:"flex gap-2 mb-4",children:[m.jsx("input",{type:"text",value:e,onChange:n=>t(n.target.value),placeholder:"Enter barcode or serial number...",className:"border border-blue-300 bg-white/80 p-3 rounded-lg w-full shadow-sm focus:ring-2 focus:ring-blue-300 transition"}),m.jsx("button",{onClick:()=>e&&r(`/assets/${e}/history`),className:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 font-semibold transition",disabled:!e,children:"Lookup"})]}),m.jsx("div",{className:"text-xs text-blue-700",children:"Quickly view the full history and details of any asset by barcode or serial number."})]})}const wb=[{key:"customer_id",label:"Customer ID"},{key:"customer_name",label:"Customer Name"},{key:"date",label:"Date"},{key:"product_code",label:"Product Code"},{key:"invoice_number",label:"Invoice Number"},{key:"qty_out",label:"Qty Out"},{key:"qty_in",label:"Qty In"}],lD=[{key:"description",label:"Description",aliases:["desc","itemdesc","linedesc"]},{key:"rate",label:"Rate",aliases:["rate","unitprice"]},{key:"amount",label:"Amount",aliases:["amount","lineamount","total"]},{key:"serial_number",label:"Serial Number",aliases:["serialnumber","serial"]}],Gl=[...wb,...lD],Up="importInvoicesFieldMapping";async function cD(){const{data:{user:e}}=await Je.auth.getUser();return e}function uD(){const[e,t]=ge.useState(null),[r,n]=ge.useState([]),[a,i]=ge.useState([]),[s,o]=ge.useState({}),[l,c]=ge.useState([]),[u,h]=ge.useState(null),[p,d]=ge.useState(!1),[y,x]=ge.useState(null),S=Rt(),[v,k]=ge.useState([]),[_,j]=ge.useState(!1),[D,z]=ge.useState(null);function I(Z){return Z.every(oe=>typeof oe=="string"&&oe.length>0&&!/^[0-9]+$/.test(oe))}function T(Z){try{const oe=localStorage.getItem(Up);if(!oe)return null;const b=JSON.parse(oe);if(b.columns&&Array.isArray(b.columns)&&JSON.stringify(b.columns)===JSON.stringify(Z))return b.mapping}catch{}return null}const L=Z=>{t(Z.target.files[0]),n([]),i([]),o({}),c([]),h(null),x(null),k([]),j(!1),z(null),ie([]);const oe=Z.target.files[0];if(!oe)return;const b=oe.name.split(".").pop().toLowerCase(),A=C=>{if(!C.length)return;let R=[],H=C;I(C[0])?(R=C[0].map((ne,me)=>ne.trim()||`Column ${me+1}`),H=C.slice(1)):R=C[0].map((ne,me)=>`Column ${me+1}`),n(H),i(R);const re=T(R);let ae={};re?ae=re:Gl.forEach(ne=>{const me=R.find(we=>{const X=we.toLowerCase().replace(/\s|_/g,"");return X.includes(ne.key.replace(/_/g,""))?!0:ne.aliases?ne.aliases.some(Ie=>X.includes(Ie)):!1});me&&(ae[ne.key]=me)}),o(ae),c(O(H,R,ae))};if(b==="xls"||b==="xlsx"){const C=new FileReader;C.onload=R=>{const H=new Uint8Array(R.target.result),re=Mc(H,{type:"array"}),ae=re.SheetNames[0],ne=re.Sheets[ae],me=r1.sheet_to_json(ne,{header:1});A(me)},C.readAsArrayBuffer(oe)}else{const C=new FileReader;C.onload=R=>{const re=R.target.result.split(`
`).map(ae=>ae.split("	")).filter(ae=>ae.length>1&&ae.some(ne=>ne.trim()!==""));A(re)},C.readAsText(oe)}};function O(Z,oe,b){return Z.map(A=>{const C={};return Gl.forEach(R=>{const H=b[R.key];if(H){const re=oe.indexOf(H);C[R.key]=A[re]||""}else C[R.key]=""}),C})}const F=(Z,oe)=>{const b={...s,[Z]:oe};o(b),c(O(r,a,b)),a.length&&localStorage.setItem(Up,JSON.stringify({columns:a,mapping:b}))},N=()=>{localStorage.removeItem(Up),o({}),c(O(r,a,{}))};function M(Z){if(!Z)return!1;if(/^\d{2}\/\d{2}\/\d{4}$/.test(Z)){const[oe,b,A]=Z.split("/");return oe>="01"&&oe<="31"&&b>="01"&&b<="12"&&A.length===4}if(/^\d{4}-\d{2}-\d{2}$/.test(Z)){const[oe,b,A]=Z.split("-");return A>="01"&&A<="31"&&b>="01"&&b<="12"&&oe.length===4}return!1}function K(Z,oe){const b=[];return Z.forEach((A,C)=>{Gl.forEach(R=>{oe[R.key]?(!A[R.key]||A[R.key].toString().trim()==="")&&b.push({row:C,field:R.key,reason:"Missing value"}):b.push({row:C,field:R.key,reason:"Field not mapped"})}),A.date&&!M(A.date)&&b.push({row:C,field:"date",reason:"Invalid date format"}),A.qty_out&&isNaN(Number(A.qty_out))&&b.push({row:C,field:"qty_out",reason:"Not a number"}),A.qty_in&&isNaN(Number(A.qty_in))&&b.push({row:C,field:"qty_in",reason:"Not a number"})}),b}const he=async Z=>{Z.preventDefault(),d(!0),h(null),x(null);const oe=K(l,s);if(oe.length>0){d(!1),x(`Validation failed: ${oe.length} error(s) found. Please fix highlighted rows before importing.`),ie(oe);return}let b=null,A=await cD(),C=new Date().toISOString();try{const{data:Se}=await Je.from("import_history").insert([{file_name:(e==null?void 0:e.name)||"",import_type:"invoices",user_id:(A==null?void 0:A.id)||null,user_email:(A==null?void 0:A.email)||null,started_at:C,status:"started"}]).select().single();b=Se==null?void 0:Se.id}catch{}let R=0,H=0,re=0,ae=0,ne=0,me=0,we=0,X=0,Ie=[];try{if(!l.length)throw new Error("No data to import.");for(const Se of l)try{let{data:_e}=await Je.from("customers").select("*").eq("CustomerListID",Se.customer_id).single();if(_e)ae++;else{const{data:Pe}=await Je.from("customers").insert([{CustomerListID:Se.customer_id,name:Se.customer_name}]).select().single();_e=Pe,re++}let{data:Q}=await Je.from("invoices").select("*").eq("details",Se.invoice_number).single();if(Q)me++;else{let Pe=Se.date;if(Pe&&Pe.includes("/")){const[qe,Ke,Ge]=Pe.split("/");Ge&&Ke&&qe&&(Pe=`${Ge}-${Ke.padStart(2,"0")}-${qe.padStart(2,"0")}`)}const{data:De}=await Je.from("invoices").insert([{customer_id:Se.customer_id,invoice_date:Pe,details:Se.invoice_number}]).select().single();Q=De,ne++}const{data:Oe}=await Je.from("cylinders").select("product_code").ilike("product_code",(Se.product_code||"").trim()).single();if(!Oe)X++,Ie.push({...Se,reason:"Not a cylinder"});else if(Q){const{data:Pe}=await Je.from("invoice_line_items").select("id").eq("invoice_id",Q.id).ilike("product_code",(Se.product_code||"").trim()).single();Pe?(X++,Ie.push({...Se,reason:"Duplicate line item"})):(await Je.from("invoice_line_items").insert([{invoice_id:Q.id,product_code:Se.product_code,qty_out:parseInt(Se.qty_out,10)||0,qty_in:parseInt(Se.qty_in,10)||0,description:Se.description||null,rate:Se.rate?parseFloat(Se.rate):null,amount:Se.amount?parseFloat(Se.amount):null,serial_number:Se.serial_number||null}]),R++,we++)}else we++}catch{H++,Ie.push({...Se,reason:"General error"})}b&&await Je.from("import_history").update({finished_at:new Date().toISOString(),status:"success",summary:{imported:R,errors:H,customersCreated:re,customersExisting:ae,invoicesCreated:ne,invoicesExisting:me,lineItemsCreated:we,lineItemsSkipped:X,skippedRowsCount:Ie.length}}).eq("id",b),h({success:!0,imported:R,errors:H,customersCreated:re,customersExisting:ae,invoicesCreated:ne,invoicesExisting:me,lineItemsCreated:we,lineItemsSkipped:X,skippedRows:Ie})}catch(Se){x(Se.message),b&&await Je.from("import_history").update({finished_at:new Date().toISOString(),status:"error",error_message:Se.message}).eq("id",b)}finally{d(!1)}};function le(Z){if(!Z.length)return;const b=[Object.keys(Z[0]).join(","),...Z.map(H=>Object.values(H).map(re=>`"${String(re).replace(/"/g,'""')}"`).join(","))].join(`
`),A=new Blob([b],{type:"text/csv"}),C=URL.createObjectURL(A),R=document.createElement("a");R.href=C,R.download="skipped_rows.csv",R.click(),URL.revokeObjectURL(C)}const[fe,ie]=ge.useState([]);async function q(){d(!0),x(null),j(!1);const Z=[];let oe=0,b=0,A=0,C=0,R=0,H=0;for(let re=0;re<l.length;re++){const ae=l[re];let ne="New",me="New",we="New",{data:X}=await Je.from("customers").select("CustomerListID").eq("CustomerListID",ae.customer_id).single();X?(ne="Existing",b++):oe++;let{data:Ie}=await Je.from("invoices").select("id").eq("details",ae.invoice_number).single();Ie?(me="Existing",C++):A++;const{data:Se}=await Je.from("cylinders").select("product_code").ilike("product_code",(ae.product_code||"").trim()).single();if(!Se)we="Skipped (Not a cylinder)",H++;else if(Ie){const{data:_e}=await Je.from("invoice_line_items").select("id").eq("invoice_id",Ie.id).ilike("product_code",(ae.product_code||"").trim()).single();_e?(we="Skipped (Duplicate)",H++):R++}else R++;Z.push({customerStatus:ne,invoiceStatus:me,lineItemStatus:we})}k(Z),z({customersCreated:oe,customersExisting:b,invoicesCreated:A,invoicesExisting:C,lineItemsCreated:R,lineItemsSkipped:H}),j(!0),d(!1)}return m.jsxs("div",{className:"max-w-4xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h2",{className:"text-3xl font-extrabold text-blue-900 tracking-tight",children:"Import Invoices / Sales Receipts"}),m.jsx("button",{onClick:()=>S(-1),className:"bg-gradient-to-r from-gray-400 to-gray-300 text-white px-6 py-2 rounded-lg shadow-md hover:from-gray-500 hover:to-gray-400 font-semibold transition",children:"Back"})]}),m.jsxs("form",{onSubmit:he,className:"mb-6 flex gap-2 items-end",children:[m.jsx("input",{type:"file",accept:".txt,.csv,.xlsx,.xls",onChange:L,className:"border p-2 rounded w-full"}),m.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-6 py-2 rounded-lg shadow-md hover:bg-blue-700 font-semibold transition",disabled:!e||!l.length||p||!_||fe.length>0,children:p?"Importing...":"Import"})]}),a.length>0&&m.jsxs("div",{className:"mb-6 bg-white/80 rounded-lg p-4 border border-blue-200",children:[m.jsxs("div",{className:"font-semibold mb-2 flex items-center gap-4",children:["Field Mapping:",m.jsx("button",{type:"button",className:"bg-gray-200 text-gray-800 px-3 py-1 rounded shadow hover:bg-gray-300 text-xs font-semibold",onClick:N,children:"Reset Mapping"})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Gl.map(Z=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("label",{className:"w-40 font-medium text-blue-900",children:[Z.label,wb.find(oe=>oe.key===Z.key)?"":" (optional)"]}),m.jsxs("select",{className:"border p-2 rounded w-full",value:s[Z.key]||"",onChange:oe=>F(Z.key,oe.target.value),children:[m.jsx("option",{value:"",children:"-- Not Mapped --"}),a.map(oe=>m.jsx("option",{value:oe,children:oe},oe))]})]},Z.key))})]}),l.length>0&&m.jsxs("div",{className:"mb-6",children:[m.jsxs("div",{className:"font-semibold mb-2",children:["Preview (",l.length," rows):"]}),m.jsxs("div",{className:"overflow-x-auto",children:[m.jsxs("table",{className:"min-w-full bg-white border",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[Gl.map(Z=>m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:Z.label},Z.key)),m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:"Customer"}),m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:"Invoice"}),m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:"Line Item"})]})}),m.jsx("tbody",{children:l.slice(0,5).map((Z,oe)=>{const b=fe.filter(C=>C.row===oe),A=v[oe]||{};return m.jsxs("tr",{className:b.length?"bg-red-100":"",children:[Gl.map(C=>{const R=b.find(H=>H.field===C.key);return m.jsx("td",{className:`border px-2 py-1 text-xs ${R?"bg-red-200 text-red-800 font-bold":""}`,children:Z[C.key]||""},C.key)}),m.jsx("td",{className:"border px-2 py-1 text-xs",children:A.customerStatus||""}),m.jsx("td",{className:"border px-2 py-1 text-xs",children:A.invoiceStatus||""}),m.jsx("td",{className:"border px-2 py-1 text-xs",children:A.lineItemStatus||""})]},oe)})})]}),l.length>5&&m.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Showing first 5 rows only."})]}),fe.length>0&&m.jsxs("div",{className:"text-red-700 bg-red-100 border border-red-300 rounded p-2 mt-2",children:[fe.length," validation error(s) found. Please fix highlighted rows before importing."]}),m.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded shadow hover:bg-blue-600 font-semibold transition mt-4",onClick:q,disabled:p||fe.length>0,children:p?"Checking...":"Check Preview"})]}),_&&D&&m.jsxs("div",{className:"bg-blue-50 text-blue-900 p-4 rounded mb-4 border border-blue-200",children:[m.jsx("div",{className:"font-semibold mb-1",children:"Import Summary:"}),m.jsxs("div",{children:["Customers to create: ",D.customersCreated,", already exist: ",D.customersExisting]}),m.jsxs("div",{children:["Invoices to create: ",D.invoicesCreated,", already exist: ",D.invoicesExisting]}),m.jsxs("div",{children:["Line items to import: ",D.lineItemsCreated,", skipped: ",D.lineItemsSkipped]})]}),u&&m.jsxs("div",{className:"bg-green-100 text-green-800 p-4 rounded space-y-1",children:[m.jsx("div",{children:"Import finished!"}),m.jsxs("div",{children:["Customers created: ",u.customersCreated,", already existed: ",u.customersExisting]}),m.jsxs("div",{children:["Invoices created: ",u.invoicesCreated,", already existed: ",u.invoicesExisting]}),m.jsxs("div",{children:["Line items imported: ",u.lineItemsCreated,", skipped: ",u.lineItemsSkipped]}),m.jsxs("div",{children:["Total imported: ",u.imported,", Errors: ",u.errors]}),u.skippedRows&&u.skippedRows.length>0&&m.jsx("button",{className:"bg-yellow-500 text-white px-4 py-2 rounded shadow hover:bg-yellow-600 font-semibold transition mt-2",onClick:()=>le(u.skippedRows),children:"Download Skipped/Errored Rows"})]})]})}function fD(){const[e,t]=ge.useState([]),[r,n]=ge.useState(!0),[a,i]=ge.useState(null),[s,o]=ge.useState(""),[l,c]=ge.useState({}),u=Rt();ge.useEffect(()=>{async function p(){n(!0),i(null);const{data:d,error:y}=await Je.from("import_history").select("*").order("started_at",{ascending:!1});y?i(y.message):t(d||[]),n(!1)}p()},[]);const h=e.filter(p=>!s||p.file_name&&p.file_name.toLowerCase().includes(s.toLowerCase())||p.import_type&&p.import_type.toLowerCase().includes(s.toLowerCase())||p.user_email&&p.user_email.toLowerCase().includes(s.toLowerCase())||p.status&&p.status.toLowerCase().includes(s.toLowerCase()));return m.jsxs("div",{className:"max-w-5xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100 w-full",children:[m.jsx("button",{onClick:()=>u(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4 text-blue-900",children:"Import History"}),m.jsx("div",{className:"mb-4",children:m.jsx("input",{className:"border p-2 rounded w-80",placeholder:"Filter by file, type, user, or status...",value:s,onChange:p=>o(p.target.value)})}),r?m.jsx("div",{children:"Loading..."}):a?m.jsxs("div",{className:"text-red-700",children:["Error: ",a]}):m.jsxs("div",{className:"overflow-x-auto",children:[m.jsxs("table",{className:"min-w-full bg-white border text-xs",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{className:"border px-2 py-1",children:"File Name"}),m.jsx("th",{className:"border px-2 py-1",children:"Type"}),m.jsx("th",{className:"border px-2 py-1",children:"User"}),m.jsx("th",{className:"border px-2 py-1",children:"Started"}),m.jsx("th",{className:"border px-2 py-1",children:"Finished"}),m.jsx("th",{className:"border px-2 py-1",children:"Status"}),m.jsx("th",{className:"border px-2 py-1",children:"Summary"}),m.jsx("th",{className:"border px-2 py-1",children:"Error"})]})}),m.jsx("tbody",{children:h.map(p=>{const d=p.error_message||"",y=d.split(`
`)[0],x=d.split(`
`).length>1||d.length>120,S=l[p.id];return m.jsxs("tr",{className:p.status==="error"?"bg-red-100":p.status==="success"?"bg-green-50":"",children:[m.jsx("td",{className:"border px-2 py-1",children:p.file_name}),m.jsx("td",{className:"border px-2 py-1",children:p.import_type}),m.jsx("td",{className:"border px-2 py-1",children:p.user_email}),m.jsx("td",{className:"border px-2 py-1",children:p.started_at?new Date(p.started_at).toLocaleString():""}),m.jsx("td",{className:"border px-2 py-1",children:p.finished_at?new Date(p.finished_at).toLocaleString():""}),m.jsx("td",{className:"border px-2 py-1 font-bold",children:p.status}),m.jsx("td",{className:"border px-2 py-1 whitespace-pre-wrap max-w-xs",children:p.summary?JSON.stringify(p.summary,null,2):""}),m.jsx("td",{className:"border px-2 py-1 text-red-700",children:x&&!S?m.jsxs(m.Fragment,{children:[y,m.jsx("button",{className:"ml-2 text-blue-600 underline text-xs",onClick:()=>c(v=>({...v,[p.id]:!0})),children:"View All"})]}):x&&S?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"whitespace-pre-wrap",children:d}),m.jsx("button",{className:"ml-2 text-blue-600 underline text-xs",onClick:()=>c(v=>({...v,[p.id]:!1})),children:"Hide"})]}):d})]},p.id)})})]}),h.length===0&&m.jsx("div",{className:"text-gray-500 mt-2",children:"No import logs found."})]})]})}function hD(){const[e,t]=ge.useState([]),[r,n]=ge.useState(!0),[a,i]=ge.useState(null),[s,o]=ge.useState(""),[l,c]=ge.useState(""),[u,h]=ge.useState(""),[p,d]=ge.useState([]),y=Rt(),x=[{key:"asset_id",label:"Asset ID"},{key:"type",label:"Type"},{key:"created_at",label:"Created"},{key:"user",label:"User"},{key:"device",label:"Device"},{key:"location",label:"Location"},{key:"data",label:"Data"},{key:"associated_assets",label:"Associated Assets"},{key:"notes",label:"Notes"}],S="allAssetMovementsColumns",[v,k]=ge.useState(!1),[_,j]=ge.useState(()=>{const N=localStorage.getItem(S);return N?JSON.parse(N):x.map(M=>M.key)});function D(N){let M=_.includes(N)?_.filter(K=>K!==N):[..._,N];j(M),localStorage.setItem(S,JSON.stringify(M))}ge.useEffect(()=>{async function N(){n(!0),i(null);const{data:M,error:K}=await Je.from("asset_records").select("*").order("created_at",{ascending:!1});K?i(K.message):t(M||[]),n(!1)}N()},[]);const z=e.filter(N=>{const M=!s||N.asset_id&&N.asset_id.toLowerCase().includes(s.toLowerCase())||N.type&&N.type.toLowerCase().includes(s.toLowerCase())||N.user&&N.user.toLowerCase().includes(s.toLowerCase())||N.location&&N.location.toLowerCase().includes(s.toLowerCase())||N.notes&&N.notes.toLowerCase().includes(s.toLowerCase()),K=(!l||new Date(N.created_at)>=new Date(l))&&(!u||new Date(N.created_at)<=new Date(u));return M&&K});function I(){p.length===z.length?d([]):d(z.map(N=>N.id))}function T(N){d(p.includes(N)?p.filter(M=>M!==N):[...p,N])}function L(){const N=z.filter(ie=>p.includes(ie.id));if(!N.length)return;const K=[Object.keys(N[0]).join(","),...N.map(ie=>Object.values(ie).map(q=>`"${String(q??"").replace(/"/g,'""')}"`).join(","))].join(`
`),he=new Blob([K],{type:"text/csv"}),le=URL.createObjectURL(he),fe=document.createElement("a");fe.href=le,fe.download="selected_asset_movements.csv",fe.click(),URL.revokeObjectURL(le)}async function O(){if(!p.length||!window.confirm(`Delete ${p.length} selected records? This cannot be undone.`))return;n(!0),i(null);const{error:N}=await Je.from("asset_records").delete().in("id",p);N?i(N.message):t(e.filter(M=>!p.includes(M.id))),d([]),n(!1)}function F(){if(!z.length)return;const M=[Object.keys(z[0]).join(","),...z.map(fe=>Object.values(fe).map(ie=>`"${String(ie??"").replace(/"/g,'""')}"`).join(","))].join(`
`),K=new Blob([M],{type:"text/csv"}),he=URL.createObjectURL(K),le=document.createElement("a");le.href=he,le.download="asset_movements.csv",le.click(),URL.revokeObjectURL(he)}return m.jsxs("div",{className:"max-w-6xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100 w-full",children:[m.jsx("button",{onClick:()=>y(-1),className:"mb-4 bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Back"}),m.jsx("h2",{className:"text-2xl font-bold mb-4 text-blue-900",children:"All Asset Movements"}),m.jsxs("div",{className:"mb-4 flex flex-wrap gap-2 items-end",children:[m.jsx("input",{className:"border p-2 rounded w-64",placeholder:"Search by asset, type, user, location, notes...",value:s,onChange:N=>o(N.target.value)}),m.jsxs("div",{className:"flex flex-col",children:[m.jsx("label",{className:"text-xs text-gray-600",children:"From"}),m.jsx("input",{type:"date",className:"border p-2 rounded",value:l,onChange:N=>c(N.target.value)})]}),m.jsxs("div",{className:"flex flex-col",children:[m.jsx("label",{className:"text-xs text-gray-600",children:"To"}),m.jsx("input",{type:"date",className:"border p-2 rounded",value:u,onChange:N=>h(N.target.value)})]}),m.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700 font-semibold transition",onClick:F,disabled:!z.length,children:"Export CSV"}),m.jsx("button",{className:"bg-green-600 text-white px-4 py-2 rounded shadow hover:bg-green-700 font-semibold transition",onClick:L,disabled:!p.length,children:"Export Selected"}),m.jsx("button",{className:"bg-red-600 text-white px-4 py-2 rounded shadow hover:bg-red-700 font-semibold transition",onClick:O,disabled:!p.length,children:"Delete Selected"}),m.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded shadow hover:bg-gray-600 font-semibold transition",onClick:()=>k(!0),children:"Columns"})]}),v&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:m.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-xl w-80",children:[m.jsx("div",{className:"font-bold mb-2",children:"Show/Hide Columns"}),x.map(N=>m.jsxs("div",{className:"flex items-center mb-1",children:[m.jsx("input",{type:"checkbox",checked:_.includes(N.key),onChange:()=>D(N.key),id:`col-${N.key}`}),m.jsx("label",{htmlFor:`col-${N.key}`,className:"ml-2",children:N.label})]},N.key)),m.jsx("button",{className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded",onClick:()=>k(!1),children:"Close"})]})}),r?m.jsx("div",{children:"Loading..."}):a?m.jsxs("div",{className:"text-red-700",children:["Error: ",a]}):m.jsxs("div",{className:"overflow-x-auto",children:[m.jsxs("table",{className:"min-w-full bg-white border text-xs",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{className:"border px-2 py-1",children:m.jsx("input",{type:"checkbox",checked:p.length===z.length&&z.length>0,onChange:I})}),x.filter(N=>_.includes(N.key)).map(N=>m.jsx("th",{className:"border px-2 py-1",children:N.label},N.key))]})}),m.jsx("tbody",{children:z.map(N=>m.jsxs("tr",{children:[m.jsx("td",{className:"border px-2 py-1",children:m.jsx("input",{type:"checkbox",checked:p.includes(N.id),onChange:()=>T(N.id)})}),x.filter(M=>_.includes(M.key)).map(M=>m.jsx("td",{className:"border px-2 py-1",children:M.key==="created_at"&&N[M.key]?new Date(N[M.key]).toLocaleString():N[M.key]},M.key))]},N.id))})]}),z.length===0&&m.jsx("div",{className:"text-gray-500 mt-2",children:"No movement records found."})]})]})}function dD(){const e=Rt();return m.jsxs("div",{className:"max-w-xl mx-auto mt-16 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100",children:[m.jsx("h2",{className:"text-3xl font-extrabold text-blue-900 mb-8",children:"Import Data"}),m.jsxs("div",{className:"flex gap-6 justify-center mb-8",children:[m.jsx("button",{className:"bg-blue-600 text-white px-8 py-4 rounded-lg shadow-md hover:bg-blue-700 font-semibold text-lg transition",onClick:()=>e("/import-invoices"),children:"Import Invoices"}),m.jsx("button",{className:"bg-green-600 text-white px-8 py-4 rounded-lg shadow-md hover:bg-green-700 font-semibold text-lg transition",onClick:()=>e("/import-sales-receipts"),children:"Import Sales Receipts"})]}),m.jsx("div",{className:"text-gray-700 text-center text-sm",children:"Choose which type of data you want to import. Each import page supports advanced mapping, validation, preview, and error logging."})]})}const _b=[{key:"customer_id",label:"Customer ID"},{key:"customer_name",label:"Customer Name"},{key:"date",label:"Date"},{key:"product_code",label:"Product Code"},{key:"sales_receipt_number",label:"Sales Receipt Number"},{key:"qty_out",label:"Qty Out"},{key:"qty_in",label:"Qty In"}],pD=[{key:"description",label:"Description",aliases:["desc","itemdesc","linedesc"]},{key:"rate",label:"Rate",aliases:["rate","unitprice"]},{key:"amount",label:"Amount",aliases:["amount","lineamount","total"]},{key:"serial_number",label:"Serial Number",aliases:["serialnumber","serial"]}],Kl=[..._b,...pD],zp="importSalesReceiptsFieldMapping";async function mD(){const{data:{user:e}}=await Je.auth.getUser();return e}function gD(){const[e,t]=ge.useState(null),[r,n]=ge.useState([]),[a,i]=ge.useState([]),[s,o]=ge.useState({}),[l,c]=ge.useState([]),[u,h]=ge.useState(null),[p,d]=ge.useState(!1),[y,x]=ge.useState(null),S=Rt(),[v,k]=ge.useState([]),[_,j]=ge.useState(!1),[D,z]=ge.useState(null),[I,T]=ge.useState([]);function L(Z){return Z.every(oe=>typeof oe=="string"&&oe.length>0&&!/^[0-9]+$/.test(oe))}function O(Z){try{const oe=localStorage.getItem(zp);if(!oe)return null;const b=JSON.parse(oe);if(b.columns&&Array.isArray(b.columns)&&JSON.stringify(b.columns)===JSON.stringify(Z))return b.mapping}catch{}return null}const F=Z=>{t(Z.target.files[0]),n([]),i([]),o({}),c([]),h(null),x(null),k([]),j(!1),z(null),T([]);const oe=Z.target.files[0];if(!oe)return;const b=oe.name.split(".").pop().toLowerCase(),A=C=>{if(!C.length)return;let R=[],H=C;L(C[0])?(R=C[0].map((ne,me)=>ne.trim()||`Column ${me+1}`),H=C.slice(1)):R=C[0].map((ne,me)=>`Column ${me+1}`),n(H),i(R);const re=O(R);let ae={};re?ae=re:Kl.forEach(ne=>{const me=R.find(we=>{const X=we.toLowerCase().replace(/\s|_/g,"");return X.includes(ne.key.replace(/_/g,""))?!0:ne.aliases?ne.aliases.some(Ie=>X.includes(Ie)):!1});me&&(ae[ne.key]=me)}),o(ae),c(N(H,R,ae))};if(b==="xls"||b==="xlsx"){const C=new FileReader;C.onload=R=>{const H=new Uint8Array(R.target.result),re=Mc(H,{type:"array"}),ae=re.SheetNames[0],ne=re.Sheets[ae],me=r1.sheet_to_json(ne,{header:1});A(me)},C.readAsArrayBuffer(oe)}else{const C=new FileReader;C.onload=R=>{const re=R.target.result.split(`
`).map(ae=>ae.split("	")).filter(ae=>ae.length>1&&ae.some(ne=>ne.trim()!==""));A(re)},C.readAsText(oe)}};function N(Z,oe,b){return Z.map(A=>{const C={};return Kl.forEach(R=>{const H=b[R.key];if(H){const re=oe.indexOf(H);C[R.key]=A[re]||""}else C[R.key]=""}),C})}const M=(Z,oe)=>{const b={...s,[Z]:oe};o(b),c(N(r,a,b)),a.length&&localStorage.setItem(zp,JSON.stringify({columns:a,mapping:b}))},K=()=>{localStorage.removeItem(zp),o({}),c(N(r,a,{}))};function he(Z){if(!Z)return!1;if(/^\d{2}\/\d{2}\/\d{4}$/.test(Z)){const[oe,b,A]=Z.split("/");return oe>="01"&&oe<="31"&&b>="01"&&b<="12"&&A.length===4}if(/^\d{4}-\d{2}-\d{2}$/.test(Z)){const[oe,b,A]=Z.split("-");return A>="01"&&A<="31"&&b>="01"&&b<="12"&&oe.length===4}return!1}function le(Z,oe){const b=[];return Z.forEach((A,C)=>{Kl.forEach(R=>{oe[R.key]?(!A[R.key]||A[R.key].toString().trim()==="")&&b.push({row:C,field:R.key,reason:"Missing value"}):b.push({row:C,field:R.key,reason:"Field not mapped"})}),A.date&&!he(A.date)&&b.push({row:C,field:"date",reason:"Invalid date format"}),A.qty_out&&isNaN(Number(A.qty_out))&&b.push({row:C,field:"qty_out",reason:"Not a number"}),A.qty_in&&isNaN(Number(A.qty_in))&&b.push({row:C,field:"qty_in",reason:"Not a number"})}),b}const fe=async Z=>{Z.preventDefault(),d(!0),h(null),x(null);const oe=le(l,s);if(oe.length>0){d(!1),x(`Validation failed: ${oe.length} error(s) found. Please fix highlighted rows before importing.`),T(oe);return}let b=null,A=await mD(),C=new Date().toISOString();try{const{data:Se}=await Je.from("import_history").insert([{file_name:(e==null?void 0:e.name)||"",import_type:"sales_receipts",user_id:(A==null?void 0:A.id)||null,user_email:(A==null?void 0:A.email)||null,started_at:C,status:"started"}]).select().single();b=Se==null?void 0:Se.id}catch{}let R=0,H=0,re=0,ae=0,ne=0,me=0,we=0,X=0,Ie=[];try{if(!l.length)throw new Error("No data to import.");for(const Se of l)try{let{data:_e}=await Je.from("customers").select("*").eq("CustomerListID",Se.customer_id).single();if(_e)ae++;else{const{data:Pe}=await Je.from("customers").insert([{CustomerListID:Se.customer_id,name:Se.customer_name}]).select().single();_e=Pe,re++}let{data:Q}=await Je.from("invoices").select("*").eq("details",Se.sales_receipt_number).single();if(Q)me++;else{let Pe=Se.date;if(Pe&&Pe.includes("/")){const[qe,Ke,Ge]=Pe.split("/");Ge&&Ke&&qe&&(Pe=`${Ge}-${Ke.padStart(2,"0")}-${qe.padStart(2,"0")}`)}const{data:De}=await Je.from("invoices").insert([{customer_id:Se.customer_id,invoice_date:Pe,details:Se.sales_receipt_number}]).select().single();Q=De,ne++}const{data:Oe}=await Je.from("cylinders").select("product_code").ilike("product_code",(Se.product_code||"").trim()).single();if(!Oe)X++,Ie.push({...Se,reason:"Not a cylinder"});else if(Q){const{data:Pe}=await Je.from("invoice_line_items").select("id").eq("invoice_id",Q.id).ilike("product_code",(Se.product_code||"").trim()).single();Pe?(X++,Ie.push({...Se,reason:"Duplicate line item"})):(await Je.from("invoice_line_items").insert([{invoice_id:Q.id,product_code:Se.product_code,qty_out:parseInt(Se.qty_out,10)||0,qty_in:parseInt(Se.qty_in,10)||0,description:Se.description||null,rate:Se.rate?parseFloat(Se.rate):null,amount:Se.amount?parseFloat(Se.amount):null,serial_number:Se.serial_number||null}]),R++,we++)}else we++}catch{H++,Ie.push({...Se,reason:"General error"})}b&&await Je.from("import_history").update({finished_at:new Date().toISOString(),status:"success",summary:{imported:R,errors:H,customersCreated:re,customersExisting:ae,receiptsCreated:ne,receiptsExisting:me,lineItemsCreated:we,lineItemsSkipped:X,skippedRowsCount:Ie.length}}).eq("id",b),h({success:!0,imported:R,errors:H,customersCreated:re,customersExisting:ae,receiptsCreated:ne,receiptsExisting:me,lineItemsCreated:we,lineItemsSkipped:X,skippedRows:Ie})}catch(Se){x(Se.message),b&&await Je.from("import_history").update({finished_at:new Date().toISOString(),status:"error",error_message:Se.message}).eq("id",b)}finally{d(!1)}};function ie(Z){if(!Z.length)return;const b=[Object.keys(Z[0]).join(","),...Z.map(H=>Object.values(H).map(re=>`"${String(re).replace(/"/g,'""')}"`).join(","))].join(`
`),A=new Blob([b],{type:"text/csv"}),C=URL.createObjectURL(A),R=document.createElement("a");R.href=C,R.download="skipped_rows.csv",R.click(),URL.revokeObjectURL(C)}async function q(){d(!0),x(null),j(!1);const Z=[];let oe=0,b=0,A=0,C=0,R=0,H=0;for(let re=0;re<l.length;re++){const ae=l[re];let ne="New",me="New",we="New",{data:X}=await Je.from("customers").select("CustomerListID").eq("CustomerListID",ae.customer_id).single();X?(ne="Existing",b++):oe++;let{data:Ie}=await Je.from("invoices").select("id").eq("details",ae.sales_receipt_number).single();Ie?(me="Existing",C++):A++;const{data:Se}=await Je.from("cylinders").select("product_code").ilike("product_code",(ae.product_code||"").trim()).single();if(!Se)we="Skipped (Not a cylinder)",H++;else if(Ie){const{data:_e}=await Je.from("invoice_line_items").select("id").eq("invoice_id",Ie.id).ilike("product_code",(ae.product_code||"").trim()).single();_e?(we="Skipped (Duplicate)",H++):R++}else R++;Z.push({customerStatus:ne,receiptStatus:me,lineItemStatus:we})}k(Z),z({customersCreated:oe,customersExisting:b,receiptsCreated:A,receiptsExisting:C,lineItemsCreated:R,lineItemsSkipped:H}),j(!0),d(!1)}return m.jsxs("div",{className:"max-w-4xl mx-auto mt-10 bg-gradient-to-br from-white via-blue-50 to-blue-100 shadow-2xl rounded-2xl p-8 border border-blue-100",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h2",{className:"text-3xl font-extrabold text-green-900 tracking-tight",children:"Import Sales Receipts"}),m.jsx("button",{onClick:()=>S(-1),className:"bg-gradient-to-r from-gray-400 to-gray-300 text-white px-6 py-2 rounded-lg shadow-md hover:from-gray-500 hover:to-gray-400 font-semibold transition",children:"Back"})]}),m.jsxs("form",{onSubmit:fe,className:"mb-6 flex gap-2 items-end",children:[m.jsx("input",{type:"file",accept:".txt,.csv,.xlsx,.xls",onChange:F,className:"border p-2 rounded w-full"}),m.jsx("button",{type:"submit",className:"bg-green-600 text-white px-6 py-2 rounded-lg shadow-md hover:bg-green-700 font-semibold transition",disabled:!e||!l.length||p||!_||I.length>0,children:p?"Importing...":"Import"})]}),a.length>0&&m.jsxs("div",{className:"mb-6 bg-white/80 rounded-lg p-4 border border-green-200",children:[m.jsxs("div",{className:"font-semibold mb-2 flex items-center gap-4",children:["Field Mapping:",m.jsx("button",{type:"button",className:"bg-gray-200 text-gray-800 px-3 py-1 rounded shadow hover:bg-gray-300 text-xs font-semibold",onClick:K,children:"Reset Mapping"})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Kl.map(Z=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("label",{className:"w-40 font-medium text-green-900",children:[Z.label,_b.find(oe=>oe.key===Z.key)?"":" (optional)"]}),m.jsxs("select",{className:"border p-2 rounded w-full",value:s[Z.key]||"",onChange:oe=>M(Z.key,oe.target.value),children:[m.jsx("option",{value:"",children:"-- Not Mapped --"}),a.map(oe=>m.jsx("option",{value:oe,children:oe},oe))]})]},Z.key))})]}),l.length>0&&m.jsxs("div",{className:"mb-6",children:[m.jsxs("div",{className:"font-semibold mb-2",children:["Preview (",l.length," rows):"]}),m.jsxs("div",{className:"overflow-x-auto",children:[m.jsxs("table",{className:"min-w-full bg-white border",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[Kl.map(Z=>m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:Z.label},Z.key)),m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:"Customer"}),m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:"Receipt"}),m.jsx("th",{className:"border px-2 py-1 text-xs uppercase",children:"Line Item"})]})}),m.jsx("tbody",{children:l.slice(0,5).map((Z,oe)=>{const b=I.filter(C=>C.row===oe),A=v[oe]||{};return m.jsxs("tr",{className:b.length?"bg-red-100":"",children:[Kl.map(C=>{const R=b.find(H=>H.field===C.key);return m.jsx("td",{className:`border px-2 py-1 text-xs ${R?"bg-red-200 text-red-800 font-bold":""}`,children:Z[C.key]||""},C.key)}),m.jsx("td",{className:"border px-2 py-1 text-xs",children:A.customerStatus||""}),m.jsx("td",{className:"border px-2 py-1 text-xs",children:A.receiptStatus||""}),m.jsx("td",{className:"border px-2 py-1 text-xs",children:A.lineItemStatus||""})]},oe)})})]}),l.length>5&&m.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Showing first 5 rows only."})]}),I.length>0&&m.jsxs("div",{className:"text-red-700 bg-red-100 border border-red-300 rounded p-2 mt-2",children:[I.length," validation error(s) found. Please fix highlighted rows before importing."]}),m.jsx("button",{className:"bg-green-500 text-white px-4 py-2 rounded shadow hover:bg-green-600 font-semibold transition mt-4",onClick:q,disabled:p||I.length>0,children:p?"Checking...":"Check Preview"})]}),_&&D&&m.jsxs("div",{className:"bg-green-50 text-green-900 p-4 rounded mb-4 border border-green-200",children:[m.jsx("div",{className:"font-semibold mb-1",children:"Import Summary:"}),m.jsxs("div",{children:["Customers to create: ",D.customersCreated,", already exist: ",D.customersExisting]}),m.jsxs("div",{children:["Receipts to create: ",D.receiptsCreated,", already exist: ",D.receiptsExisting]}),m.jsxs("div",{children:["Line items to import: ",D.lineItemsCreated,", skipped: ",D.lineItemsSkipped]})]}),u&&m.jsxs("div",{className:"bg-green-100 text-green-800 p-4 rounded space-y-1",children:[m.jsx("div",{children:"Import finished!"}),m.jsxs("div",{children:["Customers created: ",u.customersCreated,", already existed: ",u.customersExisting]}),m.jsxs("div",{children:["Receipts created: ",u.receiptsCreated,", already existed: ",u.receiptsExisting]}),m.jsxs("div",{children:["Line items imported: ",u.lineItemsCreated,", skipped: ",u.lineItemsSkipped]}),m.jsxs("div",{children:["Total imported: ",u.imported,", Errors: ",u.errors]}),u.skippedRows&&u.skippedRows.length>0&&m.jsx("button",{className:"bg-yellow-500 text-white px-4 py-2 rounded shadow hover:bg-yellow-600 font-semibold transition mt-2",onClick:()=>ie(u.skippedRows),children:"Download Skipped/Errored Rows"})]})]})}const xD=[{name:"Blue",value:"blue-600"},{name:"Emerald",value:"emerald-500"},{name:"Purple",value:"purple-600"},{name:"Rose",value:"rose-500"},{name:"Amber",value:"amber-500"}],$p={"blue-600":"#2563eb","emerald-500":"#10b981","purple-600":"#7c3aed","rose-500":"#f43f5e","amber-500":"#f59e42"};function vD(){const{user:e,profile:t}=pg(),r=Rt(),[n,a]=ge.useState("profile"),[i,s]=ge.useState((t==null?void 0:t.full_name)||""),[o,l]=ge.useState((e==null?void 0:e.email)||""),[c,u]=ge.useState("");ge.useState("");const[h,p]=ge.useState(""),[d,y]=ge.useState(""),[x,S]=ge.useState(""),[v,k]=ge.useState(localStorage.getItem("theme")||"light"),[_,j]=ge.useState(localStorage.getItem("themeColor")||"blue-600"),[D,z]=ge.useState(localStorage.getItem("importCustomersTheme")||"system"),[I,T]=ge.useState(JSON.parse(localStorage.getItem("notifications"))||{email:!0,inApp:!0}),[L,O]=ge.useState("");ge.useEffect(()=>{s((t==null?void 0:t.full_name)||""),l((e==null?void 0:e.email)||"")},[t,e]),ge.useEffect(()=>{document.documentElement.classList.toggle("dark",v==="dark"),localStorage.setItem("theme",v),localStorage.setItem("themeColor",_)},[v,_]),ge.useEffect(()=>{localStorage.setItem("importCustomersTheme",D)},[D]),ge.useEffect(()=>{document.documentElement.style.setProperty("--accent",$p[_]||$p["blue-600"])},[_]);const F=async le=>{le.preventDefault(),u("");const{error:fe}=await Je.from("profiles").update({full_name:i}).eq("id",e.id);u(fe?fe.message:"Profile updated!")},N=async le=>{if(le.preventDefault(),S(""),h!==d){S("Passwords do not match.");return}const{error:fe}=await Je.auth.updateUser({password:h});S(fe?fe.message:"Password updated!")},M=le=>k(le),K=le=>j(le),he=le=>{const fe={...I,[le]:!I[le]};T(fe),localStorage.setItem("notifications",JSON.stringify(fe)),O("Preferences saved!")};return m.jsxs("div",{className:"max-w-2xl mx-auto mt-10 p-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg",children:[m.jsx("button",{onClick:()=>r("/dashboard"),className:"mb-6 px-4 py-2 rounded font-semibold shadow transition-colors duration-200",style:{background:"var(--accent)",color:"white"},children:" Back to Dashboard"}),m.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-900 dark:text-white",children:"Settings"}),m.jsxs("div",{className:"flex space-x-4 mb-8",children:[m.jsx("button",{onClick:()=>a("profile"),className:`px-4 py-2 rounded-t-lg font-semibold transition-colors duration-200 ${n==="profile"?"text-white":"text-gray-700 dark:text-gray-200"}`,style:n==="profile"?{background:"var(--accent)"}:{background:"#f3f4f6",color:"#374151"},children:"Profile"}),m.jsx("button",{onClick:()=>a("security"),className:`px-4 py-2 rounded-t-lg font-semibold transition-colors duration-200 ${n==="security"?"text-white":"text-gray-700 dark:text-gray-200"}`,style:n==="security"?{background:"var(--accent)"}:{background:"#f3f4f6",color:"#374151"},children:"Security"}),m.jsx("button",{onClick:()=>a("appearance"),className:`px-4 py-2 rounded-t-lg font-semibold transition-colors duration-200 ${n==="appearance"?"text-white":"text-gray-700 dark:text-gray-200"}`,style:n==="appearance"?{background:"var(--accent)"}:{background:"#f3f4f6",color:"#374151"},children:"Appearance"}),m.jsx("button",{onClick:()=>a("notifications"),className:`px-4 py-2 rounded-t-lg font-semibold transition-colors duration-200 ${n==="notifications"?"text-white":"text-gray-700 dark:text-gray-200"}`,style:n==="notifications"?{background:"var(--accent)"}:{background:"#f3f4f6",color:"#374151"},children:"Notifications"})]}),n==="profile"&&m.jsxs("form",{onSubmit:F,className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:"Full Name"}),m.jsx("input",{type:"text",className:"w-full px-4 py-2 rounded border dark:bg-gray-800 dark:text-white focus:ring-2",style:{borderColor:"var(--accent)"},value:i,onChange:le=>s(le.target.value)})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:"Email"}),m.jsx("input",{type:"email",className:"w-full px-4 py-2 rounded border dark:bg-gray-800 dark:text-white",value:o,disabled:!0})]}),m.jsx("button",{type:"submit",className:"px-6 py-2 rounded shadow font-semibold transition-colors duration-200",style:{background:"var(--accent)",color:"white"},children:"Save"}),c&&m.jsx("div",{className:"mt-2 text-green-600 dark:text-green-400",children:c})]}),n==="security"&&m.jsxs("form",{onSubmit:N,className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:"New Password"}),m.jsx("input",{type:"password",className:"w-full px-4 py-2 rounded border dark:bg-gray-800 dark:text-white focus:ring-2",style:{borderColor:"var(--accent)"},value:h,onChange:le=>p(le.target.value)})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:"Confirm New Password"}),m.jsx("input",{type:"password",className:"w-full px-4 py-2 rounded border dark:bg-gray-800 dark:text-white focus:ring-2",style:{borderColor:"var(--accent)"},value:d,onChange:le=>y(le.target.value)})]}),m.jsx("button",{type:"submit",className:"px-6 py-2 rounded shadow font-semibold transition-colors duration-200",style:{background:"var(--accent)",color:"white"},children:"Change Password"}),x&&m.jsx("div",{className:"mt-2 text-green-600 dark:text-green-400",children:x})]}),n==="appearance"&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:"Theme"}),m.jsxs("div",{className:"flex space-x-4",children:[m.jsx("button",{type:"button",onClick:()=>M("light"),className:`px-4 py-2 rounded transition-colors duration-200 ${v==="light"?"text-white":"text-gray-700 dark:text-gray-200"}`,style:v==="light"?{background:"var(--accent)"}:{background:"#f3f4f6",color:"#374151"},children:"Light"}),m.jsx("button",{type:"button",onClick:()=>M("dark"),className:`px-4 py-2 rounded transition-colors duration-200 ${v==="dark"?"text-white":"text-gray-700 dark:text-gray-200"}`,style:v==="dark"?{background:"var(--accent)"}:{background:"#f3f4f6",color:"#374151"},children:"Dark"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:"Import Customers Page Theme"}),m.jsxs("select",{className:"w-full px-4 py-2 rounded border focus:ring-2",style:{borderColor:"var(--accent)"},value:D,onChange:le=>z(le.target.value),children:[m.jsx("option",{value:"system",children:"System/Global"}),m.jsx("option",{value:"light",children:"Light"}),m.jsx("option",{value:"dark",children:"Dark"})]}),m.jsx("div",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Choose a theme for the Import Customers page, independent of the global theme."})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:"Accent Color"}),m.jsx("div",{className:"flex space-x-2",children:xD.map(le=>m.jsx("button",{type:"button",onClick:()=>K(le.value),className:`w-10 h-10 rounded-full border-4 flex items-center justify-center transition-all duration-200 ${_===le.value?"ring-4 ring-accent scale-110":"border-gray-300"}`,style:{background:$p[le.value],borderColor:_===le.value?"var(--accent)":"#d1d5db"},"aria-label":le.name,children:_===le.value&&m.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",strokeWidth:"3",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})},le.value))}),m.jsx("div",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Your accent color is used for highlights, buttons, and tabs."})]})]}),n==="notifications"&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"Email Notifications"}),m.jsx("input",{type:"checkbox",checked:I.email,onChange:()=>he("email"),className:"form-checkbox h-5 w-5",style:{accentColor:"var(--accent)"}})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-700 dark:text-gray-200",children:"In-App Notifications"}),m.jsx("input",{type:"checkbox",checked:I.inApp,onChange:()=>he("inApp"),className:"form-checkbox h-5 w-5",style:{accentColor:"var(--accent)"}})]}),L&&m.jsx("div",{className:"mt-2 text-green-600 dark:text-green-400",children:L})]})]})}const yy={"blue-600":"#2563eb","emerald-500":"#10b981","purple-600":"#7c3aed","rose-500":"#f43f5e","amber-500":"#f59e42"};function yD(){return Math.random().toString(36).substr(2,8).toUpperCase()+"-"+Date.now()}function wD(){const[e,t]=ge.useState(null),[r,n]=ge.useState([]),[a,i]=ge.useState(!1),[s,o]=ge.useState(""),[l,c]=ge.useState(""),u=Rt();ge.useEffect(()=>{const _=localStorage.getItem("themeColor")||"blue-600";document.documentElement.style.setProperty("--accent",yy[_]||yy["blue-600"]);const j=localStorage.getItem("importCustomersTheme")||"system";j==="light"?document.documentElement.classList.remove("dark"):j==="dark"&&document.documentElement.classList.add("dark")},[]);const h=_=>{t(_.target.files[0]),o(""),c(""),n([])},p=()=>{if(!e)return;o(""),c("");const _=new FileReader;_.onload=j=>{const D=j.target.result,z=Mc(D,{type:"binary"}),I=z.SheetNames[0],T=z.Sheets[I];let L=r1.sheet_to_json(T,{defval:""});L=L.map(O=>{let F=O.CustomerListID||yD(),N=x(F);return{...O,CustomerListID:N,customer_number:N,barcode:`*%${N}*`,AccountNumber:N}}),n(L)},_.readAsBinaryString(e)},d=(_,j,D)=>{n(z=>z.map((I,T)=>{if(T!==_)return I;let L={...I,[j]:D};if(j==="CustomerListID"){const O=x(D);L.CustomerListID=O,L.customer_number=O,L.barcode=`*%${O}*`,L.AccountNumber=O}return L}))},y=["CustomerListID","customer_number","barcode","name","contact_details","phone"],x=_=>(_||"").trim().replace(/\s+/g,"").toLowerCase(),S=async()=>{const{data:{user:_}}=await Je.auth.getUser();return _},v=async()=>{i(!0),o(""),c("");const _=new Date().toISOString();let j=await S(),D="",z="success",I=0,T=0,L=0;const O=r.map(q=>({...q,CustomerListID:x(q.CustomerListID)})),F=500;let N=new Set;for(let q=0;q<O.length;q+=F){const Z=O.slice(q,q+F).map(b=>b.CustomerListID),{data:oe}=await Je.from("customers").select("CustomerListID").in("CustomerListID",Z);(oe||[]).forEach(b=>N.add(x(b.CustomerListID)))}const M=new Set,K=[],he=[],le=[],fe=O.filter(q=>{let Z=q.CustomerListID||"",oe=x(Z),b=oe;return b?N.has(b)?(he.push(oe),!1):M.has(b)?(K.push(oe),!1):(M.add(b),q.CustomerListID=oe,q.customer_number=oe,q.barcode=`*%${oe}*`,q.AccountNumber=oe,!0):(le.push(Z),!1)}).map(q=>{const Z={};return y.forEach(oe=>{q[oe]!==void 0&&(Z[oe]=q[oe])}),Z});if(console.log("Checked existing IDs:",Array.from(N)),console.log("To insert:",fe.map(q=>q.CustomerListID)),(K.length>0||he.length>0||le.length>0)&&o((he.length?`Skipped (already in database): ${he.join(", ")}. `:"")+(K.length?`Skipped (duplicate in file): ${K.join(", ")}. `:"")+(le.length?`Skipped (invalid/empty ID): ${le.join(", ")}.`:"")),fe.length===0){o("All customers in the file already exist."),T=r.length,z="skipped",L=0,I=0,await Je.from("import_history").insert([{file_name:(e==null?void 0:e.name)||"",import_type:"customers",user_id:(j==null?void 0:j.id)||null,user_email:(j==null?void 0:j.email)||null,started_at:_,finished_at:new Date().toISOString(),status:z,summary:{imported:I,skipped:T,errors:L},error_message:"All customers in the file already exist."}]),i(!1);return}const{error:ie}=await Je.from("customers").insert(fe);if(ie){let q="";ie.message&&ie.message.includes("duplicate key value")&&(q=`
IDs attempted: ${fe.map(Z=>Z.CustomerListID).join(", ")}`),o(ie.message+q),console.error("Insert error:",ie,"IDs attempted:",fe.map(Z=>Z.CustomerListID)),D=ie.message+q,z="error",L=1}else c(`${fe.length} customers imported successfully!`),n([]),t(null),I=fe.length,T=he.length+K.length+le.length,L=0;await Je.from("import_history").insert([{file_name:(e==null?void 0:e.name)||"",import_type:"customers",user_id:(j==null?void 0:j.id)||null,user_email:(j==null?void 0:j.email)||null,started_at:_,finished_at:new Date().toISOString(),status:z,summary:{imported:I,skipped:T,errors:L},error_message:D}]),i(!1)},k=()=>{n([]),t(null),o(""),c("")};return m.jsxs("div",{className:"max-w-3xl mx-auto mt-10 p-6 bg-white rounded-xl shadow-lg",children:[m.jsx("button",{onClick:()=>u("/dashboard"),className:"mb-6 px-4 py-2 rounded font-semibold shadow transition-colors duration-200",style:{background:"var(--accent)",color:"white"},children:" Back to Dashboard"}),m.jsx("h1",{className:"text-2xl font-bold mb-6 text-gray-900",children:"Import Customers"}),m.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:h,className:"mb-4"}),m.jsx("button",{onClick:p,disabled:!e,className:"ml-2 px-4 py-2 rounded text-white font-semibold shadow transition-colors duration-200",style:{background:"var(--accent)"},children:"Parse File"}),s&&m.jsx("div",{className:"mt-4 text-red-600",children:s}),l&&m.jsx("div",{className:"mt-4 text-green-600",children:l}),r.length>0&&m.jsxs("div",{className:"mt-8",children:[m.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Preview & Approve"}),m.jsxs("div",{className:"flex gap-4 mb-4",children:[m.jsx("button",{onClick:v,disabled:a,className:"px-6 py-2 rounded text-white font-semibold shadow transition-colors duration-200",style:{background:"var(--accent)"},children:"Approve & Import"}),m.jsx("button",{onClick:k,disabled:a,className:"px-6 py-2 rounded text-white font-semibold shadow transition-colors duration-200",style:{background:"#6b7280"},children:"Cancel"})]}),m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"min-w-full border border-gray-200 rounded-lg",children:[m.jsx("thead",{className:"bg-gray-100",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-3 py-2",children:"CustomerListID"}),m.jsx("th",{className:"px-3 py-2",children:"Customer Number"}),m.jsx("th",{className:"px-3 py-2",children:"Barcode"}),m.jsx("th",{className:"px-3 py-2",children:"AccountNumber"}),m.jsx("th",{className:"px-3 py-2",children:"Name"}),m.jsx("th",{className:"px-3 py-2",children:"Contact Details"}),m.jsx("th",{className:"px-3 py-2",children:"Phone"})]})}),m.jsx("tbody",{children:r.map((_,j)=>m.jsxs("tr",{className:"border-t",children:[m.jsx("td",{children:m.jsx("input",{value:_.CustomerListID,onChange:D=>d(j,"CustomerListID",D.target.value),className:"w-36 p-1 border rounded"})}),m.jsx("td",{children:m.jsx("input",{value:_.customer_number,readOnly:!0,className:"w-36 p-1 border rounded bg-gray-100"})}),m.jsx("td",{children:m.jsx("input",{value:_.barcode,readOnly:!0,className:"w-44 p-1 border rounded bg-gray-100 font-mono"})}),m.jsx("td",{children:m.jsx("input",{value:_.AccountNumber,readOnly:!0,className:"w-36 p-1 border rounded bg-gray-100"})}),m.jsx("td",{children:m.jsx("input",{value:_.name||"",onChange:D=>d(j,"name",D.target.value),className:"w-44 p-1 border rounded"})}),m.jsx("td",{children:m.jsx("input",{value:_.contact_details||"",onChange:D=>d(j,"contact_details",D.target.value),className:"w-44 p-1 border rounded"})}),m.jsx("td",{children:m.jsx("input",{value:_.phone||"",onChange:D=>d(j,"phone",D.target.value),className:"w-32 p-1 border rounded"})})]},j))})]})})]})]})}function _D(){const{user:e,profile:t,loading:r}=pg();if(r)return m.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."});const n=!!e;return m.jsx(IE,{children:m.jsxs(H4,{children:[m.jsx(dt,{path:"/",element:m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/login",element:m.jsx(rN,{})}),m.jsx(dt,{path:"/dashboard",element:m.jsx(Xr,{to:"/home",replace:!0})}),m.jsx(dt,{path:"/customers",element:n?m.jsx(aN,{user:e,profile:t}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/customers/:id",element:n?m.jsx(iD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/assets/:id/history",element:n?m.jsx(sD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/assets/history-lookup",element:n?m.jsx(oD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/cylinders",element:n?m.jsx(oR,{user:e,profile:t}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/rentals",element:n?m.jsx(lR,{user:e,profile:t}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/invoices",element:n?m.jsx(lO,{user:e,profile:t}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/home",element:n?m.jsx(dO,{user:e,profile:t}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/settings",element:n?m.jsx(vD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/favorites",element:m.jsx(pO,{})}),m.jsx(dt,{path:"/custom-reports",element:m.jsx(mO,{})}),m.jsxs(dt,{path:"/management-reports",element:m.jsx(vO,{}),children:[m.jsx(dt,{path:"all-assets",element:m.jsx(yO,{})}),m.jsx(dt,{path:"asset-type-changes",element:m.jsx(wO,{})}),m.jsx(dt,{path:"assets-by-customer",element:m.jsx(_O,{})}),m.jsx(dt,{path:"audits-to-delivery-records",element:m.jsx(bO,{})}),m.jsx(dt,{path:"balance-changes-summary",element:m.jsx(kO,{})}),m.jsx(dt,{path:"customer-deliveries",element:m.jsx(SO,{})}),m.jsx(dt,{path:"deliveries-by-location",element:m.jsx(EO,{})}),m.jsx(dt,{path:"delivery-totals-by-user",element:m.jsx(AO,{})}),m.jsx(dt,{path:"lost-assets",element:m.jsx(NO,{})}),m.jsx(dt,{path:"movement-between-locations",element:m.jsx(TO,{})}),m.jsx(dt,{path:"negative-balance-report",element:m.jsx(CO,{})}),m.jsx(dt,{path:"new-assets-added",element:m.jsx(LO,{})}),m.jsx(dt,{path:"not-scanned-source",element:m.jsx(FO,{})}),m.jsx(dt,{path:"overdue-asset-search",element:m.jsx(PO,{})}),m.jsx(dt,{path:"print-days-records",element:m.jsx(IO,{})}),m.jsx(dt,{path:"quick-map",element:m.jsx(jO,{})})]}),m.jsx(dt,{path:"/quick-add",element:m.jsx(RO,{})}),m.jsx(dt,{path:"/lot-reports",element:m.jsx(OO,{})}),m.jsx(dt,{path:"/regular-maintenance",element:m.jsx(DO,{})}),m.jsx(dt,{path:"/locations",element:m.jsx(MO,{})}),m.jsx(dt,{path:"/search",element:m.jsx(BO,{})}),m.jsx(dt,{path:"/create-records",element:m.jsx(UO,{})}),m.jsx(dt,{path:"/alerts",element:m.jsx(zO,{})}),m.jsx(dt,{path:"/mobile-units",element:m.jsx($O,{})}),m.jsx(dt,{path:"/rental/*",element:m.jsx(aD,{})}),m.jsx(dt,{path:"/import",element:n?m.jsx(dD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/import-customer-info",element:n?m.jsx(wD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/import-sales-receipts",element:n?m.jsx(gD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/import-invoices",element:n?m.jsx(uD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/import-history",element:n?m.jsx(fD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"/all-asset-movements",element:n?m.jsx(hD,{}):m.jsx(Xr,{to:"/login"})}),m.jsx(dt,{path:"*",element:m.jsx(Xr,{to:"/login"})})]})})}const bD=document.getElementById("root"),kD=I4(bD);kD.render(m.jsx(_D,{}));export{Qt as _,Ea as c,wy as g};
